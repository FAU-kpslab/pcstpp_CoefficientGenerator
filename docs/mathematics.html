<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 13.1.0"/>
    <title>mathematics API documentation</title>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;z-index:999;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent }nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{cursor:pointer;display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .pdoc-alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:1rem center;margin-bottom:1rem;}.pdoc .pdoc-alert > *:last-child{margin-bottom:0;}.pdoc .pdoc-alert-note {color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--code);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .view-value-toggle-state,.pdoc .view-value-toggle-state ~ .default_value{display:none;}.pdoc .view-value-toggle-state:checked ~ .default_value{display:inherit;}.pdoc .view-value-button{font-size:.5rem;vertical-align:middle;border-style:dashed;margin-top:-0.1rem;}.pdoc .view-value-button:hover{background:white;}.pdoc .view-value-button::before{content:"show";text-align:center;width:2.2em;display:inline-block;}.pdoc .view-value-toggle-state:checked ~ .view-value-button::before{content:"hide";}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>            <a class="pdoc-button module-list-button" href="index.html">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-in-left" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M10 3.5a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 1 0v2A1.5 1.5 0 0 1 9.5 14h-8A1.5 1.5 0 0 1 0 12.5v-9A1.5 1.5 0 0 1 1.5 2h8A1.5 1.5 0 0 1 11 3.5v2a.5.5 0 0 1-1 0v-2z"/>
  <path fill-rule="evenodd" d="M4.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H14.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"/>
</svg>                &nbsp;
                Module Index
            </a>


            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>



            <h2>API Documentation</h2>
                <ul class="memberlist">
            <li>
                    <a class="class" href="#Expr">Expr</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Expr.sort_key">sort_key</a>
                        </li>
                        <li>
                                <a class="variable" href="#Expr.is_number">is_number</a>
                        </li>
                        <li>
                                <a class="function" href="#Expr.is_constant">is_constant</a>
                        </li>
                        <li>
                                <a class="function" href="#Expr.equals">equals</a>
                        </li>
                        <li>
                                <a class="function" href="#Expr.conjugate">conjugate</a>
                        </li>
                        <li>
                                <a class="function" href="#Expr.dir">dir</a>
                        </li>
                        <li>
                                <a class="function" href="#Expr.transpose">transpose</a>
                        </li>
                        <li>
                                <a class="function" href="#Expr.adjoint">adjoint</a>
                        </li>
                        <li>
                                <a class="function" href="#Expr.as_ordered_factors">as_ordered_factors</a>
                        </li>
                        <li>
                                <a class="function" href="#Expr.as_poly">as_poly</a>
                        </li>
                        <li>
                                <a class="function" href="#Expr.as_ordered_terms">as_ordered_terms</a>
                        </li>
                        <li>
                                <a class="function" href="#Expr.as_terms">as_terms</a>
                        </li>
                        <li>
                                <a class="function" href="#Expr.removeO">removeO</a>
                        </li>
                        <li>
                                <a class="function" href="#Expr.getO">getO</a>
                        </li>
                        <li>
                                <a class="function" href="#Expr.getn">getn</a>
                        </li>
                        <li>
                                <a class="function" href="#Expr.count_ops">count_ops</a>
                        </li>
                        <li>
                                <a class="function" href="#Expr.args_cnc">args_cnc</a>
                        </li>
                        <li>
                                <a class="function" href="#Expr.coeff">coeff</a>
                        </li>
                        <li>
                                <a class="function" href="#Expr.as_expr">as_expr</a>
                        </li>
                        <li>
                                <a class="function" href="#Expr.as_coefficient">as_coefficient</a>
                        </li>
                        <li>
                                <a class="function" href="#Expr.as_independent">as_independent</a>
                        </li>
                        <li>
                                <a class="function" href="#Expr.as_real_imag">as_real_imag</a>
                        </li>
                        <li>
                                <a class="function" href="#Expr.as_powers_dict">as_powers_dict</a>
                        </li>
                        <li>
                                <a class="function" href="#Expr.as_coefficients_dict">as_coefficients_dict</a>
                        </li>
                        <li>
                                <a class="function" href="#Expr.as_base_exp">as_base_exp</a>
                        </li>
                        <li>
                                <a class="function" href="#Expr.as_coeff_mul">as_coeff_mul</a>
                        </li>
                        <li>
                                <a class="function" href="#Expr.as_coeff_add">as_coeff_add</a>
                        </li>
                        <li>
                                <a class="function" href="#Expr.primitive">primitive</a>
                        </li>
                        <li>
                                <a class="function" href="#Expr.as_content_primitive">as_content_primitive</a>
                        </li>
                        <li>
                                <a class="function" href="#Expr.as_numer_denom">as_numer_denom</a>
                        </li>
                        <li>
                                <a class="function" href="#Expr.normal">normal</a>
                        </li>
                        <li>
                                <a class="function" href="#Expr.extract_multiplicatively">extract_multiplicatively</a>
                        </li>
                        <li>
                                <a class="function" href="#Expr.extract_additively">extract_additively</a>
                        </li>
                        <li>
                                <a class="variable" href="#Expr.expr_free_symbols">expr_free_symbols</a>
                        </li>
                        <li>
                                <a class="function" href="#Expr.could_extract_minus_sign">could_extract_minus_sign</a>
                        </li>
                        <li>
                                <a class="function" href="#Expr.extract_branch_factor">extract_branch_factor</a>
                        </li>
                        <li>
                                <a class="function" href="#Expr.is_polynomial">is_polynomial</a>
                        </li>
                        <li>
                                <a class="function" href="#Expr.is_rational_function">is_rational_function</a>
                        </li>
                        <li>
                                <a class="function" href="#Expr.is_meromorphic">is_meromorphic</a>
                        </li>
                        <li>
                                <a class="function" href="#Expr.is_algebraic_expr">is_algebraic_expr</a>
                        </li>
                        <li>
                                <a class="function" href="#Expr.series">series</a>
                        </li>
                        <li>
                                <a class="function" href="#Expr.aseries">aseries</a>
                        </li>
                        <li>
                                <a class="function" href="#Expr.taylor_term">taylor_term</a>
                        </li>
                        <li>
                                <a class="function" href="#Expr.lseries">lseries</a>
                        </li>
                        <li>
                                <a class="function" href="#Expr.nseries">nseries</a>
                        </li>
                        <li>
                                <a class="function" href="#Expr.limit">limit</a>
                        </li>
                        <li>
                                <a class="function" href="#Expr.compute_leading_term">compute_leading_term</a>
                        </li>
                        <li>
                                <a class="function" href="#Expr.as_leading_term">as_leading_term</a>
                        </li>
                        <li>
                                <a class="function" href="#Expr.as_coeff_exponent">as_coeff_exponent</a>
                        </li>
                        <li>
                                <a class="function" href="#Expr.leadterm">leadterm</a>
                        </li>
                        <li>
                                <a class="function" href="#Expr.as_coeff_Mul">as_coeff_Mul</a>
                        </li>
                        <li>
                                <a class="function" href="#Expr.as_coeff_Add">as_coeff_Add</a>
                        </li>
                        <li>
                                <a class="function" href="#Expr.fps">fps</a>
                        </li>
                        <li>
                                <a class="function" href="#Expr.fourier_series">fourier_series</a>
                        </li>
                        <li>
                                <a class="function" href="#Expr.diff">diff</a>
                        </li>
                        <li>
                                <a class="function" href="#Expr.expand">expand</a>
                        </li>
                        <li>
                                <a class="function" href="#Expr.integrate">integrate</a>
                        </li>
                        <li>
                                <a class="function" href="#Expr.nsimplify">nsimplify</a>
                        </li>
                        <li>
                                <a class="function" href="#Expr.separate">separate</a>
                        </li>
                        <li>
                                <a class="function" href="#Expr.collect">collect</a>
                        </li>
                        <li>
                                <a class="function" href="#Expr.together">together</a>
                        </li>
                        <li>
                                <a class="function" href="#Expr.apart">apart</a>
                        </li>
                        <li>
                                <a class="function" href="#Expr.ratsimp">ratsimp</a>
                        </li>
                        <li>
                                <a class="function" href="#Expr.trigsimp">trigsimp</a>
                        </li>
                        <li>
                                <a class="function" href="#Expr.radsimp">radsimp</a>
                        </li>
                        <li>
                                <a class="function" href="#Expr.powsimp">powsimp</a>
                        </li>
                        <li>
                                <a class="function" href="#Expr.combsimp">combsimp</a>
                        </li>
                        <li>
                                <a class="function" href="#Expr.gammasimp">gammasimp</a>
                        </li>
                        <li>
                                <a class="function" href="#Expr.factor">factor</a>
                        </li>
                        <li>
                                <a class="function" href="#Expr.cancel">cancel</a>
                        </li>
                        <li>
                                <a class="function" href="#Expr.invert">invert</a>
                        </li>
                        <li>
                                <a class="function" href="#Expr.round">round</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="function" href="#energy">energy</a>
            </li>
            <li>
                    <a class="function" href="#energy_broad">energy_broad</a>
            </li>
            <li>
                    <a class="function" href="#signum">signum</a>
            </li>
            <li>
                    <a class="function" href="#signum_broad">signum_broad</a>
            </li>
            <li>
                    <a class="function" href="#signum_complex">signum_complex</a>
            </li>
            <li>
                    <a class="function" href="#exponential">exponential</a>
            </li>
            <li>
                    <a class="function" href="#partitions">partitions</a>
            </li>
    </ul>



        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
mathematics    </h1>

                
                        <input id="mod-mathematics-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-mathematics-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos">  1</span></a><span class="c1">#__pdoc__ = {}</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos">  2</span></a><span class="c1">#__pdoc__[&#39;Expr&#39;] = False</span>
</span><span id="L-3"><a href="#L-3"><span class="linenos">  3</span></a>
</span><span id="L-4"><a href="#L-4"><span class="linenos">  4</span></a><span class="kn">from</span> <span class="nn">fractions</span> <span class="kn">import</span> <span class="n">Fraction</span>
</span><span id="L-5"><a href="#L-5"><span class="linenos">  5</span></a><span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">reduce</span>
</span><span id="L-6"><a href="#L-6"><span class="linenos">  6</span></a><span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">product</span>
</span><span id="L-7"><a href="#L-7"><span class="linenos">  7</span></a><span class="kn">import</span> <span class="nn">operator</span>
</span><span id="L-8"><a href="#L-8"><span class="linenos">  8</span></a>
</span><span id="L-9"><a href="#L-9"><span class="linenos">  9</span></a><span class="kn">from</span> <span class="nn">quasiPolynomial</span> <span class="kn">import</span> <span class="n">QuasiPolynomial</span><span class="p">,</span> <span class="n">are_close</span><span class="p">,</span> <span class="n">is_zero</span>
</span><span id="L-10"><a href="#L-10"><span class="linenos"> 10</span></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span><span id="L-11"><a href="#L-11"><span class="linenos"> 11</span></a><span class="kn">import</span> <span class="nn">sympy</span> <span class="k">as</span> <span class="nn">sym</span>
</span><span id="L-12"><a href="#L-12"><span class="linenos"> 12</span></a><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">,</span> <span class="n">Union</span><span class="p">,</span> <span class="n">TypeVar</span><span class="p">,</span> <span class="n">cast</span>
</span><span id="L-13"><a href="#L-13"><span class="linenos"> 13</span></a>
</span><span id="L-14"><a href="#L-14"><span class="linenos"> 14</span></a><span class="n">Expr</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">Expr</span>
</span><span id="L-15"><a href="#L-15"><span class="linenos"> 15</span></a><span class="n">Coeff</span> <span class="o">=</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="n">Fraction</span><span class="p">,</span> <span class="nb">complex</span><span class="p">,</span> <span class="n">Expr</span><span class="p">]</span>
</span><span id="L-16"><a href="#L-16"><span class="linenos"> 16</span></a><span class="n">Energy</span> <span class="o">=</span> <span class="n">Coeff</span>
</span><span id="L-17"><a href="#L-17"><span class="linenos"> 17</span></a><span class="n">Energy_real</span> <span class="o">=</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="n">Fraction</span><span class="p">]</span>
</span><span id="L-18"><a href="#L-18"><span class="linenos"> 18</span></a><span class="n">E</span> <span class="o">=</span> <span class="n">TypeVar</span><span class="p">(</span><span class="s1">&#39;E&#39;</span><span class="p">,</span> <span class="n">bound</span><span class="o">=</span><span class="n">Energy</span><span class="p">)</span>
</span><span id="L-19"><a href="#L-19"><span class="linenos"> 19</span></a><span class="n">E_real</span> <span class="o">=</span> <span class="n">TypeVar</span><span class="p">(</span><span class="s1">&#39;E_real&#39;</span><span class="p">,</span> <span class="n">bound</span><span class="o">=</span><span class="n">Energy_real</span><span class="p">)</span>
</span><span id="L-20"><a href="#L-20"><span class="linenos"> 20</span></a><span class="n">Indices</span> <span class="o">=</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">E</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span> <span class="o">...</span><span class="p">]</span>
</span><span id="L-21"><a href="#L-21"><span class="linenos"> 21</span></a><span class="n">Sequence</span> <span class="o">=</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span> <span class="o">...</span><span class="p">]</span>
</span><span id="L-22"><a href="#L-22"><span class="linenos"> 22</span></a>
</span><span id="L-23"><a href="#L-23"><span class="linenos"> 23</span></a>
</span><span id="L-24"><a href="#L-24"><span class="linenos"> 24</span></a><span class="k">def</span> <span class="nf">energy</span><span class="p">(</span><span class="n">indices</span><span class="p">:</span> <span class="n">Indices</span><span class="p">[</span><span class="n">E</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">E</span><span class="p">:</span>
</span><span id="L-25"><a href="#L-25"><span class="linenos"> 25</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-26"><a href="#L-26"><span class="linenos"> 26</span></a><span class="sd">    energy(indices)</span>
</span><span id="L-27"><a href="#L-27"><span class="linenos"> 27</span></a>
</span><span id="L-28"><a href="#L-28"><span class="linenos"> 28</span></a><span class="sd">    Returns the sum M(m) of operator sequence indices.</span>
</span><span id="L-29"><a href="#L-29"><span class="linenos"> 29</span></a>
</span><span id="L-30"><a href="#L-30"><span class="linenos"> 30</span></a><span class="sd">    Parameters</span>
</span><span id="L-31"><a href="#L-31"><span class="linenos"> 31</span></a><span class="sd">    ----------</span>
</span><span id="L-32"><a href="#L-32"><span class="linenos"> 32</span></a><span class="sd">    indices</span>
</span><span id="L-33"><a href="#L-33"><span class="linenos"> 33</span></a><span class="sd">        Operator sequence indices.</span>
</span><span id="L-34"><a href="#L-34"><span class="linenos"> 34</span></a>
</span><span id="L-35"><a href="#L-35"><span class="linenos"> 35</span></a><span class="sd">    Returns</span>
</span><span id="L-36"><a href="#L-36"><span class="linenos"> 36</span></a><span class="sd">    -------</span>
</span><span id="L-37"><a href="#L-37"><span class="linenos"> 37</span></a><span class="sd">    Union[int, float, Fraction, complex, Expr]</span>
</span><span id="L-38"><a href="#L-38"><span class="linenos"> 38</span></a><span class="sd">        Sum M(m).</span>
</span><span id="L-39"><a href="#L-39"><span class="linenos"> 39</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-40"><a href="#L-40"><span class="linenos"> 40</span></a>
</span><span id="L-41"><a href="#L-41"><span class="linenos"> 41</span></a>    <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="n">reduce</span><span class="p">(</span><span class="n">operator</span><span class="o">.</span><span class="n">add</span><span class="p">,</span> <span class="n">indices</span><span class="p">),</span> <span class="n">cast</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
</span><span id="L-42"><a href="#L-42"><span class="linenos"> 42</span></a>
</span><span id="L-43"><a href="#L-43"><span class="linenos"> 43</span></a>
</span><span id="L-44"><a href="#L-44"><span class="linenos"> 44</span></a><span class="k">def</span> <span class="nf">energy_broad</span><span class="p">(</span><span class="n">indices</span><span class="p">:</span> <span class="n">Indices</span><span class="p">[</span><span class="n">Energy_real</span><span class="p">],</span> <span class="n">delta</span><span class="p">:</span> <span class="n">Energy_real</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Energy_real</span><span class="p">:</span>
</span><span id="L-45"><a href="#L-45"><span class="linenos"> 45</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-46"><a href="#L-46"><span class="linenos"> 46</span></a><span class="sd">    energy_broad(indices)</span>
</span><span id="L-47"><a href="#L-47"><span class="linenos"> 47</span></a>
</span><span id="L-48"><a href="#L-48"><span class="linenos"> 48</span></a><span class="sd">    Returns the *broadened* sum M(m)*theta(|M(m)|-delta) of operator sequence indices, where theta is the Heaviside</span>
</span><span id="L-49"><a href="#L-49"><span class="linenos"> 49</span></a><span class="sd">    step function.</span>
</span><span id="L-50"><a href="#L-50"><span class="linenos"> 50</span></a>
</span><span id="L-51"><a href="#L-51"><span class="linenos"> 51</span></a><span class="sd">    Parameters</span>
</span><span id="L-52"><a href="#L-52"><span class="linenos"> 52</span></a><span class="sd">    ----------</span>
</span><span id="L-53"><a href="#L-53"><span class="linenos"> 53</span></a><span class="sd">    indices</span>
</span><span id="L-54"><a href="#L-54"><span class="linenos"> 54</span></a><span class="sd">        Operator sequence indices.</span>
</span><span id="L-55"><a href="#L-55"><span class="linenos"> 55</span></a>
</span><span id="L-56"><a href="#L-56"><span class="linenos"> 56</span></a><span class="sd">    Returns</span>
</span><span id="L-57"><a href="#L-57"><span class="linenos"> 57</span></a><span class="sd">    -------</span>
</span><span id="L-58"><a href="#L-58"><span class="linenos"> 58</span></a><span class="sd">    Union[int, float, Fraction]</span>
</span><span id="L-59"><a href="#L-59"><span class="linenos"> 59</span></a><span class="sd">        Sum M(m)*theta(|M(m)|-delta).</span>
</span><span id="L-60"><a href="#L-60"><span class="linenos"> 60</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-61"><a href="#L-61"><span class="linenos"> 61</span></a>
</span><span id="L-62"><a href="#L-62"><span class="linenos"> 62</span></a>    <span class="n">e</span> <span class="o">=</span> <span class="n">energy</span><span class="p">(</span><span class="n">indices</span><span class="p">)</span>
</span><span id="L-63"><a href="#L-63"><span class="linenos"> 63</span></a>    <span class="c1"># also return 0 if `abs(e)` is very close to `delta` to deal with</span>
</span><span id="L-64"><a href="#L-64"><span class="linenos"> 64</span></a>    <span class="c1"># floating errors</span>
</span><span id="L-65"><a href="#L-65"><span class="linenos"> 65</span></a>    <span class="k">return</span> <span class="n">e</span> <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">e</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">delta</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">are_close</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">e</span><span class="p">),</span> <span class="n">delta</span><span class="p">)</span> <span class="k">else</span> <span class="mi">0</span>
</span><span id="L-66"><a href="#L-66"><span class="linenos"> 66</span></a>
</span><span id="L-67"><a href="#L-67"><span class="linenos"> 67</span></a>
</span><span id="L-68"><a href="#L-68"><span class="linenos"> 68</span></a><span class="k">def</span> <span class="nf">signum</span><span class="p">(</span><span class="n">indices1</span><span class="p">:</span> <span class="n">Indices</span><span class="p">[</span><span class="n">Energy_real</span><span class="p">],</span> <span class="n">indices2</span><span class="p">:</span> <span class="n">Indices</span><span class="p">[</span><span class="n">Energy_real</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="L-69"><a href="#L-69"><span class="linenos"> 69</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-70"><a href="#L-70"><span class="linenos"> 70</span></a><span class="sd">    signum(indices1, indices2)</span>
</span><span id="L-71"><a href="#L-71"><span class="linenos"> 71</span></a>
</span><span id="L-72"><a href="#L-72"><span class="linenos"> 72</span></a><span class="sd">    Returns the prefactor sgn(M(m1)) - sgn(M(m2)).</span>
</span><span id="L-73"><a href="#L-73"><span class="linenos"> 73</span></a>
</span><span id="L-74"><a href="#L-74"><span class="linenos"> 74</span></a><span class="sd">    Parameters</span>
</span><span id="L-75"><a href="#L-75"><span class="linenos"> 75</span></a><span class="sd">    ----------</span>
</span><span id="L-76"><a href="#L-76"><span class="linenos"> 76</span></a><span class="sd">    indices1</span>
</span><span id="L-77"><a href="#L-77"><span class="linenos"> 77</span></a><span class="sd">        Operator sequence indices whose sgn(M(m1)) is to be added.</span>
</span><span id="L-78"><a href="#L-78"><span class="linenos"> 78</span></a><span class="sd">    indices2</span>
</span><span id="L-79"><a href="#L-79"><span class="linenos"> 79</span></a><span class="sd">        Operator sequence indices whose sgn(M(m2)) is to be substracted.</span>
</span><span id="L-80"><a href="#L-80"><span class="linenos"> 80</span></a>
</span><span id="L-81"><a href="#L-81"><span class="linenos"> 81</span></a><span class="sd">    Returns</span>
</span><span id="L-82"><a href="#L-82"><span class="linenos"> 82</span></a><span class="sd">    -------</span>
</span><span id="L-83"><a href="#L-83"><span class="linenos"> 83</span></a><span class="sd">    int</span>
</span><span id="L-84"><a href="#L-84"><span class="linenos"> 84</span></a><span class="sd">        Difference of signum functions.</span>
</span><span id="L-85"><a href="#L-85"><span class="linenos"> 85</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-86"><a href="#L-86"><span class="linenos"> 86</span></a>
</span><span id="L-87"><a href="#L-87"><span class="linenos"> 87</span></a>    <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">energy</span><span class="p">(</span><span class="n">indices1</span><span class="p">)))</span> <span class="o">-</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">energy</span><span class="p">(</span><span class="n">indices2</span><span class="p">)))</span>
</span><span id="L-88"><a href="#L-88"><span class="linenos"> 88</span></a>
</span><span id="L-89"><a href="#L-89"><span class="linenos"> 89</span></a>
</span><span id="L-90"><a href="#L-90"><span class="linenos"> 90</span></a><span class="k">def</span> <span class="nf">signum_broad</span><span class="p">(</span><span class="n">indices1</span><span class="p">:</span> <span class="n">Indices</span><span class="p">[</span><span class="n">Energy_real</span><span class="p">],</span> <span class="n">indices2</span><span class="p">:</span> <span class="n">Indices</span><span class="p">[</span><span class="n">Energy_real</span><span class="p">],</span> <span class="n">delta</span><span class="p">:</span> <span class="n">Energy_real</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="L-91"><a href="#L-91"><span class="linenos"> 91</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-92"><a href="#L-92"><span class="linenos"> 92</span></a><span class="sd">    signum_broad(indices1, indices2, delta)</span>
</span><span id="L-93"><a href="#L-93"><span class="linenos"> 93</span></a>
</span><span id="L-94"><a href="#L-94"><span class="linenos"> 94</span></a><span class="sd">    Returns the prefactor sgn_`delta`(M(m1)) - sgn_delta(M(m2)), where sgn_d is the broadened signum function with</span>
</span><span id="L-95"><a href="#L-95"><span class="linenos"> 95</span></a><span class="sd">    sgn_d(x) = 0 for |x| &lt;= d and sgn_d(x) = sgn(x), otherwise.</span>
</span><span id="L-96"><a href="#L-96"><span class="linenos"> 96</span></a>
</span><span id="L-97"><a href="#L-97"><span class="linenos"> 97</span></a><span class="sd">    Parameters</span>
</span><span id="L-98"><a href="#L-98"><span class="linenos"> 98</span></a><span class="sd">    ----------</span>
</span><span id="L-99"><a href="#L-99"><span class="linenos"> 99</span></a><span class="sd">    indices1</span>
</span><span id="L-100"><a href="#L-100"><span class="linenos">100</span></a><span class="sd">        Operator sequence indices whose sgn_d(M(m1)) is to be added.</span>
</span><span id="L-101"><a href="#L-101"><span class="linenos">101</span></a><span class="sd">    indices2</span>
</span><span id="L-102"><a href="#L-102"><span class="linenos">102</span></a><span class="sd">        Operator sequence indices whose sgn_d(M(m2)) is to be substracted.</span>
</span><span id="L-103"><a href="#L-103"><span class="linenos">103</span></a>
</span><span id="L-104"><a href="#L-104"><span class="linenos">104</span></a><span class="sd">    Returns</span>
</span><span id="L-105"><a href="#L-105"><span class="linenos">105</span></a><span class="sd">    -------</span>
</span><span id="L-106"><a href="#L-106"><span class="linenos">106</span></a><span class="sd">    int</span>
</span><span id="L-107"><a href="#L-107"><span class="linenos">107</span></a><span class="sd">        Difference of broad signum functions.</span>
</span><span id="L-108"><a href="#L-108"><span class="linenos">108</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-109"><a href="#L-109"><span class="linenos">109</span></a>
</span><span id="L-110"><a href="#L-110"><span class="linenos">110</span></a>    <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">energy_broad</span><span class="p">(</span><span class="n">indices1</span><span class="p">,</span> <span class="n">delta</span><span class="p">)))</span> <span class="o">-</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">energy_broad</span><span class="p">(</span><span class="n">indices2</span><span class="p">,</span> <span class="n">delta</span><span class="p">)))</span>
</span><span id="L-111"><a href="#L-111"><span class="linenos">111</span></a>
</span><span id="L-112"><a href="#L-112"><span class="linenos">112</span></a>
</span><span id="L-113"><a href="#L-113"><span class="linenos">113</span></a><span class="k">def</span> <span class="nf">signum_complex</span><span class="p">(</span><span class="n">indices1</span><span class="p">:</span> <span class="n">Indices</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">complex</span><span class="p">,</span> <span class="n">Expr</span><span class="p">]],</span> <span class="n">indices2</span><span class="p">:</span> <span class="n">Indices</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">complex</span><span class="p">,</span> <span class="n">Expr</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="nb">complex</span><span class="p">,</span>
</span><span id="L-114"><a href="#L-114"><span class="linenos">114</span></a>                                                                                                              <span class="n">Expr</span><span class="p">]:</span>
</span><span id="L-115"><a href="#L-115"><span class="linenos">115</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-116"><a href="#L-116"><span class="linenos">116</span></a><span class="sd">    signum_complex(indices1, indices2)</span>
</span><span id="L-117"><a href="#L-117"><span class="linenos">117</span></a>
</span><span id="L-118"><a href="#L-118"><span class="linenos">118</span></a><span class="sd">    Returns the prefactor sgn(M(m1)) - sgn(M(m2)) with the definition sgn(z) = z / |z| as used in the Schmiedinghoff,</span>
</span><span id="L-119"><a href="#L-119"><span class="linenos">119</span></a><span class="sd">    Uhrig paper.</span>
</span><span id="L-120"><a href="#L-120"><span class="linenos">120</span></a>
</span><span id="L-121"><a href="#L-121"><span class="linenos">121</span></a><span class="sd">    Parameters</span>
</span><span id="L-122"><a href="#L-122"><span class="linenos">122</span></a><span class="sd">    ----------</span>
</span><span id="L-123"><a href="#L-123"><span class="linenos">123</span></a><span class="sd">    indices1</span>
</span><span id="L-124"><a href="#L-124"><span class="linenos">124</span></a><span class="sd">        Operator sequence indices whose complex sgn(M(m1)) is to be added.</span>
</span><span id="L-125"><a href="#L-125"><span class="linenos">125</span></a><span class="sd">    indices2</span>
</span><span id="L-126"><a href="#L-126"><span class="linenos">126</span></a><span class="sd">        Operator sequence indices whose complex sgn(M(m2)) is to be subtracted.</span>
</span><span id="L-127"><a href="#L-127"><span class="linenos">127</span></a>
</span><span id="L-128"><a href="#L-128"><span class="linenos">128</span></a><span class="sd">    Returns</span>
</span><span id="L-129"><a href="#L-129"><span class="linenos">129</span></a><span class="sd">    -------</span>
</span><span id="L-130"><a href="#L-130"><span class="linenos">130</span></a><span class="sd">    Union[complex, Expr]</span>
</span><span id="L-131"><a href="#L-131"><span class="linenos">131</span></a><span class="sd">        Difference of complex signum functions.</span>
</span><span id="L-132"><a href="#L-132"><span class="linenos">132</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-133"><a href="#L-133"><span class="linenos">133</span></a>
</span><span id="L-134"><a href="#L-134"><span class="linenos">134</span></a>    <span class="n">complex_sgn</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">z</span><span class="p">:</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">is_zero</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="k">else</span> <span class="n">z</span><span class="o">.</span><span class="n">conjugate</span><span class="p">()</span> <span class="o">/</span> <span class="nb">abs</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
</span><span id="L-135"><a href="#L-135"><span class="linenos">135</span></a>    <span class="k">return</span> <span class="n">complex_sgn</span><span class="p">(</span><span class="n">energy</span><span class="p">(</span><span class="n">indices1</span><span class="p">))</span> <span class="o">-</span> <span class="n">complex_sgn</span><span class="p">(</span><span class="n">energy</span><span class="p">(</span><span class="n">indices2</span><span class="p">))</span>
</span><span id="L-136"><a href="#L-136"><span class="linenos">136</span></a>
</span><span id="L-137"><a href="#L-137"><span class="linenos">137</span></a>
</span><span id="L-138"><a href="#L-138"><span class="linenos">138</span></a><span class="k">def</span> <span class="nf">exponential</span><span class="p">(</span><span class="n">indices</span><span class="p">:</span> <span class="n">Indices</span><span class="p">[</span><span class="n">Energy</span><span class="p">],</span>
</span><span id="L-139"><a href="#L-139"><span class="linenos">139</span></a>                <span class="n">indices1</span><span class="p">:</span> <span class="n">Indices</span><span class="p">[</span><span class="n">Energy</span><span class="p">],</span>
</span><span id="L-140"><a href="#L-140"><span class="linenos">140</span></a>                <span class="n">indices2</span><span class="p">:</span> <span class="n">Indices</span><span class="p">[</span><span class="n">Energy</span><span class="p">],</span>
</span><span id="L-141"><a href="#L-141"><span class="linenos">141</span></a>                <span class="n">energy_func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Indices</span><span class="p">[</span><span class="n">Energy</span><span class="p">]],</span> <span class="n">Energy</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">QuasiPolynomial</span><span class="p">:</span>
</span><span id="L-142"><a href="#L-142"><span class="linenos">142</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-143"><a href="#L-143"><span class="linenos">143</span></a><span class="sd">    exponential(indices, indices1, indices2)</span>
</span><span id="L-144"><a href="#L-144"><span class="linenos">144</span></a>
</span><span id="L-145"><a href="#L-145"><span class="linenos">145</span></a><span class="sd">    Returns the exponential exp(- alpha x) with alpha = - (|M(m)| - |M(m1)| - |M(m2)|).</span>
</span><span id="L-146"><a href="#L-146"><span class="linenos">146</span></a>
</span><span id="L-147"><a href="#L-147"><span class="linenos">147</span></a><span class="sd">    Parameters</span>
</span><span id="L-148"><a href="#L-148"><span class="linenos">148</span></a><span class="sd">    ----------</span>
</span><span id="L-149"><a href="#L-149"><span class="linenos">149</span></a><span class="sd">    indices</span>
</span><span id="L-150"><a href="#L-150"><span class="linenos">150</span></a><span class="sd">        Operator sequence indices whose |M(m)| is to be added in the exponential.</span>
</span><span id="L-151"><a href="#L-151"><span class="linenos">151</span></a><span class="sd">    indices1</span>
</span><span id="L-152"><a href="#L-152"><span class="linenos">152</span></a><span class="sd">        First operator sequence indices whose |M(m1)| is to be subtracted in the exponential.</span>
</span><span id="L-153"><a href="#L-153"><span class="linenos">153</span></a><span class="sd">    indices2</span>
</span><span id="L-154"><a href="#L-154"><span class="linenos">154</span></a><span class="sd">        Second operator sequence indices whose |M(m2)| is to be subtracted in the exponential.</span>
</span><span id="L-155"><a href="#L-155"><span class="linenos">155</span></a><span class="sd">    energy_func</span>
</span><span id="L-156"><a href="#L-156"><span class="linenos">156</span></a><span class="sd">        Energy function to be used (normal or broad).</span>
</span><span id="L-157"><a href="#L-157"><span class="linenos">157</span></a>
</span><span id="L-158"><a href="#L-158"><span class="linenos">158</span></a><span class="sd">    Returns</span>
</span><span id="L-159"><a href="#L-159"><span class="linenos">159</span></a><span class="sd">    -------</span>
</span><span id="L-160"><a href="#L-160"><span class="linenos">160</span></a><span class="sd">    QuasiPolynomial</span>
</span><span id="L-161"><a href="#L-161"><span class="linenos">161</span></a><span class="sd">        Resulting quasi-polynomial.</span>
</span><span id="L-162"><a href="#L-162"><span class="linenos">162</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-163"><a href="#L-163"><span class="linenos">163</span></a>
</span><span id="L-164"><a href="#L-164"><span class="linenos">164</span></a>    <span class="n">alpha</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">energy_func</span><span class="p">(</span><span class="n">indices</span><span class="p">))</span> <span class="o">-</span> <span class="nb">abs</span><span class="p">(</span><span class="n">energy_func</span><span class="p">(</span><span class="n">indices1</span><span class="p">))</span> <span class="o">-</span> <span class="nb">abs</span><span class="p">(</span><span class="n">energy_func</span><span class="p">(</span><span class="n">indices2</span><span class="p">))</span>
</span><span id="L-165"><a href="#L-165"><span class="linenos">165</span></a>    <span class="k">return</span> <span class="n">QuasiPolynomial</span><span class="o">.</span><span class="n">new</span><span class="p">({</span><span class="o">-</span><span class="n">alpha</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">]})</span>
</span><span id="L-166"><a href="#L-166"><span class="linenos">166</span></a>
</span><span id="L-167"><a href="#L-167"><span class="linenos">167</span></a>
</span><span id="L-168"><a href="#L-168"><span class="linenos">168</span></a><span class="k">def</span> <span class="nf">partitions</span><span class="p">(</span><span class="n">sequence</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">Sequence</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">]]:</span>
</span><span id="L-169"><a href="#L-169"><span class="linenos">169</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-170"><a href="#L-170"><span class="linenos">170</span></a><span class="sd">    partitions(sequence)</span>
</span><span id="L-171"><a href="#L-171"><span class="linenos">171</span></a>
</span><span id="L-172"><a href="#L-172"><span class="linenos">172</span></a><span class="sd">    Returns all partitions of the operator sequence (m, n, o, ...) into ((m1, n1, o1, ...), (m2, n2, o2, ...)).</span>
</span><span id="L-173"><a href="#L-173"><span class="linenos">173</span></a>
</span><span id="L-174"><a href="#L-174"><span class="linenos">174</span></a><span class="sd">    Parameters</span>
</span><span id="L-175"><a href="#L-175"><span class="linenos">175</span></a><span class="sd">    ----------</span>
</span><span id="L-176"><a href="#L-176"><span class="linenos">176</span></a><span class="sd">    sequence</span>
</span><span id="L-177"><a href="#L-177"><span class="linenos">177</span></a><span class="sd">        Operator sequence to be partitioned.</span>
</span><span id="L-178"><a href="#L-178"><span class="linenos">178</span></a>
</span><span id="L-179"><a href="#L-179"><span class="linenos">179</span></a><span class="sd">    Returns</span>
</span><span id="L-180"><a href="#L-180"><span class="linenos">180</span></a><span class="sd">    -------</span>
</span><span id="L-181"><a href="#L-181"><span class="linenos">181</span></a><span class="sd">    List[Tuple[Tuple[Tuple[int,...],...],Tuple[Tuple[int,...],...]]]</span>
</span><span id="L-182"><a href="#L-182"><span class="linenos">182</span></a><span class="sd">        List of partitions.</span>
</span><span id="L-183"><a href="#L-183"><span class="linenos">183</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-184"><a href="#L-184"><span class="linenos">184</span></a>
</span><span id="L-185"><a href="#L-185"><span class="linenos">185</span></a>    <span class="c1"># TODO: Why we have to look at all possible partitions, especially those where we have different amount of terms on</span>
</span><span id="L-186"><a href="#L-186"><span class="linenos">186</span></a>    <span class="c1">#  the left side for commuting Hilbert spaces? Should this depend on the starting conditions e.g. is this needed for</span>
</span><span id="L-187"><a href="#L-187"><span class="linenos">187</span></a>    <span class="c1">#  the Dicke model?</span>
</span><span id="L-188"><a href="#L-188"><span class="linenos">188</span></a>    <span class="c1">#  -&gt; Maybe add an option to restrict partitions depending on the model</span>
</span><span id="L-189"><a href="#L-189"><span class="linenos">189</span></a>    <span class="n">partitions</span> <span class="o">=</span> <span class="p">[[(</span><span class="n">s</span><span class="p">[:</span><span class="n">i</span><span class="p">],</span> <span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">:])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">sequence</span><span class="p">]</span>
</span><span id="L-190"><a href="#L-190"><span class="linenos">190</span></a>    <span class="c1"># skip edge cases of completely empty left or right side</span>
</span><span id="L-191"><a href="#L-191"><span class="linenos">191</span></a>    <span class="n">valid_partitions</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">product</span><span class="p">(</span><span class="o">*</span><span class="n">partitions</span><span class="p">))[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-192"><a href="#L-192"><span class="linenos">192</span></a>    <span class="k">return</span> <span class="p">[(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">pr</span><span class="p">),</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">pr</span><span class="p">))</span> <span class="k">for</span> <span class="n">pr</span> <span class="ow">in</span> <span class="n">valid_partitions</span><span class="p">]</span>
</span></pre></div>


            </section>
                <section id="Expr">
                            <input id="Expr-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Expr</span><wbr>(<span class="base">sympy.core.basic.Basic</span>, <span class="base">sympy.core.evalf.EvalfMixin</span>):

                <label class="view-source-button" for="Expr-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Expr"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Expr-38"><a href="#Expr-38"><span class="linenos">  38</span></a><span class="k">class</span> <span class="nc">Expr</span><span class="p">(</span><span class="n">Basic</span><span class="p">,</span> <span class="n">EvalfMixin</span><span class="p">):</span>
</span><span id="Expr-39"><a href="#Expr-39"><span class="linenos">  39</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Expr-40"><a href="#Expr-40"><span class="linenos">  40</span></a><span class="sd">    Base class for algebraic expressions.</span>
</span><span id="Expr-41"><a href="#Expr-41"><span class="linenos">  41</span></a>
</span><span id="Expr-42"><a href="#Expr-42"><span class="linenos">  42</span></a><span class="sd">    Explanation</span>
</span><span id="Expr-43"><a href="#Expr-43"><span class="linenos">  43</span></a><span class="sd">    ===========</span>
</span><span id="Expr-44"><a href="#Expr-44"><span class="linenos">  44</span></a>
</span><span id="Expr-45"><a href="#Expr-45"><span class="linenos">  45</span></a><span class="sd">    Everything that requires arithmetic operations to be defined</span>
</span><span id="Expr-46"><a href="#Expr-46"><span class="linenos">  46</span></a><span class="sd">    should subclass this class, instead of Basic (which should be</span>
</span><span id="Expr-47"><a href="#Expr-47"><span class="linenos">  47</span></a><span class="sd">    used only for argument storage and expression manipulation, i.e.</span>
</span><span id="Expr-48"><a href="#Expr-48"><span class="linenos">  48</span></a><span class="sd">    pattern matching, substitutions, etc).</span>
</span><span id="Expr-49"><a href="#Expr-49"><span class="linenos">  49</span></a>
</span><span id="Expr-50"><a href="#Expr-50"><span class="linenos">  50</span></a><span class="sd">    If you want to override the comparisons of expressions:</span>
</span><span id="Expr-51"><a href="#Expr-51"><span class="linenos">  51</span></a><span class="sd">    Should use _eval_is_ge for inequality, or _eval_is_eq, with multiple dispatch.</span>
</span><span id="Expr-52"><a href="#Expr-52"><span class="linenos">  52</span></a><span class="sd">    _eval_is_ge return true if x &gt;= y, false if x &lt; y, and None if the two types</span>
</span><span id="Expr-53"><a href="#Expr-53"><span class="linenos">  53</span></a><span class="sd">    are not comparable or the comparison is indeterminate</span>
</span><span id="Expr-54"><a href="#Expr-54"><span class="linenos">  54</span></a>
</span><span id="Expr-55"><a href="#Expr-55"><span class="linenos">  55</span></a><span class="sd">    See Also</span>
</span><span id="Expr-56"><a href="#Expr-56"><span class="linenos">  56</span></a><span class="sd">    ========</span>
</span><span id="Expr-57"><a href="#Expr-57"><span class="linenos">  57</span></a>
</span><span id="Expr-58"><a href="#Expr-58"><span class="linenos">  58</span></a><span class="sd">    sympy.core.basic.Basic</span>
</span><span id="Expr-59"><a href="#Expr-59"><span class="linenos">  59</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Expr-60"><a href="#Expr-60"><span class="linenos">  60</span></a>
</span><span id="Expr-61"><a href="#Expr-61"><span class="linenos">  61</span></a>    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>  <span class="c1"># type: tTuple[str, ...]</span>
</span><span id="Expr-62"><a href="#Expr-62"><span class="linenos">  62</span></a>
</span><span id="Expr-63"><a href="#Expr-63"><span class="linenos">  63</span></a>    <span class="n">is_scalar</span> <span class="o">=</span> <span class="kc">True</span>  <span class="c1"># self derivative is 1</span>
</span><span id="Expr-64"><a href="#Expr-64"><span class="linenos">  64</span></a>
</span><span id="Expr-65"><a href="#Expr-65"><span class="linenos">  65</span></a>    <span class="nd">@property</span>
</span><span id="Expr-66"><a href="#Expr-66"><span class="linenos">  66</span></a>    <span class="k">def</span> <span class="nf">_diff_wrt</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Expr-67"><a href="#Expr-67"><span class="linenos">  67</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return True if one can differentiate with respect to this</span>
</span><span id="Expr-68"><a href="#Expr-68"><span class="linenos">  68</span></a><span class="sd">        object, else False.</span>
</span><span id="Expr-69"><a href="#Expr-69"><span class="linenos">  69</span></a>
</span><span id="Expr-70"><a href="#Expr-70"><span class="linenos">  70</span></a><span class="sd">        Explanation</span>
</span><span id="Expr-71"><a href="#Expr-71"><span class="linenos">  71</span></a><span class="sd">        ===========</span>
</span><span id="Expr-72"><a href="#Expr-72"><span class="linenos">  72</span></a>
</span><span id="Expr-73"><a href="#Expr-73"><span class="linenos">  73</span></a><span class="sd">        Subclasses such as Symbol, Function and Derivative return True</span>
</span><span id="Expr-74"><a href="#Expr-74"><span class="linenos">  74</span></a><span class="sd">        to enable derivatives wrt them. The implementation in Derivative</span>
</span><span id="Expr-75"><a href="#Expr-75"><span class="linenos">  75</span></a><span class="sd">        separates the Symbol and non-Symbol (_diff_wrt=True) variables and</span>
</span><span id="Expr-76"><a href="#Expr-76"><span class="linenos">  76</span></a><span class="sd">        temporarily converts the non-Symbols into Symbols when performing</span>
</span><span id="Expr-77"><a href="#Expr-77"><span class="linenos">  77</span></a><span class="sd">        the differentiation. By default, any object deriving from Expr</span>
</span><span id="Expr-78"><a href="#Expr-78"><span class="linenos">  78</span></a><span class="sd">        will behave like a scalar with self.diff(self) == 1. If this is</span>
</span><span id="Expr-79"><a href="#Expr-79"><span class="linenos">  79</span></a><span class="sd">        not desired then the object must also set `is_scalar = False` or</span>
</span><span id="Expr-80"><a href="#Expr-80"><span class="linenos">  80</span></a><span class="sd">        else define an _eval_derivative routine.</span>
</span><span id="Expr-81"><a href="#Expr-81"><span class="linenos">  81</span></a>
</span><span id="Expr-82"><a href="#Expr-82"><span class="linenos">  82</span></a><span class="sd">        Note, see the docstring of Derivative for how this should work</span>
</span><span id="Expr-83"><a href="#Expr-83"><span class="linenos">  83</span></a><span class="sd">        mathematically. In particular, note that expr.subs(yourclass, Symbol)</span>
</span><span id="Expr-84"><a href="#Expr-84"><span class="linenos">  84</span></a><span class="sd">        should be well-defined on a structural level, or this will lead to</span>
</span><span id="Expr-85"><a href="#Expr-85"><span class="linenos">  85</span></a><span class="sd">        inconsistent results.</span>
</span><span id="Expr-86"><a href="#Expr-86"><span class="linenos">  86</span></a>
</span><span id="Expr-87"><a href="#Expr-87"><span class="linenos">  87</span></a><span class="sd">        Examples</span>
</span><span id="Expr-88"><a href="#Expr-88"><span class="linenos">  88</span></a><span class="sd">        ========</span>
</span><span id="Expr-89"><a href="#Expr-89"><span class="linenos">  89</span></a>
</span><span id="Expr-90"><a href="#Expr-90"><span class="linenos">  90</span></a><span class="sd">        &gt;&gt;&gt; from sympy import Expr</span>
</span><span id="Expr-91"><a href="#Expr-91"><span class="linenos">  91</span></a><span class="sd">        &gt;&gt;&gt; e = Expr()</span>
</span><span id="Expr-92"><a href="#Expr-92"><span class="linenos">  92</span></a><span class="sd">        &gt;&gt;&gt; e._diff_wrt</span>
</span><span id="Expr-93"><a href="#Expr-93"><span class="linenos">  93</span></a><span class="sd">        False</span>
</span><span id="Expr-94"><a href="#Expr-94"><span class="linenos">  94</span></a><span class="sd">        &gt;&gt;&gt; class MyScalar(Expr):</span>
</span><span id="Expr-95"><a href="#Expr-95"><span class="linenos">  95</span></a><span class="sd">        ...     _diff_wrt = True</span>
</span><span id="Expr-96"><a href="#Expr-96"><span class="linenos">  96</span></a><span class="sd">        ...</span>
</span><span id="Expr-97"><a href="#Expr-97"><span class="linenos">  97</span></a><span class="sd">        &gt;&gt;&gt; MyScalar().diff(MyScalar())</span>
</span><span id="Expr-98"><a href="#Expr-98"><span class="linenos">  98</span></a><span class="sd">        1</span>
</span><span id="Expr-99"><a href="#Expr-99"><span class="linenos">  99</span></a><span class="sd">        &gt;&gt;&gt; class MySymbol(Expr):</span>
</span><span id="Expr-100"><a href="#Expr-100"><span class="linenos"> 100</span></a><span class="sd">        ...     _diff_wrt = True</span>
</span><span id="Expr-101"><a href="#Expr-101"><span class="linenos"> 101</span></a><span class="sd">        ...     is_scalar = False</span>
</span><span id="Expr-102"><a href="#Expr-102"><span class="linenos"> 102</span></a><span class="sd">        ...</span>
</span><span id="Expr-103"><a href="#Expr-103"><span class="linenos"> 103</span></a><span class="sd">        &gt;&gt;&gt; MySymbol().diff(MySymbol())</span>
</span><span id="Expr-104"><a href="#Expr-104"><span class="linenos"> 104</span></a><span class="sd">        Derivative(MySymbol(), MySymbol())</span>
</span><span id="Expr-105"><a href="#Expr-105"><span class="linenos"> 105</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Expr-106"><a href="#Expr-106"><span class="linenos"> 106</span></a>        <span class="k">return</span> <span class="kc">False</span>
</span><span id="Expr-107"><a href="#Expr-107"><span class="linenos"> 107</span></a>
</span><span id="Expr-108"><a href="#Expr-108"><span class="linenos"> 108</span></a>    <span class="nd">@cacheit</span>
</span><span id="Expr-109"><a href="#Expr-109"><span class="linenos"> 109</span></a>    <span class="k">def</span> <span class="nf">sort_key</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="Expr-110"><a href="#Expr-110"><span class="linenos"> 110</span></a>
</span><span id="Expr-111"><a href="#Expr-111"><span class="linenos"> 111</span></a>        <span class="n">coeff</span><span class="p">,</span> <span class="n">expr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">as_coeff_Mul</span><span class="p">()</span>
</span><span id="Expr-112"><a href="#Expr-112"><span class="linenos"> 112</span></a>
</span><span id="Expr-113"><a href="#Expr-113"><span class="linenos"> 113</span></a>        <span class="k">if</span> <span class="n">expr</span><span class="o">.</span><span class="n">is_Pow</span><span class="p">:</span>
</span><span id="Expr-114"><a href="#Expr-114"><span class="linenos"> 114</span></a>            <span class="k">if</span> <span class="n">expr</span><span class="o">.</span><span class="n">base</span> <span class="ow">is</span> <span class="n">S</span><span class="o">.</span><span class="n">Exp1</span><span class="p">:</span>
</span><span id="Expr-115"><a href="#Expr-115"><span class="linenos"> 115</span></a>                <span class="c1"># If we remove this, many doctests will go crazy:</span>
</span><span id="Expr-116"><a href="#Expr-116"><span class="linenos"> 116</span></a>                <span class="c1"># (keeps E**x sorted like the exp(x) function,</span>
</span><span id="Expr-117"><a href="#Expr-117"><span class="linenos"> 117</span></a>                <span class="c1">#  part of exp(x) to E**x transition)</span>
</span><span id="Expr-118"><a href="#Expr-118"><span class="linenos"> 118</span></a>                <span class="n">expr</span><span class="p">,</span> <span class="n">exp</span> <span class="o">=</span> <span class="n">Function</span><span class="p">(</span><span class="s2">&quot;exp&quot;</span><span class="p">)(</span><span class="n">expr</span><span class="o">.</span><span class="n">exp</span><span class="p">),</span> <span class="n">S</span><span class="o">.</span><span class="n">One</span>
</span><span id="Expr-119"><a href="#Expr-119"><span class="linenos"> 119</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Expr-120"><a href="#Expr-120"><span class="linenos"> 120</span></a>                <span class="n">expr</span><span class="p">,</span> <span class="n">exp</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">args</span>
</span><span id="Expr-121"><a href="#Expr-121"><span class="linenos"> 121</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Expr-122"><a href="#Expr-122"><span class="linenos"> 122</span></a>            <span class="n">exp</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">One</span>
</span><span id="Expr-123"><a href="#Expr-123"><span class="linenos"> 123</span></a>
</span><span id="Expr-124"><a href="#Expr-124"><span class="linenos"> 124</span></a>        <span class="k">if</span> <span class="n">expr</span><span class="o">.</span><span class="n">is_Dummy</span><span class="p">:</span>
</span><span id="Expr-125"><a href="#Expr-125"><span class="linenos"> 125</span></a>            <span class="n">args</span> <span class="o">=</span> <span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">sort_key</span><span class="p">(),)</span>
</span><span id="Expr-126"><a href="#Expr-126"><span class="linenos"> 126</span></a>        <span class="k">elif</span> <span class="n">expr</span><span class="o">.</span><span class="n">is_Atom</span><span class="p">:</span>
</span><span id="Expr-127"><a href="#Expr-127"><span class="linenos"> 127</span></a>            <span class="n">args</span> <span class="o">=</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">expr</span><span class="p">),)</span>
</span><span id="Expr-128"><a href="#Expr-128"><span class="linenos"> 128</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Expr-129"><a href="#Expr-129"><span class="linenos"> 129</span></a>            <span class="k">if</span> <span class="n">expr</span><span class="o">.</span><span class="n">is_Add</span><span class="p">:</span>
</span><span id="Expr-130"><a href="#Expr-130"><span class="linenos"> 130</span></a>                <span class="n">args</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">as_ordered_terms</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="n">order</span><span class="p">)</span>
</span><span id="Expr-131"><a href="#Expr-131"><span class="linenos"> 131</span></a>            <span class="k">elif</span> <span class="n">expr</span><span class="o">.</span><span class="n">is_Mul</span><span class="p">:</span>
</span><span id="Expr-132"><a href="#Expr-132"><span class="linenos"> 132</span></a>                <span class="n">args</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">as_ordered_factors</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="n">order</span><span class="p">)</span>
</span><span id="Expr-133"><a href="#Expr-133"><span class="linenos"> 133</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Expr-134"><a href="#Expr-134"><span class="linenos"> 134</span></a>                <span class="n">args</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">args</span>
</span><span id="Expr-135"><a href="#Expr-135"><span class="linenos"> 135</span></a>
</span><span id="Expr-136"><a href="#Expr-136"><span class="linenos"> 136</span></a>            <span class="n">args</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span>
</span><span id="Expr-137"><a href="#Expr-137"><span class="linenos"> 137</span></a>                <span class="p">[</span> <span class="n">default_sort_key</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="n">order</span><span class="p">)</span> <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">args</span> <span class="p">])</span>
</span><span id="Expr-138"><a href="#Expr-138"><span class="linenos"> 138</span></a>
</span><span id="Expr-139"><a href="#Expr-139"><span class="linenos"> 139</span></a>        <span class="n">args</span> <span class="o">=</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">),</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">args</span><span class="p">))</span>
</span><span id="Expr-140"><a href="#Expr-140"><span class="linenos"> 140</span></a>        <span class="n">exp</span> <span class="o">=</span> <span class="n">exp</span><span class="o">.</span><span class="n">sort_key</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="n">order</span><span class="p">)</span>
</span><span id="Expr-141"><a href="#Expr-141"><span class="linenos"> 141</span></a>
</span><span id="Expr-142"><a href="#Expr-142"><span class="linenos"> 142</span></a>        <span class="k">return</span> <span class="n">expr</span><span class="o">.</span><span class="n">class_key</span><span class="p">(),</span> <span class="n">args</span><span class="p">,</span> <span class="n">exp</span><span class="p">,</span> <span class="n">coeff</span>
</span><span id="Expr-143"><a href="#Expr-143"><span class="linenos"> 143</span></a>
</span><span id="Expr-144"><a href="#Expr-144"><span class="linenos"> 144</span></a>    <span class="k">def</span> <span class="nf">_hashable_content</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Expr-145"><a href="#Expr-145"><span class="linenos"> 145</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a tuple of information about self that can be used to</span>
</span><span id="Expr-146"><a href="#Expr-146"><span class="linenos"> 146</span></a><span class="sd">        compute the hash. If a class defines additional attributes,</span>
</span><span id="Expr-147"><a href="#Expr-147"><span class="linenos"> 147</span></a><span class="sd">        like ``name`` in Symbol, then this method should be updated</span>
</span><span id="Expr-148"><a href="#Expr-148"><span class="linenos"> 148</span></a><span class="sd">        accordingly to return such relevant attributes.</span>
</span><span id="Expr-149"><a href="#Expr-149"><span class="linenos"> 149</span></a><span class="sd">        Defining more than _hashable_content is necessary if __eq__ has</span>
</span><span id="Expr-150"><a href="#Expr-150"><span class="linenos"> 150</span></a><span class="sd">        been defined by a class. See note about this in Basic.__eq__.&quot;&quot;&quot;</span>
</span><span id="Expr-151"><a href="#Expr-151"><span class="linenos"> 151</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_args</span>
</span><span id="Expr-152"><a href="#Expr-152"><span class="linenos"> 152</span></a>
</span><span id="Expr-153"><a href="#Expr-153"><span class="linenos"> 153</span></a>    <span class="c1"># ***************</span>
</span><span id="Expr-154"><a href="#Expr-154"><span class="linenos"> 154</span></a>    <span class="c1"># * Arithmetics *</span>
</span><span id="Expr-155"><a href="#Expr-155"><span class="linenos"> 155</span></a>    <span class="c1"># ***************</span>
</span><span id="Expr-156"><a href="#Expr-156"><span class="linenos"> 156</span></a>    <span class="c1"># Expr and its sublcasses use _op_priority to determine which object</span>
</span><span id="Expr-157"><a href="#Expr-157"><span class="linenos"> 157</span></a>    <span class="c1"># passed to a binary special method (__mul__, etc.) will handle the</span>
</span><span id="Expr-158"><a href="#Expr-158"><span class="linenos"> 158</span></a>    <span class="c1"># operation. In general, the &#39;call_highest_priority&#39; decorator will choose</span>
</span><span id="Expr-159"><a href="#Expr-159"><span class="linenos"> 159</span></a>    <span class="c1"># the object with the highest _op_priority to handle the call.</span>
</span><span id="Expr-160"><a href="#Expr-160"><span class="linenos"> 160</span></a>    <span class="c1"># Custom subclasses that want to define their own binary special methods</span>
</span><span id="Expr-161"><a href="#Expr-161"><span class="linenos"> 161</span></a>    <span class="c1"># should set an _op_priority value that is higher than the default.</span>
</span><span id="Expr-162"><a href="#Expr-162"><span class="linenos"> 162</span></a>    <span class="c1">#</span>
</span><span id="Expr-163"><a href="#Expr-163"><span class="linenos"> 163</span></a>    <span class="c1"># **NOTE**:</span>
</span><span id="Expr-164"><a href="#Expr-164"><span class="linenos"> 164</span></a>    <span class="c1"># This is a temporary fix, and will eventually be replaced with</span>
</span><span id="Expr-165"><a href="#Expr-165"><span class="linenos"> 165</span></a>    <span class="c1"># something better and more powerful.  See issue 5510.</span>
</span><span id="Expr-166"><a href="#Expr-166"><span class="linenos"> 166</span></a>    <span class="n">_op_priority</span> <span class="o">=</span> <span class="mf">10.0</span>
</span><span id="Expr-167"><a href="#Expr-167"><span class="linenos"> 167</span></a>
</span><span id="Expr-168"><a href="#Expr-168"><span class="linenos"> 168</span></a>    <span class="nd">@property</span>
</span><span id="Expr-169"><a href="#Expr-169"><span class="linenos"> 169</span></a>    <span class="k">def</span> <span class="nf">_add_handler</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Expr-170"><a href="#Expr-170"><span class="linenos"> 170</span></a>        <span class="k">return</span> <span class="n">Add</span>
</span><span id="Expr-171"><a href="#Expr-171"><span class="linenos"> 171</span></a>
</span><span id="Expr-172"><a href="#Expr-172"><span class="linenos"> 172</span></a>    <span class="nd">@property</span>
</span><span id="Expr-173"><a href="#Expr-173"><span class="linenos"> 173</span></a>    <span class="k">def</span> <span class="nf">_mul_handler</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Expr-174"><a href="#Expr-174"><span class="linenos"> 174</span></a>        <span class="k">return</span> <span class="n">Mul</span>
</span><span id="Expr-175"><a href="#Expr-175"><span class="linenos"> 175</span></a>
</span><span id="Expr-176"><a href="#Expr-176"><span class="linenos"> 176</span></a>    <span class="k">def</span> <span class="fm">__pos__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Expr-177"><a href="#Expr-177"><span class="linenos"> 177</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span><span id="Expr-178"><a href="#Expr-178"><span class="linenos"> 178</span></a>
</span><span id="Expr-179"><a href="#Expr-179"><span class="linenos"> 179</span></a>    <span class="k">def</span> <span class="fm">__neg__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Expr-180"><a href="#Expr-180"><span class="linenos"> 180</span></a>        <span class="c1"># Mul has its own __neg__ routine, so we just</span>
</span><span id="Expr-181"><a href="#Expr-181"><span class="linenos"> 181</span></a>        <span class="c1"># create a 2-args Mul with the -1 in the canonical</span>
</span><span id="Expr-182"><a href="#Expr-182"><span class="linenos"> 182</span></a>        <span class="c1"># slot 0.</span>
</span><span id="Expr-183"><a href="#Expr-183"><span class="linenos"> 183</span></a>        <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_commutative</span>
</span><span id="Expr-184"><a href="#Expr-184"><span class="linenos"> 184</span></a>        <span class="k">return</span> <span class="n">Mul</span><span class="o">.</span><span class="n">_from_args</span><span class="p">((</span><span class="n">S</span><span class="o">.</span><span class="n">NegativeOne</span><span class="p">,</span> <span class="bp">self</span><span class="p">),</span> <span class="n">c</span><span class="p">)</span>
</span><span id="Expr-185"><a href="#Expr-185"><span class="linenos"> 185</span></a>
</span><span id="Expr-186"><a href="#Expr-186"><span class="linenos"> 186</span></a>    <span class="k">def</span> <span class="fm">__abs__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Expr-187"><a href="#Expr-187"><span class="linenos"> 187</span></a>        <span class="kn">from</span> <span class="nn">sympy.functions.elementary.complexes</span> <span class="kn">import</span> <span class="n">Abs</span>
</span><span id="Expr-188"><a href="#Expr-188"><span class="linenos"> 188</span></a>        <span class="k">return</span> <span class="n">Abs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="Expr-189"><a href="#Expr-189"><span class="linenos"> 189</span></a>
</span><span id="Expr-190"><a href="#Expr-190"><span class="linenos"> 190</span></a>    <span class="nd">@sympify_return</span><span class="p">([(</span><span class="s1">&#39;other&#39;</span><span class="p">,</span> <span class="s1">&#39;Expr&#39;</span><span class="p">)],</span> <span class="bp">NotImplemented</span><span class="p">)</span>
</span><span id="Expr-191"><a href="#Expr-191"><span class="linenos"> 191</span></a>    <span class="nd">@call_highest_priority</span><span class="p">(</span><span class="s1">&#39;__radd__&#39;</span><span class="p">)</span>
</span><span id="Expr-192"><a href="#Expr-192"><span class="linenos"> 192</span></a>    <span class="k">def</span> <span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="Expr-193"><a href="#Expr-193"><span class="linenos"> 193</span></a>        <span class="k">return</span> <span class="n">Add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>
</span><span id="Expr-194"><a href="#Expr-194"><span class="linenos"> 194</span></a>
</span><span id="Expr-195"><a href="#Expr-195"><span class="linenos"> 195</span></a>    <span class="nd">@sympify_return</span><span class="p">([(</span><span class="s1">&#39;other&#39;</span><span class="p">,</span> <span class="s1">&#39;Expr&#39;</span><span class="p">)],</span> <span class="bp">NotImplemented</span><span class="p">)</span>
</span><span id="Expr-196"><a href="#Expr-196"><span class="linenos"> 196</span></a>    <span class="nd">@call_highest_priority</span><span class="p">(</span><span class="s1">&#39;__add__&#39;</span><span class="p">)</span>
</span><span id="Expr-197"><a href="#Expr-197"><span class="linenos"> 197</span></a>    <span class="k">def</span> <span class="fm">__radd__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="Expr-198"><a href="#Expr-198"><span class="linenos"> 198</span></a>        <span class="k">return</span> <span class="n">Add</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
</span><span id="Expr-199"><a href="#Expr-199"><span class="linenos"> 199</span></a>
</span><span id="Expr-200"><a href="#Expr-200"><span class="linenos"> 200</span></a>    <span class="nd">@sympify_return</span><span class="p">([(</span><span class="s1">&#39;other&#39;</span><span class="p">,</span> <span class="s1">&#39;Expr&#39;</span><span class="p">)],</span> <span class="bp">NotImplemented</span><span class="p">)</span>
</span><span id="Expr-201"><a href="#Expr-201"><span class="linenos"> 201</span></a>    <span class="nd">@call_highest_priority</span><span class="p">(</span><span class="s1">&#39;__rsub__&#39;</span><span class="p">)</span>
</span><span id="Expr-202"><a href="#Expr-202"><span class="linenos"> 202</span></a>    <span class="k">def</span> <span class="fm">__sub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="Expr-203"><a href="#Expr-203"><span class="linenos"> 203</span></a>        <span class="k">return</span> <span class="n">Add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">-</span><span class="n">other</span><span class="p">)</span>
</span><span id="Expr-204"><a href="#Expr-204"><span class="linenos"> 204</span></a>
</span><span id="Expr-205"><a href="#Expr-205"><span class="linenos"> 205</span></a>    <span class="nd">@sympify_return</span><span class="p">([(</span><span class="s1">&#39;other&#39;</span><span class="p">,</span> <span class="s1">&#39;Expr&#39;</span><span class="p">)],</span> <span class="bp">NotImplemented</span><span class="p">)</span>
</span><span id="Expr-206"><a href="#Expr-206"><span class="linenos"> 206</span></a>    <span class="nd">@call_highest_priority</span><span class="p">(</span><span class="s1">&#39;__sub__&#39;</span><span class="p">)</span>
</span><span id="Expr-207"><a href="#Expr-207"><span class="linenos"> 207</span></a>    <span class="k">def</span> <span class="fm">__rsub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="Expr-208"><a href="#Expr-208"><span class="linenos"> 208</span></a>        <span class="k">return</span> <span class="n">Add</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="o">-</span><span class="bp">self</span><span class="p">)</span>
</span><span id="Expr-209"><a href="#Expr-209"><span class="linenos"> 209</span></a>
</span><span id="Expr-210"><a href="#Expr-210"><span class="linenos"> 210</span></a>    <span class="nd">@sympify_return</span><span class="p">([(</span><span class="s1">&#39;other&#39;</span><span class="p">,</span> <span class="s1">&#39;Expr&#39;</span><span class="p">)],</span> <span class="bp">NotImplemented</span><span class="p">)</span>
</span><span id="Expr-211"><a href="#Expr-211"><span class="linenos"> 211</span></a>    <span class="nd">@call_highest_priority</span><span class="p">(</span><span class="s1">&#39;__rmul__&#39;</span><span class="p">)</span>
</span><span id="Expr-212"><a href="#Expr-212"><span class="linenos"> 212</span></a>    <span class="k">def</span> <span class="fm">__mul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="Expr-213"><a href="#Expr-213"><span class="linenos"> 213</span></a>        <span class="k">return</span> <span class="n">Mul</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>
</span><span id="Expr-214"><a href="#Expr-214"><span class="linenos"> 214</span></a>
</span><span id="Expr-215"><a href="#Expr-215"><span class="linenos"> 215</span></a>    <span class="nd">@sympify_return</span><span class="p">([(</span><span class="s1">&#39;other&#39;</span><span class="p">,</span> <span class="s1">&#39;Expr&#39;</span><span class="p">)],</span> <span class="bp">NotImplemented</span><span class="p">)</span>
</span><span id="Expr-216"><a href="#Expr-216"><span class="linenos"> 216</span></a>    <span class="nd">@call_highest_priority</span><span class="p">(</span><span class="s1">&#39;__mul__&#39;</span><span class="p">)</span>
</span><span id="Expr-217"><a href="#Expr-217"><span class="linenos"> 217</span></a>    <span class="k">def</span> <span class="fm">__rmul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="Expr-218"><a href="#Expr-218"><span class="linenos"> 218</span></a>        <span class="k">return</span> <span class="n">Mul</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
</span><span id="Expr-219"><a href="#Expr-219"><span class="linenos"> 219</span></a>
</span><span id="Expr-220"><a href="#Expr-220"><span class="linenos"> 220</span></a>    <span class="nd">@sympify_return</span><span class="p">([(</span><span class="s1">&#39;other&#39;</span><span class="p">,</span> <span class="s1">&#39;Expr&#39;</span><span class="p">)],</span> <span class="bp">NotImplemented</span><span class="p">)</span>
</span><span id="Expr-221"><a href="#Expr-221"><span class="linenos"> 221</span></a>    <span class="nd">@call_highest_priority</span><span class="p">(</span><span class="s1">&#39;__rpow__&#39;</span><span class="p">)</span>
</span><span id="Expr-222"><a href="#Expr-222"><span class="linenos"> 222</span></a>    <span class="k">def</span> <span class="nf">_pow</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="Expr-223"><a href="#Expr-223"><span class="linenos"> 223</span></a>        <span class="k">return</span> <span class="n">Pow</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>
</span><span id="Expr-224"><a href="#Expr-224"><span class="linenos"> 224</span></a>
</span><span id="Expr-225"><a href="#Expr-225"><span class="linenos"> 225</span></a>    <span class="k">def</span> <span class="fm">__pow__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">mod</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="Expr-226"><a href="#Expr-226"><span class="linenos"> 226</span></a>        <span class="k">if</span> <span class="n">mod</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Expr-227"><a href="#Expr-227"><span class="linenos"> 227</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pow</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
</span><span id="Expr-228"><a href="#Expr-228"><span class="linenos"> 228</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="Expr-229"><a href="#Expr-229"><span class="linenos"> 229</span></a>            <span class="n">_self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">mod</span> <span class="o">=</span> <span class="n">as_int</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span> <span class="n">as_int</span><span class="p">(</span><span class="n">other</span><span class="p">),</span> <span class="n">as_int</span><span class="p">(</span><span class="n">mod</span><span class="p">)</span>
</span><span id="Expr-230"><a href="#Expr-230"><span class="linenos"> 230</span></a>            <span class="k">if</span> <span class="n">other</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Expr-231"><a href="#Expr-231"><span class="linenos"> 231</span></a>                <span class="k">return</span> <span class="nb">pow</span><span class="p">(</span><span class="n">_self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">mod</span><span class="p">)</span>
</span><span id="Expr-232"><a href="#Expr-232"><span class="linenos"> 232</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Expr-233"><a href="#Expr-233"><span class="linenos"> 233</span></a>                <span class="kn">from</span> <span class="nn">sympy.core.numbers</span> <span class="kn">import</span> <span class="n">mod_inverse</span>
</span><span id="Expr-234"><a href="#Expr-234"><span class="linenos"> 234</span></a>                <span class="k">return</span> <span class="n">mod_inverse</span><span class="p">(</span><span class="nb">pow</span><span class="p">(</span><span class="n">_self</span><span class="p">,</span> <span class="o">-</span><span class="n">other</span><span class="p">,</span> <span class="n">mod</span><span class="p">),</span> <span class="n">mod</span><span class="p">)</span>
</span><span id="Expr-235"><a href="#Expr-235"><span class="linenos"> 235</span></a>        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
</span><span id="Expr-236"><a href="#Expr-236"><span class="linenos"> 236</span></a>            <span class="n">power</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pow</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
</span><span id="Expr-237"><a href="#Expr-237"><span class="linenos"> 237</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="Expr-238"><a href="#Expr-238"><span class="linenos"> 238</span></a>                <span class="k">return</span> <span class="n">power</span><span class="o">%</span><span class="n">mod</span>
</span><span id="Expr-239"><a href="#Expr-239"><span class="linenos"> 239</span></a>            <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
</span><span id="Expr-240"><a href="#Expr-240"><span class="linenos"> 240</span></a>                <span class="k">return</span> <span class="bp">NotImplemented</span>
</span><span id="Expr-241"><a href="#Expr-241"><span class="linenos"> 241</span></a>
</span><span id="Expr-242"><a href="#Expr-242"><span class="linenos"> 242</span></a>    <span class="nd">@sympify_return</span><span class="p">([(</span><span class="s1">&#39;other&#39;</span><span class="p">,</span> <span class="s1">&#39;Expr&#39;</span><span class="p">)],</span> <span class="bp">NotImplemented</span><span class="p">)</span>
</span><span id="Expr-243"><a href="#Expr-243"><span class="linenos"> 243</span></a>    <span class="nd">@call_highest_priority</span><span class="p">(</span><span class="s1">&#39;__pow__&#39;</span><span class="p">)</span>
</span><span id="Expr-244"><a href="#Expr-244"><span class="linenos"> 244</span></a>    <span class="k">def</span> <span class="fm">__rpow__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="Expr-245"><a href="#Expr-245"><span class="linenos"> 245</span></a>        <span class="k">return</span> <span class="n">Pow</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
</span><span id="Expr-246"><a href="#Expr-246"><span class="linenos"> 246</span></a>
</span><span id="Expr-247"><a href="#Expr-247"><span class="linenos"> 247</span></a>    <span class="nd">@sympify_return</span><span class="p">([(</span><span class="s1">&#39;other&#39;</span><span class="p">,</span> <span class="s1">&#39;Expr&#39;</span><span class="p">)],</span> <span class="bp">NotImplemented</span><span class="p">)</span>
</span><span id="Expr-248"><a href="#Expr-248"><span class="linenos"> 248</span></a>    <span class="nd">@call_highest_priority</span><span class="p">(</span><span class="s1">&#39;__rtruediv__&#39;</span><span class="p">)</span>
</span><span id="Expr-249"><a href="#Expr-249"><span class="linenos"> 249</span></a>    <span class="k">def</span> <span class="fm">__truediv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="Expr-250"><a href="#Expr-250"><span class="linenos"> 250</span></a>        <span class="n">denom</span> <span class="o">=</span> <span class="n">Pow</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">S</span><span class="o">.</span><span class="n">NegativeOne</span><span class="p">)</span>
</span><span id="Expr-251"><a href="#Expr-251"><span class="linenos"> 251</span></a>        <span class="k">if</span> <span class="bp">self</span> <span class="ow">is</span> <span class="n">S</span><span class="o">.</span><span class="n">One</span><span class="p">:</span>
</span><span id="Expr-252"><a href="#Expr-252"><span class="linenos"> 252</span></a>            <span class="k">return</span> <span class="n">denom</span>
</span><span id="Expr-253"><a href="#Expr-253"><span class="linenos"> 253</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Expr-254"><a href="#Expr-254"><span class="linenos"> 254</span></a>            <span class="k">return</span> <span class="n">Mul</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">denom</span><span class="p">)</span>
</span><span id="Expr-255"><a href="#Expr-255"><span class="linenos"> 255</span></a>
</span><span id="Expr-256"><a href="#Expr-256"><span class="linenos"> 256</span></a>    <span class="nd">@sympify_return</span><span class="p">([(</span><span class="s1">&#39;other&#39;</span><span class="p">,</span> <span class="s1">&#39;Expr&#39;</span><span class="p">)],</span> <span class="bp">NotImplemented</span><span class="p">)</span>
</span><span id="Expr-257"><a href="#Expr-257"><span class="linenos"> 257</span></a>    <span class="nd">@call_highest_priority</span><span class="p">(</span><span class="s1">&#39;__truediv__&#39;</span><span class="p">)</span>
</span><span id="Expr-258"><a href="#Expr-258"><span class="linenos"> 258</span></a>    <span class="k">def</span> <span class="fm">__rtruediv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="Expr-259"><a href="#Expr-259"><span class="linenos"> 259</span></a>        <span class="n">denom</span> <span class="o">=</span> <span class="n">Pow</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">S</span><span class="o">.</span><span class="n">NegativeOne</span><span class="p">)</span>
</span><span id="Expr-260"><a href="#Expr-260"><span class="linenos"> 260</span></a>        <span class="k">if</span> <span class="n">other</span> <span class="ow">is</span> <span class="n">S</span><span class="o">.</span><span class="n">One</span><span class="p">:</span>
</span><span id="Expr-261"><a href="#Expr-261"><span class="linenos"> 261</span></a>            <span class="k">return</span> <span class="n">denom</span>
</span><span id="Expr-262"><a href="#Expr-262"><span class="linenos"> 262</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Expr-263"><a href="#Expr-263"><span class="linenos"> 263</span></a>            <span class="k">return</span> <span class="n">Mul</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">denom</span><span class="p">)</span>
</span><span id="Expr-264"><a href="#Expr-264"><span class="linenos"> 264</span></a>
</span><span id="Expr-265"><a href="#Expr-265"><span class="linenos"> 265</span></a>    <span class="nd">@sympify_return</span><span class="p">([(</span><span class="s1">&#39;other&#39;</span><span class="p">,</span> <span class="s1">&#39;Expr&#39;</span><span class="p">)],</span> <span class="bp">NotImplemented</span><span class="p">)</span>
</span><span id="Expr-266"><a href="#Expr-266"><span class="linenos"> 266</span></a>    <span class="nd">@call_highest_priority</span><span class="p">(</span><span class="s1">&#39;__rmod__&#39;</span><span class="p">)</span>
</span><span id="Expr-267"><a href="#Expr-267"><span class="linenos"> 267</span></a>    <span class="k">def</span> <span class="fm">__mod__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="Expr-268"><a href="#Expr-268"><span class="linenos"> 268</span></a>        <span class="k">return</span> <span class="n">Mod</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>
</span><span id="Expr-269"><a href="#Expr-269"><span class="linenos"> 269</span></a>
</span><span id="Expr-270"><a href="#Expr-270"><span class="linenos"> 270</span></a>    <span class="nd">@sympify_return</span><span class="p">([(</span><span class="s1">&#39;other&#39;</span><span class="p">,</span> <span class="s1">&#39;Expr&#39;</span><span class="p">)],</span> <span class="bp">NotImplemented</span><span class="p">)</span>
</span><span id="Expr-271"><a href="#Expr-271"><span class="linenos"> 271</span></a>    <span class="nd">@call_highest_priority</span><span class="p">(</span><span class="s1">&#39;__mod__&#39;</span><span class="p">)</span>
</span><span id="Expr-272"><a href="#Expr-272"><span class="linenos"> 272</span></a>    <span class="k">def</span> <span class="fm">__rmod__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="Expr-273"><a href="#Expr-273"><span class="linenos"> 273</span></a>        <span class="k">return</span> <span class="n">Mod</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
</span><span id="Expr-274"><a href="#Expr-274"><span class="linenos"> 274</span></a>
</span><span id="Expr-275"><a href="#Expr-275"><span class="linenos"> 275</span></a>    <span class="nd">@sympify_return</span><span class="p">([(</span><span class="s1">&#39;other&#39;</span><span class="p">,</span> <span class="s1">&#39;Expr&#39;</span><span class="p">)],</span> <span class="bp">NotImplemented</span><span class="p">)</span>
</span><span id="Expr-276"><a href="#Expr-276"><span class="linenos"> 276</span></a>    <span class="nd">@call_highest_priority</span><span class="p">(</span><span class="s1">&#39;__rfloordiv__&#39;</span><span class="p">)</span>
</span><span id="Expr-277"><a href="#Expr-277"><span class="linenos"> 277</span></a>    <span class="k">def</span> <span class="fm">__floordiv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="Expr-278"><a href="#Expr-278"><span class="linenos"> 278</span></a>        <span class="kn">from</span> <span class="nn">sympy.functions.elementary.integers</span> <span class="kn">import</span> <span class="n">floor</span>
</span><span id="Expr-279"><a href="#Expr-279"><span class="linenos"> 279</span></a>        <span class="k">return</span> <span class="n">floor</span><span class="p">(</span><span class="bp">self</span> <span class="o">/</span> <span class="n">other</span><span class="p">)</span>
</span><span id="Expr-280"><a href="#Expr-280"><span class="linenos"> 280</span></a>
</span><span id="Expr-281"><a href="#Expr-281"><span class="linenos"> 281</span></a>    <span class="nd">@sympify_return</span><span class="p">([(</span><span class="s1">&#39;other&#39;</span><span class="p">,</span> <span class="s1">&#39;Expr&#39;</span><span class="p">)],</span> <span class="bp">NotImplemented</span><span class="p">)</span>
</span><span id="Expr-282"><a href="#Expr-282"><span class="linenos"> 282</span></a>    <span class="nd">@call_highest_priority</span><span class="p">(</span><span class="s1">&#39;__floordiv__&#39;</span><span class="p">)</span>
</span><span id="Expr-283"><a href="#Expr-283"><span class="linenos"> 283</span></a>    <span class="k">def</span> <span class="fm">__rfloordiv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="Expr-284"><a href="#Expr-284"><span class="linenos"> 284</span></a>        <span class="kn">from</span> <span class="nn">sympy.functions.elementary.integers</span> <span class="kn">import</span> <span class="n">floor</span>
</span><span id="Expr-285"><a href="#Expr-285"><span class="linenos"> 285</span></a>        <span class="k">return</span> <span class="n">floor</span><span class="p">(</span><span class="n">other</span> <span class="o">/</span> <span class="bp">self</span><span class="p">)</span>
</span><span id="Expr-286"><a href="#Expr-286"><span class="linenos"> 286</span></a>
</span><span id="Expr-287"><a href="#Expr-287"><span class="linenos"> 287</span></a>
</span><span id="Expr-288"><a href="#Expr-288"><span class="linenos"> 288</span></a>    <span class="nd">@sympify_return</span><span class="p">([(</span><span class="s1">&#39;other&#39;</span><span class="p">,</span> <span class="s1">&#39;Expr&#39;</span><span class="p">)],</span> <span class="bp">NotImplemented</span><span class="p">)</span>
</span><span id="Expr-289"><a href="#Expr-289"><span class="linenos"> 289</span></a>    <span class="nd">@call_highest_priority</span><span class="p">(</span><span class="s1">&#39;__rdivmod__&#39;</span><span class="p">)</span>
</span><span id="Expr-290"><a href="#Expr-290"><span class="linenos"> 290</span></a>    <span class="k">def</span> <span class="fm">__divmod__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="Expr-291"><a href="#Expr-291"><span class="linenos"> 291</span></a>        <span class="kn">from</span> <span class="nn">sympy.functions.elementary.integers</span> <span class="kn">import</span> <span class="n">floor</span>
</span><span id="Expr-292"><a href="#Expr-292"><span class="linenos"> 292</span></a>        <span class="k">return</span> <span class="n">floor</span><span class="p">(</span><span class="bp">self</span> <span class="o">/</span> <span class="n">other</span><span class="p">),</span> <span class="n">Mod</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>
</span><span id="Expr-293"><a href="#Expr-293"><span class="linenos"> 293</span></a>
</span><span id="Expr-294"><a href="#Expr-294"><span class="linenos"> 294</span></a>    <span class="nd">@sympify_return</span><span class="p">([(</span><span class="s1">&#39;other&#39;</span><span class="p">,</span> <span class="s1">&#39;Expr&#39;</span><span class="p">)],</span> <span class="bp">NotImplemented</span><span class="p">)</span>
</span><span id="Expr-295"><a href="#Expr-295"><span class="linenos"> 295</span></a>    <span class="nd">@call_highest_priority</span><span class="p">(</span><span class="s1">&#39;__divmod__&#39;</span><span class="p">)</span>
</span><span id="Expr-296"><a href="#Expr-296"><span class="linenos"> 296</span></a>    <span class="k">def</span> <span class="fm">__rdivmod__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="Expr-297"><a href="#Expr-297"><span class="linenos"> 297</span></a>        <span class="kn">from</span> <span class="nn">sympy.functions.elementary.integers</span> <span class="kn">import</span> <span class="n">floor</span>
</span><span id="Expr-298"><a href="#Expr-298"><span class="linenos"> 298</span></a>        <span class="k">return</span> <span class="n">floor</span><span class="p">(</span><span class="n">other</span> <span class="o">/</span> <span class="bp">self</span><span class="p">),</span> <span class="n">Mod</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
</span><span id="Expr-299"><a href="#Expr-299"><span class="linenos"> 299</span></a>
</span><span id="Expr-300"><a href="#Expr-300"><span class="linenos"> 300</span></a>    <span class="k">def</span> <span class="fm">__int__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Expr-301"><a href="#Expr-301"><span class="linenos"> 301</span></a>        <span class="c1"># Although we only need to round to the units position, we&#39;ll</span>
</span><span id="Expr-302"><a href="#Expr-302"><span class="linenos"> 302</span></a>        <span class="c1"># get one more digit so the extra testing below can be avoided</span>
</span><span id="Expr-303"><a href="#Expr-303"><span class="linenos"> 303</span></a>        <span class="c1"># unless the rounded value rounded to an integer, e.g. if an</span>
</span><span id="Expr-304"><a href="#Expr-304"><span class="linenos"> 304</span></a>        <span class="c1"># expression were equal to 1.9 and we rounded to the unit position</span>
</span><span id="Expr-305"><a href="#Expr-305"><span class="linenos"> 305</span></a>        <span class="c1"># we would get a 2 and would not know if this rounded up or not</span>
</span><span id="Expr-306"><a href="#Expr-306"><span class="linenos"> 306</span></a>        <span class="c1"># without doing a test (as done below). But if we keep an extra</span>
</span><span id="Expr-307"><a href="#Expr-307"><span class="linenos"> 307</span></a>        <span class="c1"># digit we know that 1.9 is not the same as 1 and there is no</span>
</span><span id="Expr-308"><a href="#Expr-308"><span class="linenos"> 308</span></a>        <span class="c1"># need for further testing: our int value is correct. If the value</span>
</span><span id="Expr-309"><a href="#Expr-309"><span class="linenos"> 309</span></a>        <span class="c1"># were 1.99, however, this would round to 2.0 and our int value is</span>
</span><span id="Expr-310"><a href="#Expr-310"><span class="linenos"> 310</span></a>        <span class="c1"># off by one. So...if our round value is the same as the int value</span>
</span><span id="Expr-311"><a href="#Expr-311"><span class="linenos"> 311</span></a>        <span class="c1"># (regardless of how much extra work we do to calculate extra decimal</span>
</span><span id="Expr-312"><a href="#Expr-312"><span class="linenos"> 312</span></a>        <span class="c1"># places) we need to test whether we are off by one.</span>
</span><span id="Expr-313"><a href="#Expr-313"><span class="linenos"> 313</span></a>        <span class="kn">from</span> <span class="nn">.symbol</span> <span class="kn">import</span> <span class="n">Dummy</span>
</span><span id="Expr-314"><a href="#Expr-314"><span class="linenos"> 314</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_number</span><span class="p">:</span>
</span><span id="Expr-315"><a href="#Expr-315"><span class="linenos"> 315</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Cannot convert symbols to int&quot;</span><span class="p">)</span>
</span><span id="Expr-316"><a href="#Expr-316"><span class="linenos"> 316</span></a>        <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</span><span id="Expr-317"><a href="#Expr-317"><span class="linenos"> 317</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">r</span><span class="o">.</span><span class="n">is_Number</span><span class="p">:</span>
</span><span id="Expr-318"><a href="#Expr-318"><span class="linenos"> 318</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Cannot convert complex to int&quot;</span><span class="p">)</span>
</span><span id="Expr-319"><a href="#Expr-319"><span class="linenos"> 319</span></a>        <span class="k">if</span> <span class="n">r</span> <span class="ow">in</span> <span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">NaN</span><span class="p">,</span> <span class="n">S</span><span class="o">.</span><span class="n">Infinity</span><span class="p">,</span> <span class="n">S</span><span class="o">.</span><span class="n">NegativeInfinity</span><span class="p">):</span>
</span><span id="Expr-320"><a href="#Expr-320"><span class="linenos"> 320</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Cannot convert </span><span class="si">%s</span><span class="s2"> to int&quot;</span> <span class="o">%</span> <span class="n">r</span><span class="p">)</span>
</span><span id="Expr-321"><a href="#Expr-321"><span class="linenos"> 321</span></a>        <span class="n">i</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
</span><span id="Expr-322"><a href="#Expr-322"><span class="linenos"> 322</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">i</span><span class="p">:</span>
</span><span id="Expr-323"><a href="#Expr-323"><span class="linenos"> 323</span></a>            <span class="k">return</span> <span class="mi">0</span>
</span><span id="Expr-324"><a href="#Expr-324"><span class="linenos"> 324</span></a>        <span class="c1"># off-by-one check</span>
</span><span id="Expr-325"><a href="#Expr-325"><span class="linenos"> 325</span></a>        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="n">r</span> <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span><span class="bp">self</span> <span class="o">-</span> <span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="mi">0</span><span class="p">):</span>
</span><span id="Expr-326"><a href="#Expr-326"><span class="linenos"> 326</span></a>            <span class="n">isign</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="o">-</span><span class="mi">1</span>
</span><span id="Expr-327"><a href="#Expr-327"><span class="linenos"> 327</span></a>            <span class="n">x</span> <span class="o">=</span> <span class="n">Dummy</span><span class="p">()</span>
</span><span id="Expr-328"><a href="#Expr-328"><span class="linenos"> 328</span></a>            <span class="c1"># in the following (self - i).evalf(2) will not always work while</span>
</span><span id="Expr-329"><a href="#Expr-329"><span class="linenos"> 329</span></a>            <span class="c1"># (self - r).evalf(2) and the use of subs does; if the test that</span>
</span><span id="Expr-330"><a href="#Expr-330"><span class="linenos"> 330</span></a>            <span class="c1"># was added when this comment was added passes, it might be safe</span>
</span><span id="Expr-331"><a href="#Expr-331"><span class="linenos"> 331</span></a>            <span class="c1"># to simply use sign to compute this rather than doing this by hand:</span>
</span><span id="Expr-332"><a href="#Expr-332"><span class="linenos"> 332</span></a>            <span class="n">diff_sign</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">if</span> <span class="p">(</span><span class="bp">self</span> <span class="o">-</span> <span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">evalf</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">subs</span><span class="o">=</span><span class="p">{</span><span class="n">x</span><span class="p">:</span> <span class="n">i</span><span class="p">})</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="o">-</span><span class="mi">1</span>
</span><span id="Expr-333"><a href="#Expr-333"><span class="linenos"> 333</span></a>            <span class="k">if</span> <span class="n">diff_sign</span> <span class="o">!=</span> <span class="n">isign</span><span class="p">:</span>
</span><span id="Expr-334"><a href="#Expr-334"><span class="linenos"> 334</span></a>                <span class="n">i</span> <span class="o">-=</span> <span class="n">isign</span>
</span><span id="Expr-335"><a href="#Expr-335"><span class="linenos"> 335</span></a>        <span class="k">return</span> <span class="n">i</span>
</span><span id="Expr-336"><a href="#Expr-336"><span class="linenos"> 336</span></a>
</span><span id="Expr-337"><a href="#Expr-337"><span class="linenos"> 337</span></a>    <span class="k">def</span> <span class="fm">__float__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Expr-338"><a href="#Expr-338"><span class="linenos"> 338</span></a>        <span class="c1"># Don&#39;t bother testing if it&#39;s a number; if it&#39;s not this is going</span>
</span><span id="Expr-339"><a href="#Expr-339"><span class="linenos"> 339</span></a>        <span class="c1"># to fail, and if it is we still need to check that it evalf&#39;ed to</span>
</span><span id="Expr-340"><a href="#Expr-340"><span class="linenos"> 340</span></a>        <span class="c1"># a number.</span>
</span><span id="Expr-341"><a href="#Expr-341"><span class="linenos"> 341</span></a>        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">evalf</span><span class="p">()</span>
</span><span id="Expr-342"><a href="#Expr-342"><span class="linenos"> 342</span></a>        <span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">is_Number</span><span class="p">:</span>
</span><span id="Expr-343"><a href="#Expr-343"><span class="linenos"> 343</span></a>            <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span><span id="Expr-344"><a href="#Expr-344"><span class="linenos"> 344</span></a>        <span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">is_number</span> <span class="ow">and</span> <span class="n">result</span><span class="o">.</span><span class="n">as_real_imag</span><span class="p">()[</span><span class="mi">1</span><span class="p">]:</span>
</span><span id="Expr-345"><a href="#Expr-345"><span class="linenos"> 345</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Cannot convert complex to float&quot;</span><span class="p">)</span>
</span><span id="Expr-346"><a href="#Expr-346"><span class="linenos"> 346</span></a>        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Cannot convert expression to float&quot;</span><span class="p">)</span>
</span><span id="Expr-347"><a href="#Expr-347"><span class="linenos"> 347</span></a>
</span><span id="Expr-348"><a href="#Expr-348"><span class="linenos"> 348</span></a>    <span class="k">def</span> <span class="fm">__complex__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Expr-349"><a href="#Expr-349"><span class="linenos"> 349</span></a>        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">evalf</span><span class="p">()</span>
</span><span id="Expr-350"><a href="#Expr-350"><span class="linenos"> 350</span></a>        <span class="n">re</span><span class="p">,</span> <span class="n">im</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">as_real_imag</span><span class="p">()</span>
</span><span id="Expr-351"><a href="#Expr-351"><span class="linenos"> 351</span></a>        <span class="k">return</span> <span class="nb">complex</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">re</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="n">im</span><span class="p">))</span>
</span><span id="Expr-352"><a href="#Expr-352"><span class="linenos"> 352</span></a>
</span><span id="Expr-353"><a href="#Expr-353"><span class="linenos"> 353</span></a>    <span class="nd">@sympify_return</span><span class="p">([(</span><span class="s1">&#39;other&#39;</span><span class="p">,</span> <span class="s1">&#39;Expr&#39;</span><span class="p">)],</span> <span class="bp">NotImplemented</span><span class="p">)</span>
</span><span id="Expr-354"><a href="#Expr-354"><span class="linenos"> 354</span></a>    <span class="k">def</span> <span class="fm">__ge__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="Expr-355"><a href="#Expr-355"><span class="linenos"> 355</span></a>        <span class="kn">from</span> <span class="nn">.relational</span> <span class="kn">import</span> <span class="n">GreaterThan</span>
</span><span id="Expr-356"><a href="#Expr-356"><span class="linenos"> 356</span></a>        <span class="k">return</span> <span class="n">GreaterThan</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>
</span><span id="Expr-357"><a href="#Expr-357"><span class="linenos"> 357</span></a>
</span><span id="Expr-358"><a href="#Expr-358"><span class="linenos"> 358</span></a>    <span class="nd">@sympify_return</span><span class="p">([(</span><span class="s1">&#39;other&#39;</span><span class="p">,</span> <span class="s1">&#39;Expr&#39;</span><span class="p">)],</span> <span class="bp">NotImplemented</span><span class="p">)</span>
</span><span id="Expr-359"><a href="#Expr-359"><span class="linenos"> 359</span></a>    <span class="k">def</span> <span class="fm">__le__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="Expr-360"><a href="#Expr-360"><span class="linenos"> 360</span></a>        <span class="kn">from</span> <span class="nn">.relational</span> <span class="kn">import</span> <span class="n">LessThan</span>
</span><span id="Expr-361"><a href="#Expr-361"><span class="linenos"> 361</span></a>        <span class="k">return</span> <span class="n">LessThan</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>
</span><span id="Expr-362"><a href="#Expr-362"><span class="linenos"> 362</span></a>
</span><span id="Expr-363"><a href="#Expr-363"><span class="linenos"> 363</span></a>    <span class="nd">@sympify_return</span><span class="p">([(</span><span class="s1">&#39;other&#39;</span><span class="p">,</span> <span class="s1">&#39;Expr&#39;</span><span class="p">)],</span> <span class="bp">NotImplemented</span><span class="p">)</span>
</span><span id="Expr-364"><a href="#Expr-364"><span class="linenos"> 364</span></a>    <span class="k">def</span> <span class="fm">__gt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="Expr-365"><a href="#Expr-365"><span class="linenos"> 365</span></a>        <span class="kn">from</span> <span class="nn">.relational</span> <span class="kn">import</span> <span class="n">StrictGreaterThan</span>
</span><span id="Expr-366"><a href="#Expr-366"><span class="linenos"> 366</span></a>        <span class="k">return</span> <span class="n">StrictGreaterThan</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>
</span><span id="Expr-367"><a href="#Expr-367"><span class="linenos"> 367</span></a>
</span><span id="Expr-368"><a href="#Expr-368"><span class="linenos"> 368</span></a>    <span class="nd">@sympify_return</span><span class="p">([(</span><span class="s1">&#39;other&#39;</span><span class="p">,</span> <span class="s1">&#39;Expr&#39;</span><span class="p">)],</span> <span class="bp">NotImplemented</span><span class="p">)</span>
</span><span id="Expr-369"><a href="#Expr-369"><span class="linenos"> 369</span></a>    <span class="k">def</span> <span class="fm">__lt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="Expr-370"><a href="#Expr-370"><span class="linenos"> 370</span></a>        <span class="kn">from</span> <span class="nn">.relational</span> <span class="kn">import</span> <span class="n">StrictLessThan</span>
</span><span id="Expr-371"><a href="#Expr-371"><span class="linenos"> 371</span></a>        <span class="k">return</span> <span class="n">StrictLessThan</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>
</span><span id="Expr-372"><a href="#Expr-372"><span class="linenos"> 372</span></a>
</span><span id="Expr-373"><a href="#Expr-373"><span class="linenos"> 373</span></a>    <span class="k">def</span> <span class="nf">__trunc__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Expr-374"><a href="#Expr-374"><span class="linenos"> 374</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_number</span><span class="p">:</span>
</span><span id="Expr-375"><a href="#Expr-375"><span class="linenos"> 375</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Cannot truncate symbols and expressions&quot;</span><span class="p">)</span>
</span><span id="Expr-376"><a href="#Expr-376"><span class="linenos"> 376</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Expr-377"><a href="#Expr-377"><span class="linenos"> 377</span></a>            <span class="k">return</span> <span class="n">Integer</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="Expr-378"><a href="#Expr-378"><span class="linenos"> 378</span></a>
</span><span id="Expr-379"><a href="#Expr-379"><span class="linenos"> 379</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Expr-380"><a href="#Expr-380"><span class="linenos"> 380</span></a>    <span class="k">def</span> <span class="nf">_from_mpmath</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">prec</span><span class="p">):</span>
</span><span id="Expr-381"><a href="#Expr-381"><span class="linenos"> 381</span></a>        <span class="kn">from</span> <span class="nn">.numbers</span> <span class="kn">import</span> <span class="n">Float</span>
</span><span id="Expr-382"><a href="#Expr-382"><span class="linenos"> 382</span></a>        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="s2">&quot;_mpf_&quot;</span><span class="p">):</span>
</span><span id="Expr-383"><a href="#Expr-383"><span class="linenos"> 383</span></a>            <span class="k">return</span> <span class="n">Float</span><span class="o">.</span><span class="n">_new</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">_mpf_</span><span class="p">,</span> <span class="n">prec</span><span class="p">)</span>
</span><span id="Expr-384"><a href="#Expr-384"><span class="linenos"> 384</span></a>        <span class="k">elif</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="s2">&quot;_mpc_&quot;</span><span class="p">):</span>
</span><span id="Expr-385"><a href="#Expr-385"><span class="linenos"> 385</span></a>            <span class="n">re</span><span class="p">,</span> <span class="n">im</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">_mpc_</span>
</span><span id="Expr-386"><a href="#Expr-386"><span class="linenos"> 386</span></a>            <span class="n">re</span> <span class="o">=</span> <span class="n">Float</span><span class="o">.</span><span class="n">_new</span><span class="p">(</span><span class="n">re</span><span class="p">,</span> <span class="n">prec</span><span class="p">)</span>
</span><span id="Expr-387"><a href="#Expr-387"><span class="linenos"> 387</span></a>            <span class="n">im</span> <span class="o">=</span> <span class="n">Float</span><span class="o">.</span><span class="n">_new</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">prec</span><span class="p">)</span><span class="o">*</span><span class="n">S</span><span class="o">.</span><span class="n">ImaginaryUnit</span>
</span><span id="Expr-388"><a href="#Expr-388"><span class="linenos"> 388</span></a>            <span class="k">return</span> <span class="n">re</span> <span class="o">+</span> <span class="n">im</span>
</span><span id="Expr-389"><a href="#Expr-389"><span class="linenos"> 389</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Expr-390"><a href="#Expr-390"><span class="linenos"> 390</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;expected mpmath number (mpf or mpc)&quot;</span><span class="p">)</span>
</span><span id="Expr-391"><a href="#Expr-391"><span class="linenos"> 391</span></a>
</span><span id="Expr-392"><a href="#Expr-392"><span class="linenos"> 392</span></a>    <span class="nd">@property</span>
</span><span id="Expr-393"><a href="#Expr-393"><span class="linenos"> 393</span></a>    <span class="k">def</span> <span class="nf">is_number</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Expr-394"><a href="#Expr-394"><span class="linenos"> 394</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns True if ``self`` has no free symbols and no</span>
</span><span id="Expr-395"><a href="#Expr-395"><span class="linenos"> 395</span></a><span class="sd">        undefined functions (AppliedUndef, to be precise). It will be</span>
</span><span id="Expr-396"><a href="#Expr-396"><span class="linenos"> 396</span></a><span class="sd">        faster than ``if not self.free_symbols``, however, since</span>
</span><span id="Expr-397"><a href="#Expr-397"><span class="linenos"> 397</span></a><span class="sd">        ``is_number`` will fail as soon as it hits a free symbol</span>
</span><span id="Expr-398"><a href="#Expr-398"><span class="linenos"> 398</span></a><span class="sd">        or undefined function.</span>
</span><span id="Expr-399"><a href="#Expr-399"><span class="linenos"> 399</span></a>
</span><span id="Expr-400"><a href="#Expr-400"><span class="linenos"> 400</span></a><span class="sd">        Examples</span>
</span><span id="Expr-401"><a href="#Expr-401"><span class="linenos"> 401</span></a><span class="sd">        ========</span>
</span><span id="Expr-402"><a href="#Expr-402"><span class="linenos"> 402</span></a>
</span><span id="Expr-403"><a href="#Expr-403"><span class="linenos"> 403</span></a><span class="sd">        &gt;&gt;&gt; from sympy import Function, Integral, cos, sin, pi</span>
</span><span id="Expr-404"><a href="#Expr-404"><span class="linenos"> 404</span></a><span class="sd">        &gt;&gt;&gt; from sympy.abc import x</span>
</span><span id="Expr-405"><a href="#Expr-405"><span class="linenos"> 405</span></a><span class="sd">        &gt;&gt;&gt; f = Function(&#39;f&#39;)</span>
</span><span id="Expr-406"><a href="#Expr-406"><span class="linenos"> 406</span></a>
</span><span id="Expr-407"><a href="#Expr-407"><span class="linenos"> 407</span></a><span class="sd">        &gt;&gt;&gt; x.is_number</span>
</span><span id="Expr-408"><a href="#Expr-408"><span class="linenos"> 408</span></a><span class="sd">        False</span>
</span><span id="Expr-409"><a href="#Expr-409"><span class="linenos"> 409</span></a><span class="sd">        &gt;&gt;&gt; f(1).is_number</span>
</span><span id="Expr-410"><a href="#Expr-410"><span class="linenos"> 410</span></a><span class="sd">        False</span>
</span><span id="Expr-411"><a href="#Expr-411"><span class="linenos"> 411</span></a><span class="sd">        &gt;&gt;&gt; (2*x).is_number</span>
</span><span id="Expr-412"><a href="#Expr-412"><span class="linenos"> 412</span></a><span class="sd">        False</span>
</span><span id="Expr-413"><a href="#Expr-413"><span class="linenos"> 413</span></a><span class="sd">        &gt;&gt;&gt; (2 + Integral(2, x)).is_number</span>
</span><span id="Expr-414"><a href="#Expr-414"><span class="linenos"> 414</span></a><span class="sd">        False</span>
</span><span id="Expr-415"><a href="#Expr-415"><span class="linenos"> 415</span></a><span class="sd">        &gt;&gt;&gt; (2 + Integral(2, (x, 1, 2))).is_number</span>
</span><span id="Expr-416"><a href="#Expr-416"><span class="linenos"> 416</span></a><span class="sd">        True</span>
</span><span id="Expr-417"><a href="#Expr-417"><span class="linenos"> 417</span></a>
</span><span id="Expr-418"><a href="#Expr-418"><span class="linenos"> 418</span></a><span class="sd">        Not all numbers are Numbers in the SymPy sense:</span>
</span><span id="Expr-419"><a href="#Expr-419"><span class="linenos"> 419</span></a>
</span><span id="Expr-420"><a href="#Expr-420"><span class="linenos"> 420</span></a><span class="sd">        &gt;&gt;&gt; pi.is_number, pi.is_Number</span>
</span><span id="Expr-421"><a href="#Expr-421"><span class="linenos"> 421</span></a><span class="sd">        (True, False)</span>
</span><span id="Expr-422"><a href="#Expr-422"><span class="linenos"> 422</span></a>
</span><span id="Expr-423"><a href="#Expr-423"><span class="linenos"> 423</span></a><span class="sd">        If something is a number it should evaluate to a number with</span>
</span><span id="Expr-424"><a href="#Expr-424"><span class="linenos"> 424</span></a><span class="sd">        real and imaginary parts that are Numbers; the result may not</span>
</span><span id="Expr-425"><a href="#Expr-425"><span class="linenos"> 425</span></a><span class="sd">        be comparable, however, since the real and/or imaginary part</span>
</span><span id="Expr-426"><a href="#Expr-426"><span class="linenos"> 426</span></a><span class="sd">        of the result may not have precision.</span>
</span><span id="Expr-427"><a href="#Expr-427"><span class="linenos"> 427</span></a>
</span><span id="Expr-428"><a href="#Expr-428"><span class="linenos"> 428</span></a><span class="sd">        &gt;&gt;&gt; cos(1).is_number and cos(1).is_comparable</span>
</span><span id="Expr-429"><a href="#Expr-429"><span class="linenos"> 429</span></a><span class="sd">        True</span>
</span><span id="Expr-430"><a href="#Expr-430"><span class="linenos"> 430</span></a>
</span><span id="Expr-431"><a href="#Expr-431"><span class="linenos"> 431</span></a><span class="sd">        &gt;&gt;&gt; z = cos(1)**2 + sin(1)**2 - 1</span>
</span><span id="Expr-432"><a href="#Expr-432"><span class="linenos"> 432</span></a><span class="sd">        &gt;&gt;&gt; z.is_number</span>
</span><span id="Expr-433"><a href="#Expr-433"><span class="linenos"> 433</span></a><span class="sd">        True</span>
</span><span id="Expr-434"><a href="#Expr-434"><span class="linenos"> 434</span></a><span class="sd">        &gt;&gt;&gt; z.is_comparable</span>
</span><span id="Expr-435"><a href="#Expr-435"><span class="linenos"> 435</span></a><span class="sd">        False</span>
</span><span id="Expr-436"><a href="#Expr-436"><span class="linenos"> 436</span></a>
</span><span id="Expr-437"><a href="#Expr-437"><span class="linenos"> 437</span></a><span class="sd">        See Also</span>
</span><span id="Expr-438"><a href="#Expr-438"><span class="linenos"> 438</span></a><span class="sd">        ========</span>
</span><span id="Expr-439"><a href="#Expr-439"><span class="linenos"> 439</span></a>
</span><span id="Expr-440"><a href="#Expr-440"><span class="linenos"> 440</span></a><span class="sd">        sympy.core.basic.Basic.is_comparable</span>
</span><span id="Expr-441"><a href="#Expr-441"><span class="linenos"> 441</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Expr-442"><a href="#Expr-442"><span class="linenos"> 442</span></a>        <span class="k">return</span> <span class="nb">all</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">is_number</span> <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">)</span>
</span><span id="Expr-443"><a href="#Expr-443"><span class="linenos"> 443</span></a>
</span><span id="Expr-444"><a href="#Expr-444"><span class="linenos"> 444</span></a>    <span class="k">def</span> <span class="nf">_random</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">re_min</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">im_min</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">re_max</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">im_max</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
</span><span id="Expr-445"><a href="#Expr-445"><span class="linenos"> 445</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return self evaluated, if possible, replacing free symbols with</span>
</span><span id="Expr-446"><a href="#Expr-446"><span class="linenos"> 446</span></a><span class="sd">        random complex values, if necessary.</span>
</span><span id="Expr-447"><a href="#Expr-447"><span class="linenos"> 447</span></a>
</span><span id="Expr-448"><a href="#Expr-448"><span class="linenos"> 448</span></a><span class="sd">        Explanation</span>
</span><span id="Expr-449"><a href="#Expr-449"><span class="linenos"> 449</span></a><span class="sd">        ===========</span>
</span><span id="Expr-450"><a href="#Expr-450"><span class="linenos"> 450</span></a>
</span><span id="Expr-451"><a href="#Expr-451"><span class="linenos"> 451</span></a><span class="sd">        The random complex value for each free symbol is generated</span>
</span><span id="Expr-452"><a href="#Expr-452"><span class="linenos"> 452</span></a><span class="sd">        by the random_complex_number routine giving real and imaginary</span>
</span><span id="Expr-453"><a href="#Expr-453"><span class="linenos"> 453</span></a><span class="sd">        parts in the range given by the re_min, re_max, im_min, and im_max</span>
</span><span id="Expr-454"><a href="#Expr-454"><span class="linenos"> 454</span></a><span class="sd">        values. The returned value is evaluated to a precision of n</span>
</span><span id="Expr-455"><a href="#Expr-455"><span class="linenos"> 455</span></a><span class="sd">        (if given) else the maximum of 15 and the precision needed</span>
</span><span id="Expr-456"><a href="#Expr-456"><span class="linenos"> 456</span></a><span class="sd">        to get more than 1 digit of precision. If the expression</span>
</span><span id="Expr-457"><a href="#Expr-457"><span class="linenos"> 457</span></a><span class="sd">        could not be evaluated to a number, or could not be evaluated</span>
</span><span id="Expr-458"><a href="#Expr-458"><span class="linenos"> 458</span></a><span class="sd">        to more than 1 digit of precision, then None is returned.</span>
</span><span id="Expr-459"><a href="#Expr-459"><span class="linenos"> 459</span></a>
</span><span id="Expr-460"><a href="#Expr-460"><span class="linenos"> 460</span></a><span class="sd">        Examples</span>
</span><span id="Expr-461"><a href="#Expr-461"><span class="linenos"> 461</span></a><span class="sd">        ========</span>
</span><span id="Expr-462"><a href="#Expr-462"><span class="linenos"> 462</span></a>
</span><span id="Expr-463"><a href="#Expr-463"><span class="linenos"> 463</span></a><span class="sd">        &gt;&gt;&gt; from sympy import sqrt</span>
</span><span id="Expr-464"><a href="#Expr-464"><span class="linenos"> 464</span></a><span class="sd">        &gt;&gt;&gt; from sympy.abc import x, y</span>
</span><span id="Expr-465"><a href="#Expr-465"><span class="linenos"> 465</span></a><span class="sd">        &gt;&gt;&gt; x._random()                         # doctest: +SKIP</span>
</span><span id="Expr-466"><a href="#Expr-466"><span class="linenos"> 466</span></a><span class="sd">        0.0392918155679172 + 0.916050214307199*I</span>
</span><span id="Expr-467"><a href="#Expr-467"><span class="linenos"> 467</span></a><span class="sd">        &gt;&gt;&gt; x._random(2)                        # doctest: +SKIP</span>
</span><span id="Expr-468"><a href="#Expr-468"><span class="linenos"> 468</span></a><span class="sd">        -0.77 - 0.87*I</span>
</span><span id="Expr-469"><a href="#Expr-469"><span class="linenos"> 469</span></a><span class="sd">        &gt;&gt;&gt; (x + y/2)._random(2)                # doctest: +SKIP</span>
</span><span id="Expr-470"><a href="#Expr-470"><span class="linenos"> 470</span></a><span class="sd">        -0.57 + 0.16*I</span>
</span><span id="Expr-471"><a href="#Expr-471"><span class="linenos"> 471</span></a><span class="sd">        &gt;&gt;&gt; sqrt(2)._random(2)</span>
</span><span id="Expr-472"><a href="#Expr-472"><span class="linenos"> 472</span></a><span class="sd">        1.4</span>
</span><span id="Expr-473"><a href="#Expr-473"><span class="linenos"> 473</span></a>
</span><span id="Expr-474"><a href="#Expr-474"><span class="linenos"> 474</span></a><span class="sd">        See Also</span>
</span><span id="Expr-475"><a href="#Expr-475"><span class="linenos"> 475</span></a><span class="sd">        ========</span>
</span><span id="Expr-476"><a href="#Expr-476"><span class="linenos"> 476</span></a>
</span><span id="Expr-477"><a href="#Expr-477"><span class="linenos"> 477</span></a><span class="sd">        sympy.core.random.random_complex_number</span>
</span><span id="Expr-478"><a href="#Expr-478"><span class="linenos"> 478</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Expr-479"><a href="#Expr-479"><span class="linenos"> 479</span></a>
</span><span id="Expr-480"><a href="#Expr-480"><span class="linenos"> 480</span></a>        <span class="n">free</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">free_symbols</span>
</span><span id="Expr-481"><a href="#Expr-481"><span class="linenos"> 481</span></a>        <span class="n">prec</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="Expr-482"><a href="#Expr-482"><span class="linenos"> 482</span></a>        <span class="k">if</span> <span class="n">free</span><span class="p">:</span>
</span><span id="Expr-483"><a href="#Expr-483"><span class="linenos"> 483</span></a>            <span class="kn">from</span> <span class="nn">sympy.core.random</span> <span class="kn">import</span> <span class="n">random_complex_number</span>
</span><span id="Expr-484"><a href="#Expr-484"><span class="linenos"> 484</span></a>            <span class="n">a</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">d</span> <span class="o">=</span> <span class="n">re_min</span><span class="p">,</span> <span class="n">re_max</span><span class="p">,</span> <span class="n">im_min</span><span class="p">,</span> <span class="n">im_max</span>
</span><span id="Expr-485"><a href="#Expr-485"><span class="linenos"> 485</span></a>            <span class="n">reps</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">free</span><span class="p">,</span> <span class="p">[</span><span class="n">random_complex_number</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">rational</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="Expr-486"><a href="#Expr-486"><span class="linenos"> 486</span></a>                           <span class="k">for</span> <span class="n">zi</span> <span class="ow">in</span> <span class="n">free</span><span class="p">])))</span>
</span><span id="Expr-487"><a href="#Expr-487"><span class="linenos"> 487</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="Expr-488"><a href="#Expr-488"><span class="linenos"> 488</span></a>                <span class="n">nmag</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">evalf</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">subs</span><span class="o">=</span><span class="n">reps</span><span class="p">))</span>
</span><span id="Expr-489"><a href="#Expr-489"><span class="linenos"> 489</span></a>            <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">):</span>
</span><span id="Expr-490"><a href="#Expr-490"><span class="linenos"> 490</span></a>                <span class="c1"># if an out of range value resulted in evalf problems</span>
</span><span id="Expr-491"><a href="#Expr-491"><span class="linenos"> 491</span></a>                <span class="c1"># then return None -- XXX is there a way to know how to</span>
</span><span id="Expr-492"><a href="#Expr-492"><span class="linenos"> 492</span></a>                <span class="c1"># select a good random number for a given expression?</span>
</span><span id="Expr-493"><a href="#Expr-493"><span class="linenos"> 493</span></a>                <span class="c1"># e.g. when calculating n! negative values for n should not</span>
</span><span id="Expr-494"><a href="#Expr-494"><span class="linenos"> 494</span></a>                <span class="c1"># be used</span>
</span><span id="Expr-495"><a href="#Expr-495"><span class="linenos"> 495</span></a>                <span class="k">return</span> <span class="kc">None</span>
</span><span id="Expr-496"><a href="#Expr-496"><span class="linenos"> 496</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Expr-497"><a href="#Expr-497"><span class="linenos"> 497</span></a>            <span class="n">reps</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="Expr-498"><a href="#Expr-498"><span class="linenos"> 498</span></a>            <span class="n">nmag</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">evalf</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
</span><span id="Expr-499"><a href="#Expr-499"><span class="linenos"> 499</span></a>
</span><span id="Expr-500"><a href="#Expr-500"><span class="linenos"> 500</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">nmag</span><span class="p">,</span> <span class="s1">&#39;_prec&#39;</span><span class="p">):</span>
</span><span id="Expr-501"><a href="#Expr-501"><span class="linenos"> 501</span></a>            <span class="c1"># e.g. exp_polar(2*I*pi) doesn&#39;t evaluate but is_number is True</span>
</span><span id="Expr-502"><a href="#Expr-502"><span class="linenos"> 502</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="Expr-503"><a href="#Expr-503"><span class="linenos"> 503</span></a>
</span><span id="Expr-504"><a href="#Expr-504"><span class="linenos"> 504</span></a>        <span class="k">if</span> <span class="n">nmag</span><span class="o">.</span><span class="n">_prec</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Expr-505"><a href="#Expr-505"><span class="linenos"> 505</span></a>            <span class="c1"># increase the precision up to the default maximum</span>
</span><span id="Expr-506"><a href="#Expr-506"><span class="linenos"> 506</span></a>            <span class="c1"># precision to see if we can get any significance</span>
</span><span id="Expr-507"><a href="#Expr-507"><span class="linenos"> 507</span></a>
</span><span id="Expr-508"><a href="#Expr-508"><span class="linenos"> 508</span></a>            <span class="c1"># evaluate</span>
</span><span id="Expr-509"><a href="#Expr-509"><span class="linenos"> 509</span></a>            <span class="k">for</span> <span class="n">prec</span> <span class="ow">in</span> <span class="n">giant_steps</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">DEFAULT_MAXPREC</span><span class="p">):</span>
</span><span id="Expr-510"><a href="#Expr-510"><span class="linenos"> 510</span></a>                <span class="n">nmag</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">evalf</span><span class="p">(</span><span class="n">prec</span><span class="p">,</span> <span class="n">subs</span><span class="o">=</span><span class="n">reps</span><span class="p">))</span>
</span><span id="Expr-511"><a href="#Expr-511"><span class="linenos"> 511</span></a>                <span class="k">if</span> <span class="n">nmag</span><span class="o">.</span><span class="n">_prec</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Expr-512"><a href="#Expr-512"><span class="linenos"> 512</span></a>                    <span class="k">break</span>
</span><span id="Expr-513"><a href="#Expr-513"><span class="linenos"> 513</span></a>
</span><span id="Expr-514"><a href="#Expr-514"><span class="linenos"> 514</span></a>        <span class="k">if</span> <span class="n">nmag</span><span class="o">.</span><span class="n">_prec</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Expr-515"><a href="#Expr-515"><span class="linenos"> 515</span></a>            <span class="k">if</span> <span class="n">n</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Expr-516"><a href="#Expr-516"><span class="linenos"> 516</span></a>                <span class="n">n</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">prec</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>
</span><span id="Expr-517"><a href="#Expr-517"><span class="linenos"> 517</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">evalf</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">subs</span><span class="o">=</span><span class="n">reps</span><span class="p">)</span>
</span><span id="Expr-518"><a href="#Expr-518"><span class="linenos"> 518</span></a>
</span><span id="Expr-519"><a href="#Expr-519"><span class="linenos"> 519</span></a>        <span class="c1"># never got any significance</span>
</span><span id="Expr-520"><a href="#Expr-520"><span class="linenos"> 520</span></a>        <span class="k">return</span> <span class="kc">None</span>
</span><span id="Expr-521"><a href="#Expr-521"><span class="linenos"> 521</span></a>
</span><span id="Expr-522"><a href="#Expr-522"><span class="linenos"> 522</span></a>    <span class="k">def</span> <span class="nf">is_constant</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">wrt</span><span class="p">,</span> <span class="o">**</span><span class="n">flags</span><span class="p">):</span>
</span><span id="Expr-523"><a href="#Expr-523"><span class="linenos"> 523</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return True if self is constant, False if not, or None if</span>
</span><span id="Expr-524"><a href="#Expr-524"><span class="linenos"> 524</span></a><span class="sd">        the constancy could not be determined conclusively.</span>
</span><span id="Expr-525"><a href="#Expr-525"><span class="linenos"> 525</span></a>
</span><span id="Expr-526"><a href="#Expr-526"><span class="linenos"> 526</span></a><span class="sd">        Explanation</span>
</span><span id="Expr-527"><a href="#Expr-527"><span class="linenos"> 527</span></a><span class="sd">        ===========</span>
</span><span id="Expr-528"><a href="#Expr-528"><span class="linenos"> 528</span></a>
</span><span id="Expr-529"><a href="#Expr-529"><span class="linenos"> 529</span></a><span class="sd">        If an expression has no free symbols then it is a constant. If</span>
</span><span id="Expr-530"><a href="#Expr-530"><span class="linenos"> 530</span></a><span class="sd">        there are free symbols it is possible that the expression is a</span>
</span><span id="Expr-531"><a href="#Expr-531"><span class="linenos"> 531</span></a><span class="sd">        constant, perhaps (but not necessarily) zero. To test such</span>
</span><span id="Expr-532"><a href="#Expr-532"><span class="linenos"> 532</span></a><span class="sd">        expressions, a few strategies are tried:</span>
</span><span id="Expr-533"><a href="#Expr-533"><span class="linenos"> 533</span></a>
</span><span id="Expr-534"><a href="#Expr-534"><span class="linenos"> 534</span></a><span class="sd">        1) numerical evaluation at two random points. If two such evaluations</span>
</span><span id="Expr-535"><a href="#Expr-535"><span class="linenos"> 535</span></a><span class="sd">        give two different values and the values have a precision greater than</span>
</span><span id="Expr-536"><a href="#Expr-536"><span class="linenos"> 536</span></a><span class="sd">        1 then self is not constant. If the evaluations agree or could not be</span>
</span><span id="Expr-537"><a href="#Expr-537"><span class="linenos"> 537</span></a><span class="sd">        obtained with any precision, no decision is made. The numerical testing</span>
</span><span id="Expr-538"><a href="#Expr-538"><span class="linenos"> 538</span></a><span class="sd">        is done only if ``wrt`` is different than the free symbols.</span>
</span><span id="Expr-539"><a href="#Expr-539"><span class="linenos"> 539</span></a>
</span><span id="Expr-540"><a href="#Expr-540"><span class="linenos"> 540</span></a><span class="sd">        2) differentiation with respect to variables in &#39;wrt&#39; (or all free</span>
</span><span id="Expr-541"><a href="#Expr-541"><span class="linenos"> 541</span></a><span class="sd">        symbols if omitted) to see if the expression is constant or not. This</span>
</span><span id="Expr-542"><a href="#Expr-542"><span class="linenos"> 542</span></a><span class="sd">        will not always lead to an expression that is zero even though an</span>
</span><span id="Expr-543"><a href="#Expr-543"><span class="linenos"> 543</span></a><span class="sd">        expression is constant (see added test in test_expr.py). If</span>
</span><span id="Expr-544"><a href="#Expr-544"><span class="linenos"> 544</span></a><span class="sd">        all derivatives are zero then self is constant with respect to the</span>
</span><span id="Expr-545"><a href="#Expr-545"><span class="linenos"> 545</span></a><span class="sd">        given symbols.</span>
</span><span id="Expr-546"><a href="#Expr-546"><span class="linenos"> 546</span></a>
</span><span id="Expr-547"><a href="#Expr-547"><span class="linenos"> 547</span></a><span class="sd">        3) finding out zeros of denominator expression with free_symbols.</span>
</span><span id="Expr-548"><a href="#Expr-548"><span class="linenos"> 548</span></a><span class="sd">        It will not be constant if there are zeros. It gives more negative</span>
</span><span id="Expr-549"><a href="#Expr-549"><span class="linenos"> 549</span></a><span class="sd">        answers for expression that are not constant.</span>
</span><span id="Expr-550"><a href="#Expr-550"><span class="linenos"> 550</span></a>
</span><span id="Expr-551"><a href="#Expr-551"><span class="linenos"> 551</span></a><span class="sd">        If neither evaluation nor differentiation can prove the expression is</span>
</span><span id="Expr-552"><a href="#Expr-552"><span class="linenos"> 552</span></a><span class="sd">        constant, None is returned unless two numerical values happened to be</span>
</span><span id="Expr-553"><a href="#Expr-553"><span class="linenos"> 553</span></a><span class="sd">        the same and the flag ``failing_number`` is True -- in that case the</span>
</span><span id="Expr-554"><a href="#Expr-554"><span class="linenos"> 554</span></a><span class="sd">        numerical value will be returned.</span>
</span><span id="Expr-555"><a href="#Expr-555"><span class="linenos"> 555</span></a>
</span><span id="Expr-556"><a href="#Expr-556"><span class="linenos"> 556</span></a><span class="sd">        If flag simplify=False is passed, self will not be simplified;</span>
</span><span id="Expr-557"><a href="#Expr-557"><span class="linenos"> 557</span></a><span class="sd">        the default is True since self should be simplified before testing.</span>
</span><span id="Expr-558"><a href="#Expr-558"><span class="linenos"> 558</span></a>
</span><span id="Expr-559"><a href="#Expr-559"><span class="linenos"> 559</span></a><span class="sd">        Examples</span>
</span><span id="Expr-560"><a href="#Expr-560"><span class="linenos"> 560</span></a><span class="sd">        ========</span>
</span><span id="Expr-561"><a href="#Expr-561"><span class="linenos"> 561</span></a>
</span><span id="Expr-562"><a href="#Expr-562"><span class="linenos"> 562</span></a><span class="sd">        &gt;&gt;&gt; from sympy import cos, sin, Sum, S, pi</span>
</span><span id="Expr-563"><a href="#Expr-563"><span class="linenos"> 563</span></a><span class="sd">        &gt;&gt;&gt; from sympy.abc import a, n, x, y</span>
</span><span id="Expr-564"><a href="#Expr-564"><span class="linenos"> 564</span></a><span class="sd">        &gt;&gt;&gt; x.is_constant()</span>
</span><span id="Expr-565"><a href="#Expr-565"><span class="linenos"> 565</span></a><span class="sd">        False</span>
</span><span id="Expr-566"><a href="#Expr-566"><span class="linenos"> 566</span></a><span class="sd">        &gt;&gt;&gt; S(2).is_constant()</span>
</span><span id="Expr-567"><a href="#Expr-567"><span class="linenos"> 567</span></a><span class="sd">        True</span>
</span><span id="Expr-568"><a href="#Expr-568"><span class="linenos"> 568</span></a><span class="sd">        &gt;&gt;&gt; Sum(x, (x, 1, 10)).is_constant()</span>
</span><span id="Expr-569"><a href="#Expr-569"><span class="linenos"> 569</span></a><span class="sd">        True</span>
</span><span id="Expr-570"><a href="#Expr-570"><span class="linenos"> 570</span></a><span class="sd">        &gt;&gt;&gt; Sum(x, (x, 1, n)).is_constant()</span>
</span><span id="Expr-571"><a href="#Expr-571"><span class="linenos"> 571</span></a><span class="sd">        False</span>
</span><span id="Expr-572"><a href="#Expr-572"><span class="linenos"> 572</span></a><span class="sd">        &gt;&gt;&gt; Sum(x, (x, 1, n)).is_constant(y)</span>
</span><span id="Expr-573"><a href="#Expr-573"><span class="linenos"> 573</span></a><span class="sd">        True</span>
</span><span id="Expr-574"><a href="#Expr-574"><span class="linenos"> 574</span></a><span class="sd">        &gt;&gt;&gt; Sum(x, (x, 1, n)).is_constant(n)</span>
</span><span id="Expr-575"><a href="#Expr-575"><span class="linenos"> 575</span></a><span class="sd">        False</span>
</span><span id="Expr-576"><a href="#Expr-576"><span class="linenos"> 576</span></a><span class="sd">        &gt;&gt;&gt; Sum(x, (x, 1, n)).is_constant(x)</span>
</span><span id="Expr-577"><a href="#Expr-577"><span class="linenos"> 577</span></a><span class="sd">        True</span>
</span><span id="Expr-578"><a href="#Expr-578"><span class="linenos"> 578</span></a><span class="sd">        &gt;&gt;&gt; eq = a*cos(x)**2 + a*sin(x)**2 - a</span>
</span><span id="Expr-579"><a href="#Expr-579"><span class="linenos"> 579</span></a><span class="sd">        &gt;&gt;&gt; eq.is_constant()</span>
</span><span id="Expr-580"><a href="#Expr-580"><span class="linenos"> 580</span></a><span class="sd">        True</span>
</span><span id="Expr-581"><a href="#Expr-581"><span class="linenos"> 581</span></a><span class="sd">        &gt;&gt;&gt; eq.subs({x: pi, a: 2}) == eq.subs({x: pi, a: 3}) == 0</span>
</span><span id="Expr-582"><a href="#Expr-582"><span class="linenos"> 582</span></a><span class="sd">        True</span>
</span><span id="Expr-583"><a href="#Expr-583"><span class="linenos"> 583</span></a>
</span><span id="Expr-584"><a href="#Expr-584"><span class="linenos"> 584</span></a><span class="sd">        &gt;&gt;&gt; (0**x).is_constant()</span>
</span><span id="Expr-585"><a href="#Expr-585"><span class="linenos"> 585</span></a><span class="sd">        False</span>
</span><span id="Expr-586"><a href="#Expr-586"><span class="linenos"> 586</span></a><span class="sd">        &gt;&gt;&gt; x.is_constant()</span>
</span><span id="Expr-587"><a href="#Expr-587"><span class="linenos"> 587</span></a><span class="sd">        False</span>
</span><span id="Expr-588"><a href="#Expr-588"><span class="linenos"> 588</span></a><span class="sd">        &gt;&gt;&gt; (x**x).is_constant()</span>
</span><span id="Expr-589"><a href="#Expr-589"><span class="linenos"> 589</span></a><span class="sd">        False</span>
</span><span id="Expr-590"><a href="#Expr-590"><span class="linenos"> 590</span></a><span class="sd">        &gt;&gt;&gt; one = cos(x)**2 + sin(x)**2</span>
</span><span id="Expr-591"><a href="#Expr-591"><span class="linenos"> 591</span></a><span class="sd">        &gt;&gt;&gt; one.is_constant()</span>
</span><span id="Expr-592"><a href="#Expr-592"><span class="linenos"> 592</span></a><span class="sd">        True</span>
</span><span id="Expr-593"><a href="#Expr-593"><span class="linenos"> 593</span></a><span class="sd">        &gt;&gt;&gt; ((one - 1)**(x + 1)).is_constant() in (True, False) # could be 0 or 1</span>
</span><span id="Expr-594"><a href="#Expr-594"><span class="linenos"> 594</span></a><span class="sd">        True</span>
</span><span id="Expr-595"><a href="#Expr-595"><span class="linenos"> 595</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Expr-596"><a href="#Expr-596"><span class="linenos"> 596</span></a>
</span><span id="Expr-597"><a href="#Expr-597"><span class="linenos"> 597</span></a>        <span class="k">def</span> <span class="nf">check_denominator_zeros</span><span class="p">(</span><span class="n">expression</span><span class="p">):</span>
</span><span id="Expr-598"><a href="#Expr-598"><span class="linenos"> 598</span></a>            <span class="kn">from</span> <span class="nn">sympy.solvers.solvers</span> <span class="kn">import</span> <span class="n">denoms</span>
</span><span id="Expr-599"><a href="#Expr-599"><span class="linenos"> 599</span></a>
</span><span id="Expr-600"><a href="#Expr-600"><span class="linenos"> 600</span></a>            <span class="n">retNone</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="Expr-601"><a href="#Expr-601"><span class="linenos"> 601</span></a>            <span class="k">for</span> <span class="n">den</span> <span class="ow">in</span> <span class="n">denoms</span><span class="p">(</span><span class="n">expression</span><span class="p">):</span>
</span><span id="Expr-602"><a href="#Expr-602"><span class="linenos"> 602</span></a>                <span class="n">z</span> <span class="o">=</span> <span class="n">den</span><span class="o">.</span><span class="n">is_zero</span>
</span><span id="Expr-603"><a href="#Expr-603"><span class="linenos"> 603</span></a>                <span class="k">if</span> <span class="n">z</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="Expr-604"><a href="#Expr-604"><span class="linenos"> 604</span></a>                    <span class="k">return</span> <span class="kc">True</span>
</span><span id="Expr-605"><a href="#Expr-605"><span class="linenos"> 605</span></a>                <span class="k">if</span> <span class="n">z</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Expr-606"><a href="#Expr-606"><span class="linenos"> 606</span></a>                    <span class="n">retNone</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="Expr-607"><a href="#Expr-607"><span class="linenos"> 607</span></a>            <span class="k">if</span> <span class="n">retNone</span><span class="p">:</span>
</span><span id="Expr-608"><a href="#Expr-608"><span class="linenos"> 608</span></a>                <span class="k">return</span> <span class="kc">None</span>
</span><span id="Expr-609"><a href="#Expr-609"><span class="linenos"> 609</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="Expr-610"><a href="#Expr-610"><span class="linenos"> 610</span></a>
</span><span id="Expr-611"><a href="#Expr-611"><span class="linenos"> 611</span></a>        <span class="n">simplify</span> <span class="o">=</span> <span class="n">flags</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;simplify&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
</span><span id="Expr-612"><a href="#Expr-612"><span class="linenos"> 612</span></a>
</span><span id="Expr-613"><a href="#Expr-613"><span class="linenos"> 613</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_number</span><span class="p">:</span>
</span><span id="Expr-614"><a href="#Expr-614"><span class="linenos"> 614</span></a>            <span class="k">return</span> <span class="kc">True</span>
</span><span id="Expr-615"><a href="#Expr-615"><span class="linenos"> 615</span></a>        <span class="n">free</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">free_symbols</span>
</span><span id="Expr-616"><a href="#Expr-616"><span class="linenos"> 616</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">free</span><span class="p">:</span>
</span><span id="Expr-617"><a href="#Expr-617"><span class="linenos"> 617</span></a>            <span class="k">return</span> <span class="kc">True</span>  <span class="c1"># assume f(1) is some constant</span>
</span><span id="Expr-618"><a href="#Expr-618"><span class="linenos"> 618</span></a>
</span><span id="Expr-619"><a href="#Expr-619"><span class="linenos"> 619</span></a>        <span class="c1"># if we are only interested in some symbols and they are not in the</span>
</span><span id="Expr-620"><a href="#Expr-620"><span class="linenos"> 620</span></a>        <span class="c1"># free symbols then this expression is constant wrt those symbols</span>
</span><span id="Expr-621"><a href="#Expr-621"><span class="linenos"> 621</span></a>        <span class="n">wrt</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">wrt</span><span class="p">)</span>
</span><span id="Expr-622"><a href="#Expr-622"><span class="linenos"> 622</span></a>        <span class="k">if</span> <span class="n">wrt</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">wrt</span> <span class="o">&amp;</span> <span class="n">free</span><span class="p">:</span>
</span><span id="Expr-623"><a href="#Expr-623"><span class="linenos"> 623</span></a>            <span class="k">return</span> <span class="kc">True</span>
</span><span id="Expr-624"><a href="#Expr-624"><span class="linenos"> 624</span></a>        <span class="n">wrt</span> <span class="o">=</span> <span class="n">wrt</span> <span class="ow">or</span> <span class="n">free</span>
</span><span id="Expr-625"><a href="#Expr-625"><span class="linenos"> 625</span></a>
</span><span id="Expr-626"><a href="#Expr-626"><span class="linenos"> 626</span></a>        <span class="c1"># simplify unless this has already been done</span>
</span><span id="Expr-627"><a href="#Expr-627"><span class="linenos"> 627</span></a>        <span class="n">expr</span> <span class="o">=</span> <span class="bp">self</span>
</span><span id="Expr-628"><a href="#Expr-628"><span class="linenos"> 628</span></a>        <span class="k">if</span> <span class="n">simplify</span><span class="p">:</span>
</span><span id="Expr-629"><a href="#Expr-629"><span class="linenos"> 629</span></a>            <span class="n">expr</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">simplify</span><span class="p">()</span>
</span><span id="Expr-630"><a href="#Expr-630"><span class="linenos"> 630</span></a>
</span><span id="Expr-631"><a href="#Expr-631"><span class="linenos"> 631</span></a>        <span class="c1"># is_zero should be a quick assumptions check; it can be wrong for</span>
</span><span id="Expr-632"><a href="#Expr-632"><span class="linenos"> 632</span></a>        <span class="c1"># numbers (see test_is_not_constant test), giving False when it</span>
</span><span id="Expr-633"><a href="#Expr-633"><span class="linenos"> 633</span></a>        <span class="c1"># shouldn&#39;t, but hopefully it will never give True unless it is sure.</span>
</span><span id="Expr-634"><a href="#Expr-634"><span class="linenos"> 634</span></a>        <span class="k">if</span> <span class="n">expr</span><span class="o">.</span><span class="n">is_zero</span><span class="p">:</span>
</span><span id="Expr-635"><a href="#Expr-635"><span class="linenos"> 635</span></a>            <span class="k">return</span> <span class="kc">True</span>
</span><span id="Expr-636"><a href="#Expr-636"><span class="linenos"> 636</span></a>
</span><span id="Expr-637"><a href="#Expr-637"><span class="linenos"> 637</span></a>        <span class="c1"># Don&#39;t attempt substitution or differentiation with non-number symbols</span>
</span><span id="Expr-638"><a href="#Expr-638"><span class="linenos"> 638</span></a>        <span class="n">wrt_number</span> <span class="o">=</span> <span class="p">{</span><span class="n">sym</span> <span class="k">for</span> <span class="n">sym</span> <span class="ow">in</span> <span class="n">wrt</span> <span class="k">if</span> <span class="n">sym</span><span class="o">.</span><span class="n">kind</span> <span class="ow">is</span> <span class="n">NumberKind</span><span class="p">}</span>
</span><span id="Expr-639"><a href="#Expr-639"><span class="linenos"> 639</span></a>
</span><span id="Expr-640"><a href="#Expr-640"><span class="linenos"> 640</span></a>        <span class="c1"># try numerical evaluation to see if we get two different values</span>
</span><span id="Expr-641"><a href="#Expr-641"><span class="linenos"> 641</span></a>        <span class="n">failing_number</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Expr-642"><a href="#Expr-642"><span class="linenos"> 642</span></a>        <span class="k">if</span> <span class="n">wrt_number</span> <span class="o">==</span> <span class="n">free</span><span class="p">:</span>
</span><span id="Expr-643"><a href="#Expr-643"><span class="linenos"> 643</span></a>            <span class="c1"># try 0 (for a) and 1 (for b)</span>
</span><span id="Expr-644"><a href="#Expr-644"><span class="linenos"> 644</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="Expr-645"><a href="#Expr-645"><span class="linenos"> 645</span></a>                <span class="n">a</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">free</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">free</span><span class="p">))),</span>
</span><span id="Expr-646"><a href="#Expr-646"><span class="linenos"> 646</span></a>                    <span class="n">simultaneous</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="Expr-647"><a href="#Expr-647"><span class="linenos"> 647</span></a>                <span class="k">if</span> <span class="n">a</span> <span class="ow">is</span> <span class="n">S</span><span class="o">.</span><span class="n">NaN</span><span class="p">:</span>
</span><span id="Expr-648"><a href="#Expr-648"><span class="linenos"> 648</span></a>                    <span class="c1"># evaluation may succeed when substitution fails</span>
</span><span id="Expr-649"><a href="#Expr-649"><span class="linenos"> 649</span></a>                    <span class="n">a</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">_random</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="Expr-650"><a href="#Expr-650"><span class="linenos"> 650</span></a>            <span class="k">except</span> <span class="ne">ZeroDivisionError</span><span class="p">:</span>
</span><span id="Expr-651"><a href="#Expr-651"><span class="linenos"> 651</span></a>                <span class="n">a</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Expr-652"><a href="#Expr-652"><span class="linenos"> 652</span></a>            <span class="k">if</span> <span class="n">a</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">a</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">S</span><span class="o">.</span><span class="n">NaN</span><span class="p">:</span>
</span><span id="Expr-653"><a href="#Expr-653"><span class="linenos"> 653</span></a>                <span class="k">try</span><span class="p">:</span>
</span><span id="Expr-654"><a href="#Expr-654"><span class="linenos"> 654</span></a>                    <span class="n">b</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">free</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">free</span><span class="p">))),</span>
</span><span id="Expr-655"><a href="#Expr-655"><span class="linenos"> 655</span></a>                        <span class="n">simultaneous</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="Expr-656"><a href="#Expr-656"><span class="linenos"> 656</span></a>                    <span class="k">if</span> <span class="n">b</span> <span class="ow">is</span> <span class="n">S</span><span class="o">.</span><span class="n">NaN</span><span class="p">:</span>
</span><span id="Expr-657"><a href="#Expr-657"><span class="linenos"> 657</span></a>                        <span class="c1"># evaluation may succeed when substitution fails</span>
</span><span id="Expr-658"><a href="#Expr-658"><span class="linenos"> 658</span></a>                        <span class="n">b</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">_random</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="Expr-659"><a href="#Expr-659"><span class="linenos"> 659</span></a>                <span class="k">except</span> <span class="ne">ZeroDivisionError</span><span class="p">:</span>
</span><span id="Expr-660"><a href="#Expr-660"><span class="linenos"> 660</span></a>                    <span class="n">b</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Expr-661"><a href="#Expr-661"><span class="linenos"> 661</span></a>                <span class="k">if</span> <span class="n">b</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">b</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">S</span><span class="o">.</span><span class="n">NaN</span> <span class="ow">and</span> <span class="n">b</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
</span><span id="Expr-662"><a href="#Expr-662"><span class="linenos"> 662</span></a>                    <span class="k">return</span> <span class="kc">False</span>
</span><span id="Expr-663"><a href="#Expr-663"><span class="linenos"> 663</span></a>                <span class="c1"># try random real</span>
</span><span id="Expr-664"><a href="#Expr-664"><span class="linenos"> 664</span></a>                <span class="n">b</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">_random</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="Expr-665"><a href="#Expr-665"><span class="linenos"> 665</span></a>                <span class="k">if</span> <span class="n">b</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">b</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">S</span><span class="o">.</span><span class="n">NaN</span> <span class="ow">and</span> <span class="n">b</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
</span><span id="Expr-666"><a href="#Expr-666"><span class="linenos"> 666</span></a>                    <span class="k">return</span> <span class="kc">False</span>
</span><span id="Expr-667"><a href="#Expr-667"><span class="linenos"> 667</span></a>                <span class="c1"># try random complex</span>
</span><span id="Expr-668"><a href="#Expr-668"><span class="linenos"> 668</span></a>                <span class="n">b</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">_random</span><span class="p">()</span>
</span><span id="Expr-669"><a href="#Expr-669"><span class="linenos"> 669</span></a>                <span class="k">if</span> <span class="n">b</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">b</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">S</span><span class="o">.</span><span class="n">NaN</span><span class="p">:</span>
</span><span id="Expr-670"><a href="#Expr-670"><span class="linenos"> 670</span></a>                    <span class="k">if</span> <span class="n">b</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
</span><span id="Expr-671"><a href="#Expr-671"><span class="linenos"> 671</span></a>                        <span class="k">return</span> <span class="kc">False</span>
</span><span id="Expr-672"><a href="#Expr-672"><span class="linenos"> 672</span></a>                    <span class="n">failing_number</span> <span class="o">=</span> <span class="n">a</span> <span class="k">if</span> <span class="n">a</span><span class="o">.</span><span class="n">is_number</span> <span class="k">else</span> <span class="n">b</span>
</span><span id="Expr-673"><a href="#Expr-673"><span class="linenos"> 673</span></a>
</span><span id="Expr-674"><a href="#Expr-674"><span class="linenos"> 674</span></a>        <span class="c1"># now we will test each wrt symbol (or all free symbols) to see if the</span>
</span><span id="Expr-675"><a href="#Expr-675"><span class="linenos"> 675</span></a>        <span class="c1"># expression depends on them or not using differentiation. This is</span>
</span><span id="Expr-676"><a href="#Expr-676"><span class="linenos"> 676</span></a>        <span class="c1"># not sufficient for all expressions, however, so we don&#39;t return</span>
</span><span id="Expr-677"><a href="#Expr-677"><span class="linenos"> 677</span></a>        <span class="c1"># False if we get a derivative other than 0 with free symbols.</span>
</span><span id="Expr-678"><a href="#Expr-678"><span class="linenos"> 678</span></a>        <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">wrt_number</span><span class="p">:</span>
</span><span id="Expr-679"><a href="#Expr-679"><span class="linenos"> 679</span></a>            <span class="n">deriv</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
</span><span id="Expr-680"><a href="#Expr-680"><span class="linenos"> 680</span></a>            <span class="k">if</span> <span class="n">simplify</span><span class="p">:</span>
</span><span id="Expr-681"><a href="#Expr-681"><span class="linenos"> 681</span></a>                <span class="n">deriv</span> <span class="o">=</span> <span class="n">deriv</span><span class="o">.</span><span class="n">simplify</span><span class="p">()</span>
</span><span id="Expr-682"><a href="#Expr-682"><span class="linenos"> 682</span></a>            <span class="k">if</span> <span class="n">deriv</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Expr-683"><a href="#Expr-683"><span class="linenos"> 683</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">pure_complex</span><span class="p">(</span><span class="n">deriv</span><span class="p">,</span> <span class="n">or_real</span><span class="o">=</span><span class="kc">True</span><span class="p">)):</span>
</span><span id="Expr-684"><a href="#Expr-684"><span class="linenos"> 684</span></a>                    <span class="k">if</span> <span class="n">flags</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;failing_number&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
</span><span id="Expr-685"><a href="#Expr-685"><span class="linenos"> 685</span></a>                        <span class="k">return</span> <span class="n">failing_number</span>
</span><span id="Expr-686"><a href="#Expr-686"><span class="linenos"> 686</span></a>                <span class="k">return</span> <span class="kc">False</span>
</span><span id="Expr-687"><a href="#Expr-687"><span class="linenos"> 687</span></a>        <span class="n">cd</span> <span class="o">=</span> <span class="n">check_denominator_zeros</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="Expr-688"><a href="#Expr-688"><span class="linenos"> 688</span></a>        <span class="k">if</span> <span class="n">cd</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="Expr-689"><a href="#Expr-689"><span class="linenos"> 689</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="Expr-690"><a href="#Expr-690"><span class="linenos"> 690</span></a>        <span class="k">elif</span> <span class="n">cd</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Expr-691"><a href="#Expr-691"><span class="linenos"> 691</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="Expr-692"><a href="#Expr-692"><span class="linenos"> 692</span></a>        <span class="k">return</span> <span class="kc">True</span>
</span><span id="Expr-693"><a href="#Expr-693"><span class="linenos"> 693</span></a>
</span><span id="Expr-694"><a href="#Expr-694"><span class="linenos"> 694</span></a>    <span class="k">def</span> <span class="nf">equals</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">failing_expression</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="Expr-695"><a href="#Expr-695"><span class="linenos"> 695</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return True if self == other, False if it doesn&#39;t, or None. If</span>
</span><span id="Expr-696"><a href="#Expr-696"><span class="linenos"> 696</span></a><span class="sd">        failing_expression is True then the expression which did not simplify</span>
</span><span id="Expr-697"><a href="#Expr-697"><span class="linenos"> 697</span></a><span class="sd">        to a 0 will be returned instead of None.</span>
</span><span id="Expr-698"><a href="#Expr-698"><span class="linenos"> 698</span></a>
</span><span id="Expr-699"><a href="#Expr-699"><span class="linenos"> 699</span></a><span class="sd">        Explanation</span>
</span><span id="Expr-700"><a href="#Expr-700"><span class="linenos"> 700</span></a><span class="sd">        ===========</span>
</span><span id="Expr-701"><a href="#Expr-701"><span class="linenos"> 701</span></a>
</span><span id="Expr-702"><a href="#Expr-702"><span class="linenos"> 702</span></a><span class="sd">        If ``self`` is a Number (or complex number) that is not zero, then</span>
</span><span id="Expr-703"><a href="#Expr-703"><span class="linenos"> 703</span></a><span class="sd">        the result is False.</span>
</span><span id="Expr-704"><a href="#Expr-704"><span class="linenos"> 704</span></a>
</span><span id="Expr-705"><a href="#Expr-705"><span class="linenos"> 705</span></a><span class="sd">        If ``self`` is a number and has not evaluated to zero, evalf will be</span>
</span><span id="Expr-706"><a href="#Expr-706"><span class="linenos"> 706</span></a><span class="sd">        used to test whether the expression evaluates to zero. If it does so</span>
</span><span id="Expr-707"><a href="#Expr-707"><span class="linenos"> 707</span></a><span class="sd">        and the result has significance (i.e. the precision is either -1, for</span>
</span><span id="Expr-708"><a href="#Expr-708"><span class="linenos"> 708</span></a><span class="sd">        a Rational result, or is greater than 1) then the evalf value will be</span>
</span><span id="Expr-709"><a href="#Expr-709"><span class="linenos"> 709</span></a><span class="sd">        used to return True or False.</span>
</span><span id="Expr-710"><a href="#Expr-710"><span class="linenos"> 710</span></a>
</span><span id="Expr-711"><a href="#Expr-711"><span class="linenos"> 711</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Expr-712"><a href="#Expr-712"><span class="linenos"> 712</span></a>        <span class="kn">from</span> <span class="nn">sympy.simplify.simplify</span> <span class="kn">import</span> <span class="n">nsimplify</span><span class="p">,</span> <span class="n">simplify</span>
</span><span id="Expr-713"><a href="#Expr-713"><span class="linenos"> 713</span></a>        <span class="kn">from</span> <span class="nn">sympy.solvers.solvers</span> <span class="kn">import</span> <span class="n">solve</span>
</span><span id="Expr-714"><a href="#Expr-714"><span class="linenos"> 714</span></a>        <span class="kn">from</span> <span class="nn">sympy.polys.polyerrors</span> <span class="kn">import</span> <span class="n">NotAlgebraic</span>
</span><span id="Expr-715"><a href="#Expr-715"><span class="linenos"> 715</span></a>        <span class="kn">from</span> <span class="nn">sympy.polys.numberfields</span> <span class="kn">import</span> <span class="n">minimal_polynomial</span>
</span><span id="Expr-716"><a href="#Expr-716"><span class="linenos"> 716</span></a>
</span><span id="Expr-717"><a href="#Expr-717"><span class="linenos"> 717</span></a>        <span class="n">other</span> <span class="o">=</span> <span class="n">sympify</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
</span><span id="Expr-718"><a href="#Expr-718"><span class="linenos"> 718</span></a>        <span class="k">if</span> <span class="bp">self</span> <span class="o">==</span> <span class="n">other</span><span class="p">:</span>
</span><span id="Expr-719"><a href="#Expr-719"><span class="linenos"> 719</span></a>            <span class="k">return</span> <span class="kc">True</span>
</span><span id="Expr-720"><a href="#Expr-720"><span class="linenos"> 720</span></a>
</span><span id="Expr-721"><a href="#Expr-721"><span class="linenos"> 721</span></a>        <span class="c1"># they aren&#39;t the same so see if we can make the difference 0;</span>
</span><span id="Expr-722"><a href="#Expr-722"><span class="linenos"> 722</span></a>        <span class="c1"># don&#39;t worry about doing simplification steps one at a time</span>
</span><span id="Expr-723"><a href="#Expr-723"><span class="linenos"> 723</span></a>        <span class="c1"># because if the expression ever goes to 0 then the subsequent</span>
</span><span id="Expr-724"><a href="#Expr-724"><span class="linenos"> 724</span></a>        <span class="c1"># simplification steps that are done will be very fast.</span>
</span><span id="Expr-725"><a href="#Expr-725"><span class="linenos"> 725</span></a>        <span class="n">diff</span> <span class="o">=</span> <span class="n">factor_terms</span><span class="p">(</span><span class="n">simplify</span><span class="p">(</span><span class="bp">self</span> <span class="o">-</span> <span class="n">other</span><span class="p">),</span> <span class="n">radical</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="Expr-726"><a href="#Expr-726"><span class="linenos"> 726</span></a>
</span><span id="Expr-727"><a href="#Expr-727"><span class="linenos"> 727</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">diff</span><span class="p">:</span>
</span><span id="Expr-728"><a href="#Expr-728"><span class="linenos"> 728</span></a>            <span class="k">return</span> <span class="kc">True</span>
</span><span id="Expr-729"><a href="#Expr-729"><span class="linenos"> 729</span></a>
</span><span id="Expr-730"><a href="#Expr-730"><span class="linenos"> 730</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">diff</span><span class="o">.</span><span class="n">has</span><span class="p">(</span><span class="n">Add</span><span class="p">,</span> <span class="n">Mod</span><span class="p">):</span>
</span><span id="Expr-731"><a href="#Expr-731"><span class="linenos"> 731</span></a>            <span class="c1"># if there is no expanding to be done after simplifying</span>
</span><span id="Expr-732"><a href="#Expr-732"><span class="linenos"> 732</span></a>            <span class="c1"># then this can&#39;t be a zero</span>
</span><span id="Expr-733"><a href="#Expr-733"><span class="linenos"> 733</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="Expr-734"><a href="#Expr-734"><span class="linenos"> 734</span></a>
</span><span id="Expr-735"><a href="#Expr-735"><span class="linenos"> 735</span></a>        <span class="n">factors</span> <span class="o">=</span> <span class="n">diff</span><span class="o">.</span><span class="n">as_coeff_mul</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Expr-736"><a href="#Expr-736"><span class="linenos"> 736</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">factors</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># avoid infinity recursion</span>
</span><span id="Expr-737"><a href="#Expr-737"><span class="linenos"> 737</span></a>            <span class="n">fac_zero</span> <span class="o">=</span> <span class="p">[</span><span class="n">fac</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="k">for</span> <span class="n">fac</span> <span class="ow">in</span> <span class="n">factors</span><span class="p">]</span>
</span><span id="Expr-738"><a href="#Expr-738"><span class="linenos"> 738</span></a>            <span class="k">if</span> <span class="kc">None</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">fac_zero</span><span class="p">:</span>  <span class="c1"># every part can be decided</span>
</span><span id="Expr-739"><a href="#Expr-739"><span class="linenos"> 739</span></a>                <span class="k">return</span> <span class="nb">any</span><span class="p">(</span><span class="n">fac_zero</span><span class="p">)</span>
</span><span id="Expr-740"><a href="#Expr-740"><span class="linenos"> 740</span></a>
</span><span id="Expr-741"><a href="#Expr-741"><span class="linenos"> 741</span></a>        <span class="n">constant</span> <span class="o">=</span> <span class="n">diff</span><span class="o">.</span><span class="n">is_constant</span><span class="p">(</span><span class="n">simplify</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">failing_number</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="Expr-742"><a href="#Expr-742"><span class="linenos"> 742</span></a>
</span><span id="Expr-743"><a href="#Expr-743"><span class="linenos"> 743</span></a>        <span class="k">if</span> <span class="n">constant</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
</span><span id="Expr-744"><a href="#Expr-744"><span class="linenos"> 744</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="Expr-745"><a href="#Expr-745"><span class="linenos"> 745</span></a>
</span><span id="Expr-746"><a href="#Expr-746"><span class="linenos"> 746</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">diff</span><span class="o">.</span><span class="n">is_number</span><span class="p">:</span>
</span><span id="Expr-747"><a href="#Expr-747"><span class="linenos"> 747</span></a>            <span class="k">if</span> <span class="n">constant</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Expr-748"><a href="#Expr-748"><span class="linenos"> 748</span></a>                <span class="c1"># e.g. unless the right simplification is done, a symbolic</span>
</span><span id="Expr-749"><a href="#Expr-749"><span class="linenos"> 749</span></a>                <span class="c1"># zero is possible (see expression of issue 6829: without</span>
</span><span id="Expr-750"><a href="#Expr-750"><span class="linenos"> 750</span></a>                <span class="c1"># simplification constant will be None).</span>
</span><span id="Expr-751"><a href="#Expr-751"><span class="linenos"> 751</span></a>                <span class="k">return</span>
</span><span id="Expr-752"><a href="#Expr-752"><span class="linenos"> 752</span></a>
</span><span id="Expr-753"><a href="#Expr-753"><span class="linenos"> 753</span></a>        <span class="k">if</span> <span class="n">constant</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="Expr-754"><a href="#Expr-754"><span class="linenos"> 754</span></a>            <span class="c1"># this gives a number whether there are free symbols or not</span>
</span><span id="Expr-755"><a href="#Expr-755"><span class="linenos"> 755</span></a>            <span class="n">ndiff</span> <span class="o">=</span> <span class="n">diff</span><span class="o">.</span><span class="n">_random</span><span class="p">()</span>
</span><span id="Expr-756"><a href="#Expr-756"><span class="linenos"> 756</span></a>            <span class="c1"># is_comparable will work whether the result is real</span>
</span><span id="Expr-757"><a href="#Expr-757"><span class="linenos"> 757</span></a>            <span class="c1"># or complex; it could be None, however.</span>
</span><span id="Expr-758"><a href="#Expr-758"><span class="linenos"> 758</span></a>            <span class="k">if</span> <span class="n">ndiff</span> <span class="ow">and</span> <span class="n">ndiff</span><span class="o">.</span><span class="n">is_comparable</span><span class="p">:</span>
</span><span id="Expr-759"><a href="#Expr-759"><span class="linenos"> 759</span></a>                <span class="k">return</span> <span class="kc">False</span>
</span><span id="Expr-760"><a href="#Expr-760"><span class="linenos"> 760</span></a>
</span><span id="Expr-761"><a href="#Expr-761"><span class="linenos"> 761</span></a>        <span class="c1"># sometimes we can use a simplified result to give a clue as to</span>
</span><span id="Expr-762"><a href="#Expr-762"><span class="linenos"> 762</span></a>        <span class="c1"># what the expression should be; if the expression is *not* zero</span>
</span><span id="Expr-763"><a href="#Expr-763"><span class="linenos"> 763</span></a>        <span class="c1"># then we should have been able to compute that and so now</span>
</span><span id="Expr-764"><a href="#Expr-764"><span class="linenos"> 764</span></a>        <span class="c1"># we can just consider the cases where the approximation appears</span>
</span><span id="Expr-765"><a href="#Expr-765"><span class="linenos"> 765</span></a>        <span class="c1"># to be zero -- we try to prove it via minimal_polynomial.</span>
</span><span id="Expr-766"><a href="#Expr-766"><span class="linenos"> 766</span></a>        <span class="c1">#</span>
</span><span id="Expr-767"><a href="#Expr-767"><span class="linenos"> 767</span></a>        <span class="c1"># removed</span>
</span><span id="Expr-768"><a href="#Expr-768"><span class="linenos"> 768</span></a>        <span class="c1"># ns = nsimplify(diff)</span>
</span><span id="Expr-769"><a href="#Expr-769"><span class="linenos"> 769</span></a>        <span class="c1"># if diff.is_number and (not ns or ns == diff):</span>
</span><span id="Expr-770"><a href="#Expr-770"><span class="linenos"> 770</span></a>        <span class="c1">#</span>
</span><span id="Expr-771"><a href="#Expr-771"><span class="linenos"> 771</span></a>        <span class="c1"># The thought was that if it nsimplifies to 0 that&#39;s a sure sign</span>
</span><span id="Expr-772"><a href="#Expr-772"><span class="linenos"> 772</span></a>        <span class="c1"># to try the following to prove it; or if it changed but wasn&#39;t</span>
</span><span id="Expr-773"><a href="#Expr-773"><span class="linenos"> 773</span></a>        <span class="c1"># zero that might be a sign that it&#39;s not going to be easy to</span>
</span><span id="Expr-774"><a href="#Expr-774"><span class="linenos"> 774</span></a>        <span class="c1"># prove. But tests seem to be working without that logic.</span>
</span><span id="Expr-775"><a href="#Expr-775"><span class="linenos"> 775</span></a>        <span class="c1">#</span>
</span><span id="Expr-776"><a href="#Expr-776"><span class="linenos"> 776</span></a>        <span class="k">if</span> <span class="n">diff</span><span class="o">.</span><span class="n">is_number</span><span class="p">:</span>
</span><span id="Expr-777"><a href="#Expr-777"><span class="linenos"> 777</span></a>            <span class="c1"># try to prove via self-consistency</span>
</span><span id="Expr-778"><a href="#Expr-778"><span class="linenos"> 778</span></a>            <span class="n">surds</span> <span class="o">=</span> <span class="p">[</span><span class="n">s</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">diff</span><span class="o">.</span><span class="n">atoms</span><span class="p">(</span><span class="n">Pow</span><span class="p">)</span> <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">is_Integer</span><span class="p">]</span>
</span><span id="Expr-779"><a href="#Expr-779"><span class="linenos"> 779</span></a>            <span class="c1"># it seems to work better to try big ones first</span>
</span><span id="Expr-780"><a href="#Expr-780"><span class="linenos"> 780</span></a>            <span class="n">surds</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="o">-</span><span class="n">x</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="Expr-781"><a href="#Expr-781"><span class="linenos"> 781</span></a>            <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">surds</span><span class="p">:</span>
</span><span id="Expr-782"><a href="#Expr-782"><span class="linenos"> 782</span></a>                <span class="k">try</span><span class="p">:</span>
</span><span id="Expr-783"><a href="#Expr-783"><span class="linenos"> 783</span></a>                    <span class="c1"># simplify is False here -- this expression has already</span>
</span><span id="Expr-784"><a href="#Expr-784"><span class="linenos"> 784</span></a>                    <span class="c1"># been identified as being hard to identify as zero;</span>
</span><span id="Expr-785"><a href="#Expr-785"><span class="linenos"> 785</span></a>                    <span class="c1"># we will handle the checking ourselves using nsimplify</span>
</span><span id="Expr-786"><a href="#Expr-786"><span class="linenos"> 786</span></a>                    <span class="c1"># to see if we are in the right ballpark or not and if so</span>
</span><span id="Expr-787"><a href="#Expr-787"><span class="linenos"> 787</span></a>                    <span class="c1"># *then* the simplification will be attempted.</span>
</span><span id="Expr-788"><a href="#Expr-788"><span class="linenos"> 788</span></a>                    <span class="n">sol</span> <span class="o">=</span> <span class="n">solve</span><span class="p">(</span><span class="n">diff</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">simplify</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="Expr-789"><a href="#Expr-789"><span class="linenos"> 789</span></a>                    <span class="k">if</span> <span class="n">sol</span><span class="p">:</span>
</span><span id="Expr-790"><a href="#Expr-790"><span class="linenos"> 790</span></a>                        <span class="k">if</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">sol</span><span class="p">:</span>
</span><span id="Expr-791"><a href="#Expr-791"><span class="linenos"> 791</span></a>                            <span class="c1"># the self-consistent result is present</span>
</span><span id="Expr-792"><a href="#Expr-792"><span class="linenos"> 792</span></a>                            <span class="k">return</span> <span class="kc">True</span>
</span><span id="Expr-793"><a href="#Expr-793"><span class="linenos"> 793</span></a>                        <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="n">si</span><span class="o">.</span><span class="n">is_Integer</span> <span class="k">for</span> <span class="n">si</span> <span class="ow">in</span> <span class="n">sol</span><span class="p">):</span>
</span><span id="Expr-794"><a href="#Expr-794"><span class="linenos"> 794</span></a>                            <span class="c1"># perfect powers are removed at instantiation</span>
</span><span id="Expr-795"><a href="#Expr-795"><span class="linenos"> 795</span></a>                            <span class="c1"># so surd s cannot be an integer</span>
</span><span id="Expr-796"><a href="#Expr-796"><span class="linenos"> 796</span></a>                            <span class="k">return</span> <span class="kc">False</span>
</span><span id="Expr-797"><a href="#Expr-797"><span class="linenos"> 797</span></a>                        <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">is_algebraic</span> <span class="ow">is</span> <span class="kc">False</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">sol</span><span class="p">):</span>
</span><span id="Expr-798"><a href="#Expr-798"><span class="linenos"> 798</span></a>                            <span class="c1"># a surd is algebraic</span>
</span><span id="Expr-799"><a href="#Expr-799"><span class="linenos"> 799</span></a>                            <span class="k">return</span> <span class="kc">False</span>
</span><span id="Expr-800"><a href="#Expr-800"><span class="linenos"> 800</span></a>                        <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">si</span> <span class="ow">in</span> <span class="n">surds</span> <span class="k">for</span> <span class="n">si</span> <span class="ow">in</span> <span class="n">sol</span><span class="p">):</span>
</span><span id="Expr-801"><a href="#Expr-801"><span class="linenos"> 801</span></a>                            <span class="c1"># it wasn&#39;t equal to s but it is in surds</span>
</span><span id="Expr-802"><a href="#Expr-802"><span class="linenos"> 802</span></a>                            <span class="c1"># and different surds are not equal</span>
</span><span id="Expr-803"><a href="#Expr-803"><span class="linenos"> 803</span></a>                            <span class="k">return</span> <span class="kc">False</span>
</span><span id="Expr-804"><a href="#Expr-804"><span class="linenos"> 804</span></a>                        <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">nsimplify</span><span class="p">(</span><span class="n">s</span> <span class="o">-</span> <span class="n">si</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span>
</span><span id="Expr-805"><a href="#Expr-805"><span class="linenos"> 805</span></a>                                <span class="n">simplify</span><span class="p">(</span><span class="n">s</span> <span class="o">-</span> <span class="n">si</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">si</span> <span class="ow">in</span> <span class="n">sol</span><span class="p">):</span>
</span><span id="Expr-806"><a href="#Expr-806"><span class="linenos"> 806</span></a>                            <span class="k">return</span> <span class="kc">True</span>
</span><span id="Expr-807"><a href="#Expr-807"><span class="linenos"> 807</span></a>                        <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">is_real</span><span class="p">:</span>
</span><span id="Expr-808"><a href="#Expr-808"><span class="linenos"> 808</span></a>                            <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">nsimplify</span><span class="p">(</span><span class="n">si</span><span class="p">,</span> <span class="p">[</span><span class="n">s</span><span class="p">])</span> <span class="o">==</span> <span class="n">s</span> <span class="ow">and</span> <span class="n">simplify</span><span class="p">(</span><span class="n">si</span><span class="p">)</span> <span class="o">==</span> <span class="n">s</span>
</span><span id="Expr-809"><a href="#Expr-809"><span class="linenos"> 809</span></a>                                    <span class="k">for</span> <span class="n">si</span> <span class="ow">in</span> <span class="n">sol</span><span class="p">):</span>
</span><span id="Expr-810"><a href="#Expr-810"><span class="linenos"> 810</span></a>                                <span class="k">return</span> <span class="kc">True</span>
</span><span id="Expr-811"><a href="#Expr-811"><span class="linenos"> 811</span></a>                <span class="k">except</span> <span class="ne">NotImplementedError</span><span class="p">:</span>
</span><span id="Expr-812"><a href="#Expr-812"><span class="linenos"> 812</span></a>                    <span class="k">pass</span>
</span><span id="Expr-813"><a href="#Expr-813"><span class="linenos"> 813</span></a>
</span><span id="Expr-814"><a href="#Expr-814"><span class="linenos"> 814</span></a>            <span class="c1"># try to prove with minimal_polynomial but know when</span>
</span><span id="Expr-815"><a href="#Expr-815"><span class="linenos"> 815</span></a>            <span class="c1"># *not* to use this or else it can take a long time. e.g. issue 8354</span>
</span><span id="Expr-816"><a href="#Expr-816"><span class="linenos"> 816</span></a>            <span class="k">if</span> <span class="kc">True</span><span class="p">:</span>  <span class="c1"># change True to condition that assures non-hang</span>
</span><span id="Expr-817"><a href="#Expr-817"><span class="linenos"> 817</span></a>                <span class="k">try</span><span class="p">:</span>
</span><span id="Expr-818"><a href="#Expr-818"><span class="linenos"> 818</span></a>                    <span class="n">mp</span> <span class="o">=</span> <span class="n">minimal_polynomial</span><span class="p">(</span><span class="n">diff</span><span class="p">)</span>
</span><span id="Expr-819"><a href="#Expr-819"><span class="linenos"> 819</span></a>                    <span class="k">if</span> <span class="n">mp</span><span class="o">.</span><span class="n">is_Symbol</span><span class="p">:</span>
</span><span id="Expr-820"><a href="#Expr-820"><span class="linenos"> 820</span></a>                        <span class="k">return</span> <span class="kc">True</span>
</span><span id="Expr-821"><a href="#Expr-821"><span class="linenos"> 821</span></a>                    <span class="k">return</span> <span class="kc">False</span>
</span><span id="Expr-822"><a href="#Expr-822"><span class="linenos"> 822</span></a>                <span class="k">except</span> <span class="p">(</span><span class="n">NotAlgebraic</span><span class="p">,</span> <span class="ne">NotImplementedError</span><span class="p">):</span>
</span><span id="Expr-823"><a href="#Expr-823"><span class="linenos"> 823</span></a>                    <span class="k">pass</span>
</span><span id="Expr-824"><a href="#Expr-824"><span class="linenos"> 824</span></a>
</span><span id="Expr-825"><a href="#Expr-825"><span class="linenos"> 825</span></a>        <span class="c1"># diff has not simplified to zero; constant is either None, True</span>
</span><span id="Expr-826"><a href="#Expr-826"><span class="linenos"> 826</span></a>        <span class="c1"># or the number with significance (is_comparable) that was randomly</span>
</span><span id="Expr-827"><a href="#Expr-827"><span class="linenos"> 827</span></a>        <span class="c1"># calculated twice as the same value.</span>
</span><span id="Expr-828"><a href="#Expr-828"><span class="linenos"> 828</span></a>        <span class="k">if</span> <span class="n">constant</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="n">constant</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Expr-829"><a href="#Expr-829"><span class="linenos"> 829</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="Expr-830"><a href="#Expr-830"><span class="linenos"> 830</span></a>
</span><span id="Expr-831"><a href="#Expr-831"><span class="linenos"> 831</span></a>        <span class="k">if</span> <span class="n">failing_expression</span><span class="p">:</span>
</span><span id="Expr-832"><a href="#Expr-832"><span class="linenos"> 832</span></a>            <span class="k">return</span> <span class="n">diff</span>
</span><span id="Expr-833"><a href="#Expr-833"><span class="linenos"> 833</span></a>        <span class="k">return</span> <span class="kc">None</span>
</span><span id="Expr-834"><a href="#Expr-834"><span class="linenos"> 834</span></a>
</span><span id="Expr-835"><a href="#Expr-835"><span class="linenos"> 835</span></a>    <span class="k">def</span> <span class="nf">_eval_is_positive</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Expr-836"><a href="#Expr-836"><span class="linenos"> 836</span></a>        <span class="n">finite</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_finite</span>
</span><span id="Expr-837"><a href="#Expr-837"><span class="linenos"> 837</span></a>        <span class="k">if</span> <span class="n">finite</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
</span><span id="Expr-838"><a href="#Expr-838"><span class="linenos"> 838</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="Expr-839"><a href="#Expr-839"><span class="linenos"> 839</span></a>        <span class="n">extended_positive</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_extended_positive</span>
</span><span id="Expr-840"><a href="#Expr-840"><span class="linenos"> 840</span></a>        <span class="k">if</span> <span class="n">finite</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="Expr-841"><a href="#Expr-841"><span class="linenos"> 841</span></a>            <span class="k">return</span> <span class="n">extended_positive</span>
</span><span id="Expr-842"><a href="#Expr-842"><span class="linenos"> 842</span></a>        <span class="k">if</span> <span class="n">extended_positive</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
</span><span id="Expr-843"><a href="#Expr-843"><span class="linenos"> 843</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="Expr-844"><a href="#Expr-844"><span class="linenos"> 844</span></a>
</span><span id="Expr-845"><a href="#Expr-845"><span class="linenos"> 845</span></a>    <span class="k">def</span> <span class="nf">_eval_is_negative</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Expr-846"><a href="#Expr-846"><span class="linenos"> 846</span></a>        <span class="n">finite</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_finite</span>
</span><span id="Expr-847"><a href="#Expr-847"><span class="linenos"> 847</span></a>        <span class="k">if</span> <span class="n">finite</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
</span><span id="Expr-848"><a href="#Expr-848"><span class="linenos"> 848</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="Expr-849"><a href="#Expr-849"><span class="linenos"> 849</span></a>        <span class="n">extended_negative</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_extended_negative</span>
</span><span id="Expr-850"><a href="#Expr-850"><span class="linenos"> 850</span></a>        <span class="k">if</span> <span class="n">finite</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="Expr-851"><a href="#Expr-851"><span class="linenos"> 851</span></a>            <span class="k">return</span> <span class="n">extended_negative</span>
</span><span id="Expr-852"><a href="#Expr-852"><span class="linenos"> 852</span></a>        <span class="k">if</span> <span class="n">extended_negative</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
</span><span id="Expr-853"><a href="#Expr-853"><span class="linenos"> 853</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="Expr-854"><a href="#Expr-854"><span class="linenos"> 854</span></a>
</span><span id="Expr-855"><a href="#Expr-855"><span class="linenos"> 855</span></a>    <span class="k">def</span> <span class="nf">_eval_is_extended_positive_negative</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">positive</span><span class="p">):</span>
</span><span id="Expr-856"><a href="#Expr-856"><span class="linenos"> 856</span></a>        <span class="kn">from</span> <span class="nn">sympy.polys.numberfields</span> <span class="kn">import</span> <span class="n">minimal_polynomial</span>
</span><span id="Expr-857"><a href="#Expr-857"><span class="linenos"> 857</span></a>        <span class="kn">from</span> <span class="nn">sympy.polys.polyerrors</span> <span class="kn">import</span> <span class="n">NotAlgebraic</span>
</span><span id="Expr-858"><a href="#Expr-858"><span class="linenos"> 858</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_number</span><span class="p">:</span>
</span><span id="Expr-859"><a href="#Expr-859"><span class="linenos"> 859</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_extended_real</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
</span><span id="Expr-860"><a href="#Expr-860"><span class="linenos"> 860</span></a>                <span class="k">return</span> <span class="kc">False</span>
</span><span id="Expr-861"><a href="#Expr-861"><span class="linenos"> 861</span></a>
</span><span id="Expr-862"><a href="#Expr-862"><span class="linenos"> 862</span></a>            <span class="c1"># check to see that we can get a value</span>
</span><span id="Expr-863"><a href="#Expr-863"><span class="linenos"> 863</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="Expr-864"><a href="#Expr-864"><span class="linenos"> 864</span></a>                <span class="n">n2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_eval_evalf</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</span><span id="Expr-865"><a href="#Expr-865"><span class="linenos"> 865</span></a>            <span class="c1"># XXX: This shouldn&#39;t be caught here</span>
</span><span id="Expr-866"><a href="#Expr-866"><span class="linenos"> 866</span></a>            <span class="c1"># Catches ValueError: hypsum() failed to converge to the requested</span>
</span><span id="Expr-867"><a href="#Expr-867"><span class="linenos"> 867</span></a>            <span class="c1"># 34 bits of accuracy</span>
</span><span id="Expr-868"><a href="#Expr-868"><span class="linenos"> 868</span></a>            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
</span><span id="Expr-869"><a href="#Expr-869"><span class="linenos"> 869</span></a>                <span class="k">return</span> <span class="kc">None</span>
</span><span id="Expr-870"><a href="#Expr-870"><span class="linenos"> 870</span></a>            <span class="k">if</span> <span class="n">n2</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Expr-871"><a href="#Expr-871"><span class="linenos"> 871</span></a>                <span class="k">return</span> <span class="kc">None</span>
</span><span id="Expr-872"><a href="#Expr-872"><span class="linenos"> 872</span></a>            <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">n2</span><span class="p">,</span> <span class="s1">&#39;_prec&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># no significance</span>
</span><span id="Expr-873"><a href="#Expr-873"><span class="linenos"> 873</span></a>                <span class="k">return</span> <span class="kc">None</span>
</span><span id="Expr-874"><a href="#Expr-874"><span class="linenos"> 874</span></a>            <span class="k">if</span> <span class="n">n2</span> <span class="ow">is</span> <span class="n">S</span><span class="o">.</span><span class="n">NaN</span><span class="p">:</span>
</span><span id="Expr-875"><a href="#Expr-875"><span class="linenos"> 875</span></a>                <span class="k">return</span> <span class="kc">None</span>
</span><span id="Expr-876"><a href="#Expr-876"><span class="linenos"> 876</span></a>
</span><span id="Expr-877"><a href="#Expr-877"><span class="linenos"> 877</span></a>            <span class="n">f</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">evalf</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</span><span id="Expr-878"><a href="#Expr-878"><span class="linenos"> 878</span></a>            <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">is_Float</span><span class="p">:</span>
</span><span id="Expr-879"><a href="#Expr-879"><span class="linenos"> 879</span></a>                <span class="n">match</span> <span class="o">=</span> <span class="n">f</span><span class="p">,</span> <span class="n">S</span><span class="o">.</span><span class="n">Zero</span>
</span><span id="Expr-880"><a href="#Expr-880"><span class="linenos"> 880</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Expr-881"><a href="#Expr-881"><span class="linenos"> 881</span></a>                <span class="n">match</span> <span class="o">=</span> <span class="n">pure_complex</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</span><span id="Expr-882"><a href="#Expr-882"><span class="linenos"> 882</span></a>            <span class="k">if</span> <span class="n">match</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Expr-883"><a href="#Expr-883"><span class="linenos"> 883</span></a>                <span class="k">return</span> <span class="kc">False</span>
</span><span id="Expr-884"><a href="#Expr-884"><span class="linenos"> 884</span></a>            <span class="n">r</span><span class="p">,</span> <span class="n">i</span> <span class="o">=</span> <span class="n">match</span>
</span><span id="Expr-885"><a href="#Expr-885"><span class="linenos"> 885</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">is_Number</span> <span class="ow">and</span> <span class="n">r</span><span class="o">.</span><span class="n">is_Number</span><span class="p">):</span>
</span><span id="Expr-886"><a href="#Expr-886"><span class="linenos"> 886</span></a>                <span class="k">return</span> <span class="kc">False</span>
</span><span id="Expr-887"><a href="#Expr-887"><span class="linenos"> 887</span></a>            <span class="k">if</span> <span class="n">r</span><span class="o">.</span><span class="n">_prec</span> <span class="o">!=</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">i</span><span class="o">.</span><span class="n">_prec</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Expr-888"><a href="#Expr-888"><span class="linenos"> 888</span></a>                <span class="k">return</span> <span class="nb">bool</span><span class="p">(</span><span class="ow">not</span> <span class="n">i</span> <span class="ow">and</span> <span class="p">((</span><span class="n">r</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">if</span> <span class="n">positive</span> <span class="k">else</span> <span class="p">(</span><span class="n">r</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)))</span>
</span><span id="Expr-889"><a href="#Expr-889"><span class="linenos"> 889</span></a>            <span class="k">elif</span> <span class="n">r</span><span class="o">.</span><span class="n">_prec</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="n">i</span> <span class="ow">or</span> <span class="n">i</span><span class="o">.</span><span class="n">_prec</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="ow">and</span> \
</span><span id="Expr-890"><a href="#Expr-890"><span class="linenos"> 890</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">is_algebraic</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">has</span><span class="p">(</span><span class="n">Function</span><span class="p">):</span>
</span><span id="Expr-891"><a href="#Expr-891"><span class="linenos"> 891</span></a>                <span class="k">try</span><span class="p">:</span>
</span><span id="Expr-892"><a href="#Expr-892"><span class="linenos"> 892</span></a>                    <span class="k">if</span> <span class="n">minimal_polynomial</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">is_Symbol</span><span class="p">:</span>
</span><span id="Expr-893"><a href="#Expr-893"><span class="linenos"> 893</span></a>                        <span class="k">return</span> <span class="kc">False</span>
</span><span id="Expr-894"><a href="#Expr-894"><span class="linenos"> 894</span></a>                <span class="k">except</span> <span class="p">(</span><span class="n">NotAlgebraic</span><span class="p">,</span> <span class="ne">NotImplementedError</span><span class="p">):</span>
</span><span id="Expr-895"><a href="#Expr-895"><span class="linenos"> 895</span></a>                    <span class="k">pass</span>
</span><span id="Expr-896"><a href="#Expr-896"><span class="linenos"> 896</span></a>
</span><span id="Expr-897"><a href="#Expr-897"><span class="linenos"> 897</span></a>    <span class="k">def</span> <span class="nf">_eval_is_extended_positive</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Expr-898"><a href="#Expr-898"><span class="linenos"> 898</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_eval_is_extended_positive_negative</span><span class="p">(</span><span class="n">positive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="Expr-899"><a href="#Expr-899"><span class="linenos"> 899</span></a>
</span><span id="Expr-900"><a href="#Expr-900"><span class="linenos"> 900</span></a>    <span class="k">def</span> <span class="nf">_eval_is_extended_negative</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Expr-901"><a href="#Expr-901"><span class="linenos"> 901</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_eval_is_extended_positive_negative</span><span class="p">(</span><span class="n">positive</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="Expr-902"><a href="#Expr-902"><span class="linenos"> 902</span></a>
</span><span id="Expr-903"><a href="#Expr-903"><span class="linenos"> 903</span></a>    <span class="k">def</span> <span class="nf">_eval_interval</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
</span><span id="Expr-904"><a href="#Expr-904"><span class="linenos"> 904</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Expr-905"><a href="#Expr-905"><span class="linenos"> 905</span></a><span class="sd">        Returns evaluation over an interval.  For most functions this is:</span>
</span><span id="Expr-906"><a href="#Expr-906"><span class="linenos"> 906</span></a>
</span><span id="Expr-907"><a href="#Expr-907"><span class="linenos"> 907</span></a><span class="sd">        self.subs(x, b) - self.subs(x, a),</span>
</span><span id="Expr-908"><a href="#Expr-908"><span class="linenos"> 908</span></a>
</span><span id="Expr-909"><a href="#Expr-909"><span class="linenos"> 909</span></a><span class="sd">        possibly using limit() if NaN is returned from subs, or if</span>
</span><span id="Expr-910"><a href="#Expr-910"><span class="linenos"> 910</span></a><span class="sd">        singularities are found between a and b.</span>
</span><span id="Expr-911"><a href="#Expr-911"><span class="linenos"> 911</span></a>
</span><span id="Expr-912"><a href="#Expr-912"><span class="linenos"> 912</span></a><span class="sd">        If b or a is None, it only evaluates -self.subs(x, a) or self.subs(b, x),</span>
</span><span id="Expr-913"><a href="#Expr-913"><span class="linenos"> 913</span></a><span class="sd">        respectively.</span>
</span><span id="Expr-914"><a href="#Expr-914"><span class="linenos"> 914</span></a>
</span><span id="Expr-915"><a href="#Expr-915"><span class="linenos"> 915</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Expr-916"><a href="#Expr-916"><span class="linenos"> 916</span></a>        <span class="kn">from</span> <span class="nn">sympy.calculus.accumulationbounds</span> <span class="kn">import</span> <span class="n">AccumBounds</span>
</span><span id="Expr-917"><a href="#Expr-917"><span class="linenos"> 917</span></a>        <span class="kn">from</span> <span class="nn">sympy.functions.elementary.exponential</span> <span class="kn">import</span> <span class="n">log</span>
</span><span id="Expr-918"><a href="#Expr-918"><span class="linenos"> 918</span></a>        <span class="kn">from</span> <span class="nn">sympy.series.limits</span> <span class="kn">import</span> <span class="n">limit</span><span class="p">,</span> <span class="n">Limit</span>
</span><span id="Expr-919"><a href="#Expr-919"><span class="linenos"> 919</span></a>        <span class="kn">from</span> <span class="nn">sympy.sets.sets</span> <span class="kn">import</span> <span class="n">Interval</span>
</span><span id="Expr-920"><a href="#Expr-920"><span class="linenos"> 920</span></a>        <span class="kn">from</span> <span class="nn">sympy.solvers.solveset</span> <span class="kn">import</span> <span class="n">solveset</span>
</span><span id="Expr-921"><a href="#Expr-921"><span class="linenos"> 921</span></a>
</span><span id="Expr-922"><a href="#Expr-922"><span class="linenos"> 922</span></a>        <span class="k">if</span> <span class="p">(</span><span class="n">a</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">b</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="Expr-923"><a href="#Expr-923"><span class="linenos"> 923</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Both interval ends cannot be None.&#39;</span><span class="p">)</span>
</span><span id="Expr-924"><a href="#Expr-924"><span class="linenos"> 924</span></a>
</span><span id="Expr-925"><a href="#Expr-925"><span class="linenos"> 925</span></a>        <span class="k">def</span> <span class="nf">_eval_endpoint</span><span class="p">(</span><span class="n">left</span><span class="p">):</span>
</span><span id="Expr-926"><a href="#Expr-926"><span class="linenos"> 926</span></a>            <span class="n">c</span> <span class="o">=</span> <span class="n">a</span> <span class="k">if</span> <span class="n">left</span> <span class="k">else</span> <span class="n">b</span>
</span><span id="Expr-927"><a href="#Expr-927"><span class="linenos"> 927</span></a>            <span class="k">if</span> <span class="n">c</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Expr-928"><a href="#Expr-928"><span class="linenos"> 928</span></a>                <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">Zero</span>
</span><span id="Expr-929"><a href="#Expr-929"><span class="linenos"> 929</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Expr-930"><a href="#Expr-930"><span class="linenos"> 930</span></a>                <span class="n">C</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
</span><span id="Expr-931"><a href="#Expr-931"><span class="linenos"> 931</span></a>                <span class="k">if</span> <span class="n">C</span><span class="o">.</span><span class="n">has</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">NaN</span><span class="p">,</span> <span class="n">S</span><span class="o">.</span><span class="n">Infinity</span><span class="p">,</span> <span class="n">S</span><span class="o">.</span><span class="n">NegativeInfinity</span><span class="p">,</span>
</span><span id="Expr-932"><a href="#Expr-932"><span class="linenos"> 932</span></a>                         <span class="n">S</span><span class="o">.</span><span class="n">ComplexInfinity</span><span class="p">,</span> <span class="n">AccumBounds</span><span class="p">):</span>
</span><span id="Expr-933"><a href="#Expr-933"><span class="linenos"> 933</span></a>                    <span class="k">if</span> <span class="p">(</span><span class="n">a</span> <span class="o">&lt;</span> <span class="n">b</span><span class="p">)</span> <span class="o">!=</span> <span class="kc">False</span><span class="p">:</span>
</span><span id="Expr-934"><a href="#Expr-934"><span class="linenos"> 934</span></a>                        <span class="n">C</span> <span class="o">=</span> <span class="n">limit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="s2">&quot;+&quot;</span> <span class="k">if</span> <span class="n">left</span> <span class="k">else</span> <span class="s2">&quot;-&quot;</span><span class="p">)</span>
</span><span id="Expr-935"><a href="#Expr-935"><span class="linenos"> 935</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="Expr-936"><a href="#Expr-936"><span class="linenos"> 936</span></a>                        <span class="n">C</span> <span class="o">=</span> <span class="n">limit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span> <span class="k">if</span> <span class="n">left</span> <span class="k">else</span> <span class="s2">&quot;+&quot;</span><span class="p">)</span>
</span><span id="Expr-937"><a href="#Expr-937"><span class="linenos"> 937</span></a>
</span><span id="Expr-938"><a href="#Expr-938"><span class="linenos"> 938</span></a>                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">Limit</span><span class="p">):</span>
</span><span id="Expr-939"><a href="#Expr-939"><span class="linenos"> 939</span></a>                        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Could not compute limit&quot;</span><span class="p">)</span>
</span><span id="Expr-940"><a href="#Expr-940"><span class="linenos"> 940</span></a>            <span class="k">return</span> <span class="n">C</span>
</span><span id="Expr-941"><a href="#Expr-941"><span class="linenos"> 941</span></a>
</span><span id="Expr-942"><a href="#Expr-942"><span class="linenos"> 942</span></a>        <span class="k">if</span> <span class="n">a</span> <span class="o">==</span> <span class="n">b</span><span class="p">:</span>
</span><span id="Expr-943"><a href="#Expr-943"><span class="linenos"> 943</span></a>            <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">Zero</span>
</span><span id="Expr-944"><a href="#Expr-944"><span class="linenos"> 944</span></a>
</span><span id="Expr-945"><a href="#Expr-945"><span class="linenos"> 945</span></a>        <span class="n">A</span> <span class="o">=</span> <span class="n">_eval_endpoint</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="Expr-946"><a href="#Expr-946"><span class="linenos"> 946</span></a>        <span class="k">if</span> <span class="n">A</span> <span class="ow">is</span> <span class="n">S</span><span class="o">.</span><span class="n">NaN</span><span class="p">:</span>
</span><span id="Expr-947"><a href="#Expr-947"><span class="linenos"> 947</span></a>            <span class="k">return</span> <span class="n">A</span>
</span><span id="Expr-948"><a href="#Expr-948"><span class="linenos"> 948</span></a>
</span><span id="Expr-949"><a href="#Expr-949"><span class="linenos"> 949</span></a>        <span class="n">B</span> <span class="o">=</span> <span class="n">_eval_endpoint</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="Expr-950"><a href="#Expr-950"><span class="linenos"> 950</span></a>
</span><span id="Expr-951"><a href="#Expr-951"><span class="linenos"> 951</span></a>        <span class="k">if</span> <span class="p">(</span><span class="n">a</span> <span class="ow">and</span> <span class="n">b</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Expr-952"><a href="#Expr-952"><span class="linenos"> 952</span></a>            <span class="k">return</span> <span class="n">B</span> <span class="o">-</span> <span class="n">A</span>
</span><span id="Expr-953"><a href="#Expr-953"><span class="linenos"> 953</span></a>
</span><span id="Expr-954"><a href="#Expr-954"><span class="linenos"> 954</span></a>        <span class="n">value</span> <span class="o">=</span> <span class="n">B</span> <span class="o">-</span> <span class="n">A</span>
</span><span id="Expr-955"><a href="#Expr-955"><span class="linenos"> 955</span></a>
</span><span id="Expr-956"><a href="#Expr-956"><span class="linenos"> 956</span></a>        <span class="k">if</span> <span class="n">a</span><span class="o">.</span><span class="n">is_comparable</span> <span class="ow">and</span> <span class="n">b</span><span class="o">.</span><span class="n">is_comparable</span><span class="p">:</span>
</span><span id="Expr-957"><a href="#Expr-957"><span class="linenos"> 957</span></a>            <span class="k">if</span> <span class="n">a</span> <span class="o">&lt;</span> <span class="n">b</span><span class="p">:</span>
</span><span id="Expr-958"><a href="#Expr-958"><span class="linenos"> 958</span></a>                <span class="n">domain</span> <span class="o">=</span> <span class="n">Interval</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
</span><span id="Expr-959"><a href="#Expr-959"><span class="linenos"> 959</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Expr-960"><a href="#Expr-960"><span class="linenos"> 960</span></a>                <span class="n">domain</span> <span class="o">=</span> <span class="n">Interval</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
</span><span id="Expr-961"><a href="#Expr-961"><span class="linenos"> 961</span></a>            <span class="c1"># check the singularities of self within the interval</span>
</span><span id="Expr-962"><a href="#Expr-962"><span class="linenos"> 962</span></a>            <span class="c1"># if singularities is a ConditionSet (not iterable), catch the exception and pass</span>
</span><span id="Expr-963"><a href="#Expr-963"><span class="linenos"> 963</span></a>            <span class="n">singularities</span> <span class="o">=</span> <span class="n">solveset</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cancel</span><span class="p">()</span><span class="o">.</span><span class="n">as_numer_denom</span><span class="p">()[</span><span class="mi">1</span><span class="p">],</span> <span class="n">x</span><span class="p">,</span>
</span><span id="Expr-964"><a href="#Expr-964"><span class="linenos"> 964</span></a>                <span class="n">domain</span><span class="o">=</span><span class="n">domain</span><span class="p">)</span>
</span><span id="Expr-965"><a href="#Expr-965"><span class="linenos"> 965</span></a>            <span class="k">for</span> <span class="n">logterm</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">(</span><span class="n">log</span><span class="p">):</span>
</span><span id="Expr-966"><a href="#Expr-966"><span class="linenos"> 966</span></a>                <span class="n">singularities</span> <span class="o">=</span> <span class="n">singularities</span> <span class="o">|</span> <span class="n">solveset</span><span class="p">(</span><span class="n">logterm</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">,</span>
</span><span id="Expr-967"><a href="#Expr-967"><span class="linenos"> 967</span></a>                    <span class="n">domain</span><span class="o">=</span><span class="n">domain</span><span class="p">)</span>
</span><span id="Expr-968"><a href="#Expr-968"><span class="linenos"> 968</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="Expr-969"><a href="#Expr-969"><span class="linenos"> 969</span></a>                <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">singularities</span><span class="p">:</span>
</span><span id="Expr-970"><a href="#Expr-970"><span class="linenos"> 970</span></a>                    <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="n">S</span><span class="o">.</span><span class="n">NaN</span><span class="p">:</span>
</span><span id="Expr-971"><a href="#Expr-971"><span class="linenos"> 971</span></a>                        <span class="c1"># no need to keep adding, it will stay NaN</span>
</span><span id="Expr-972"><a href="#Expr-972"><span class="linenos"> 972</span></a>                        <span class="k">break</span>
</span><span id="Expr-973"><a href="#Expr-973"><span class="linenos"> 973</span></a>                    <span class="k">if</span> <span class="ow">not</span> <span class="n">s</span><span class="o">.</span><span class="n">is_comparable</span><span class="p">:</span>
</span><span id="Expr-974"><a href="#Expr-974"><span class="linenos"> 974</span></a>                        <span class="k">continue</span>
</span><span id="Expr-975"><a href="#Expr-975"><span class="linenos"> 975</span></a>                    <span class="k">if</span> <span class="p">(</span><span class="n">a</span> <span class="o">&lt;</span> <span class="n">s</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="n">s</span> <span class="o">&lt;</span> <span class="n">b</span><span class="p">)</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="Expr-976"><a href="#Expr-976"><span class="linenos"> 976</span></a>                        <span class="n">value</span> <span class="o">+=</span> <span class="o">-</span><span class="n">limit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="s2">&quot;+&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">limit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">)</span>
</span><span id="Expr-977"><a href="#Expr-977"><span class="linenos"> 977</span></a>                    <span class="k">elif</span> <span class="p">(</span><span class="n">b</span> <span class="o">&lt;</span> <span class="n">s</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="n">s</span> <span class="o">&lt;</span> <span class="n">a</span><span class="p">)</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="Expr-978"><a href="#Expr-978"><span class="linenos"> 978</span></a>                        <span class="n">value</span> <span class="o">+=</span> <span class="n">limit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="s2">&quot;+&quot;</span><span class="p">)</span> <span class="o">-</span> <span class="n">limit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">)</span>
</span><span id="Expr-979"><a href="#Expr-979"><span class="linenos"> 979</span></a>            <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
</span><span id="Expr-980"><a href="#Expr-980"><span class="linenos"> 980</span></a>                <span class="k">pass</span>
</span><span id="Expr-981"><a href="#Expr-981"><span class="linenos"> 981</span></a>
</span><span id="Expr-982"><a href="#Expr-982"><span class="linenos"> 982</span></a>        <span class="k">return</span> <span class="n">value</span>
</span><span id="Expr-983"><a href="#Expr-983"><span class="linenos"> 983</span></a>
</span><span id="Expr-984"><a href="#Expr-984"><span class="linenos"> 984</span></a>    <span class="k">def</span> <span class="nf">_eval_power</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="Expr-985"><a href="#Expr-985"><span class="linenos"> 985</span></a>        <span class="c1"># subclass to compute self**other for cases when</span>
</span><span id="Expr-986"><a href="#Expr-986"><span class="linenos"> 986</span></a>        <span class="c1"># other is not NaN, 0, or 1</span>
</span><span id="Expr-987"><a href="#Expr-987"><span class="linenos"> 987</span></a>        <span class="k">return</span> <span class="kc">None</span>
</span><span id="Expr-988"><a href="#Expr-988"><span class="linenos"> 988</span></a>
</span><span id="Expr-989"><a href="#Expr-989"><span class="linenos"> 989</span></a>    <span class="k">def</span> <span class="nf">_eval_conjugate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Expr-990"><a href="#Expr-990"><span class="linenos"> 990</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_extended_real</span><span class="p">:</span>
</span><span id="Expr-991"><a href="#Expr-991"><span class="linenos"> 991</span></a>            <span class="k">return</span> <span class="bp">self</span>
</span><span id="Expr-992"><a href="#Expr-992"><span class="linenos"> 992</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_imaginary</span><span class="p">:</span>
</span><span id="Expr-993"><a href="#Expr-993"><span class="linenos"> 993</span></a>            <span class="k">return</span> <span class="o">-</span><span class="bp">self</span>
</span><span id="Expr-994"><a href="#Expr-994"><span class="linenos"> 994</span></a>
</span><span id="Expr-995"><a href="#Expr-995"><span class="linenos"> 995</span></a>    <span class="k">def</span> <span class="nf">conjugate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Expr-996"><a href="#Expr-996"><span class="linenos"> 996</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the complex conjugate of &#39;self&#39;.&quot;&quot;&quot;</span>
</span><span id="Expr-997"><a href="#Expr-997"><span class="linenos"> 997</span></a>        <span class="kn">from</span> <span class="nn">sympy.functions.elementary.complexes</span> <span class="kn">import</span> <span class="n">conjugate</span> <span class="k">as</span> <span class="n">c</span>
</span><span id="Expr-998"><a href="#Expr-998"><span class="linenos"> 998</span></a>        <span class="k">return</span> <span class="n">c</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="Expr-999"><a href="#Expr-999"><span class="linenos"> 999</span></a>
</span><span id="Expr-1000"><a href="#Expr-1000"><span class="linenos">1000</span></a>    <span class="k">def</span> <span class="nf">dir</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">cdir</span><span class="p">):</span>
</span><span id="Expr-1001"><a href="#Expr-1001"><span class="linenos">1001</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_zero</span><span class="p">:</span>
</span><span id="Expr-1002"><a href="#Expr-1002"><span class="linenos">1002</span></a>            <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">Zero</span>
</span><span id="Expr-1003"><a href="#Expr-1003"><span class="linenos">1003</span></a>        <span class="kn">from</span> <span class="nn">sympy.functions.elementary.exponential</span> <span class="kn">import</span> <span class="n">log</span>
</span><span id="Expr-1004"><a href="#Expr-1004"><span class="linenos">1004</span></a>        <span class="n">minexp</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">Zero</span>
</span><span id="Expr-1005"><a href="#Expr-1005"><span class="linenos">1005</span></a>        <span class="n">arg</span> <span class="o">=</span> <span class="bp">self</span>
</span><span id="Expr-1006"><a href="#Expr-1006"><span class="linenos">1006</span></a>        <span class="k">while</span> <span class="n">arg</span><span class="p">:</span>
</span><span id="Expr-1007"><a href="#Expr-1007"><span class="linenos">1007</span></a>            <span class="n">minexp</span> <span class="o">+=</span> <span class="n">S</span><span class="o">.</span><span class="n">One</span>
</span><span id="Expr-1008"><a href="#Expr-1008"><span class="linenos">1008</span></a>            <span class="n">arg</span> <span class="o">=</span> <span class="n">arg</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span><span id="Expr-1009"><a href="#Expr-1009"><span class="linenos">1009</span></a>            <span class="n">coeff</span> <span class="o">=</span> <span class="n">arg</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="Expr-1010"><a href="#Expr-1010"><span class="linenos">1010</span></a>            <span class="k">if</span> <span class="n">coeff</span> <span class="ow">is</span> <span class="n">S</span><span class="o">.</span><span class="n">NaN</span><span class="p">:</span>
</span><span id="Expr-1011"><a href="#Expr-1011"><span class="linenos">1011</span></a>                <span class="n">coeff</span> <span class="o">=</span> <span class="n">arg</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="Expr-1012"><a href="#Expr-1012"><span class="linenos">1012</span></a>            <span class="k">if</span> <span class="n">coeff</span> <span class="ow">is</span> <span class="n">S</span><span class="o">.</span><span class="n">ComplexInfinity</span><span class="p">:</span>
</span><span id="Expr-1013"><a href="#Expr-1013"><span class="linenos">1013</span></a>                <span class="k">try</span><span class="p">:</span>
</span><span id="Expr-1014"><a href="#Expr-1014"><span class="linenos">1014</span></a>                    <span class="n">coeff</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">arg</span><span class="o">.</span><span class="n">leadterm</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span><span id="Expr-1015"><a href="#Expr-1015"><span class="linenos">1015</span></a>                    <span class="k">if</span> <span class="n">coeff</span><span class="o">.</span><span class="n">has</span><span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)):</span>
</span><span id="Expr-1016"><a href="#Expr-1016"><span class="linenos">1016</span></a>                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">()</span>
</span><span id="Expr-1017"><a href="#Expr-1017"><span class="linenos">1017</span></a>                <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
</span><span id="Expr-1018"><a href="#Expr-1018"><span class="linenos">1018</span></a>                    <span class="n">coeff</span> <span class="o">=</span> <span class="n">arg</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="Expr-1019"><a href="#Expr-1019"><span class="linenos">1019</span></a>            <span class="k">if</span> <span class="n">coeff</span> <span class="o">!=</span> <span class="n">S</span><span class="o">.</span><span class="n">Zero</span><span class="p">:</span>
</span><span id="Expr-1020"><a href="#Expr-1020"><span class="linenos">1020</span></a>                <span class="k">break</span>
</span><span id="Expr-1021"><a href="#Expr-1021"><span class="linenos">1021</span></a>        <span class="k">return</span> <span class="n">coeff</span><span class="o">*</span><span class="n">cdir</span><span class="o">**</span><span class="n">minexp</span>
</span><span id="Expr-1022"><a href="#Expr-1022"><span class="linenos">1022</span></a>
</span><span id="Expr-1023"><a href="#Expr-1023"><span class="linenos">1023</span></a>    <span class="k">def</span> <span class="nf">_eval_transpose</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Expr-1024"><a href="#Expr-1024"><span class="linenos">1024</span></a>        <span class="kn">from</span> <span class="nn">sympy.functions.elementary.complexes</span> <span class="kn">import</span> <span class="n">conjugate</span>
</span><span id="Expr-1025"><a href="#Expr-1025"><span class="linenos">1025</span></a>        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">is_complex</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_infinite</span><span class="p">):</span>
</span><span id="Expr-1026"><a href="#Expr-1026"><span class="linenos">1026</span></a>            <span class="k">return</span> <span class="bp">self</span>
</span><span id="Expr-1027"><a href="#Expr-1027"><span class="linenos">1027</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_hermitian</span><span class="p">:</span>
</span><span id="Expr-1028"><a href="#Expr-1028"><span class="linenos">1028</span></a>            <span class="k">return</span> <span class="n">conjugate</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="Expr-1029"><a href="#Expr-1029"><span class="linenos">1029</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_antihermitian</span><span class="p">:</span>
</span><span id="Expr-1030"><a href="#Expr-1030"><span class="linenos">1030</span></a>            <span class="k">return</span> <span class="o">-</span><span class="n">conjugate</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="Expr-1031"><a href="#Expr-1031"><span class="linenos">1031</span></a>
</span><span id="Expr-1032"><a href="#Expr-1032"><span class="linenos">1032</span></a>    <span class="k">def</span> <span class="nf">transpose</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Expr-1033"><a href="#Expr-1033"><span class="linenos">1033</span></a>        <span class="kn">from</span> <span class="nn">sympy.functions.elementary.complexes</span> <span class="kn">import</span> <span class="n">transpose</span>
</span><span id="Expr-1034"><a href="#Expr-1034"><span class="linenos">1034</span></a>        <span class="k">return</span> <span class="n">transpose</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="Expr-1035"><a href="#Expr-1035"><span class="linenos">1035</span></a>
</span><span id="Expr-1036"><a href="#Expr-1036"><span class="linenos">1036</span></a>    <span class="k">def</span> <span class="nf">_eval_adjoint</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Expr-1037"><a href="#Expr-1037"><span class="linenos">1037</span></a>        <span class="kn">from</span> <span class="nn">sympy.functions.elementary.complexes</span> <span class="kn">import</span> <span class="n">conjugate</span><span class="p">,</span> <span class="n">transpose</span>
</span><span id="Expr-1038"><a href="#Expr-1038"><span class="linenos">1038</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_hermitian</span><span class="p">:</span>
</span><span id="Expr-1039"><a href="#Expr-1039"><span class="linenos">1039</span></a>            <span class="k">return</span> <span class="bp">self</span>
</span><span id="Expr-1040"><a href="#Expr-1040"><span class="linenos">1040</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_antihermitian</span><span class="p">:</span>
</span><span id="Expr-1041"><a href="#Expr-1041"><span class="linenos">1041</span></a>            <span class="k">return</span> <span class="o">-</span><span class="bp">self</span>
</span><span id="Expr-1042"><a href="#Expr-1042"><span class="linenos">1042</span></a>        <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_eval_conjugate</span><span class="p">()</span>
</span><span id="Expr-1043"><a href="#Expr-1043"><span class="linenos">1043</span></a>        <span class="k">if</span> <span class="n">obj</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Expr-1044"><a href="#Expr-1044"><span class="linenos">1044</span></a>            <span class="k">return</span> <span class="n">transpose</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
</span><span id="Expr-1045"><a href="#Expr-1045"><span class="linenos">1045</span></a>        <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_eval_transpose</span><span class="p">()</span>
</span><span id="Expr-1046"><a href="#Expr-1046"><span class="linenos">1046</span></a>        <span class="k">if</span> <span class="n">obj</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Expr-1047"><a href="#Expr-1047"><span class="linenos">1047</span></a>            <span class="k">return</span> <span class="n">conjugate</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
</span><span id="Expr-1048"><a href="#Expr-1048"><span class="linenos">1048</span></a>
</span><span id="Expr-1049"><a href="#Expr-1049"><span class="linenos">1049</span></a>    <span class="k">def</span> <span class="nf">adjoint</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Expr-1050"><a href="#Expr-1050"><span class="linenos">1050</span></a>        <span class="kn">from</span> <span class="nn">sympy.functions.elementary.complexes</span> <span class="kn">import</span> <span class="n">adjoint</span>
</span><span id="Expr-1051"><a href="#Expr-1051"><span class="linenos">1051</span></a>        <span class="k">return</span> <span class="n">adjoint</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="Expr-1052"><a href="#Expr-1052"><span class="linenos">1052</span></a>
</span><span id="Expr-1053"><a href="#Expr-1053"><span class="linenos">1053</span></a>    <span class="nd">@classmethod</span>
</span><span id="Expr-1054"><a href="#Expr-1054"><span class="linenos">1054</span></a>    <span class="k">def</span> <span class="nf">_parse_order</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">order</span><span class="p">):</span>
</span><span id="Expr-1055"><a href="#Expr-1055"><span class="linenos">1055</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Parse and configure the ordering of terms. &quot;&quot;&quot;</span>
</span><span id="Expr-1056"><a href="#Expr-1056"><span class="linenos">1056</span></a>        <span class="kn">from</span> <span class="nn">sympy.polys.orderings</span> <span class="kn">import</span> <span class="n">monomial_key</span>
</span><span id="Expr-1057"><a href="#Expr-1057"><span class="linenos">1057</span></a>
</span><span id="Expr-1058"><a href="#Expr-1058"><span class="linenos">1058</span></a>        <span class="n">startswith</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">order</span><span class="p">,</span> <span class="s2">&quot;startswith&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="Expr-1059"><a href="#Expr-1059"><span class="linenos">1059</span></a>        <span class="k">if</span> <span class="n">startswith</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Expr-1060"><a href="#Expr-1060"><span class="linenos">1060</span></a>            <span class="n">reverse</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="Expr-1061"><a href="#Expr-1061"><span class="linenos">1061</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Expr-1062"><a href="#Expr-1062"><span class="linenos">1062</span></a>            <span class="n">reverse</span> <span class="o">=</span> <span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;rev-&#39;</span><span class="p">)</span>
</span><span id="Expr-1063"><a href="#Expr-1063"><span class="linenos">1063</span></a>            <span class="k">if</span> <span class="n">reverse</span><span class="p">:</span>
</span><span id="Expr-1064"><a href="#Expr-1064"><span class="linenos">1064</span></a>                <span class="n">order</span> <span class="o">=</span> <span class="n">order</span><span class="p">[</span><span class="mi">4</span><span class="p">:]</span>
</span><span id="Expr-1065"><a href="#Expr-1065"><span class="linenos">1065</span></a>
</span><span id="Expr-1066"><a href="#Expr-1066"><span class="linenos">1066</span></a>        <span class="n">monom_key</span> <span class="o">=</span> <span class="n">monomial_key</span><span class="p">(</span><span class="n">order</span><span class="p">)</span>
</span><span id="Expr-1067"><a href="#Expr-1067"><span class="linenos">1067</span></a>
</span><span id="Expr-1068"><a href="#Expr-1068"><span class="linenos">1068</span></a>        <span class="k">def</span> <span class="nf">neg</span><span class="p">(</span><span class="n">monom</span><span class="p">):</span>
</span><span id="Expr-1069"><a href="#Expr-1069"><span class="linenos">1069</span></a>            <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Expr-1070"><a href="#Expr-1070"><span class="linenos">1070</span></a>
</span><span id="Expr-1071"><a href="#Expr-1071"><span class="linenos">1071</span></a>            <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">monom</span><span class="p">:</span>
</span><span id="Expr-1072"><a href="#Expr-1072"><span class="linenos">1072</span></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
</span><span id="Expr-1073"><a href="#Expr-1073"><span class="linenos">1073</span></a>                    <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">neg</span><span class="p">(</span><span class="n">m</span><span class="p">))</span>
</span><span id="Expr-1074"><a href="#Expr-1074"><span class="linenos">1074</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="Expr-1075"><a href="#Expr-1075"><span class="linenos">1075</span></a>                    <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="o">-</span><span class="n">m</span><span class="p">)</span>
</span><span id="Expr-1076"><a href="#Expr-1076"><span class="linenos">1076</span></a>
</span><span id="Expr-1077"><a href="#Expr-1077"><span class="linenos">1077</span></a>            <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span><span id="Expr-1078"><a href="#Expr-1078"><span class="linenos">1078</span></a>
</span><span id="Expr-1079"><a href="#Expr-1079"><span class="linenos">1079</span></a>        <span class="k">def</span> <span class="nf">key</span><span class="p">(</span><span class="n">term</span><span class="p">):</span>
</span><span id="Expr-1080"><a href="#Expr-1080"><span class="linenos">1080</span></a>            <span class="n">_</span><span class="p">,</span> <span class="p">((</span><span class="n">re</span><span class="p">,</span> <span class="n">im</span><span class="p">),</span> <span class="n">monom</span><span class="p">,</span> <span class="n">ncpart</span><span class="p">)</span> <span class="o">=</span> <span class="n">term</span>
</span><span id="Expr-1081"><a href="#Expr-1081"><span class="linenos">1081</span></a>
</span><span id="Expr-1082"><a href="#Expr-1082"><span class="linenos">1082</span></a>            <span class="n">monom</span> <span class="o">=</span> <span class="n">neg</span><span class="p">(</span><span class="n">monom_key</span><span class="p">(</span><span class="n">monom</span><span class="p">))</span>
</span><span id="Expr-1083"><a href="#Expr-1083"><span class="linenos">1083</span></a>            <span class="n">ncpart</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">([</span><span class="n">e</span><span class="o">.</span><span class="n">sort_key</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="n">order</span><span class="p">)</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">ncpart</span><span class="p">])</span>
</span><span id="Expr-1084"><a href="#Expr-1084"><span class="linenos">1084</span></a>            <span class="n">coeff</span> <span class="o">=</span> <span class="p">((</span><span class="nb">bool</span><span class="p">(</span><span class="n">im</span><span class="p">),</span> <span class="n">im</span><span class="p">),</span> <span class="p">(</span><span class="n">re</span><span class="p">,</span> <span class="n">im</span><span class="p">))</span>
</span><span id="Expr-1085"><a href="#Expr-1085"><span class="linenos">1085</span></a>
</span><span id="Expr-1086"><a href="#Expr-1086"><span class="linenos">1086</span></a>            <span class="k">return</span> <span class="n">monom</span><span class="p">,</span> <span class="n">ncpart</span><span class="p">,</span> <span class="n">coeff</span>
</span><span id="Expr-1087"><a href="#Expr-1087"><span class="linenos">1087</span></a>
</span><span id="Expr-1088"><a href="#Expr-1088"><span class="linenos">1088</span></a>        <span class="k">return</span> <span class="n">key</span><span class="p">,</span> <span class="n">reverse</span>
</span><span id="Expr-1089"><a href="#Expr-1089"><span class="linenos">1089</span></a>
</span><span id="Expr-1090"><a href="#Expr-1090"><span class="linenos">1090</span></a>    <span class="k">def</span> <span class="nf">as_ordered_factors</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="Expr-1091"><a href="#Expr-1091"><span class="linenos">1091</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return list of ordered factors (if Mul) else [self].&quot;&quot;&quot;</span>
</span><span id="Expr-1092"><a href="#Expr-1092"><span class="linenos">1092</span></a>        <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="p">]</span>
</span><span id="Expr-1093"><a href="#Expr-1093"><span class="linenos">1093</span></a>
</span><span id="Expr-1094"><a href="#Expr-1094"><span class="linenos">1094</span></a>    <span class="k">def</span> <span class="nf">as_poly</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">):</span>
</span><span id="Expr-1095"><a href="#Expr-1095"><span class="linenos">1095</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Converts ``self`` to a polynomial or returns ``None``.</span>
</span><span id="Expr-1096"><a href="#Expr-1096"><span class="linenos">1096</span></a>
</span><span id="Expr-1097"><a href="#Expr-1097"><span class="linenos">1097</span></a><span class="sd">        Explanation</span>
</span><span id="Expr-1098"><a href="#Expr-1098"><span class="linenos">1098</span></a><span class="sd">        ===========</span>
</span><span id="Expr-1099"><a href="#Expr-1099"><span class="linenos">1099</span></a>
</span><span id="Expr-1100"><a href="#Expr-1100"><span class="linenos">1100</span></a><span class="sd">        &gt;&gt;&gt; from sympy import sin</span>
</span><span id="Expr-1101"><a href="#Expr-1101"><span class="linenos">1101</span></a><span class="sd">        &gt;&gt;&gt; from sympy.abc import x, y</span>
</span><span id="Expr-1102"><a href="#Expr-1102"><span class="linenos">1102</span></a>
</span><span id="Expr-1103"><a href="#Expr-1103"><span class="linenos">1103</span></a><span class="sd">        &gt;&gt;&gt; print((x**2 + x*y).as_poly())</span>
</span><span id="Expr-1104"><a href="#Expr-1104"><span class="linenos">1104</span></a><span class="sd">        Poly(x**2 + x*y, x, y, domain=&#39;ZZ&#39;)</span>
</span><span id="Expr-1105"><a href="#Expr-1105"><span class="linenos">1105</span></a>
</span><span id="Expr-1106"><a href="#Expr-1106"><span class="linenos">1106</span></a><span class="sd">        &gt;&gt;&gt; print((x**2 + x*y).as_poly(x, y))</span>
</span><span id="Expr-1107"><a href="#Expr-1107"><span class="linenos">1107</span></a><span class="sd">        Poly(x**2 + x*y, x, y, domain=&#39;ZZ&#39;)</span>
</span><span id="Expr-1108"><a href="#Expr-1108"><span class="linenos">1108</span></a>
</span><span id="Expr-1109"><a href="#Expr-1109"><span class="linenos">1109</span></a><span class="sd">        &gt;&gt;&gt; print((x**2 + sin(y)).as_poly(x, y))</span>
</span><span id="Expr-1110"><a href="#Expr-1110"><span class="linenos">1110</span></a><span class="sd">        None</span>
</span><span id="Expr-1111"><a href="#Expr-1111"><span class="linenos">1111</span></a>
</span><span id="Expr-1112"><a href="#Expr-1112"><span class="linenos">1112</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Expr-1113"><a href="#Expr-1113"><span class="linenos">1113</span></a>        <span class="kn">from</span> <span class="nn">sympy.polys.polyerrors</span> <span class="kn">import</span> <span class="n">PolynomialError</span><span class="p">,</span> <span class="n">GeneratorsNeeded</span>
</span><span id="Expr-1114"><a href="#Expr-1114"><span class="linenos">1114</span></a>        <span class="kn">from</span> <span class="nn">sympy.polys.polytools</span> <span class="kn">import</span> <span class="n">Poly</span>
</span><span id="Expr-1115"><a href="#Expr-1115"><span class="linenos">1115</span></a>
</span><span id="Expr-1116"><a href="#Expr-1116"><span class="linenos">1116</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="Expr-1117"><a href="#Expr-1117"><span class="linenos">1117</span></a>            <span class="n">poly</span> <span class="o">=</span> <span class="n">Poly</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">)</span>
</span><span id="Expr-1118"><a href="#Expr-1118"><span class="linenos">1118</span></a>
</span><span id="Expr-1119"><a href="#Expr-1119"><span class="linenos">1119</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">poly</span><span class="o">.</span><span class="n">is_Poly</span><span class="p">:</span>
</span><span id="Expr-1120"><a href="#Expr-1120"><span class="linenos">1120</span></a>                <span class="k">return</span> <span class="kc">None</span>
</span><span id="Expr-1121"><a href="#Expr-1121"><span class="linenos">1121</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Expr-1122"><a href="#Expr-1122"><span class="linenos">1122</span></a>                <span class="k">return</span> <span class="n">poly</span>
</span><span id="Expr-1123"><a href="#Expr-1123"><span class="linenos">1123</span></a>        <span class="k">except</span> <span class="p">(</span><span class="n">PolynomialError</span><span class="p">,</span> <span class="n">GeneratorsNeeded</span><span class="p">):</span>
</span><span id="Expr-1124"><a href="#Expr-1124"><span class="linenos">1124</span></a>            <span class="c1"># PolynomialError is caught for e.g. exp(x).as_poly(x)</span>
</span><span id="Expr-1125"><a href="#Expr-1125"><span class="linenos">1125</span></a>            <span class="c1"># GeneratorsNeeded is caught for e.g. S(2).as_poly()</span>
</span><span id="Expr-1126"><a href="#Expr-1126"><span class="linenos">1126</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="Expr-1127"><a href="#Expr-1127"><span class="linenos">1127</span></a>
</span><span id="Expr-1128"><a href="#Expr-1128"><span class="linenos">1128</span></a>    <span class="k">def</span> <span class="nf">as_ordered_terms</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="Expr-1129"><a href="#Expr-1129"><span class="linenos">1129</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Expr-1130"><a href="#Expr-1130"><span class="linenos">1130</span></a><span class="sd">        Transform an expression to an ordered list of terms.</span>
</span><span id="Expr-1131"><a href="#Expr-1131"><span class="linenos">1131</span></a>
</span><span id="Expr-1132"><a href="#Expr-1132"><span class="linenos">1132</span></a><span class="sd">        Examples</span>
</span><span id="Expr-1133"><a href="#Expr-1133"><span class="linenos">1133</span></a><span class="sd">        ========</span>
</span><span id="Expr-1134"><a href="#Expr-1134"><span class="linenos">1134</span></a>
</span><span id="Expr-1135"><a href="#Expr-1135"><span class="linenos">1135</span></a><span class="sd">        &gt;&gt;&gt; from sympy import sin, cos</span>
</span><span id="Expr-1136"><a href="#Expr-1136"><span class="linenos">1136</span></a><span class="sd">        &gt;&gt;&gt; from sympy.abc import x</span>
</span><span id="Expr-1137"><a href="#Expr-1137"><span class="linenos">1137</span></a>
</span><span id="Expr-1138"><a href="#Expr-1138"><span class="linenos">1138</span></a><span class="sd">        &gt;&gt;&gt; (sin(x)**2*cos(x) + sin(x)**2 + 1).as_ordered_terms()</span>
</span><span id="Expr-1139"><a href="#Expr-1139"><span class="linenos">1139</span></a><span class="sd">        [sin(x)**2*cos(x), sin(x)**2, 1]</span>
</span><span id="Expr-1140"><a href="#Expr-1140"><span class="linenos">1140</span></a>
</span><span id="Expr-1141"><a href="#Expr-1141"><span class="linenos">1141</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Expr-1142"><a href="#Expr-1142"><span class="linenos">1142</span></a>
</span><span id="Expr-1143"><a href="#Expr-1143"><span class="linenos">1143</span></a>        <span class="kn">from</span> <span class="nn">.numbers</span> <span class="kn">import</span> <span class="n">Number</span><span class="p">,</span> <span class="n">NumberSymbol</span>
</span><span id="Expr-1144"><a href="#Expr-1144"><span class="linenos">1144</span></a>
</span><span id="Expr-1145"><a href="#Expr-1145"><span class="linenos">1145</span></a>        <span class="k">if</span> <span class="n">order</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_Add</span><span class="p">:</span>
</span><span id="Expr-1146"><a href="#Expr-1146"><span class="linenos">1146</span></a>            <span class="c1"># Spot the special case of Add(Number, Mul(Number, expr)) with the</span>
</span><span id="Expr-1147"><a href="#Expr-1147"><span class="linenos">1147</span></a>            <span class="c1"># first number positive and the second number negative</span>
</span><span id="Expr-1148"><a href="#Expr-1148"><span class="linenos">1148</span></a>            <span class="n">key</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="n">Number</span><span class="p">,</span> <span class="n">NumberSymbol</span><span class="p">))</span>
</span><span id="Expr-1149"><a href="#Expr-1149"><span class="linenos">1149</span></a>            <span class="n">add_args</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">Add</span><span class="o">.</span><span class="n">make_args</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span> <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">)</span>
</span><span id="Expr-1150"><a href="#Expr-1150"><span class="linenos">1150</span></a>            <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">add_args</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span>
</span><span id="Expr-1151"><a href="#Expr-1151"><span class="linenos">1151</span></a>                <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">add_args</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">(</span><span class="n">Number</span><span class="p">,</span> <span class="n">NumberSymbol</span><span class="p">))</span>
</span><span id="Expr-1152"><a href="#Expr-1152"><span class="linenos">1152</span></a>                <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">add_args</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">Mul</span><span class="p">)):</span>
</span><span id="Expr-1153"><a href="#Expr-1153"><span class="linenos">1153</span></a>                <span class="n">mul_args</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">Mul</span><span class="o">.</span><span class="n">make_args</span><span class="p">(</span><span class="n">add_args</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">)</span>
</span><span id="Expr-1154"><a href="#Expr-1154"><span class="linenos">1154</span></a>                <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">mul_args</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span>
</span><span id="Expr-1155"><a href="#Expr-1155"><span class="linenos">1155</span></a>                    <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mul_args</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Number</span><span class="p">)</span>
</span><span id="Expr-1156"><a href="#Expr-1156"><span class="linenos">1156</span></a>                    <span class="ow">and</span> <span class="n">add_args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">is_positive</span>
</span><span id="Expr-1157"><a href="#Expr-1157"><span class="linenos">1157</span></a>                    <span class="ow">and</span> <span class="n">mul_args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">is_negative</span><span class="p">):</span>
</span><span id="Expr-1158"><a href="#Expr-1158"><span class="linenos">1158</span></a>                    <span class="k">return</span> <span class="n">add_args</span>
</span><span id="Expr-1159"><a href="#Expr-1159"><span class="linenos">1159</span></a>
</span><span id="Expr-1160"><a href="#Expr-1160"><span class="linenos">1160</span></a>        <span class="n">key</span><span class="p">,</span> <span class="n">reverse</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_order</span><span class="p">(</span><span class="n">order</span><span class="p">)</span>
</span><span id="Expr-1161"><a href="#Expr-1161"><span class="linenos">1161</span></a>        <span class="n">terms</span><span class="p">,</span> <span class="n">gens</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">as_terms</span><span class="p">()</span>
</span><span id="Expr-1162"><a href="#Expr-1162"><span class="linenos">1162</span></a>
</span><span id="Expr-1163"><a href="#Expr-1163"><span class="linenos">1163</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">any</span><span class="p">(</span><span class="n">term</span><span class="o">.</span><span class="n">is_Order</span> <span class="k">for</span> <span class="n">term</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">terms</span><span class="p">):</span>
</span><span id="Expr-1164"><a href="#Expr-1164"><span class="linenos">1164</span></a>            <span class="n">ordered</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">terms</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="n">reverse</span><span class="p">)</span>
</span><span id="Expr-1165"><a href="#Expr-1165"><span class="linenos">1165</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Expr-1166"><a href="#Expr-1166"><span class="linenos">1166</span></a>            <span class="n">_terms</span><span class="p">,</span> <span class="n">_order</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
</span><span id="Expr-1167"><a href="#Expr-1167"><span class="linenos">1167</span></a>
</span><span id="Expr-1168"><a href="#Expr-1168"><span class="linenos">1168</span></a>            <span class="k">for</span> <span class="n">term</span><span class="p">,</span> <span class="nb">repr</span> <span class="ow">in</span> <span class="n">terms</span><span class="p">:</span>
</span><span id="Expr-1169"><a href="#Expr-1169"><span class="linenos">1169</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">term</span><span class="o">.</span><span class="n">is_Order</span><span class="p">:</span>
</span><span id="Expr-1170"><a href="#Expr-1170"><span class="linenos">1170</span></a>                    <span class="n">_terms</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">term</span><span class="p">,</span> <span class="nb">repr</span><span class="p">))</span>
</span><span id="Expr-1171"><a href="#Expr-1171"><span class="linenos">1171</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="Expr-1172"><a href="#Expr-1172"><span class="linenos">1172</span></a>                    <span class="n">_order</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">term</span><span class="p">,</span> <span class="nb">repr</span><span class="p">))</span>
</span><span id="Expr-1173"><a href="#Expr-1173"><span class="linenos">1173</span></a>
</span><span id="Expr-1174"><a href="#Expr-1174"><span class="linenos">1174</span></a>            <span class="n">ordered</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">_terms</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> \
</span><span id="Expr-1175"><a href="#Expr-1175"><span class="linenos">1175</span></a>                <span class="o">+</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">_order</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="Expr-1176"><a href="#Expr-1176"><span class="linenos">1176</span></a>
</span><span id="Expr-1177"><a href="#Expr-1177"><span class="linenos">1177</span></a>        <span class="k">if</span> <span class="n">data</span><span class="p">:</span>
</span><span id="Expr-1178"><a href="#Expr-1178"><span class="linenos">1178</span></a>            <span class="k">return</span> <span class="n">ordered</span><span class="p">,</span> <span class="n">gens</span>
</span><span id="Expr-1179"><a href="#Expr-1179"><span class="linenos">1179</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Expr-1180"><a href="#Expr-1180"><span class="linenos">1180</span></a>            <span class="k">return</span> <span class="p">[</span><span class="n">term</span> <span class="k">for</span> <span class="n">term</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">ordered</span><span class="p">]</span>
</span><span id="Expr-1181"><a href="#Expr-1181"><span class="linenos">1181</span></a>
</span><span id="Expr-1182"><a href="#Expr-1182"><span class="linenos">1182</span></a>    <span class="k">def</span> <span class="nf">as_terms</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Expr-1183"><a href="#Expr-1183"><span class="linenos">1183</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Transform an expression to a list of terms. &quot;&quot;&quot;</span>
</span><span id="Expr-1184"><a href="#Expr-1184"><span class="linenos">1184</span></a>        <span class="kn">from</span> <span class="nn">.exprtools</span> <span class="kn">import</span> <span class="n">decompose_power</span>
</span><span id="Expr-1185"><a href="#Expr-1185"><span class="linenos">1185</span></a>
</span><span id="Expr-1186"><a href="#Expr-1186"><span class="linenos">1186</span></a>        <span class="n">gens</span><span class="p">,</span> <span class="n">terms</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(),</span> <span class="p">[]</span>
</span><span id="Expr-1187"><a href="#Expr-1187"><span class="linenos">1187</span></a>
</span><span id="Expr-1188"><a href="#Expr-1188"><span class="linenos">1188</span></a>        <span class="k">for</span> <span class="n">term</span> <span class="ow">in</span> <span class="n">Add</span><span class="o">.</span><span class="n">make_args</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Expr-1189"><a href="#Expr-1189"><span class="linenos">1189</span></a>            <span class="n">coeff</span><span class="p">,</span> <span class="n">_term</span> <span class="o">=</span> <span class="n">term</span><span class="o">.</span><span class="n">as_coeff_Mul</span><span class="p">()</span>
</span><span id="Expr-1190"><a href="#Expr-1190"><span class="linenos">1190</span></a>
</span><span id="Expr-1191"><a href="#Expr-1191"><span class="linenos">1191</span></a>            <span class="n">coeff</span> <span class="o">=</span> <span class="nb">complex</span><span class="p">(</span><span class="n">coeff</span><span class="p">)</span>
</span><span id="Expr-1192"><a href="#Expr-1192"><span class="linenos">1192</span></a>            <span class="n">cpart</span><span class="p">,</span> <span class="n">ncpart</span> <span class="o">=</span> <span class="p">{},</span> <span class="p">[]</span>
</span><span id="Expr-1193"><a href="#Expr-1193"><span class="linenos">1193</span></a>
</span><span id="Expr-1194"><a href="#Expr-1194"><span class="linenos">1194</span></a>            <span class="k">if</span> <span class="n">_term</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">S</span><span class="o">.</span><span class="n">One</span><span class="p">:</span>
</span><span id="Expr-1195"><a href="#Expr-1195"><span class="linenos">1195</span></a>                <span class="k">for</span> <span class="n">factor</span> <span class="ow">in</span> <span class="n">Mul</span><span class="o">.</span><span class="n">make_args</span><span class="p">(</span><span class="n">_term</span><span class="p">):</span>
</span><span id="Expr-1196"><a href="#Expr-1196"><span class="linenos">1196</span></a>                    <span class="k">if</span> <span class="n">factor</span><span class="o">.</span><span class="n">is_number</span><span class="p">:</span>
</span><span id="Expr-1197"><a href="#Expr-1197"><span class="linenos">1197</span></a>                        <span class="k">try</span><span class="p">:</span>
</span><span id="Expr-1198"><a href="#Expr-1198"><span class="linenos">1198</span></a>                            <span class="n">coeff</span> <span class="o">*=</span> <span class="nb">complex</span><span class="p">(</span><span class="n">factor</span><span class="p">)</span>
</span><span id="Expr-1199"><a href="#Expr-1199"><span class="linenos">1199</span></a>                        <span class="k">except</span> <span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span>
</span><span id="Expr-1200"><a href="#Expr-1200"><span class="linenos">1200</span></a>                            <span class="k">pass</span>
</span><span id="Expr-1201"><a href="#Expr-1201"><span class="linenos">1201</span></a>                        <span class="k">else</span><span class="p">:</span>
</span><span id="Expr-1202"><a href="#Expr-1202"><span class="linenos">1202</span></a>                            <span class="k">continue</span>
</span><span id="Expr-1203"><a href="#Expr-1203"><span class="linenos">1203</span></a>
</span><span id="Expr-1204"><a href="#Expr-1204"><span class="linenos">1204</span></a>                    <span class="k">if</span> <span class="n">factor</span><span class="o">.</span><span class="n">is_commutative</span><span class="p">:</span>
</span><span id="Expr-1205"><a href="#Expr-1205"><span class="linenos">1205</span></a>                        <span class="n">base</span><span class="p">,</span> <span class="n">exp</span> <span class="o">=</span> <span class="n">decompose_power</span><span class="p">(</span><span class="n">factor</span><span class="p">)</span>
</span><span id="Expr-1206"><a href="#Expr-1206"><span class="linenos">1206</span></a>
</span><span id="Expr-1207"><a href="#Expr-1207"><span class="linenos">1207</span></a>                        <span class="n">cpart</span><span class="p">[</span><span class="n">base</span><span class="p">]</span> <span class="o">=</span> <span class="n">exp</span>
</span><span id="Expr-1208"><a href="#Expr-1208"><span class="linenos">1208</span></a>                        <span class="n">gens</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">base</span><span class="p">)</span>
</span><span id="Expr-1209"><a href="#Expr-1209"><span class="linenos">1209</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="Expr-1210"><a href="#Expr-1210"><span class="linenos">1210</span></a>                        <span class="n">ncpart</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">factor</span><span class="p">)</span>
</span><span id="Expr-1211"><a href="#Expr-1211"><span class="linenos">1211</span></a>
</span><span id="Expr-1212"><a href="#Expr-1212"><span class="linenos">1212</span></a>            <span class="n">coeff</span> <span class="o">=</span> <span class="n">coeff</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="n">coeff</span><span class="o">.</span><span class="n">imag</span>
</span><span id="Expr-1213"><a href="#Expr-1213"><span class="linenos">1213</span></a>            <span class="n">ncpart</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">ncpart</span><span class="p">)</span>
</span><span id="Expr-1214"><a href="#Expr-1214"><span class="linenos">1214</span></a>
</span><span id="Expr-1215"><a href="#Expr-1215"><span class="linenos">1215</span></a>            <span class="n">terms</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">term</span><span class="p">,</span> <span class="p">(</span><span class="n">coeff</span><span class="p">,</span> <span class="n">cpart</span><span class="p">,</span> <span class="n">ncpart</span><span class="p">)))</span>
</span><span id="Expr-1216"><a href="#Expr-1216"><span class="linenos">1216</span></a>
</span><span id="Expr-1217"><a href="#Expr-1217"><span class="linenos">1217</span></a>        <span class="n">gens</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">gens</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">default_sort_key</span><span class="p">)</span>
</span><span id="Expr-1218"><a href="#Expr-1218"><span class="linenos">1218</span></a>
</span><span id="Expr-1219"><a href="#Expr-1219"><span class="linenos">1219</span></a>        <span class="n">k</span><span class="p">,</span> <span class="n">indices</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">gens</span><span class="p">),</span> <span class="p">{}</span>
</span><span id="Expr-1220"><a href="#Expr-1220"><span class="linenos">1220</span></a>
</span><span id="Expr-1221"><a href="#Expr-1221"><span class="linenos">1221</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">g</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">gens</span><span class="p">):</span>
</span><span id="Expr-1222"><a href="#Expr-1222"><span class="linenos">1222</span></a>            <span class="n">indices</span><span class="p">[</span><span class="n">g</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span>
</span><span id="Expr-1223"><a href="#Expr-1223"><span class="linenos">1223</span></a>
</span><span id="Expr-1224"><a href="#Expr-1224"><span class="linenos">1224</span></a>        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Expr-1225"><a href="#Expr-1225"><span class="linenos">1225</span></a>
</span><span id="Expr-1226"><a href="#Expr-1226"><span class="linenos">1226</span></a>        <span class="k">for</span> <span class="n">term</span><span class="p">,</span> <span class="p">(</span><span class="n">coeff</span><span class="p">,</span> <span class="n">cpart</span><span class="p">,</span> <span class="n">ncpart</span><span class="p">)</span> <span class="ow">in</span> <span class="n">terms</span><span class="p">:</span>
</span><span id="Expr-1227"><a href="#Expr-1227"><span class="linenos">1227</span></a>            <span class="n">monom</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">k</span>
</span><span id="Expr-1228"><a href="#Expr-1228"><span class="linenos">1228</span></a>
</span><span id="Expr-1229"><a href="#Expr-1229"><span class="linenos">1229</span></a>            <span class="k">for</span> <span class="n">base</span><span class="p">,</span> <span class="n">exp</span> <span class="ow">in</span> <span class="n">cpart</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="Expr-1230"><a href="#Expr-1230"><span class="linenos">1230</span></a>                <span class="n">monom</span><span class="p">[</span><span class="n">indices</span><span class="p">[</span><span class="n">base</span><span class="p">]]</span> <span class="o">=</span> <span class="n">exp</span>
</span><span id="Expr-1231"><a href="#Expr-1231"><span class="linenos">1231</span></a>
</span><span id="Expr-1232"><a href="#Expr-1232"><span class="linenos">1232</span></a>            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">term</span><span class="p">,</span> <span class="p">(</span><span class="n">coeff</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">monom</span><span class="p">),</span> <span class="n">ncpart</span><span class="p">)))</span>
</span><span id="Expr-1233"><a href="#Expr-1233"><span class="linenos">1233</span></a>
</span><span id="Expr-1234"><a href="#Expr-1234"><span class="linenos">1234</span></a>        <span class="k">return</span> <span class="n">result</span><span class="p">,</span> <span class="n">gens</span>
</span><span id="Expr-1235"><a href="#Expr-1235"><span class="linenos">1235</span></a>
</span><span id="Expr-1236"><a href="#Expr-1236"><span class="linenos">1236</span></a>    <span class="k">def</span> <span class="nf">removeO</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Expr-1237"><a href="#Expr-1237"><span class="linenos">1237</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Removes the additive O(..) symbol if there is one&quot;&quot;&quot;</span>
</span><span id="Expr-1238"><a href="#Expr-1238"><span class="linenos">1238</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span><span id="Expr-1239"><a href="#Expr-1239"><span class="linenos">1239</span></a>
</span><span id="Expr-1240"><a href="#Expr-1240"><span class="linenos">1240</span></a>    <span class="k">def</span> <span class="nf">getO</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Expr-1241"><a href="#Expr-1241"><span class="linenos">1241</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the additive O(..) symbol if there is one, else None.&quot;&quot;&quot;</span>
</span><span id="Expr-1242"><a href="#Expr-1242"><span class="linenos">1242</span></a>        <span class="k">return</span> <span class="kc">None</span>
</span><span id="Expr-1243"><a href="#Expr-1243"><span class="linenos">1243</span></a>
</span><span id="Expr-1244"><a href="#Expr-1244"><span class="linenos">1244</span></a>    <span class="k">def</span> <span class="nf">getn</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Expr-1245"><a href="#Expr-1245"><span class="linenos">1245</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Expr-1246"><a href="#Expr-1246"><span class="linenos">1246</span></a><span class="sd">        Returns the order of the expression.</span>
</span><span id="Expr-1247"><a href="#Expr-1247"><span class="linenos">1247</span></a>
</span><span id="Expr-1248"><a href="#Expr-1248"><span class="linenos">1248</span></a><span class="sd">        Explanation</span>
</span><span id="Expr-1249"><a href="#Expr-1249"><span class="linenos">1249</span></a><span class="sd">        ===========</span>
</span><span id="Expr-1250"><a href="#Expr-1250"><span class="linenos">1250</span></a>
</span><span id="Expr-1251"><a href="#Expr-1251"><span class="linenos">1251</span></a><span class="sd">        The order is determined either from the O(...) term. If there</span>
</span><span id="Expr-1252"><a href="#Expr-1252"><span class="linenos">1252</span></a><span class="sd">        is no O(...) term, it returns None.</span>
</span><span id="Expr-1253"><a href="#Expr-1253"><span class="linenos">1253</span></a>
</span><span id="Expr-1254"><a href="#Expr-1254"><span class="linenos">1254</span></a><span class="sd">        Examples</span>
</span><span id="Expr-1255"><a href="#Expr-1255"><span class="linenos">1255</span></a><span class="sd">        ========</span>
</span><span id="Expr-1256"><a href="#Expr-1256"><span class="linenos">1256</span></a>
</span><span id="Expr-1257"><a href="#Expr-1257"><span class="linenos">1257</span></a><span class="sd">        &gt;&gt;&gt; from sympy import O</span>
</span><span id="Expr-1258"><a href="#Expr-1258"><span class="linenos">1258</span></a><span class="sd">        &gt;&gt;&gt; from sympy.abc import x</span>
</span><span id="Expr-1259"><a href="#Expr-1259"><span class="linenos">1259</span></a><span class="sd">        &gt;&gt;&gt; (1 + x + O(x**2)).getn()</span>
</span><span id="Expr-1260"><a href="#Expr-1260"><span class="linenos">1260</span></a><span class="sd">        2</span>
</span><span id="Expr-1261"><a href="#Expr-1261"><span class="linenos">1261</span></a><span class="sd">        &gt;&gt;&gt; (1 + x).getn()</span>
</span><span id="Expr-1262"><a href="#Expr-1262"><span class="linenos">1262</span></a>
</span><span id="Expr-1263"><a href="#Expr-1263"><span class="linenos">1263</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Expr-1264"><a href="#Expr-1264"><span class="linenos">1264</span></a>        <span class="n">o</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getO</span><span class="p">()</span>
</span><span id="Expr-1265"><a href="#Expr-1265"><span class="linenos">1265</span></a>        <span class="k">if</span> <span class="n">o</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Expr-1266"><a href="#Expr-1266"><span class="linenos">1266</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="Expr-1267"><a href="#Expr-1267"><span class="linenos">1267</span></a>        <span class="k">elif</span> <span class="n">o</span><span class="o">.</span><span class="n">is_Order</span><span class="p">:</span>
</span><span id="Expr-1268"><a href="#Expr-1268"><span class="linenos">1268</span></a>            <span class="n">o</span> <span class="o">=</span> <span class="n">o</span><span class="o">.</span><span class="n">expr</span>
</span><span id="Expr-1269"><a href="#Expr-1269"><span class="linenos">1269</span></a>            <span class="k">if</span> <span class="n">o</span> <span class="ow">is</span> <span class="n">S</span><span class="o">.</span><span class="n">One</span><span class="p">:</span>
</span><span id="Expr-1270"><a href="#Expr-1270"><span class="linenos">1270</span></a>                <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">Zero</span>
</span><span id="Expr-1271"><a href="#Expr-1271"><span class="linenos">1271</span></a>            <span class="k">if</span> <span class="n">o</span><span class="o">.</span><span class="n">is_Symbol</span><span class="p">:</span>
</span><span id="Expr-1272"><a href="#Expr-1272"><span class="linenos">1272</span></a>                <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">One</span>
</span><span id="Expr-1273"><a href="#Expr-1273"><span class="linenos">1273</span></a>            <span class="k">if</span> <span class="n">o</span><span class="o">.</span><span class="n">is_Pow</span><span class="p">:</span>
</span><span id="Expr-1274"><a href="#Expr-1274"><span class="linenos">1274</span></a>                <span class="k">return</span> <span class="n">o</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Expr-1275"><a href="#Expr-1275"><span class="linenos">1275</span></a>            <span class="k">if</span> <span class="n">o</span><span class="o">.</span><span class="n">is_Mul</span><span class="p">:</span>  <span class="c1"># x**n*log(x)**n or x**n/log(x)**n</span>
</span><span id="Expr-1276"><a href="#Expr-1276"><span class="linenos">1276</span></a>                <span class="k">for</span> <span class="n">oi</span> <span class="ow">in</span> <span class="n">o</span><span class="o">.</span><span class="n">args</span><span class="p">:</span>
</span><span id="Expr-1277"><a href="#Expr-1277"><span class="linenos">1277</span></a>                    <span class="k">if</span> <span class="n">oi</span><span class="o">.</span><span class="n">is_Symbol</span><span class="p">:</span>
</span><span id="Expr-1278"><a href="#Expr-1278"><span class="linenos">1278</span></a>                        <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">One</span>
</span><span id="Expr-1279"><a href="#Expr-1279"><span class="linenos">1279</span></a>                    <span class="k">if</span> <span class="n">oi</span><span class="o">.</span><span class="n">is_Pow</span><span class="p">:</span>
</span><span id="Expr-1280"><a href="#Expr-1280"><span class="linenos">1280</span></a>                        <span class="kn">from</span> <span class="nn">.symbol</span> <span class="kn">import</span> <span class="n">Dummy</span><span class="p">,</span> <span class="n">Symbol</span>
</span><span id="Expr-1281"><a href="#Expr-1281"><span class="linenos">1281</span></a>                        <span class="n">syms</span> <span class="o">=</span> <span class="n">oi</span><span class="o">.</span><span class="n">atoms</span><span class="p">(</span><span class="n">Symbol</span><span class="p">)</span>
</span><span id="Expr-1282"><a href="#Expr-1282"><span class="linenos">1282</span></a>                        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">syms</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Expr-1283"><a href="#Expr-1283"><span class="linenos">1283</span></a>                            <span class="n">x</span> <span class="o">=</span> <span class="n">syms</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
</span><span id="Expr-1284"><a href="#Expr-1284"><span class="linenos">1284</span></a>                            <span class="n">oi</span> <span class="o">=</span> <span class="n">oi</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Dummy</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">positive</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</span><span id="Expr-1285"><a href="#Expr-1285"><span class="linenos">1285</span></a>                            <span class="k">if</span> <span class="n">oi</span><span class="o">.</span><span class="n">base</span><span class="o">.</span><span class="n">is_Symbol</span> <span class="ow">and</span> <span class="n">oi</span><span class="o">.</span><span class="n">exp</span><span class="o">.</span><span class="n">is_Rational</span><span class="p">:</span>
</span><span id="Expr-1286"><a href="#Expr-1286"><span class="linenos">1286</span></a>                                <span class="k">return</span> <span class="nb">abs</span><span class="p">(</span><span class="n">oi</span><span class="o">.</span><span class="n">exp</span><span class="p">)</span>
</span><span id="Expr-1287"><a href="#Expr-1287"><span class="linenos">1287</span></a>
</span><span id="Expr-1288"><a href="#Expr-1288"><span class="linenos">1288</span></a>        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;not sure of order of </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">o</span><span class="p">)</span>
</span><span id="Expr-1289"><a href="#Expr-1289"><span class="linenos">1289</span></a>
</span><span id="Expr-1290"><a href="#Expr-1290"><span class="linenos">1290</span></a>    <span class="k">def</span> <span class="nf">count_ops</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">visual</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="Expr-1291"><a href="#Expr-1291"><span class="linenos">1291</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;wrapper for count_ops that returns the operation count.&quot;&quot;&quot;</span>
</span><span id="Expr-1292"><a href="#Expr-1292"><span class="linenos">1292</span></a>        <span class="kn">from</span> <span class="nn">.function</span> <span class="kn">import</span> <span class="n">count_ops</span>
</span><span id="Expr-1293"><a href="#Expr-1293"><span class="linenos">1293</span></a>        <span class="k">return</span> <span class="n">count_ops</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">visual</span><span class="p">)</span>
</span><span id="Expr-1294"><a href="#Expr-1294"><span class="linenos">1294</span></a>
</span><span id="Expr-1295"><a href="#Expr-1295"><span class="linenos">1295</span></a>    <span class="k">def</span> <span class="nf">args_cnc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cset</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">warn</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">split_1</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="Expr-1296"><a href="#Expr-1296"><span class="linenos">1296</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return [commutative factors, non-commutative factors] of self.</span>
</span><span id="Expr-1297"><a href="#Expr-1297"><span class="linenos">1297</span></a>
</span><span id="Expr-1298"><a href="#Expr-1298"><span class="linenos">1298</span></a><span class="sd">        Explanation</span>
</span><span id="Expr-1299"><a href="#Expr-1299"><span class="linenos">1299</span></a><span class="sd">        ===========</span>
</span><span id="Expr-1300"><a href="#Expr-1300"><span class="linenos">1300</span></a>
</span><span id="Expr-1301"><a href="#Expr-1301"><span class="linenos">1301</span></a><span class="sd">        self is treated as a Mul and the ordering of the factors is maintained.</span>
</span><span id="Expr-1302"><a href="#Expr-1302"><span class="linenos">1302</span></a><span class="sd">        If ``cset`` is True the commutative factors will be returned in a set.</span>
</span><span id="Expr-1303"><a href="#Expr-1303"><span class="linenos">1303</span></a><span class="sd">        If there were repeated factors (as may happen with an unevaluated Mul)</span>
</span><span id="Expr-1304"><a href="#Expr-1304"><span class="linenos">1304</span></a><span class="sd">        then an error will be raised unless it is explicitly suppressed by</span>
</span><span id="Expr-1305"><a href="#Expr-1305"><span class="linenos">1305</span></a><span class="sd">        setting ``warn`` to False.</span>
</span><span id="Expr-1306"><a href="#Expr-1306"><span class="linenos">1306</span></a>
</span><span id="Expr-1307"><a href="#Expr-1307"><span class="linenos">1307</span></a><span class="sd">        Note: -1 is always separated from a Number unless split_1 is False.</span>
</span><span id="Expr-1308"><a href="#Expr-1308"><span class="linenos">1308</span></a>
</span><span id="Expr-1309"><a href="#Expr-1309"><span class="linenos">1309</span></a><span class="sd">        Examples</span>
</span><span id="Expr-1310"><a href="#Expr-1310"><span class="linenos">1310</span></a><span class="sd">        ========</span>
</span><span id="Expr-1311"><a href="#Expr-1311"><span class="linenos">1311</span></a>
</span><span id="Expr-1312"><a href="#Expr-1312"><span class="linenos">1312</span></a><span class="sd">        &gt;&gt;&gt; from sympy import symbols, oo</span>
</span><span id="Expr-1313"><a href="#Expr-1313"><span class="linenos">1313</span></a><span class="sd">        &gt;&gt;&gt; A, B = symbols(&#39;A B&#39;, commutative=0)</span>
</span><span id="Expr-1314"><a href="#Expr-1314"><span class="linenos">1314</span></a><span class="sd">        &gt;&gt;&gt; x, y = symbols(&#39;x y&#39;)</span>
</span><span id="Expr-1315"><a href="#Expr-1315"><span class="linenos">1315</span></a><span class="sd">        &gt;&gt;&gt; (-2*x*y).args_cnc()</span>
</span><span id="Expr-1316"><a href="#Expr-1316"><span class="linenos">1316</span></a><span class="sd">        [[-1, 2, x, y], []]</span>
</span><span id="Expr-1317"><a href="#Expr-1317"><span class="linenos">1317</span></a><span class="sd">        &gt;&gt;&gt; (-2.5*x).args_cnc()</span>
</span><span id="Expr-1318"><a href="#Expr-1318"><span class="linenos">1318</span></a><span class="sd">        [[-1, 2.5, x], []]</span>
</span><span id="Expr-1319"><a href="#Expr-1319"><span class="linenos">1319</span></a><span class="sd">        &gt;&gt;&gt; (-2*x*A*B*y).args_cnc()</span>
</span><span id="Expr-1320"><a href="#Expr-1320"><span class="linenos">1320</span></a><span class="sd">        [[-1, 2, x, y], [A, B]]</span>
</span><span id="Expr-1321"><a href="#Expr-1321"><span class="linenos">1321</span></a><span class="sd">        &gt;&gt;&gt; (-2*x*A*B*y).args_cnc(split_1=False)</span>
</span><span id="Expr-1322"><a href="#Expr-1322"><span class="linenos">1322</span></a><span class="sd">        [[-2, x, y], [A, B]]</span>
</span><span id="Expr-1323"><a href="#Expr-1323"><span class="linenos">1323</span></a><span class="sd">        &gt;&gt;&gt; (-2*x*y).args_cnc(cset=True)</span>
</span><span id="Expr-1324"><a href="#Expr-1324"><span class="linenos">1324</span></a><span class="sd">        [{-1, 2, x, y}, []]</span>
</span><span id="Expr-1325"><a href="#Expr-1325"><span class="linenos">1325</span></a>
</span><span id="Expr-1326"><a href="#Expr-1326"><span class="linenos">1326</span></a><span class="sd">        The arg is always treated as a Mul:</span>
</span><span id="Expr-1327"><a href="#Expr-1327"><span class="linenos">1327</span></a>
</span><span id="Expr-1328"><a href="#Expr-1328"><span class="linenos">1328</span></a><span class="sd">        &gt;&gt;&gt; (-2 + x + A).args_cnc()</span>
</span><span id="Expr-1329"><a href="#Expr-1329"><span class="linenos">1329</span></a><span class="sd">        [[], [x - 2 + A]]</span>
</span><span id="Expr-1330"><a href="#Expr-1330"><span class="linenos">1330</span></a><span class="sd">        &gt;&gt;&gt; (-oo).args_cnc() # -oo is a singleton</span>
</span><span id="Expr-1331"><a href="#Expr-1331"><span class="linenos">1331</span></a><span class="sd">        [[-1, oo], []]</span>
</span><span id="Expr-1332"><a href="#Expr-1332"><span class="linenos">1332</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Expr-1333"><a href="#Expr-1333"><span class="linenos">1333</span></a>
</span><span id="Expr-1334"><a href="#Expr-1334"><span class="linenos">1334</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_Mul</span><span class="p">:</span>
</span><span id="Expr-1335"><a href="#Expr-1335"><span class="linenos">1335</span></a>            <span class="n">args</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">)</span>
</span><span id="Expr-1336"><a href="#Expr-1336"><span class="linenos">1336</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Expr-1337"><a href="#Expr-1337"><span class="linenos">1337</span></a>            <span class="n">args</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="p">]</span>
</span><span id="Expr-1338"><a href="#Expr-1338"><span class="linenos">1338</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">mi</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">args</span><span class="p">):</span>
</span><span id="Expr-1339"><a href="#Expr-1339"><span class="linenos">1339</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">mi</span><span class="o">.</span><span class="n">is_commutative</span><span class="p">:</span>
</span><span id="Expr-1340"><a href="#Expr-1340"><span class="linenos">1340</span></a>                <span class="n">c</span> <span class="o">=</span> <span class="n">args</span><span class="p">[:</span><span class="n">i</span><span class="p">]</span>
</span><span id="Expr-1341"><a href="#Expr-1341"><span class="linenos">1341</span></a>                <span class="n">nc</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="n">i</span><span class="p">:]</span>
</span><span id="Expr-1342"><a href="#Expr-1342"><span class="linenos">1342</span></a>                <span class="k">break</span>
</span><span id="Expr-1343"><a href="#Expr-1343"><span class="linenos">1343</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Expr-1344"><a href="#Expr-1344"><span class="linenos">1344</span></a>            <span class="n">c</span> <span class="o">=</span> <span class="n">args</span>
</span><span id="Expr-1345"><a href="#Expr-1345"><span class="linenos">1345</span></a>            <span class="n">nc</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Expr-1346"><a href="#Expr-1346"><span class="linenos">1346</span></a>
</span><span id="Expr-1347"><a href="#Expr-1347"><span class="linenos">1347</span></a>        <span class="k">if</span> <span class="n">c</span> <span class="ow">and</span> <span class="n">split_1</span> <span class="ow">and</span> <span class="p">(</span>
</span><span id="Expr-1348"><a href="#Expr-1348"><span class="linenos">1348</span></a>            <span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">is_Number</span> <span class="ow">and</span>
</span><span id="Expr-1349"><a href="#Expr-1349"><span class="linenos">1349</span></a>            <span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">is_extended_negative</span> <span class="ow">and</span>
</span><span id="Expr-1350"><a href="#Expr-1350"><span class="linenos">1350</span></a>                <span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">S</span><span class="o">.</span><span class="n">NegativeOne</span><span class="p">):</span>
</span><span id="Expr-1351"><a href="#Expr-1351"><span class="linenos">1351</span></a>            <span class="n">c</span><span class="p">[:</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">S</span><span class="o">.</span><span class="n">NegativeOne</span><span class="p">,</span> <span class="o">-</span><span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
</span><span id="Expr-1352"><a href="#Expr-1352"><span class="linenos">1352</span></a>
</span><span id="Expr-1353"><a href="#Expr-1353"><span class="linenos">1353</span></a>        <span class="k">if</span> <span class="n">cset</span><span class="p">:</span>
</span><span id="Expr-1354"><a href="#Expr-1354"><span class="linenos">1354</span></a>            <span class="n">clen</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
</span><span id="Expr-1355"><a href="#Expr-1355"><span class="linenos">1355</span></a>            <span class="n">c</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
</span><span id="Expr-1356"><a href="#Expr-1356"><span class="linenos">1356</span></a>            <span class="k">if</span> <span class="n">clen</span> <span class="ow">and</span> <span class="n">warn</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">!=</span> <span class="n">clen</span><span class="p">:</span>
</span><span id="Expr-1357"><a href="#Expr-1357"><span class="linenos">1357</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;repeated commutative arguments: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span>
</span><span id="Expr-1358"><a href="#Expr-1358"><span class="linenos">1358</span></a>                                 <span class="p">[</span><span class="n">ci</span> <span class="k">for</span> <span class="n">ci</span> <span class="ow">in</span> <span class="n">c</span> <span class="k">if</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">ci</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">])</span>
</span><span id="Expr-1359"><a href="#Expr-1359"><span class="linenos">1359</span></a>        <span class="k">return</span> <span class="p">[</span><span class="n">c</span><span class="p">,</span> <span class="n">nc</span><span class="p">]</span>
</span><span id="Expr-1360"><a href="#Expr-1360"><span class="linenos">1360</span></a>
</span><span id="Expr-1361"><a href="#Expr-1361"><span class="linenos">1361</span></a>    <span class="k">def</span> <span class="nf">coeff</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">_first</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="Expr-1362"><a href="#Expr-1362"><span class="linenos">1362</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Expr-1363"><a href="#Expr-1363"><span class="linenos">1363</span></a><span class="sd">        Returns the coefficient from the term(s) containing ``x**n``. If ``n``</span>
</span><span id="Expr-1364"><a href="#Expr-1364"><span class="linenos">1364</span></a><span class="sd">        is zero then all terms independent of ``x`` will be returned.</span>
</span><span id="Expr-1365"><a href="#Expr-1365"><span class="linenos">1365</span></a>
</span><span id="Expr-1366"><a href="#Expr-1366"><span class="linenos">1366</span></a><span class="sd">        Explanation</span>
</span><span id="Expr-1367"><a href="#Expr-1367"><span class="linenos">1367</span></a><span class="sd">        ===========</span>
</span><span id="Expr-1368"><a href="#Expr-1368"><span class="linenos">1368</span></a>
</span><span id="Expr-1369"><a href="#Expr-1369"><span class="linenos">1369</span></a><span class="sd">        When ``x`` is noncommutative, the coefficient to the left (default) or</span>
</span><span id="Expr-1370"><a href="#Expr-1370"><span class="linenos">1370</span></a><span class="sd">        right of ``x`` can be returned. The keyword &#39;right&#39; is ignored when</span>
</span><span id="Expr-1371"><a href="#Expr-1371"><span class="linenos">1371</span></a><span class="sd">        ``x`` is commutative.</span>
</span><span id="Expr-1372"><a href="#Expr-1372"><span class="linenos">1372</span></a>
</span><span id="Expr-1373"><a href="#Expr-1373"><span class="linenos">1373</span></a><span class="sd">        Examples</span>
</span><span id="Expr-1374"><a href="#Expr-1374"><span class="linenos">1374</span></a><span class="sd">        ========</span>
</span><span id="Expr-1375"><a href="#Expr-1375"><span class="linenos">1375</span></a>
</span><span id="Expr-1376"><a href="#Expr-1376"><span class="linenos">1376</span></a><span class="sd">        &gt;&gt;&gt; from sympy import symbols</span>
</span><span id="Expr-1377"><a href="#Expr-1377"><span class="linenos">1377</span></a><span class="sd">        &gt;&gt;&gt; from sympy.abc import x, y, z</span>
</span><span id="Expr-1378"><a href="#Expr-1378"><span class="linenos">1378</span></a>
</span><span id="Expr-1379"><a href="#Expr-1379"><span class="linenos">1379</span></a><span class="sd">        You can select terms that have an explicit negative in front of them:</span>
</span><span id="Expr-1380"><a href="#Expr-1380"><span class="linenos">1380</span></a>
</span><span id="Expr-1381"><a href="#Expr-1381"><span class="linenos">1381</span></a><span class="sd">        &gt;&gt;&gt; (-x + 2*y).coeff(-1)</span>
</span><span id="Expr-1382"><a href="#Expr-1382"><span class="linenos">1382</span></a><span class="sd">        x</span>
</span><span id="Expr-1383"><a href="#Expr-1383"><span class="linenos">1383</span></a><span class="sd">        &gt;&gt;&gt; (x - 2*y).coeff(-1)</span>
</span><span id="Expr-1384"><a href="#Expr-1384"><span class="linenos">1384</span></a><span class="sd">        2*y</span>
</span><span id="Expr-1385"><a href="#Expr-1385"><span class="linenos">1385</span></a>
</span><span id="Expr-1386"><a href="#Expr-1386"><span class="linenos">1386</span></a><span class="sd">        You can select terms with no Rational coefficient:</span>
</span><span id="Expr-1387"><a href="#Expr-1387"><span class="linenos">1387</span></a>
</span><span id="Expr-1388"><a href="#Expr-1388"><span class="linenos">1388</span></a><span class="sd">        &gt;&gt;&gt; (x + 2*y).coeff(1)</span>
</span><span id="Expr-1389"><a href="#Expr-1389"><span class="linenos">1389</span></a><span class="sd">        x</span>
</span><span id="Expr-1390"><a href="#Expr-1390"><span class="linenos">1390</span></a><span class="sd">        &gt;&gt;&gt; (3 + 2*x + 4*x**2).coeff(1)</span>
</span><span id="Expr-1391"><a href="#Expr-1391"><span class="linenos">1391</span></a><span class="sd">        0</span>
</span><span id="Expr-1392"><a href="#Expr-1392"><span class="linenos">1392</span></a>
</span><span id="Expr-1393"><a href="#Expr-1393"><span class="linenos">1393</span></a><span class="sd">        You can select terms independent of x by making n=0; in this case</span>
</span><span id="Expr-1394"><a href="#Expr-1394"><span class="linenos">1394</span></a><span class="sd">        expr.as_independent(x)[0] is returned (and 0 will be returned instead</span>
</span><span id="Expr-1395"><a href="#Expr-1395"><span class="linenos">1395</span></a><span class="sd">        of None):</span>
</span><span id="Expr-1396"><a href="#Expr-1396"><span class="linenos">1396</span></a>
</span><span id="Expr-1397"><a href="#Expr-1397"><span class="linenos">1397</span></a><span class="sd">        &gt;&gt;&gt; (3 + 2*x + 4*x**2).coeff(x, 0)</span>
</span><span id="Expr-1398"><a href="#Expr-1398"><span class="linenos">1398</span></a><span class="sd">        3</span>
</span><span id="Expr-1399"><a href="#Expr-1399"><span class="linenos">1399</span></a><span class="sd">        &gt;&gt;&gt; eq = ((x + 1)**3).expand() + 1</span>
</span><span id="Expr-1400"><a href="#Expr-1400"><span class="linenos">1400</span></a><span class="sd">        &gt;&gt;&gt; eq</span>
</span><span id="Expr-1401"><a href="#Expr-1401"><span class="linenos">1401</span></a><span class="sd">        x**3 + 3*x**2 + 3*x + 2</span>
</span><span id="Expr-1402"><a href="#Expr-1402"><span class="linenos">1402</span></a><span class="sd">        &gt;&gt;&gt; [eq.coeff(x, i) for i in reversed(range(4))]</span>
</span><span id="Expr-1403"><a href="#Expr-1403"><span class="linenos">1403</span></a><span class="sd">        [1, 3, 3, 2]</span>
</span><span id="Expr-1404"><a href="#Expr-1404"><span class="linenos">1404</span></a><span class="sd">        &gt;&gt;&gt; eq -= 2</span>
</span><span id="Expr-1405"><a href="#Expr-1405"><span class="linenos">1405</span></a><span class="sd">        &gt;&gt;&gt; [eq.coeff(x, i) for i in reversed(range(4))]</span>
</span><span id="Expr-1406"><a href="#Expr-1406"><span class="linenos">1406</span></a><span class="sd">        [1, 3, 3, 0]</span>
</span><span id="Expr-1407"><a href="#Expr-1407"><span class="linenos">1407</span></a>
</span><span id="Expr-1408"><a href="#Expr-1408"><span class="linenos">1408</span></a><span class="sd">        You can select terms that have a numerical term in front of them:</span>
</span><span id="Expr-1409"><a href="#Expr-1409"><span class="linenos">1409</span></a>
</span><span id="Expr-1410"><a href="#Expr-1410"><span class="linenos">1410</span></a><span class="sd">        &gt;&gt;&gt; (-x - 2*y).coeff(2)</span>
</span><span id="Expr-1411"><a href="#Expr-1411"><span class="linenos">1411</span></a><span class="sd">        -y</span>
</span><span id="Expr-1412"><a href="#Expr-1412"><span class="linenos">1412</span></a><span class="sd">        &gt;&gt;&gt; from sympy import sqrt</span>
</span><span id="Expr-1413"><a href="#Expr-1413"><span class="linenos">1413</span></a><span class="sd">        &gt;&gt;&gt; (x + sqrt(2)*x).coeff(sqrt(2))</span>
</span><span id="Expr-1414"><a href="#Expr-1414"><span class="linenos">1414</span></a><span class="sd">        x</span>
</span><span id="Expr-1415"><a href="#Expr-1415"><span class="linenos">1415</span></a>
</span><span id="Expr-1416"><a href="#Expr-1416"><span class="linenos">1416</span></a><span class="sd">        The matching is exact:</span>
</span><span id="Expr-1417"><a href="#Expr-1417"><span class="linenos">1417</span></a>
</span><span id="Expr-1418"><a href="#Expr-1418"><span class="linenos">1418</span></a><span class="sd">        &gt;&gt;&gt; (3 + 2*x + 4*x**2).coeff(x)</span>
</span><span id="Expr-1419"><a href="#Expr-1419"><span class="linenos">1419</span></a><span class="sd">        2</span>
</span><span id="Expr-1420"><a href="#Expr-1420"><span class="linenos">1420</span></a><span class="sd">        &gt;&gt;&gt; (3 + 2*x + 4*x**2).coeff(x**2)</span>
</span><span id="Expr-1421"><a href="#Expr-1421"><span class="linenos">1421</span></a><span class="sd">        4</span>
</span><span id="Expr-1422"><a href="#Expr-1422"><span class="linenos">1422</span></a><span class="sd">        &gt;&gt;&gt; (3 + 2*x + 4*x**2).coeff(x**3)</span>
</span><span id="Expr-1423"><a href="#Expr-1423"><span class="linenos">1423</span></a><span class="sd">        0</span>
</span><span id="Expr-1424"><a href="#Expr-1424"><span class="linenos">1424</span></a><span class="sd">        &gt;&gt;&gt; (z*(x + y)**2).coeff((x + y)**2)</span>
</span><span id="Expr-1425"><a href="#Expr-1425"><span class="linenos">1425</span></a><span class="sd">        z</span>
</span><span id="Expr-1426"><a href="#Expr-1426"><span class="linenos">1426</span></a><span class="sd">        &gt;&gt;&gt; (z*(x + y)**2).coeff(x + y)</span>
</span><span id="Expr-1427"><a href="#Expr-1427"><span class="linenos">1427</span></a><span class="sd">        0</span>
</span><span id="Expr-1428"><a href="#Expr-1428"><span class="linenos">1428</span></a>
</span><span id="Expr-1429"><a href="#Expr-1429"><span class="linenos">1429</span></a><span class="sd">        In addition, no factoring is done, so 1 + z*(1 + y) is not obtained</span>
</span><span id="Expr-1430"><a href="#Expr-1430"><span class="linenos">1430</span></a><span class="sd">        from the following:</span>
</span><span id="Expr-1431"><a href="#Expr-1431"><span class="linenos">1431</span></a>
</span><span id="Expr-1432"><a href="#Expr-1432"><span class="linenos">1432</span></a><span class="sd">        &gt;&gt;&gt; (x + z*(x + x*y)).coeff(x)</span>
</span><span id="Expr-1433"><a href="#Expr-1433"><span class="linenos">1433</span></a><span class="sd">        1</span>
</span><span id="Expr-1434"><a href="#Expr-1434"><span class="linenos">1434</span></a>
</span><span id="Expr-1435"><a href="#Expr-1435"><span class="linenos">1435</span></a><span class="sd">        If such factoring is desired, factor_terms can be used first:</span>
</span><span id="Expr-1436"><a href="#Expr-1436"><span class="linenos">1436</span></a>
</span><span id="Expr-1437"><a href="#Expr-1437"><span class="linenos">1437</span></a><span class="sd">        &gt;&gt;&gt; from sympy import factor_terms</span>
</span><span id="Expr-1438"><a href="#Expr-1438"><span class="linenos">1438</span></a><span class="sd">        &gt;&gt;&gt; factor_terms(x + z*(x + x*y)).coeff(x)</span>
</span><span id="Expr-1439"><a href="#Expr-1439"><span class="linenos">1439</span></a><span class="sd">        z*(y + 1) + 1</span>
</span><span id="Expr-1440"><a href="#Expr-1440"><span class="linenos">1440</span></a>
</span><span id="Expr-1441"><a href="#Expr-1441"><span class="linenos">1441</span></a><span class="sd">        &gt;&gt;&gt; n, m, o = symbols(&#39;n m o&#39;, commutative=False)</span>
</span><span id="Expr-1442"><a href="#Expr-1442"><span class="linenos">1442</span></a><span class="sd">        &gt;&gt;&gt; n.coeff(n)</span>
</span><span id="Expr-1443"><a href="#Expr-1443"><span class="linenos">1443</span></a><span class="sd">        1</span>
</span><span id="Expr-1444"><a href="#Expr-1444"><span class="linenos">1444</span></a><span class="sd">        &gt;&gt;&gt; (3*n).coeff(n)</span>
</span><span id="Expr-1445"><a href="#Expr-1445"><span class="linenos">1445</span></a><span class="sd">        3</span>
</span><span id="Expr-1446"><a href="#Expr-1446"><span class="linenos">1446</span></a><span class="sd">        &gt;&gt;&gt; (n*m + m*n*m).coeff(n) # = (1 + m)*n*m</span>
</span><span id="Expr-1447"><a href="#Expr-1447"><span class="linenos">1447</span></a><span class="sd">        1 + m</span>
</span><span id="Expr-1448"><a href="#Expr-1448"><span class="linenos">1448</span></a><span class="sd">        &gt;&gt;&gt; (n*m + m*n*m).coeff(n, right=True) # = (1 + m)*n*m</span>
</span><span id="Expr-1449"><a href="#Expr-1449"><span class="linenos">1449</span></a><span class="sd">        m</span>
</span><span id="Expr-1450"><a href="#Expr-1450"><span class="linenos">1450</span></a>
</span><span id="Expr-1451"><a href="#Expr-1451"><span class="linenos">1451</span></a><span class="sd">        If there is more than one possible coefficient 0 is returned:</span>
</span><span id="Expr-1452"><a href="#Expr-1452"><span class="linenos">1452</span></a>
</span><span id="Expr-1453"><a href="#Expr-1453"><span class="linenos">1453</span></a><span class="sd">        &gt;&gt;&gt; (n*m + m*n).coeff(n)</span>
</span><span id="Expr-1454"><a href="#Expr-1454"><span class="linenos">1454</span></a><span class="sd">        0</span>
</span><span id="Expr-1455"><a href="#Expr-1455"><span class="linenos">1455</span></a>
</span><span id="Expr-1456"><a href="#Expr-1456"><span class="linenos">1456</span></a><span class="sd">        If there is only one possible coefficient, it is returned:</span>
</span><span id="Expr-1457"><a href="#Expr-1457"><span class="linenos">1457</span></a>
</span><span id="Expr-1458"><a href="#Expr-1458"><span class="linenos">1458</span></a><span class="sd">        &gt;&gt;&gt; (n*m + x*m*n).coeff(m*n)</span>
</span><span id="Expr-1459"><a href="#Expr-1459"><span class="linenos">1459</span></a><span class="sd">        x</span>
</span><span id="Expr-1460"><a href="#Expr-1460"><span class="linenos">1460</span></a><span class="sd">        &gt;&gt;&gt; (n*m + x*m*n).coeff(m*n, right=1)</span>
</span><span id="Expr-1461"><a href="#Expr-1461"><span class="linenos">1461</span></a><span class="sd">        1</span>
</span><span id="Expr-1462"><a href="#Expr-1462"><span class="linenos">1462</span></a>
</span><span id="Expr-1463"><a href="#Expr-1463"><span class="linenos">1463</span></a><span class="sd">        See Also</span>
</span><span id="Expr-1464"><a href="#Expr-1464"><span class="linenos">1464</span></a><span class="sd">        ========</span>
</span><span id="Expr-1465"><a href="#Expr-1465"><span class="linenos">1465</span></a>
</span><span id="Expr-1466"><a href="#Expr-1466"><span class="linenos">1466</span></a><span class="sd">        as_coefficient: separate the expression into a coefficient and factor</span>
</span><span id="Expr-1467"><a href="#Expr-1467"><span class="linenos">1467</span></a><span class="sd">        as_coeff_Add: separate the additive constant from an expression</span>
</span><span id="Expr-1468"><a href="#Expr-1468"><span class="linenos">1468</span></a><span class="sd">        as_coeff_Mul: separate the multiplicative constant from an expression</span>
</span><span id="Expr-1469"><a href="#Expr-1469"><span class="linenos">1469</span></a><span class="sd">        as_independent: separate x-dependent terms/factors from others</span>
</span><span id="Expr-1470"><a href="#Expr-1470"><span class="linenos">1470</span></a><span class="sd">        sympy.polys.polytools.Poly.coeff_monomial: efficiently find the single coefficient of a monomial in Poly</span>
</span><span id="Expr-1471"><a href="#Expr-1471"><span class="linenos">1471</span></a><span class="sd">        sympy.polys.polytools.Poly.nth: like coeff_monomial but powers of monomial terms are used</span>
</span><span id="Expr-1472"><a href="#Expr-1472"><span class="linenos">1472</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Expr-1473"><a href="#Expr-1473"><span class="linenos">1473</span></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">sympify</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span><span id="Expr-1474"><a href="#Expr-1474"><span class="linenos">1474</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Basic</span><span class="p">):</span>
</span><span id="Expr-1475"><a href="#Expr-1475"><span class="linenos">1475</span></a>            <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">Zero</span>
</span><span id="Expr-1476"><a href="#Expr-1476"><span class="linenos">1476</span></a>
</span><span id="Expr-1477"><a href="#Expr-1477"><span class="linenos">1477</span></a>        <span class="n">n</span> <span class="o">=</span> <span class="n">as_int</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
</span><span id="Expr-1478"><a href="#Expr-1478"><span class="linenos">1478</span></a>
</span><span id="Expr-1479"><a href="#Expr-1479"><span class="linenos">1479</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">x</span><span class="p">:</span>
</span><span id="Expr-1480"><a href="#Expr-1480"><span class="linenos">1480</span></a>            <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">Zero</span>
</span><span id="Expr-1481"><a href="#Expr-1481"><span class="linenos">1481</span></a>
</span><span id="Expr-1482"><a href="#Expr-1482"><span class="linenos">1482</span></a>        <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="bp">self</span><span class="p">:</span>
</span><span id="Expr-1483"><a href="#Expr-1483"><span class="linenos">1483</span></a>            <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Expr-1484"><a href="#Expr-1484"><span class="linenos">1484</span></a>                <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">One</span>
</span><span id="Expr-1485"><a href="#Expr-1485"><span class="linenos">1485</span></a>            <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">Zero</span>
</span><span id="Expr-1486"><a href="#Expr-1486"><span class="linenos">1486</span></a>
</span><span id="Expr-1487"><a href="#Expr-1487"><span class="linenos">1487</span></a>        <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="n">S</span><span class="o">.</span><span class="n">One</span><span class="p">:</span>
</span><span id="Expr-1488"><a href="#Expr-1488"><span class="linenos">1488</span></a>            <span class="n">co</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">Add</span><span class="o">.</span><span class="n">make_args</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="Expr-1489"><a href="#Expr-1489"><span class="linenos">1489</span></a>                  <span class="k">if</span> <span class="n">a</span><span class="o">.</span><span class="n">as_coeff_Mul</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">is</span> <span class="n">S</span><span class="o">.</span><span class="n">One</span><span class="p">]</span>
</span><span id="Expr-1490"><a href="#Expr-1490"><span class="linenos">1490</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">co</span><span class="p">:</span>
</span><span id="Expr-1491"><a href="#Expr-1491"><span class="linenos">1491</span></a>                <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">Zero</span>
</span><span id="Expr-1492"><a href="#Expr-1492"><span class="linenos">1492</span></a>            <span class="k">return</span> <span class="n">Add</span><span class="p">(</span><span class="o">*</span><span class="n">co</span><span class="p">)</span>
</span><span id="Expr-1493"><a href="#Expr-1493"><span class="linenos">1493</span></a>
</span><span id="Expr-1494"><a href="#Expr-1494"><span class="linenos">1494</span></a>        <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Expr-1495"><a href="#Expr-1495"><span class="linenos">1495</span></a>            <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">is_Add</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_Add</span><span class="p">:</span>
</span><span id="Expr-1496"><a href="#Expr-1496"><span class="linenos">1496</span></a>                <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coeff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="n">right</span><span class="p">)</span>
</span><span id="Expr-1497"><a href="#Expr-1497"><span class="linenos">1497</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">c</span><span class="p">:</span>
</span><span id="Expr-1498"><a href="#Expr-1498"><span class="linenos">1498</span></a>                    <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">Zero</span>
</span><span id="Expr-1499"><a href="#Expr-1499"><span class="linenos">1499</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">right</span><span class="p">:</span>
</span><span id="Expr-1500"><a href="#Expr-1500"><span class="linenos">1500</span></a>                    <span class="k">return</span> <span class="bp">self</span> <span class="o">-</span> <span class="n">Add</span><span class="p">(</span><span class="o">*</span><span class="p">[</span><span class="n">a</span><span class="o">*</span><span class="n">x</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">Add</span><span class="o">.</span><span class="n">make_args</span><span class="p">(</span><span class="n">c</span><span class="p">)])</span>
</span><span id="Expr-1501"><a href="#Expr-1501"><span class="linenos">1501</span></a>                <span class="k">return</span> <span class="bp">self</span> <span class="o">-</span> <span class="n">Add</span><span class="p">(</span><span class="o">*</span><span class="p">[</span><span class="n">x</span><span class="o">*</span><span class="n">a</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">Add</span><span class="o">.</span><span class="n">make_args</span><span class="p">(</span><span class="n">c</span><span class="p">)])</span>
</span><span id="Expr-1502"><a href="#Expr-1502"><span class="linenos">1502</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">as_independent</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">as_Add</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Expr-1503"><a href="#Expr-1503"><span class="linenos">1503</span></a>
</span><span id="Expr-1504"><a href="#Expr-1504"><span class="linenos">1504</span></a>        <span class="c1"># continue with the full method, looking for this power of x:</span>
</span><span id="Expr-1505"><a href="#Expr-1505"><span class="linenos">1505</span></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">**</span><span class="n">n</span>
</span><span id="Expr-1506"><a href="#Expr-1506"><span class="linenos">1506</span></a>
</span><span id="Expr-1507"><a href="#Expr-1507"><span class="linenos">1507</span></a>        <span class="k">def</span> <span class="nf">incommon</span><span class="p">(</span><span class="n">l1</span><span class="p">,</span> <span class="n">l2</span><span class="p">):</span>
</span><span id="Expr-1508"><a href="#Expr-1508"><span class="linenos">1508</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">l1</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">l2</span><span class="p">:</span>
</span><span id="Expr-1509"><a href="#Expr-1509"><span class="linenos">1509</span></a>                <span class="k">return</span> <span class="p">[]</span>
</span><span id="Expr-1510"><a href="#Expr-1510"><span class="linenos">1510</span></a>            <span class="n">n</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">l1</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">l2</span><span class="p">))</span>
</span><span id="Expr-1511"><a href="#Expr-1511"><span class="linenos">1511</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
</span><span id="Expr-1512"><a href="#Expr-1512"><span class="linenos">1512</span></a>                <span class="k">if</span> <span class="n">l1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="n">l2</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
</span><span id="Expr-1513"><a href="#Expr-1513"><span class="linenos">1513</span></a>                    <span class="k">return</span> <span class="n">l1</span><span class="p">[:</span><span class="n">i</span><span class="p">]</span>
</span><span id="Expr-1514"><a href="#Expr-1514"><span class="linenos">1514</span></a>            <span class="k">return</span> <span class="n">l1</span><span class="p">[:]</span>
</span><span id="Expr-1515"><a href="#Expr-1515"><span class="linenos">1515</span></a>
</span><span id="Expr-1516"><a href="#Expr-1516"><span class="linenos">1516</span></a>        <span class="k">def</span> <span class="nf">find</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">sub</span><span class="p">,</span> <span class="n">first</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="Expr-1517"><a href="#Expr-1517"><span class="linenos">1517</span></a><span class="w">            </span><span class="sd">&quot;&quot;&quot; Find where list sub appears in list l. When ``first`` is True</span>
</span><span id="Expr-1518"><a href="#Expr-1518"><span class="linenos">1518</span></a><span class="sd">            the first occurrence from the left is returned, else the last</span>
</span><span id="Expr-1519"><a href="#Expr-1519"><span class="linenos">1519</span></a><span class="sd">            occurrence is returned. Return None if sub is not in l.</span>
</span><span id="Expr-1520"><a href="#Expr-1520"><span class="linenos">1520</span></a>
</span><span id="Expr-1521"><a href="#Expr-1521"><span class="linenos">1521</span></a><span class="sd">            Examples</span>
</span><span id="Expr-1522"><a href="#Expr-1522"><span class="linenos">1522</span></a><span class="sd">            ========</span>
</span><span id="Expr-1523"><a href="#Expr-1523"><span class="linenos">1523</span></a>
</span><span id="Expr-1524"><a href="#Expr-1524"><span class="linenos">1524</span></a><span class="sd">            &gt;&gt; l = range(5)*2</span>
</span><span id="Expr-1525"><a href="#Expr-1525"><span class="linenos">1525</span></a><span class="sd">            &gt;&gt; find(l, [2, 3])</span>
</span><span id="Expr-1526"><a href="#Expr-1526"><span class="linenos">1526</span></a><span class="sd">            2</span>
</span><span id="Expr-1527"><a href="#Expr-1527"><span class="linenos">1527</span></a><span class="sd">            &gt;&gt; find(l, [2, 3], first=0)</span>
</span><span id="Expr-1528"><a href="#Expr-1528"><span class="linenos">1528</span></a><span class="sd">            7</span>
</span><span id="Expr-1529"><a href="#Expr-1529"><span class="linenos">1529</span></a><span class="sd">            &gt;&gt; find(l, [2, 4])</span>
</span><span id="Expr-1530"><a href="#Expr-1530"><span class="linenos">1530</span></a><span class="sd">            None</span>
</span><span id="Expr-1531"><a href="#Expr-1531"><span class="linenos">1531</span></a>
</span><span id="Expr-1532"><a href="#Expr-1532"><span class="linenos">1532</span></a><span class="sd">            &quot;&quot;&quot;</span>
</span><span id="Expr-1533"><a href="#Expr-1533"><span class="linenos">1533</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">sub</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">l</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">sub</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">):</span>
</span><span id="Expr-1534"><a href="#Expr-1534"><span class="linenos">1534</span></a>                <span class="k">return</span> <span class="kc">None</span>
</span><span id="Expr-1535"><a href="#Expr-1535"><span class="linenos">1535</span></a>            <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sub</span><span class="p">)</span>
</span><span id="Expr-1536"><a href="#Expr-1536"><span class="linenos">1536</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">first</span><span class="p">:</span>
</span><span id="Expr-1537"><a href="#Expr-1537"><span class="linenos">1537</span></a>                <span class="n">l</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
</span><span id="Expr-1538"><a href="#Expr-1538"><span class="linenos">1538</span></a>                <span class="n">sub</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
</span><span id="Expr-1539"><a href="#Expr-1539"><span class="linenos">1539</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="o">-</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
</span><span id="Expr-1540"><a href="#Expr-1540"><span class="linenos">1540</span></a>                <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="n">sub</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)):</span>
</span><span id="Expr-1541"><a href="#Expr-1541"><span class="linenos">1541</span></a>                    <span class="k">break</span>
</span><span id="Expr-1542"><a href="#Expr-1542"><span class="linenos">1542</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Expr-1543"><a href="#Expr-1543"><span class="linenos">1543</span></a>                <span class="n">i</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Expr-1544"><a href="#Expr-1544"><span class="linenos">1544</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">first</span><span class="p">:</span>
</span><span id="Expr-1545"><a href="#Expr-1545"><span class="linenos">1545</span></a>                <span class="n">l</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
</span><span id="Expr-1546"><a href="#Expr-1546"><span class="linenos">1546</span></a>                <span class="n">sub</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
</span><span id="Expr-1547"><a href="#Expr-1547"><span class="linenos">1547</span></a>            <span class="k">if</span> <span class="n">i</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">first</span><span class="p">:</span>
</span><span id="Expr-1548"><a href="#Expr-1548"><span class="linenos">1548</span></a>                <span class="n">i</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="n">n</span><span class="p">)</span>
</span><span id="Expr-1549"><a href="#Expr-1549"><span class="linenos">1549</span></a>            <span class="k">return</span> <span class="n">i</span>
</span><span id="Expr-1550"><a href="#Expr-1550"><span class="linenos">1550</span></a>
</span><span id="Expr-1551"><a href="#Expr-1551"><span class="linenos">1551</span></a>        <span class="n">co</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Expr-1552"><a href="#Expr-1552"><span class="linenos">1552</span></a>        <span class="n">args</span> <span class="o">=</span> <span class="n">Add</span><span class="o">.</span><span class="n">make_args</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="Expr-1553"><a href="#Expr-1553"><span class="linenos">1553</span></a>        <span class="n">self_c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_commutative</span>
</span><span id="Expr-1554"><a href="#Expr-1554"><span class="linenos">1554</span></a>        <span class="n">x_c</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">is_commutative</span>
</span><span id="Expr-1555"><a href="#Expr-1555"><span class="linenos">1555</span></a>        <span class="k">if</span> <span class="n">self_c</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">x_c</span><span class="p">:</span>
</span><span id="Expr-1556"><a href="#Expr-1556"><span class="linenos">1556</span></a>            <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">Zero</span>
</span><span id="Expr-1557"><a href="#Expr-1557"><span class="linenos">1557</span></a>        <span class="k">if</span> <span class="n">_first</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_Add</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">self_c</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">x_c</span><span class="p">:</span>
</span><span id="Expr-1558"><a href="#Expr-1558"><span class="linenos">1558</span></a>            <span class="c1"># get the part that depends on x exactly</span>
</span><span id="Expr-1559"><a href="#Expr-1559"><span class="linenos">1559</span></a>            <span class="n">xargs</span> <span class="o">=</span> <span class="n">Mul</span><span class="o">.</span><span class="n">make_args</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span><span id="Expr-1560"><a href="#Expr-1560"><span class="linenos">1560</span></a>            <span class="n">d</span> <span class="o">=</span> <span class="n">Add</span><span class="p">(</span><span class="o">*</span><span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">Add</span><span class="o">.</span><span class="n">make_args</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">as_independent</span><span class="p">(</span><span class="n">x</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="Expr-1561"><a href="#Expr-1561"><span class="linenos">1561</span></a>                <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="n">xi</span> <span class="ow">in</span> <span class="n">Mul</span><span class="o">.</span><span class="n">make_args</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">xi</span> <span class="ow">in</span> <span class="n">xargs</span><span class="p">)])</span>
</span><span id="Expr-1562"><a href="#Expr-1562"><span class="linenos">1562</span></a>            <span class="n">rv</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">coeff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="n">right</span><span class="p">,</span> <span class="n">_first</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="Expr-1563"><a href="#Expr-1563"><span class="linenos">1563</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">rv</span><span class="o">.</span><span class="n">is_Add</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">right</span><span class="p">:</span>
</span><span id="Expr-1564"><a href="#Expr-1564"><span class="linenos">1564</span></a>                <span class="k">return</span> <span class="n">rv</span>
</span><span id="Expr-1565"><a href="#Expr-1565"><span class="linenos">1565</span></a>            <span class="n">c_part</span><span class="p">,</span> <span class="n">nc_part</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">args_cnc</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">rv</span><span class="o">.</span><span class="n">args</span><span class="p">])</span>
</span><span id="Expr-1566"><a href="#Expr-1566"><span class="linenos">1566</span></a>            <span class="k">if</span> <span class="n">has_variety</span><span class="p">(</span><span class="n">c_part</span><span class="p">):</span>
</span><span id="Expr-1567"><a href="#Expr-1567"><span class="linenos">1567</span></a>                <span class="k">return</span> <span class="n">rv</span>
</span><span id="Expr-1568"><a href="#Expr-1568"><span class="linenos">1568</span></a>            <span class="k">return</span> <span class="n">Add</span><span class="p">(</span><span class="o">*</span><span class="p">[</span><span class="n">Mul</span><span class="o">.</span><span class="n">_from_args</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">nc_part</span><span class="p">])</span>
</span><span id="Expr-1569"><a href="#Expr-1569"><span class="linenos">1569</span></a>
</span><span id="Expr-1570"><a href="#Expr-1570"><span class="linenos">1570</span></a>        <span class="n">one_c</span> <span class="o">=</span> <span class="n">self_c</span> <span class="ow">or</span> <span class="n">x_c</span>
</span><span id="Expr-1571"><a href="#Expr-1571"><span class="linenos">1571</span></a>        <span class="n">xargs</span><span class="p">,</span> <span class="n">nx</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">args_cnc</span><span class="p">(</span><span class="n">cset</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">warn</span><span class="o">=</span><span class="nb">bool</span><span class="p">(</span><span class="ow">not</span> <span class="n">x_c</span><span class="p">))</span>
</span><span id="Expr-1572"><a href="#Expr-1572"><span class="linenos">1572</span></a>        <span class="c1"># find the parts that pass the commutative terms</span>
</span><span id="Expr-1573"><a href="#Expr-1573"><span class="linenos">1573</span></a>        <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">args</span><span class="p">:</span>
</span><span id="Expr-1574"><a href="#Expr-1574"><span class="linenos">1574</span></a>            <span class="n">margs</span><span class="p">,</span> <span class="n">nc</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">args_cnc</span><span class="p">(</span><span class="n">cset</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">warn</span><span class="o">=</span><span class="nb">bool</span><span class="p">(</span><span class="ow">not</span> <span class="n">self_c</span><span class="p">))</span>
</span><span id="Expr-1575"><a href="#Expr-1575"><span class="linenos">1575</span></a>            <span class="k">if</span> <span class="n">nc</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Expr-1576"><a href="#Expr-1576"><span class="linenos">1576</span></a>                <span class="n">nc</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Expr-1577"><a href="#Expr-1577"><span class="linenos">1577</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">xargs</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">margs</span><span class="p">):</span>
</span><span id="Expr-1578"><a href="#Expr-1578"><span class="linenos">1578</span></a>                <span class="k">continue</span>
</span><span id="Expr-1579"><a href="#Expr-1579"><span class="linenos">1579</span></a>            <span class="n">resid</span> <span class="o">=</span> <span class="n">margs</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="n">xargs</span><span class="p">)</span>
</span><span id="Expr-1580"><a href="#Expr-1580"><span class="linenos">1580</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">resid</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">xargs</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">margs</span><span class="p">):</span>
</span><span id="Expr-1581"><a href="#Expr-1581"><span class="linenos">1581</span></a>                <span class="k">if</span> <span class="n">one_c</span><span class="p">:</span>
</span><span id="Expr-1582"><a href="#Expr-1582"><span class="linenos">1582</span></a>                    <span class="n">co</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Mul</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">resid</span><span class="p">)</span> <span class="o">+</span> <span class="n">nc</span><span class="p">)))</span>
</span><span id="Expr-1583"><a href="#Expr-1583"><span class="linenos">1583</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="Expr-1584"><a href="#Expr-1584"><span class="linenos">1584</span></a>                    <span class="n">co</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">resid</span><span class="p">,</span> <span class="n">nc</span><span class="p">))</span>
</span><span id="Expr-1585"><a href="#Expr-1585"><span class="linenos">1585</span></a>        <span class="k">if</span> <span class="n">one_c</span><span class="p">:</span>
</span><span id="Expr-1586"><a href="#Expr-1586"><span class="linenos">1586</span></a>            <span class="k">if</span> <span class="n">co</span> <span class="o">==</span> <span class="p">[]:</span>
</span><span id="Expr-1587"><a href="#Expr-1587"><span class="linenos">1587</span></a>                <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">Zero</span>
</span><span id="Expr-1588"><a href="#Expr-1588"><span class="linenos">1588</span></a>            <span class="k">elif</span> <span class="n">co</span><span class="p">:</span>
</span><span id="Expr-1589"><a href="#Expr-1589"><span class="linenos">1589</span></a>                <span class="k">return</span> <span class="n">Add</span><span class="p">(</span><span class="o">*</span><span class="n">co</span><span class="p">)</span>
</span><span id="Expr-1590"><a href="#Expr-1590"><span class="linenos">1590</span></a>        <span class="k">else</span><span class="p">:</span>  <span class="c1"># both nc</span>
</span><span id="Expr-1591"><a href="#Expr-1591"><span class="linenos">1591</span></a>            <span class="c1"># now check the non-comm parts</span>
</span><span id="Expr-1592"><a href="#Expr-1592"><span class="linenos">1592</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">co</span><span class="p">:</span>
</span><span id="Expr-1593"><a href="#Expr-1593"><span class="linenos">1593</span></a>                <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">Zero</span>
</span><span id="Expr-1594"><a href="#Expr-1594"><span class="linenos">1594</span></a>            <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="n">n</span> <span class="o">==</span> <span class="n">co</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">r</span><span class="p">,</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">co</span><span class="p">):</span>
</span><span id="Expr-1595"><a href="#Expr-1595"><span class="linenos">1595</span></a>                <span class="n">ii</span> <span class="o">=</span> <span class="n">find</span><span class="p">(</span><span class="n">co</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">nx</span><span class="p">,</span> <span class="n">right</span><span class="p">)</span>
</span><span id="Expr-1596"><a href="#Expr-1596"><span class="linenos">1596</span></a>                <span class="k">if</span> <span class="n">ii</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Expr-1597"><a href="#Expr-1597"><span class="linenos">1597</span></a>                    <span class="k">if</span> <span class="ow">not</span> <span class="n">right</span><span class="p">:</span>
</span><span id="Expr-1598"><a href="#Expr-1598"><span class="linenos">1598</span></a>                        <span class="k">return</span> <span class="n">Mul</span><span class="p">(</span><span class="n">Add</span><span class="p">(</span><span class="o">*</span><span class="p">[</span><span class="n">Mul</span><span class="p">(</span><span class="o">*</span><span class="n">r</span><span class="p">)</span> <span class="k">for</span> <span class="n">r</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">co</span><span class="p">]),</span> <span class="n">Mul</span><span class="p">(</span><span class="o">*</span><span class="n">co</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">][:</span><span class="n">ii</span><span class="p">]))</span>
</span><span id="Expr-1599"><a href="#Expr-1599"><span class="linenos">1599</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="Expr-1600"><a href="#Expr-1600"><span class="linenos">1600</span></a>                        <span class="k">return</span> <span class="n">Mul</span><span class="p">(</span><span class="o">*</span><span class="n">co</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="n">ii</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">nx</span><span class="p">):])</span>
</span><span id="Expr-1601"><a href="#Expr-1601"><span class="linenos">1601</span></a>            <span class="n">beg</span> <span class="o">=</span> <span class="n">reduce</span><span class="p">(</span><span class="n">incommon</span><span class="p">,</span> <span class="p">(</span><span class="n">n</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">co</span><span class="p">))</span>
</span><span id="Expr-1602"><a href="#Expr-1602"><span class="linenos">1602</span></a>            <span class="k">if</span> <span class="n">beg</span><span class="p">:</span>
</span><span id="Expr-1603"><a href="#Expr-1603"><span class="linenos">1603</span></a>                <span class="n">ii</span> <span class="o">=</span> <span class="n">find</span><span class="p">(</span><span class="n">beg</span><span class="p">,</span> <span class="n">nx</span><span class="p">,</span> <span class="n">right</span><span class="p">)</span>
</span><span id="Expr-1604"><a href="#Expr-1604"><span class="linenos">1604</span></a>                <span class="k">if</span> <span class="n">ii</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Expr-1605"><a href="#Expr-1605"><span class="linenos">1605</span></a>                    <span class="k">if</span> <span class="ow">not</span> <span class="n">right</span><span class="p">:</span>
</span><span id="Expr-1606"><a href="#Expr-1606"><span class="linenos">1606</span></a>                        <span class="n">gcdc</span> <span class="o">=</span> <span class="n">co</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Expr-1607"><a href="#Expr-1607"><span class="linenos">1607</span></a>                        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">co</span><span class="p">)):</span>
</span><span id="Expr-1608"><a href="#Expr-1608"><span class="linenos">1608</span></a>                            <span class="n">gcdc</span> <span class="o">=</span> <span class="n">gcdc</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">co</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
</span><span id="Expr-1609"><a href="#Expr-1609"><span class="linenos">1609</span></a>                            <span class="k">if</span> <span class="ow">not</span> <span class="n">gcdc</span><span class="p">:</span>
</span><span id="Expr-1610"><a href="#Expr-1610"><span class="linenos">1610</span></a>                                <span class="k">break</span>
</span><span id="Expr-1611"><a href="#Expr-1611"><span class="linenos">1611</span></a>                        <span class="k">return</span> <span class="n">Mul</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">gcdc</span><span class="p">)</span> <span class="o">+</span> <span class="n">beg</span><span class="p">[:</span><span class="n">ii</span><span class="p">]))</span>
</span><span id="Expr-1612"><a href="#Expr-1612"><span class="linenos">1612</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="Expr-1613"><a href="#Expr-1613"><span class="linenos">1613</span></a>                        <span class="n">m</span> <span class="o">=</span> <span class="n">ii</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">nx</span><span class="p">)</span>
</span><span id="Expr-1614"><a href="#Expr-1614"><span class="linenos">1614</span></a>                        <span class="k">return</span> <span class="n">Add</span><span class="p">(</span><span class="o">*</span><span class="p">[</span><span class="n">Mul</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="o">+</span> <span class="n">n</span><span class="p">[</span><span class="n">m</span><span class="p">:]))</span> <span class="k">for</span> <span class="n">r</span><span class="p">,</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">co</span><span class="p">])</span>
</span><span id="Expr-1615"><a href="#Expr-1615"><span class="linenos">1615</span></a>            <span class="n">end</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span>
</span><span id="Expr-1616"><a href="#Expr-1616"><span class="linenos">1616</span></a>                <span class="n">reduce</span><span class="p">(</span><span class="n">incommon</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="n">n</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">co</span><span class="p">))))</span>
</span><span id="Expr-1617"><a href="#Expr-1617"><span class="linenos">1617</span></a>            <span class="k">if</span> <span class="n">end</span><span class="p">:</span>
</span><span id="Expr-1618"><a href="#Expr-1618"><span class="linenos">1618</span></a>                <span class="n">ii</span> <span class="o">=</span> <span class="n">find</span><span class="p">(</span><span class="n">end</span><span class="p">,</span> <span class="n">nx</span><span class="p">,</span> <span class="n">right</span><span class="p">)</span>
</span><span id="Expr-1619"><a href="#Expr-1619"><span class="linenos">1619</span></a>                <span class="k">if</span> <span class="n">ii</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Expr-1620"><a href="#Expr-1620"><span class="linenos">1620</span></a>                    <span class="k">if</span> <span class="ow">not</span> <span class="n">right</span><span class="p">:</span>
</span><span id="Expr-1621"><a href="#Expr-1621"><span class="linenos">1621</span></a>                        <span class="k">return</span> <span class="n">Add</span><span class="p">(</span><span class="o">*</span><span class="p">[</span><span class="n">Mul</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="o">+</span> <span class="n">n</span><span class="p">[:</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">end</span><span class="p">)</span> <span class="o">+</span> <span class="n">ii</span><span class="p">]))</span> <span class="k">for</span> <span class="n">r</span><span class="p">,</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">co</span><span class="p">])</span>
</span><span id="Expr-1622"><a href="#Expr-1622"><span class="linenos">1622</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="Expr-1623"><a href="#Expr-1623"><span class="linenos">1623</span></a>                        <span class="k">return</span> <span class="n">Mul</span><span class="p">(</span><span class="o">*</span><span class="n">end</span><span class="p">[</span><span class="n">ii</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">nx</span><span class="p">):])</span>
</span><span id="Expr-1624"><a href="#Expr-1624"><span class="linenos">1624</span></a>            <span class="c1"># look for single match</span>
</span><span id="Expr-1625"><a href="#Expr-1625"><span class="linenos">1625</span></a>            <span class="n">hit</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Expr-1626"><a href="#Expr-1626"><span class="linenos">1626</span></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">co</span><span class="p">):</span>
</span><span id="Expr-1627"><a href="#Expr-1627"><span class="linenos">1627</span></a>                <span class="n">ii</span> <span class="o">=</span> <span class="n">find</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">nx</span><span class="p">,</span> <span class="n">right</span><span class="p">)</span>
</span><span id="Expr-1628"><a href="#Expr-1628"><span class="linenos">1628</span></a>                <span class="k">if</span> <span class="n">ii</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Expr-1629"><a href="#Expr-1629"><span class="linenos">1629</span></a>                    <span class="k">if</span> <span class="ow">not</span> <span class="n">hit</span><span class="p">:</span>
</span><span id="Expr-1630"><a href="#Expr-1630"><span class="linenos">1630</span></a>                        <span class="n">hit</span> <span class="o">=</span> <span class="n">ii</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">n</span>
</span><span id="Expr-1631"><a href="#Expr-1631"><span class="linenos">1631</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="Expr-1632"><a href="#Expr-1632"><span class="linenos">1632</span></a>                        <span class="k">break</span>
</span><span id="Expr-1633"><a href="#Expr-1633"><span class="linenos">1633</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Expr-1634"><a href="#Expr-1634"><span class="linenos">1634</span></a>                <span class="k">if</span> <span class="n">hit</span><span class="p">:</span>
</span><span id="Expr-1635"><a href="#Expr-1635"><span class="linenos">1635</span></a>                    <span class="n">ii</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="n">hit</span>
</span><span id="Expr-1636"><a href="#Expr-1636"><span class="linenos">1636</span></a>                    <span class="k">if</span> <span class="ow">not</span> <span class="n">right</span><span class="p">:</span>
</span><span id="Expr-1637"><a href="#Expr-1637"><span class="linenos">1637</span></a>                        <span class="k">return</span> <span class="n">Mul</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="o">+</span> <span class="n">n</span><span class="p">[:</span><span class="n">ii</span><span class="p">]))</span>
</span><span id="Expr-1638"><a href="#Expr-1638"><span class="linenos">1638</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="Expr-1639"><a href="#Expr-1639"><span class="linenos">1639</span></a>                        <span class="k">return</span> <span class="n">Mul</span><span class="p">(</span><span class="o">*</span><span class="n">n</span><span class="p">[</span><span class="n">ii</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">nx</span><span class="p">):])</span>
</span><span id="Expr-1640"><a href="#Expr-1640"><span class="linenos">1640</span></a>
</span><span id="Expr-1641"><a href="#Expr-1641"><span class="linenos">1641</span></a>            <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">Zero</span>
</span><span id="Expr-1642"><a href="#Expr-1642"><span class="linenos">1642</span></a>
</span><span id="Expr-1643"><a href="#Expr-1643"><span class="linenos">1643</span></a>    <span class="k">def</span> <span class="nf">as_expr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">gens</span><span class="p">):</span>
</span><span id="Expr-1644"><a href="#Expr-1644"><span class="linenos">1644</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Expr-1645"><a href="#Expr-1645"><span class="linenos">1645</span></a><span class="sd">        Convert a polynomial to a SymPy expression.</span>
</span><span id="Expr-1646"><a href="#Expr-1646"><span class="linenos">1646</span></a>
</span><span id="Expr-1647"><a href="#Expr-1647"><span class="linenos">1647</span></a><span class="sd">        Examples</span>
</span><span id="Expr-1648"><a href="#Expr-1648"><span class="linenos">1648</span></a><span class="sd">        ========</span>
</span><span id="Expr-1649"><a href="#Expr-1649"><span class="linenos">1649</span></a>
</span><span id="Expr-1650"><a href="#Expr-1650"><span class="linenos">1650</span></a><span class="sd">        &gt;&gt;&gt; from sympy import sin</span>
</span><span id="Expr-1651"><a href="#Expr-1651"><span class="linenos">1651</span></a><span class="sd">        &gt;&gt;&gt; from sympy.abc import x, y</span>
</span><span id="Expr-1652"><a href="#Expr-1652"><span class="linenos">1652</span></a>
</span><span id="Expr-1653"><a href="#Expr-1653"><span class="linenos">1653</span></a><span class="sd">        &gt;&gt;&gt; f = (x**2 + x*y).as_poly(x, y)</span>
</span><span id="Expr-1654"><a href="#Expr-1654"><span class="linenos">1654</span></a><span class="sd">        &gt;&gt;&gt; f.as_expr()</span>
</span><span id="Expr-1655"><a href="#Expr-1655"><span class="linenos">1655</span></a><span class="sd">        x**2 + x*y</span>
</span><span id="Expr-1656"><a href="#Expr-1656"><span class="linenos">1656</span></a>
</span><span id="Expr-1657"><a href="#Expr-1657"><span class="linenos">1657</span></a><span class="sd">        &gt;&gt;&gt; sin(x).as_expr()</span>
</span><span id="Expr-1658"><a href="#Expr-1658"><span class="linenos">1658</span></a><span class="sd">        sin(x)</span>
</span><span id="Expr-1659"><a href="#Expr-1659"><span class="linenos">1659</span></a>
</span><span id="Expr-1660"><a href="#Expr-1660"><span class="linenos">1660</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Expr-1661"><a href="#Expr-1661"><span class="linenos">1661</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span><span id="Expr-1662"><a href="#Expr-1662"><span class="linenos">1662</span></a>
</span><span id="Expr-1663"><a href="#Expr-1663"><span class="linenos">1663</span></a>    <span class="k">def</span> <span class="nf">as_coefficient</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
</span><span id="Expr-1664"><a href="#Expr-1664"><span class="linenos">1664</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Expr-1665"><a href="#Expr-1665"><span class="linenos">1665</span></a><span class="sd">        Extracts symbolic coefficient at the given expression. In</span>
</span><span id="Expr-1666"><a href="#Expr-1666"><span class="linenos">1666</span></a><span class="sd">        other words, this functions separates &#39;self&#39; into the product</span>
</span><span id="Expr-1667"><a href="#Expr-1667"><span class="linenos">1667</span></a><span class="sd">        of &#39;expr&#39; and &#39;expr&#39;-free coefficient. If such separation</span>
</span><span id="Expr-1668"><a href="#Expr-1668"><span class="linenos">1668</span></a><span class="sd">        is not possible it will return None.</span>
</span><span id="Expr-1669"><a href="#Expr-1669"><span class="linenos">1669</span></a>
</span><span id="Expr-1670"><a href="#Expr-1670"><span class="linenos">1670</span></a><span class="sd">        Examples</span>
</span><span id="Expr-1671"><a href="#Expr-1671"><span class="linenos">1671</span></a><span class="sd">        ========</span>
</span><span id="Expr-1672"><a href="#Expr-1672"><span class="linenos">1672</span></a>
</span><span id="Expr-1673"><a href="#Expr-1673"><span class="linenos">1673</span></a><span class="sd">        &gt;&gt;&gt; from sympy import E, pi, sin, I, Poly</span>
</span><span id="Expr-1674"><a href="#Expr-1674"><span class="linenos">1674</span></a><span class="sd">        &gt;&gt;&gt; from sympy.abc import x</span>
</span><span id="Expr-1675"><a href="#Expr-1675"><span class="linenos">1675</span></a>
</span><span id="Expr-1676"><a href="#Expr-1676"><span class="linenos">1676</span></a><span class="sd">        &gt;&gt;&gt; E.as_coefficient(E)</span>
</span><span id="Expr-1677"><a href="#Expr-1677"><span class="linenos">1677</span></a><span class="sd">        1</span>
</span><span id="Expr-1678"><a href="#Expr-1678"><span class="linenos">1678</span></a><span class="sd">        &gt;&gt;&gt; (2*E).as_coefficient(E)</span>
</span><span id="Expr-1679"><a href="#Expr-1679"><span class="linenos">1679</span></a><span class="sd">        2</span>
</span><span id="Expr-1680"><a href="#Expr-1680"><span class="linenos">1680</span></a><span class="sd">        &gt;&gt;&gt; (2*sin(E)*E).as_coefficient(E)</span>
</span><span id="Expr-1681"><a href="#Expr-1681"><span class="linenos">1681</span></a>
</span><span id="Expr-1682"><a href="#Expr-1682"><span class="linenos">1682</span></a><span class="sd">        Two terms have E in them so a sum is returned. (If one were</span>
</span><span id="Expr-1683"><a href="#Expr-1683"><span class="linenos">1683</span></a><span class="sd">        desiring the coefficient of the term exactly matching E then</span>
</span><span id="Expr-1684"><a href="#Expr-1684"><span class="linenos">1684</span></a><span class="sd">        the constant from the returned expression could be selected.</span>
</span><span id="Expr-1685"><a href="#Expr-1685"><span class="linenos">1685</span></a><span class="sd">        Or, for greater precision, a method of Poly can be used to</span>
</span><span id="Expr-1686"><a href="#Expr-1686"><span class="linenos">1686</span></a><span class="sd">        indicate the desired term from which the coefficient is</span>
</span><span id="Expr-1687"><a href="#Expr-1687"><span class="linenos">1687</span></a><span class="sd">        desired.)</span>
</span><span id="Expr-1688"><a href="#Expr-1688"><span class="linenos">1688</span></a>
</span><span id="Expr-1689"><a href="#Expr-1689"><span class="linenos">1689</span></a><span class="sd">        &gt;&gt;&gt; (2*E + x*E).as_coefficient(E)</span>
</span><span id="Expr-1690"><a href="#Expr-1690"><span class="linenos">1690</span></a><span class="sd">        x + 2</span>
</span><span id="Expr-1691"><a href="#Expr-1691"><span class="linenos">1691</span></a><span class="sd">        &gt;&gt;&gt; _.args[0]  # just want the exact match</span>
</span><span id="Expr-1692"><a href="#Expr-1692"><span class="linenos">1692</span></a><span class="sd">        2</span>
</span><span id="Expr-1693"><a href="#Expr-1693"><span class="linenos">1693</span></a><span class="sd">        &gt;&gt;&gt; p = Poly(2*E + x*E); p</span>
</span><span id="Expr-1694"><a href="#Expr-1694"><span class="linenos">1694</span></a><span class="sd">        Poly(x*E + 2*E, x, E, domain=&#39;ZZ&#39;)</span>
</span><span id="Expr-1695"><a href="#Expr-1695"><span class="linenos">1695</span></a><span class="sd">        &gt;&gt;&gt; p.coeff_monomial(E)</span>
</span><span id="Expr-1696"><a href="#Expr-1696"><span class="linenos">1696</span></a><span class="sd">        2</span>
</span><span id="Expr-1697"><a href="#Expr-1697"><span class="linenos">1697</span></a><span class="sd">        &gt;&gt;&gt; p.nth(0, 1)</span>
</span><span id="Expr-1698"><a href="#Expr-1698"><span class="linenos">1698</span></a><span class="sd">        2</span>
</span><span id="Expr-1699"><a href="#Expr-1699"><span class="linenos">1699</span></a>
</span><span id="Expr-1700"><a href="#Expr-1700"><span class="linenos">1700</span></a><span class="sd">        Since the following cannot be written as a product containing</span>
</span><span id="Expr-1701"><a href="#Expr-1701"><span class="linenos">1701</span></a><span class="sd">        E as a factor, None is returned. (If the coefficient ``2*x`` is</span>
</span><span id="Expr-1702"><a href="#Expr-1702"><span class="linenos">1702</span></a><span class="sd">        desired then the ``coeff`` method should be used.)</span>
</span><span id="Expr-1703"><a href="#Expr-1703"><span class="linenos">1703</span></a>
</span><span id="Expr-1704"><a href="#Expr-1704"><span class="linenos">1704</span></a><span class="sd">        &gt;&gt;&gt; (2*E*x + x).as_coefficient(E)</span>
</span><span id="Expr-1705"><a href="#Expr-1705"><span class="linenos">1705</span></a><span class="sd">        &gt;&gt;&gt; (2*E*x + x).coeff(E)</span>
</span><span id="Expr-1706"><a href="#Expr-1706"><span class="linenos">1706</span></a><span class="sd">        2*x</span>
</span><span id="Expr-1707"><a href="#Expr-1707"><span class="linenos">1707</span></a>
</span><span id="Expr-1708"><a href="#Expr-1708"><span class="linenos">1708</span></a><span class="sd">        &gt;&gt;&gt; (E*(x + 1) + x).as_coefficient(E)</span>
</span><span id="Expr-1709"><a href="#Expr-1709"><span class="linenos">1709</span></a>
</span><span id="Expr-1710"><a href="#Expr-1710"><span class="linenos">1710</span></a><span class="sd">        &gt;&gt;&gt; (2*pi*I).as_coefficient(pi*I)</span>
</span><span id="Expr-1711"><a href="#Expr-1711"><span class="linenos">1711</span></a><span class="sd">        2</span>
</span><span id="Expr-1712"><a href="#Expr-1712"><span class="linenos">1712</span></a><span class="sd">        &gt;&gt;&gt; (2*I).as_coefficient(pi*I)</span>
</span><span id="Expr-1713"><a href="#Expr-1713"><span class="linenos">1713</span></a>
</span><span id="Expr-1714"><a href="#Expr-1714"><span class="linenos">1714</span></a><span class="sd">        See Also</span>
</span><span id="Expr-1715"><a href="#Expr-1715"><span class="linenos">1715</span></a><span class="sd">        ========</span>
</span><span id="Expr-1716"><a href="#Expr-1716"><span class="linenos">1716</span></a>
</span><span id="Expr-1717"><a href="#Expr-1717"><span class="linenos">1717</span></a><span class="sd">        coeff: return sum of terms have a given factor</span>
</span><span id="Expr-1718"><a href="#Expr-1718"><span class="linenos">1718</span></a><span class="sd">        as_coeff_Add: separate the additive constant from an expression</span>
</span><span id="Expr-1719"><a href="#Expr-1719"><span class="linenos">1719</span></a><span class="sd">        as_coeff_Mul: separate the multiplicative constant from an expression</span>
</span><span id="Expr-1720"><a href="#Expr-1720"><span class="linenos">1720</span></a><span class="sd">        as_independent: separate x-dependent terms/factors from others</span>
</span><span id="Expr-1721"><a href="#Expr-1721"><span class="linenos">1721</span></a><span class="sd">        sympy.polys.polytools.Poly.coeff_monomial: efficiently find the single coefficient of a monomial in Poly</span>
</span><span id="Expr-1722"><a href="#Expr-1722"><span class="linenos">1722</span></a><span class="sd">        sympy.polys.polytools.Poly.nth: like coeff_monomial but powers of monomial terms are used</span>
</span><span id="Expr-1723"><a href="#Expr-1723"><span class="linenos">1723</span></a>
</span><span id="Expr-1724"><a href="#Expr-1724"><span class="linenos">1724</span></a>
</span><span id="Expr-1725"><a href="#Expr-1725"><span class="linenos">1725</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Expr-1726"><a href="#Expr-1726"><span class="linenos">1726</span></a>
</span><span id="Expr-1727"><a href="#Expr-1727"><span class="linenos">1727</span></a>        <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">extract_multiplicatively</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span>
</span><span id="Expr-1728"><a href="#Expr-1728"><span class="linenos">1728</span></a>        <span class="k">if</span> <span class="n">r</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">r</span><span class="o">.</span><span class="n">has</span><span class="p">(</span><span class="n">expr</span><span class="p">):</span>
</span><span id="Expr-1729"><a href="#Expr-1729"><span class="linenos">1729</span></a>            <span class="k">return</span> <span class="n">r</span>
</span><span id="Expr-1730"><a href="#Expr-1730"><span class="linenos">1730</span></a>
</span><span id="Expr-1731"><a href="#Expr-1731"><span class="linenos">1731</span></a>    <span class="k">def</span> <span class="nf">as_independent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">deps</span><span class="p">,</span> <span class="o">**</span><span class="n">hint</span><span class="p">):</span>
</span><span id="Expr-1732"><a href="#Expr-1732"><span class="linenos">1732</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Expr-1733"><a href="#Expr-1733"><span class="linenos">1733</span></a><span class="sd">        A mostly naive separation of a Mul or Add into arguments that are not</span>
</span><span id="Expr-1734"><a href="#Expr-1734"><span class="linenos">1734</span></a><span class="sd">        are dependent on deps. To obtain as complete a separation of variables</span>
</span><span id="Expr-1735"><a href="#Expr-1735"><span class="linenos">1735</span></a><span class="sd">        as possible, use a separation method first, e.g.:</span>
</span><span id="Expr-1736"><a href="#Expr-1736"><span class="linenos">1736</span></a>
</span><span id="Expr-1737"><a href="#Expr-1737"><span class="linenos">1737</span></a><span class="sd">        * separatevars() to change Mul, Add and Pow (including exp) into Mul</span>
</span><span id="Expr-1738"><a href="#Expr-1738"><span class="linenos">1738</span></a><span class="sd">        * .expand(mul=True) to change Add or Mul into Add</span>
</span><span id="Expr-1739"><a href="#Expr-1739"><span class="linenos">1739</span></a><span class="sd">        * .expand(log=True) to change log expr into an Add</span>
</span><span id="Expr-1740"><a href="#Expr-1740"><span class="linenos">1740</span></a>
</span><span id="Expr-1741"><a href="#Expr-1741"><span class="linenos">1741</span></a><span class="sd">        The only non-naive thing that is done here is to respect noncommutative</span>
</span><span id="Expr-1742"><a href="#Expr-1742"><span class="linenos">1742</span></a><span class="sd">        ordering of variables and to always return (0, 0) for `self` of zero</span>
</span><span id="Expr-1743"><a href="#Expr-1743"><span class="linenos">1743</span></a><span class="sd">        regardless of hints.</span>
</span><span id="Expr-1744"><a href="#Expr-1744"><span class="linenos">1744</span></a>
</span><span id="Expr-1745"><a href="#Expr-1745"><span class="linenos">1745</span></a><span class="sd">        For nonzero `self`, the returned tuple (i, d) has the</span>
</span><span id="Expr-1746"><a href="#Expr-1746"><span class="linenos">1746</span></a><span class="sd">        following interpretation:</span>
</span><span id="Expr-1747"><a href="#Expr-1747"><span class="linenos">1747</span></a>
</span><span id="Expr-1748"><a href="#Expr-1748"><span class="linenos">1748</span></a><span class="sd">        * i will has no variable that appears in deps</span>
</span><span id="Expr-1749"><a href="#Expr-1749"><span class="linenos">1749</span></a><span class="sd">        * d will either have terms that contain variables that are in deps, or</span>
</span><span id="Expr-1750"><a href="#Expr-1750"><span class="linenos">1750</span></a><span class="sd">          be equal to 0 (when self is an Add) or 1 (when self is a Mul)</span>
</span><span id="Expr-1751"><a href="#Expr-1751"><span class="linenos">1751</span></a><span class="sd">        * if self is an Add then self = i + d</span>
</span><span id="Expr-1752"><a href="#Expr-1752"><span class="linenos">1752</span></a><span class="sd">        * if self is a Mul then self = i*d</span>
</span><span id="Expr-1753"><a href="#Expr-1753"><span class="linenos">1753</span></a><span class="sd">        * otherwise (self, S.One) or (S.One, self) is returned.</span>
</span><span id="Expr-1754"><a href="#Expr-1754"><span class="linenos">1754</span></a>
</span><span id="Expr-1755"><a href="#Expr-1755"><span class="linenos">1755</span></a><span class="sd">        To force the expression to be treated as an Add, use the hint as_Add=True</span>
</span><span id="Expr-1756"><a href="#Expr-1756"><span class="linenos">1756</span></a>
</span><span id="Expr-1757"><a href="#Expr-1757"><span class="linenos">1757</span></a><span class="sd">        Examples</span>
</span><span id="Expr-1758"><a href="#Expr-1758"><span class="linenos">1758</span></a><span class="sd">        ========</span>
</span><span id="Expr-1759"><a href="#Expr-1759"><span class="linenos">1759</span></a>
</span><span id="Expr-1760"><a href="#Expr-1760"><span class="linenos">1760</span></a><span class="sd">        -- self is an Add</span>
</span><span id="Expr-1761"><a href="#Expr-1761"><span class="linenos">1761</span></a>
</span><span id="Expr-1762"><a href="#Expr-1762"><span class="linenos">1762</span></a><span class="sd">        &gt;&gt;&gt; from sympy import sin, cos, exp</span>
</span><span id="Expr-1763"><a href="#Expr-1763"><span class="linenos">1763</span></a><span class="sd">        &gt;&gt;&gt; from sympy.abc import x, y, z</span>
</span><span id="Expr-1764"><a href="#Expr-1764"><span class="linenos">1764</span></a>
</span><span id="Expr-1765"><a href="#Expr-1765"><span class="linenos">1765</span></a><span class="sd">        &gt;&gt;&gt; (x + x*y).as_independent(x)</span>
</span><span id="Expr-1766"><a href="#Expr-1766"><span class="linenos">1766</span></a><span class="sd">        (0, x*y + x)</span>
</span><span id="Expr-1767"><a href="#Expr-1767"><span class="linenos">1767</span></a><span class="sd">        &gt;&gt;&gt; (x + x*y).as_independent(y)</span>
</span><span id="Expr-1768"><a href="#Expr-1768"><span class="linenos">1768</span></a><span class="sd">        (x, x*y)</span>
</span><span id="Expr-1769"><a href="#Expr-1769"><span class="linenos">1769</span></a><span class="sd">        &gt;&gt;&gt; (2*x*sin(x) + y + x + z).as_independent(x)</span>
</span><span id="Expr-1770"><a href="#Expr-1770"><span class="linenos">1770</span></a><span class="sd">        (y + z, 2*x*sin(x) + x)</span>
</span><span id="Expr-1771"><a href="#Expr-1771"><span class="linenos">1771</span></a><span class="sd">        &gt;&gt;&gt; (2*x*sin(x) + y + x + z).as_independent(x, y)</span>
</span><span id="Expr-1772"><a href="#Expr-1772"><span class="linenos">1772</span></a><span class="sd">        (z, 2*x*sin(x) + x + y)</span>
</span><span id="Expr-1773"><a href="#Expr-1773"><span class="linenos">1773</span></a>
</span><span id="Expr-1774"><a href="#Expr-1774"><span class="linenos">1774</span></a><span class="sd">        -- self is a Mul</span>
</span><span id="Expr-1775"><a href="#Expr-1775"><span class="linenos">1775</span></a>
</span><span id="Expr-1776"><a href="#Expr-1776"><span class="linenos">1776</span></a><span class="sd">        &gt;&gt;&gt; (x*sin(x)*cos(y)).as_independent(x)</span>
</span><span id="Expr-1777"><a href="#Expr-1777"><span class="linenos">1777</span></a><span class="sd">        (cos(y), x*sin(x))</span>
</span><span id="Expr-1778"><a href="#Expr-1778"><span class="linenos">1778</span></a>
</span><span id="Expr-1779"><a href="#Expr-1779"><span class="linenos">1779</span></a><span class="sd">        non-commutative terms cannot always be separated out when self is a Mul</span>
</span><span id="Expr-1780"><a href="#Expr-1780"><span class="linenos">1780</span></a>
</span><span id="Expr-1781"><a href="#Expr-1781"><span class="linenos">1781</span></a><span class="sd">        &gt;&gt;&gt; from sympy import symbols</span>
</span><span id="Expr-1782"><a href="#Expr-1782"><span class="linenos">1782</span></a><span class="sd">        &gt;&gt;&gt; n1, n2, n3 = symbols(&#39;n1 n2 n3&#39;, commutative=False)</span>
</span><span id="Expr-1783"><a href="#Expr-1783"><span class="linenos">1783</span></a><span class="sd">        &gt;&gt;&gt; (n1 + n1*n2).as_independent(n2)</span>
</span><span id="Expr-1784"><a href="#Expr-1784"><span class="linenos">1784</span></a><span class="sd">        (n1, n1*n2)</span>
</span><span id="Expr-1785"><a href="#Expr-1785"><span class="linenos">1785</span></a><span class="sd">        &gt;&gt;&gt; (n2*n1 + n1*n2).as_independent(n2)</span>
</span><span id="Expr-1786"><a href="#Expr-1786"><span class="linenos">1786</span></a><span class="sd">        (0, n1*n2 + n2*n1)</span>
</span><span id="Expr-1787"><a href="#Expr-1787"><span class="linenos">1787</span></a><span class="sd">        &gt;&gt;&gt; (n1*n2*n3).as_independent(n1)</span>
</span><span id="Expr-1788"><a href="#Expr-1788"><span class="linenos">1788</span></a><span class="sd">        (1, n1*n2*n3)</span>
</span><span id="Expr-1789"><a href="#Expr-1789"><span class="linenos">1789</span></a><span class="sd">        &gt;&gt;&gt; (n1*n2*n3).as_independent(n2)</span>
</span><span id="Expr-1790"><a href="#Expr-1790"><span class="linenos">1790</span></a><span class="sd">        (n1, n2*n3)</span>
</span><span id="Expr-1791"><a href="#Expr-1791"><span class="linenos">1791</span></a><span class="sd">        &gt;&gt;&gt; ((x-n1)*(x-y)).as_independent(x)</span>
</span><span id="Expr-1792"><a href="#Expr-1792"><span class="linenos">1792</span></a><span class="sd">        (1, (x - y)*(x - n1))</span>
</span><span id="Expr-1793"><a href="#Expr-1793"><span class="linenos">1793</span></a>
</span><span id="Expr-1794"><a href="#Expr-1794"><span class="linenos">1794</span></a><span class="sd">        -- self is anything else:</span>
</span><span id="Expr-1795"><a href="#Expr-1795"><span class="linenos">1795</span></a>
</span><span id="Expr-1796"><a href="#Expr-1796"><span class="linenos">1796</span></a><span class="sd">        &gt;&gt;&gt; (sin(x)).as_independent(x)</span>
</span><span id="Expr-1797"><a href="#Expr-1797"><span class="linenos">1797</span></a><span class="sd">        (1, sin(x))</span>
</span><span id="Expr-1798"><a href="#Expr-1798"><span class="linenos">1798</span></a><span class="sd">        &gt;&gt;&gt; (sin(x)).as_independent(y)</span>
</span><span id="Expr-1799"><a href="#Expr-1799"><span class="linenos">1799</span></a><span class="sd">        (sin(x), 1)</span>
</span><span id="Expr-1800"><a href="#Expr-1800"><span class="linenos">1800</span></a><span class="sd">        &gt;&gt;&gt; exp(x+y).as_independent(x)</span>
</span><span id="Expr-1801"><a href="#Expr-1801"><span class="linenos">1801</span></a><span class="sd">        (1, exp(x + y))</span>
</span><span id="Expr-1802"><a href="#Expr-1802"><span class="linenos">1802</span></a>
</span><span id="Expr-1803"><a href="#Expr-1803"><span class="linenos">1803</span></a><span class="sd">        -- force self to be treated as an Add:</span>
</span><span id="Expr-1804"><a href="#Expr-1804"><span class="linenos">1804</span></a>
</span><span id="Expr-1805"><a href="#Expr-1805"><span class="linenos">1805</span></a><span class="sd">        &gt;&gt;&gt; (3*x).as_independent(x, as_Add=True)</span>
</span><span id="Expr-1806"><a href="#Expr-1806"><span class="linenos">1806</span></a><span class="sd">        (0, 3*x)</span>
</span><span id="Expr-1807"><a href="#Expr-1807"><span class="linenos">1807</span></a>
</span><span id="Expr-1808"><a href="#Expr-1808"><span class="linenos">1808</span></a><span class="sd">        -- force self to be treated as a Mul:</span>
</span><span id="Expr-1809"><a href="#Expr-1809"><span class="linenos">1809</span></a>
</span><span id="Expr-1810"><a href="#Expr-1810"><span class="linenos">1810</span></a><span class="sd">        &gt;&gt;&gt; (3+x).as_independent(x, as_Add=False)</span>
</span><span id="Expr-1811"><a href="#Expr-1811"><span class="linenos">1811</span></a><span class="sd">        (1, x + 3)</span>
</span><span id="Expr-1812"><a href="#Expr-1812"><span class="linenos">1812</span></a><span class="sd">        &gt;&gt;&gt; (-3+x).as_independent(x, as_Add=False)</span>
</span><span id="Expr-1813"><a href="#Expr-1813"><span class="linenos">1813</span></a><span class="sd">        (1, x - 3)</span>
</span><span id="Expr-1814"><a href="#Expr-1814"><span class="linenos">1814</span></a>
</span><span id="Expr-1815"><a href="#Expr-1815"><span class="linenos">1815</span></a><span class="sd">        Note how the below differs from the above in making the</span>
</span><span id="Expr-1816"><a href="#Expr-1816"><span class="linenos">1816</span></a><span class="sd">        constant on the dep term positive.</span>
</span><span id="Expr-1817"><a href="#Expr-1817"><span class="linenos">1817</span></a>
</span><span id="Expr-1818"><a href="#Expr-1818"><span class="linenos">1818</span></a><span class="sd">        &gt;&gt;&gt; (y*(-3+x)).as_independent(x)</span>
</span><span id="Expr-1819"><a href="#Expr-1819"><span class="linenos">1819</span></a><span class="sd">        (y, x - 3)</span>
</span><span id="Expr-1820"><a href="#Expr-1820"><span class="linenos">1820</span></a>
</span><span id="Expr-1821"><a href="#Expr-1821"><span class="linenos">1821</span></a><span class="sd">        -- use .as_independent() for true independence testing instead</span>
</span><span id="Expr-1822"><a href="#Expr-1822"><span class="linenos">1822</span></a><span class="sd">           of .has(). The former considers only symbols in the free</span>
</span><span id="Expr-1823"><a href="#Expr-1823"><span class="linenos">1823</span></a><span class="sd">           symbols while the latter considers all symbols</span>
</span><span id="Expr-1824"><a href="#Expr-1824"><span class="linenos">1824</span></a>
</span><span id="Expr-1825"><a href="#Expr-1825"><span class="linenos">1825</span></a><span class="sd">        &gt;&gt;&gt; from sympy import Integral</span>
</span><span id="Expr-1826"><a href="#Expr-1826"><span class="linenos">1826</span></a><span class="sd">        &gt;&gt;&gt; I = Integral(x, (x, 1, 2))</span>
</span><span id="Expr-1827"><a href="#Expr-1827"><span class="linenos">1827</span></a><span class="sd">        &gt;&gt;&gt; I.has(x)</span>
</span><span id="Expr-1828"><a href="#Expr-1828"><span class="linenos">1828</span></a><span class="sd">        True</span>
</span><span id="Expr-1829"><a href="#Expr-1829"><span class="linenos">1829</span></a><span class="sd">        &gt;&gt;&gt; x in I.free_symbols</span>
</span><span id="Expr-1830"><a href="#Expr-1830"><span class="linenos">1830</span></a><span class="sd">        False</span>
</span><span id="Expr-1831"><a href="#Expr-1831"><span class="linenos">1831</span></a><span class="sd">        &gt;&gt;&gt; I.as_independent(x) == (I, 1)</span>
</span><span id="Expr-1832"><a href="#Expr-1832"><span class="linenos">1832</span></a><span class="sd">        True</span>
</span><span id="Expr-1833"><a href="#Expr-1833"><span class="linenos">1833</span></a><span class="sd">        &gt;&gt;&gt; (I + x).as_independent(x) == (I, x)</span>
</span><span id="Expr-1834"><a href="#Expr-1834"><span class="linenos">1834</span></a><span class="sd">        True</span>
</span><span id="Expr-1835"><a href="#Expr-1835"><span class="linenos">1835</span></a>
</span><span id="Expr-1836"><a href="#Expr-1836"><span class="linenos">1836</span></a><span class="sd">        Note: when trying to get independent terms, a separation method</span>
</span><span id="Expr-1837"><a href="#Expr-1837"><span class="linenos">1837</span></a><span class="sd">        might need to be used first. In this case, it is important to keep</span>
</span><span id="Expr-1838"><a href="#Expr-1838"><span class="linenos">1838</span></a><span class="sd">        track of what you send to this routine so you know how to interpret</span>
</span><span id="Expr-1839"><a href="#Expr-1839"><span class="linenos">1839</span></a><span class="sd">        the returned values</span>
</span><span id="Expr-1840"><a href="#Expr-1840"><span class="linenos">1840</span></a>
</span><span id="Expr-1841"><a href="#Expr-1841"><span class="linenos">1841</span></a><span class="sd">        &gt;&gt;&gt; from sympy import separatevars, log</span>
</span><span id="Expr-1842"><a href="#Expr-1842"><span class="linenos">1842</span></a><span class="sd">        &gt;&gt;&gt; separatevars(exp(x+y)).as_independent(x)</span>
</span><span id="Expr-1843"><a href="#Expr-1843"><span class="linenos">1843</span></a><span class="sd">        (exp(y), exp(x))</span>
</span><span id="Expr-1844"><a href="#Expr-1844"><span class="linenos">1844</span></a><span class="sd">        &gt;&gt;&gt; (x + x*y).as_independent(y)</span>
</span><span id="Expr-1845"><a href="#Expr-1845"><span class="linenos">1845</span></a><span class="sd">        (x, x*y)</span>
</span><span id="Expr-1846"><a href="#Expr-1846"><span class="linenos">1846</span></a><span class="sd">        &gt;&gt;&gt; separatevars(x + x*y).as_independent(y)</span>
</span><span id="Expr-1847"><a href="#Expr-1847"><span class="linenos">1847</span></a><span class="sd">        (x, y + 1)</span>
</span><span id="Expr-1848"><a href="#Expr-1848"><span class="linenos">1848</span></a><span class="sd">        &gt;&gt;&gt; (x*(1 + y)).as_independent(y)</span>
</span><span id="Expr-1849"><a href="#Expr-1849"><span class="linenos">1849</span></a><span class="sd">        (x, y + 1)</span>
</span><span id="Expr-1850"><a href="#Expr-1850"><span class="linenos">1850</span></a><span class="sd">        &gt;&gt;&gt; (x*(1 + y)).expand(mul=True).as_independent(y)</span>
</span><span id="Expr-1851"><a href="#Expr-1851"><span class="linenos">1851</span></a><span class="sd">        (x, x*y)</span>
</span><span id="Expr-1852"><a href="#Expr-1852"><span class="linenos">1852</span></a><span class="sd">        &gt;&gt;&gt; a, b=symbols(&#39;a b&#39;, positive=True)</span>
</span><span id="Expr-1853"><a href="#Expr-1853"><span class="linenos">1853</span></a><span class="sd">        &gt;&gt;&gt; (log(a*b).expand(log=True)).as_independent(b)</span>
</span><span id="Expr-1854"><a href="#Expr-1854"><span class="linenos">1854</span></a><span class="sd">        (log(a), log(b))</span>
</span><span id="Expr-1855"><a href="#Expr-1855"><span class="linenos">1855</span></a>
</span><span id="Expr-1856"><a href="#Expr-1856"><span class="linenos">1856</span></a><span class="sd">        See Also</span>
</span><span id="Expr-1857"><a href="#Expr-1857"><span class="linenos">1857</span></a><span class="sd">        ========</span>
</span><span id="Expr-1858"><a href="#Expr-1858"><span class="linenos">1858</span></a><span class="sd">        .separatevars(), .expand(log=True), sympy.core.add.Add.as_two_terms(),</span>
</span><span id="Expr-1859"><a href="#Expr-1859"><span class="linenos">1859</span></a><span class="sd">        sympy.core.mul.Mul.as_two_terms(), .as_coeff_add(), .as_coeff_mul()</span>
</span><span id="Expr-1860"><a href="#Expr-1860"><span class="linenos">1860</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Expr-1861"><a href="#Expr-1861"><span class="linenos">1861</span></a>        <span class="kn">from</span> <span class="nn">.symbol</span> <span class="kn">import</span> <span class="n">Symbol</span>
</span><span id="Expr-1862"><a href="#Expr-1862"><span class="linenos">1862</span></a>        <span class="kn">from</span> <span class="nn">.add</span> <span class="kn">import</span> <span class="n">_unevaluated_Add</span>
</span><span id="Expr-1863"><a href="#Expr-1863"><span class="linenos">1863</span></a>        <span class="kn">from</span> <span class="nn">.mul</span> <span class="kn">import</span> <span class="n">_unevaluated_Mul</span>
</span><span id="Expr-1864"><a href="#Expr-1864"><span class="linenos">1864</span></a>
</span><span id="Expr-1865"><a href="#Expr-1865"><span class="linenos">1865</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_zero</span><span class="p">:</span>
</span><span id="Expr-1866"><a href="#Expr-1866"><span class="linenos">1866</span></a>            <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">Zero</span><span class="p">,</span> <span class="n">S</span><span class="o">.</span><span class="n">Zero</span>
</span><span id="Expr-1867"><a href="#Expr-1867"><span class="linenos">1867</span></a>
</span><span id="Expr-1868"><a href="#Expr-1868"><span class="linenos">1868</span></a>        <span class="n">func</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">func</span>
</span><span id="Expr-1869"><a href="#Expr-1869"><span class="linenos">1869</span></a>        <span class="k">if</span> <span class="n">hint</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;as_Add&#39;</span><span class="p">,</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Add</span><span class="p">)</span> <span class="p">):</span>
</span><span id="Expr-1870"><a href="#Expr-1870"><span class="linenos">1870</span></a>            <span class="n">want</span> <span class="o">=</span> <span class="n">Add</span>
</span><span id="Expr-1871"><a href="#Expr-1871"><span class="linenos">1871</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Expr-1872"><a href="#Expr-1872"><span class="linenos">1872</span></a>            <span class="n">want</span> <span class="o">=</span> <span class="n">Mul</span>
</span><span id="Expr-1873"><a href="#Expr-1873"><span class="linenos">1873</span></a>
</span><span id="Expr-1874"><a href="#Expr-1874"><span class="linenos">1874</span></a>        <span class="c1"># sift out deps into symbolic and other and ignore</span>
</span><span id="Expr-1875"><a href="#Expr-1875"><span class="linenos">1875</span></a>        <span class="c1"># all symbols but those that are in the free symbols</span>
</span><span id="Expr-1876"><a href="#Expr-1876"><span class="linenos">1876</span></a>        <span class="n">sym</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
</span><span id="Expr-1877"><a href="#Expr-1877"><span class="linenos">1877</span></a>        <span class="n">other</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Expr-1878"><a href="#Expr-1878"><span class="linenos">1878</span></a>        <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">deps</span><span class="p">:</span>
</span><span id="Expr-1879"><a href="#Expr-1879"><span class="linenos">1879</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">Symbol</span><span class="p">):</span>  <span class="c1"># Symbol.is_Symbol is True</span>
</span><span id="Expr-1880"><a href="#Expr-1880"><span class="linenos">1880</span></a>                <span class="n">sym</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
</span><span id="Expr-1881"><a href="#Expr-1881"><span class="linenos">1881</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Expr-1882"><a href="#Expr-1882"><span class="linenos">1882</span></a>                <span class="n">other</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
</span><span id="Expr-1883"><a href="#Expr-1883"><span class="linenos">1883</span></a>
</span><span id="Expr-1884"><a href="#Expr-1884"><span class="linenos">1884</span></a>        <span class="k">def</span> <span class="nf">has</span><span class="p">(</span><span class="n">e</span><span class="p">):</span>
</span><span id="Expr-1885"><a href="#Expr-1885"><span class="linenos">1885</span></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;return the standard has() if there are no literal symbols, else</span>
</span><span id="Expr-1886"><a href="#Expr-1886"><span class="linenos">1886</span></a><span class="sd">            check to see that symbol-deps are in the free symbols.&quot;&quot;&quot;</span>
</span><span id="Expr-1887"><a href="#Expr-1887"><span class="linenos">1887</span></a>            <span class="n">has_other</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">has</span><span class="p">(</span><span class="o">*</span><span class="n">other</span><span class="p">)</span>
</span><span id="Expr-1888"><a href="#Expr-1888"><span class="linenos">1888</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">sym</span><span class="p">:</span>
</span><span id="Expr-1889"><a href="#Expr-1889"><span class="linenos">1889</span></a>                <span class="k">return</span> <span class="n">has_other</span>
</span><span id="Expr-1890"><a href="#Expr-1890"><span class="linenos">1890</span></a>            <span class="k">return</span> <span class="n">has_other</span> <span class="ow">or</span> <span class="n">e</span><span class="o">.</span><span class="n">has</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">free_symbols</span> <span class="o">&amp;</span> <span class="n">sym</span><span class="p">))</span>
</span><span id="Expr-1891"><a href="#Expr-1891"><span class="linenos">1891</span></a>
</span><span id="Expr-1892"><a href="#Expr-1892"><span class="linenos">1892</span></a>        <span class="k">if</span> <span class="p">(</span><span class="n">want</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">func</span> <span class="ow">or</span>
</span><span id="Expr-1893"><a href="#Expr-1893"><span class="linenos">1893</span></a>                <span class="n">func</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">Add</span> <span class="ow">and</span> <span class="n">func</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">Mul</span><span class="p">):</span>
</span><span id="Expr-1894"><a href="#Expr-1894"><span class="linenos">1894</span></a>            <span class="k">if</span> <span class="n">has</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Expr-1895"><a href="#Expr-1895"><span class="linenos">1895</span></a>                <span class="k">return</span> <span class="p">(</span><span class="n">want</span><span class="o">.</span><span class="n">identity</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
</span><span id="Expr-1896"><a href="#Expr-1896"><span class="linenos">1896</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Expr-1897"><a href="#Expr-1897"><span class="linenos">1897</span></a>                <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">want</span><span class="o">.</span><span class="n">identity</span><span class="p">)</span>
</span><span id="Expr-1898"><a href="#Expr-1898"><span class="linenos">1898</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Expr-1899"><a href="#Expr-1899"><span class="linenos">1899</span></a>            <span class="k">if</span> <span class="n">func</span> <span class="ow">is</span> <span class="n">Add</span><span class="p">:</span>
</span><span id="Expr-1900"><a href="#Expr-1900"><span class="linenos">1900</span></a>                <span class="n">args</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">)</span>
</span><span id="Expr-1901"><a href="#Expr-1901"><span class="linenos">1901</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Expr-1902"><a href="#Expr-1902"><span class="linenos">1902</span></a>                <span class="n">args</span><span class="p">,</span> <span class="n">nc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">args_cnc</span><span class="p">()</span>
</span><span id="Expr-1903"><a href="#Expr-1903"><span class="linenos">1903</span></a>
</span><span id="Expr-1904"><a href="#Expr-1904"><span class="linenos">1904</span></a>        <span class="n">d</span> <span class="o">=</span> <span class="n">sift</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">has</span><span class="p">)</span>
</span><span id="Expr-1905"><a href="#Expr-1905"><span class="linenos">1905</span></a>        <span class="n">depend</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="kc">True</span><span class="p">]</span>
</span><span id="Expr-1906"><a href="#Expr-1906"><span class="linenos">1906</span></a>        <span class="n">indep</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="kc">False</span><span class="p">]</span>
</span><span id="Expr-1907"><a href="#Expr-1907"><span class="linenos">1907</span></a>        <span class="k">if</span> <span class="n">func</span> <span class="ow">is</span> <span class="n">Add</span><span class="p">:</span>  <span class="c1"># all terms were treated as commutative</span>
</span><span id="Expr-1908"><a href="#Expr-1908"><span class="linenos">1908</span></a>            <span class="k">return</span> <span class="p">(</span><span class="n">Add</span><span class="p">(</span><span class="o">*</span><span class="n">indep</span><span class="p">),</span> <span class="n">_unevaluated_Add</span><span class="p">(</span><span class="o">*</span><span class="n">depend</span><span class="p">))</span>
</span><span id="Expr-1909"><a href="#Expr-1909"><span class="linenos">1909</span></a>        <span class="k">else</span><span class="p">:</span>  <span class="c1"># handle noncommutative by stopping at first dependent term</span>
</span><span id="Expr-1910"><a href="#Expr-1910"><span class="linenos">1910</span></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">nc</span><span class="p">):</span>
</span><span id="Expr-1911"><a href="#Expr-1911"><span class="linenos">1911</span></a>                <span class="k">if</span> <span class="n">has</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
</span><span id="Expr-1912"><a href="#Expr-1912"><span class="linenos">1912</span></a>                    <span class="n">depend</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">nc</span><span class="p">[</span><span class="n">i</span><span class="p">:])</span>
</span><span id="Expr-1913"><a href="#Expr-1913"><span class="linenos">1913</span></a>                    <span class="k">break</span>
</span><span id="Expr-1914"><a href="#Expr-1914"><span class="linenos">1914</span></a>                <span class="n">indep</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
</span><span id="Expr-1915"><a href="#Expr-1915"><span class="linenos">1915</span></a>            <span class="k">return</span> <span class="n">Mul</span><span class="p">(</span><span class="o">*</span><span class="n">indep</span><span class="p">),</span> <span class="p">(</span>
</span><span id="Expr-1916"><a href="#Expr-1916"><span class="linenos">1916</span></a>                <span class="n">Mul</span><span class="p">(</span><span class="o">*</span><span class="n">depend</span><span class="p">,</span> <span class="n">evaluate</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="k">if</span> <span class="n">nc</span> <span class="k">else</span>
</span><span id="Expr-1917"><a href="#Expr-1917"><span class="linenos">1917</span></a>                <span class="n">_unevaluated_Mul</span><span class="p">(</span><span class="o">*</span><span class="n">depend</span><span class="p">))</span>
</span><span id="Expr-1918"><a href="#Expr-1918"><span class="linenos">1918</span></a>
</span><span id="Expr-1919"><a href="#Expr-1919"><span class="linenos">1919</span></a>    <span class="k">def</span> <span class="nf">as_real_imag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">hints</span><span class="p">):</span>
</span><span id="Expr-1920"><a href="#Expr-1920"><span class="linenos">1920</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Performs complex expansion on &#39;self&#39; and returns a tuple</span>
</span><span id="Expr-1921"><a href="#Expr-1921"><span class="linenos">1921</span></a><span class="sd">           containing collected both real and imaginary parts. This</span>
</span><span id="Expr-1922"><a href="#Expr-1922"><span class="linenos">1922</span></a><span class="sd">           method cannot be confused with re() and im() functions,</span>
</span><span id="Expr-1923"><a href="#Expr-1923"><span class="linenos">1923</span></a><span class="sd">           which does not perform complex expansion at evaluation.</span>
</span><span id="Expr-1924"><a href="#Expr-1924"><span class="linenos">1924</span></a>
</span><span id="Expr-1925"><a href="#Expr-1925"><span class="linenos">1925</span></a><span class="sd">           However it is possible to expand both re() and im()</span>
</span><span id="Expr-1926"><a href="#Expr-1926"><span class="linenos">1926</span></a><span class="sd">           functions and get exactly the same results as with</span>
</span><span id="Expr-1927"><a href="#Expr-1927"><span class="linenos">1927</span></a><span class="sd">           a single call to this function.</span>
</span><span id="Expr-1928"><a href="#Expr-1928"><span class="linenos">1928</span></a>
</span><span id="Expr-1929"><a href="#Expr-1929"><span class="linenos">1929</span></a><span class="sd">           &gt;&gt;&gt; from sympy import symbols, I</span>
</span><span id="Expr-1930"><a href="#Expr-1930"><span class="linenos">1930</span></a>
</span><span id="Expr-1931"><a href="#Expr-1931"><span class="linenos">1931</span></a><span class="sd">           &gt;&gt;&gt; x, y = symbols(&#39;x,y&#39;, real=True)</span>
</span><span id="Expr-1932"><a href="#Expr-1932"><span class="linenos">1932</span></a>
</span><span id="Expr-1933"><a href="#Expr-1933"><span class="linenos">1933</span></a><span class="sd">           &gt;&gt;&gt; (x + y*I).as_real_imag()</span>
</span><span id="Expr-1934"><a href="#Expr-1934"><span class="linenos">1934</span></a><span class="sd">           (x, y)</span>
</span><span id="Expr-1935"><a href="#Expr-1935"><span class="linenos">1935</span></a>
</span><span id="Expr-1936"><a href="#Expr-1936"><span class="linenos">1936</span></a><span class="sd">           &gt;&gt;&gt; from sympy.abc import z, w</span>
</span><span id="Expr-1937"><a href="#Expr-1937"><span class="linenos">1937</span></a>
</span><span id="Expr-1938"><a href="#Expr-1938"><span class="linenos">1938</span></a><span class="sd">           &gt;&gt;&gt; (z + w*I).as_real_imag()</span>
</span><span id="Expr-1939"><a href="#Expr-1939"><span class="linenos">1939</span></a><span class="sd">           (re(z) - im(w), re(w) + im(z))</span>
</span><span id="Expr-1940"><a href="#Expr-1940"><span class="linenos">1940</span></a>
</span><span id="Expr-1941"><a href="#Expr-1941"><span class="linenos">1941</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Expr-1942"><a href="#Expr-1942"><span class="linenos">1942</span></a>        <span class="k">if</span> <span class="n">hints</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="p">:</span>
</span><span id="Expr-1943"><a href="#Expr-1943"><span class="linenos">1943</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="Expr-1944"><a href="#Expr-1944"><span class="linenos">1944</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Expr-1945"><a href="#Expr-1945"><span class="linenos">1945</span></a>            <span class="kn">from</span> <span class="nn">sympy.functions.elementary.complexes</span> <span class="kn">import</span> <span class="n">im</span><span class="p">,</span> <span class="n">re</span>
</span><span id="Expr-1946"><a href="#Expr-1946"><span class="linenos">1946</span></a>            <span class="k">return</span> <span class="p">(</span><span class="n">re</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span> <span class="n">im</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>
</span><span id="Expr-1947"><a href="#Expr-1947"><span class="linenos">1947</span></a>
</span><span id="Expr-1948"><a href="#Expr-1948"><span class="linenos">1948</span></a>    <span class="k">def</span> <span class="nf">as_powers_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Expr-1949"><a href="#Expr-1949"><span class="linenos">1949</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return self as a dictionary of factors with each factor being</span>
</span><span id="Expr-1950"><a href="#Expr-1950"><span class="linenos">1950</span></a><span class="sd">        treated as a power. The keys are the bases of the factors and the</span>
</span><span id="Expr-1951"><a href="#Expr-1951"><span class="linenos">1951</span></a><span class="sd">        values, the corresponding exponents. The resulting dictionary should</span>
</span><span id="Expr-1952"><a href="#Expr-1952"><span class="linenos">1952</span></a><span class="sd">        be used with caution if the expression is a Mul and contains non-</span>
</span><span id="Expr-1953"><a href="#Expr-1953"><span class="linenos">1953</span></a><span class="sd">        commutative factors since the order that they appeared will be lost in</span>
</span><span id="Expr-1954"><a href="#Expr-1954"><span class="linenos">1954</span></a><span class="sd">        the dictionary.</span>
</span><span id="Expr-1955"><a href="#Expr-1955"><span class="linenos">1955</span></a>
</span><span id="Expr-1956"><a href="#Expr-1956"><span class="linenos">1956</span></a><span class="sd">        See Also</span>
</span><span id="Expr-1957"><a href="#Expr-1957"><span class="linenos">1957</span></a><span class="sd">        ========</span>
</span><span id="Expr-1958"><a href="#Expr-1958"><span class="linenos">1958</span></a><span class="sd">        as_ordered_factors: An alternative for noncommutative applications,</span>
</span><span id="Expr-1959"><a href="#Expr-1959"><span class="linenos">1959</span></a><span class="sd">                            returning an ordered list of factors.</span>
</span><span id="Expr-1960"><a href="#Expr-1960"><span class="linenos">1960</span></a><span class="sd">        args_cnc: Similar to as_ordered_factors, but guarantees separation</span>
</span><span id="Expr-1961"><a href="#Expr-1961"><span class="linenos">1961</span></a><span class="sd">                  of commutative and noncommutative factors.</span>
</span><span id="Expr-1962"><a href="#Expr-1962"><span class="linenos">1962</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Expr-1963"><a href="#Expr-1963"><span class="linenos">1963</span></a>        <span class="n">d</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</span><span id="Expr-1964"><a href="#Expr-1964"><span class="linenos">1964</span></a>        <span class="n">d</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="nb">dict</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">as_base_exp</span><span class="p">()]))</span>
</span><span id="Expr-1965"><a href="#Expr-1965"><span class="linenos">1965</span></a>        <span class="k">return</span> <span class="n">d</span>
</span><span id="Expr-1966"><a href="#Expr-1966"><span class="linenos">1966</span></a>
</span><span id="Expr-1967"><a href="#Expr-1967"><span class="linenos">1967</span></a>    <span class="k">def</span> <span class="nf">as_coefficients_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Expr-1968"><a href="#Expr-1968"><span class="linenos">1968</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a dictionary mapping terms to their Rational coefficient.</span>
</span><span id="Expr-1969"><a href="#Expr-1969"><span class="linenos">1969</span></a><span class="sd">        Since the dictionary is a defaultdict, inquiries about terms which</span>
</span><span id="Expr-1970"><a href="#Expr-1970"><span class="linenos">1970</span></a><span class="sd">        were not present will return a coefficient of 0. If an expression is</span>
</span><span id="Expr-1971"><a href="#Expr-1971"><span class="linenos">1971</span></a><span class="sd">        not an Add it is considered to have a single term.</span>
</span><span id="Expr-1972"><a href="#Expr-1972"><span class="linenos">1972</span></a>
</span><span id="Expr-1973"><a href="#Expr-1973"><span class="linenos">1973</span></a><span class="sd">        Examples</span>
</span><span id="Expr-1974"><a href="#Expr-1974"><span class="linenos">1974</span></a><span class="sd">        ========</span>
</span><span id="Expr-1975"><a href="#Expr-1975"><span class="linenos">1975</span></a>
</span><span id="Expr-1976"><a href="#Expr-1976"><span class="linenos">1976</span></a><span class="sd">        &gt;&gt;&gt; from sympy.abc import a, x</span>
</span><span id="Expr-1977"><a href="#Expr-1977"><span class="linenos">1977</span></a><span class="sd">        &gt;&gt;&gt; (3*x + a*x + 4).as_coefficients_dict()</span>
</span><span id="Expr-1978"><a href="#Expr-1978"><span class="linenos">1978</span></a><span class="sd">        {1: 4, x: 3, a*x: 1}</span>
</span><span id="Expr-1979"><a href="#Expr-1979"><span class="linenos">1979</span></a><span class="sd">        &gt;&gt;&gt; _[a]</span>
</span><span id="Expr-1980"><a href="#Expr-1980"><span class="linenos">1980</span></a><span class="sd">        0</span>
</span><span id="Expr-1981"><a href="#Expr-1981"><span class="linenos">1981</span></a><span class="sd">        &gt;&gt;&gt; (3*a*x).as_coefficients_dict()</span>
</span><span id="Expr-1982"><a href="#Expr-1982"><span class="linenos">1982</span></a><span class="sd">        {a*x: 3}</span>
</span><span id="Expr-1983"><a href="#Expr-1983"><span class="linenos">1983</span></a>
</span><span id="Expr-1984"><a href="#Expr-1984"><span class="linenos">1984</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Expr-1985"><a href="#Expr-1985"><span class="linenos">1985</span></a>        <span class="n">c</span><span class="p">,</span> <span class="n">m</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">as_coeff_Mul</span><span class="p">()</span>
</span><span id="Expr-1986"><a href="#Expr-1986"><span class="linenos">1986</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">c</span><span class="o">.</span><span class="n">is_Rational</span><span class="p">:</span>
</span><span id="Expr-1987"><a href="#Expr-1987"><span class="linenos">1987</span></a>            <span class="n">c</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">One</span>
</span><span id="Expr-1988"><a href="#Expr-1988"><span class="linenos">1988</span></a>            <span class="n">m</span> <span class="o">=</span> <span class="bp">self</span>
</span><span id="Expr-1989"><a href="#Expr-1989"><span class="linenos">1989</span></a>        <span class="n">d</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</span><span id="Expr-1990"><a href="#Expr-1990"><span class="linenos">1990</span></a>        <span class="n">d</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">m</span><span class="p">:</span> <span class="n">c</span><span class="p">})</span>
</span><span id="Expr-1991"><a href="#Expr-1991"><span class="linenos">1991</span></a>        <span class="k">return</span> <span class="n">d</span>
</span><span id="Expr-1992"><a href="#Expr-1992"><span class="linenos">1992</span></a>
</span><span id="Expr-1993"><a href="#Expr-1993"><span class="linenos">1993</span></a>    <span class="k">def</span> <span class="nf">as_base_exp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Expr-1994"><a href="#Expr-1994"><span class="linenos">1994</span></a>        <span class="c1"># a -&gt; b ** e</span>
</span><span id="Expr-1995"><a href="#Expr-1995"><span class="linenos">1995</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="p">,</span> <span class="n">S</span><span class="o">.</span><span class="n">One</span>
</span><span id="Expr-1996"><a href="#Expr-1996"><span class="linenos">1996</span></a>
</span><span id="Expr-1997"><a href="#Expr-1997"><span class="linenos">1997</span></a>    <span class="k">def</span> <span class="nf">as_coeff_mul</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">deps</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Expr-1998"><a href="#Expr-1998"><span class="linenos">1998</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the tuple (c, args) where self is written as a Mul, ``m``.</span>
</span><span id="Expr-1999"><a href="#Expr-1999"><span class="linenos">1999</span></a>
</span><span id="Expr-2000"><a href="#Expr-2000"><span class="linenos">2000</span></a><span class="sd">        c should be a Rational multiplied by any factors of the Mul that are</span>
</span><span id="Expr-2001"><a href="#Expr-2001"><span class="linenos">2001</span></a><span class="sd">        independent of deps.</span>
</span><span id="Expr-2002"><a href="#Expr-2002"><span class="linenos">2002</span></a>
</span><span id="Expr-2003"><a href="#Expr-2003"><span class="linenos">2003</span></a><span class="sd">        args should be a tuple of all other factors of m; args is empty</span>
</span><span id="Expr-2004"><a href="#Expr-2004"><span class="linenos">2004</span></a><span class="sd">        if self is a Number or if self is independent of deps (when given).</span>
</span><span id="Expr-2005"><a href="#Expr-2005"><span class="linenos">2005</span></a>
</span><span id="Expr-2006"><a href="#Expr-2006"><span class="linenos">2006</span></a><span class="sd">        This should be used when you do not know if self is a Mul or not but</span>
</span><span id="Expr-2007"><a href="#Expr-2007"><span class="linenos">2007</span></a><span class="sd">        you want to treat self as a Mul or if you want to process the</span>
</span><span id="Expr-2008"><a href="#Expr-2008"><span class="linenos">2008</span></a><span class="sd">        individual arguments of the tail of self as a Mul.</span>
</span><span id="Expr-2009"><a href="#Expr-2009"><span class="linenos">2009</span></a>
</span><span id="Expr-2010"><a href="#Expr-2010"><span class="linenos">2010</span></a><span class="sd">        - if you know self is a Mul and want only the head, use self.args[0];</span>
</span><span id="Expr-2011"><a href="#Expr-2011"><span class="linenos">2011</span></a><span class="sd">        - if you do not want to process the arguments of the tail but need the</span>
</span><span id="Expr-2012"><a href="#Expr-2012"><span class="linenos">2012</span></a><span class="sd">          tail then use self.as_two_terms() which gives the head and tail;</span>
</span><span id="Expr-2013"><a href="#Expr-2013"><span class="linenos">2013</span></a><span class="sd">        - if you want to split self into an independent and dependent parts</span>
</span><span id="Expr-2014"><a href="#Expr-2014"><span class="linenos">2014</span></a><span class="sd">          use ``self.as_independent(*deps)``</span>
</span><span id="Expr-2015"><a href="#Expr-2015"><span class="linenos">2015</span></a>
</span><span id="Expr-2016"><a href="#Expr-2016"><span class="linenos">2016</span></a><span class="sd">        &gt;&gt;&gt; from sympy import S</span>
</span><span id="Expr-2017"><a href="#Expr-2017"><span class="linenos">2017</span></a><span class="sd">        &gt;&gt;&gt; from sympy.abc import x, y</span>
</span><span id="Expr-2018"><a href="#Expr-2018"><span class="linenos">2018</span></a><span class="sd">        &gt;&gt;&gt; (S(3)).as_coeff_mul()</span>
</span><span id="Expr-2019"><a href="#Expr-2019"><span class="linenos">2019</span></a><span class="sd">        (3, ())</span>
</span><span id="Expr-2020"><a href="#Expr-2020"><span class="linenos">2020</span></a><span class="sd">        &gt;&gt;&gt; (3*x*y).as_coeff_mul()</span>
</span><span id="Expr-2021"><a href="#Expr-2021"><span class="linenos">2021</span></a><span class="sd">        (3, (x, y))</span>
</span><span id="Expr-2022"><a href="#Expr-2022"><span class="linenos">2022</span></a><span class="sd">        &gt;&gt;&gt; (3*x*y).as_coeff_mul(x)</span>
</span><span id="Expr-2023"><a href="#Expr-2023"><span class="linenos">2023</span></a><span class="sd">        (3*y, (x,))</span>
</span><span id="Expr-2024"><a href="#Expr-2024"><span class="linenos">2024</span></a><span class="sd">        &gt;&gt;&gt; (3*y).as_coeff_mul(x)</span>
</span><span id="Expr-2025"><a href="#Expr-2025"><span class="linenos">2025</span></a><span class="sd">        (3*y, ())</span>
</span><span id="Expr-2026"><a href="#Expr-2026"><span class="linenos">2026</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Expr-2027"><a href="#Expr-2027"><span class="linenos">2027</span></a>        <span class="k">if</span> <span class="n">deps</span><span class="p">:</span>
</span><span id="Expr-2028"><a href="#Expr-2028"><span class="linenos">2028</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">has</span><span class="p">(</span><span class="o">*</span><span class="n">deps</span><span class="p">):</span>
</span><span id="Expr-2029"><a href="#Expr-2029"><span class="linenos">2029</span></a>                <span class="k">return</span> <span class="bp">self</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">()</span>
</span><span id="Expr-2030"><a href="#Expr-2030"><span class="linenos">2030</span></a>        <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">One</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="p">,)</span>
</span><span id="Expr-2031"><a href="#Expr-2031"><span class="linenos">2031</span></a>
</span><span id="Expr-2032"><a href="#Expr-2032"><span class="linenos">2032</span></a>    <span class="k">def</span> <span class="nf">as_coeff_add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">deps</span><span class="p">):</span>
</span><span id="Expr-2033"><a href="#Expr-2033"><span class="linenos">2033</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the tuple (c, args) where self is written as an Add, ``a``.</span>
</span><span id="Expr-2034"><a href="#Expr-2034"><span class="linenos">2034</span></a>
</span><span id="Expr-2035"><a href="#Expr-2035"><span class="linenos">2035</span></a><span class="sd">        c should be a Rational added to any terms of the Add that are</span>
</span><span id="Expr-2036"><a href="#Expr-2036"><span class="linenos">2036</span></a><span class="sd">        independent of deps.</span>
</span><span id="Expr-2037"><a href="#Expr-2037"><span class="linenos">2037</span></a>
</span><span id="Expr-2038"><a href="#Expr-2038"><span class="linenos">2038</span></a><span class="sd">        args should be a tuple of all other terms of ``a``; args is empty</span>
</span><span id="Expr-2039"><a href="#Expr-2039"><span class="linenos">2039</span></a><span class="sd">        if self is a Number or if self is independent of deps (when given).</span>
</span><span id="Expr-2040"><a href="#Expr-2040"><span class="linenos">2040</span></a>
</span><span id="Expr-2041"><a href="#Expr-2041"><span class="linenos">2041</span></a><span class="sd">        This should be used when you do not know if self is an Add or not but</span>
</span><span id="Expr-2042"><a href="#Expr-2042"><span class="linenos">2042</span></a><span class="sd">        you want to treat self as an Add or if you want to process the</span>
</span><span id="Expr-2043"><a href="#Expr-2043"><span class="linenos">2043</span></a><span class="sd">        individual arguments of the tail of self as an Add.</span>
</span><span id="Expr-2044"><a href="#Expr-2044"><span class="linenos">2044</span></a>
</span><span id="Expr-2045"><a href="#Expr-2045"><span class="linenos">2045</span></a><span class="sd">        - if you know self is an Add and want only the head, use self.args[0];</span>
</span><span id="Expr-2046"><a href="#Expr-2046"><span class="linenos">2046</span></a><span class="sd">        - if you do not want to process the arguments of the tail but need the</span>
</span><span id="Expr-2047"><a href="#Expr-2047"><span class="linenos">2047</span></a><span class="sd">          tail then use self.as_two_terms() which gives the head and tail.</span>
</span><span id="Expr-2048"><a href="#Expr-2048"><span class="linenos">2048</span></a><span class="sd">        - if you want to split self into an independent and dependent parts</span>
</span><span id="Expr-2049"><a href="#Expr-2049"><span class="linenos">2049</span></a><span class="sd">          use ``self.as_independent(*deps)``</span>
</span><span id="Expr-2050"><a href="#Expr-2050"><span class="linenos">2050</span></a>
</span><span id="Expr-2051"><a href="#Expr-2051"><span class="linenos">2051</span></a><span class="sd">        &gt;&gt;&gt; from sympy import S</span>
</span><span id="Expr-2052"><a href="#Expr-2052"><span class="linenos">2052</span></a><span class="sd">        &gt;&gt;&gt; from sympy.abc import x, y</span>
</span><span id="Expr-2053"><a href="#Expr-2053"><span class="linenos">2053</span></a><span class="sd">        &gt;&gt;&gt; (S(3)).as_coeff_add()</span>
</span><span id="Expr-2054"><a href="#Expr-2054"><span class="linenos">2054</span></a><span class="sd">        (3, ())</span>
</span><span id="Expr-2055"><a href="#Expr-2055"><span class="linenos">2055</span></a><span class="sd">        &gt;&gt;&gt; (3 + x).as_coeff_add()</span>
</span><span id="Expr-2056"><a href="#Expr-2056"><span class="linenos">2056</span></a><span class="sd">        (3, (x,))</span>
</span><span id="Expr-2057"><a href="#Expr-2057"><span class="linenos">2057</span></a><span class="sd">        &gt;&gt;&gt; (3 + x + y).as_coeff_add(x)</span>
</span><span id="Expr-2058"><a href="#Expr-2058"><span class="linenos">2058</span></a><span class="sd">        (y + 3, (x,))</span>
</span><span id="Expr-2059"><a href="#Expr-2059"><span class="linenos">2059</span></a><span class="sd">        &gt;&gt;&gt; (3 + y).as_coeff_add(x)</span>
</span><span id="Expr-2060"><a href="#Expr-2060"><span class="linenos">2060</span></a><span class="sd">        (y + 3, ())</span>
</span><span id="Expr-2061"><a href="#Expr-2061"><span class="linenos">2061</span></a>
</span><span id="Expr-2062"><a href="#Expr-2062"><span class="linenos">2062</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Expr-2063"><a href="#Expr-2063"><span class="linenos">2063</span></a>        <span class="k">if</span> <span class="n">deps</span><span class="p">:</span>
</span><span id="Expr-2064"><a href="#Expr-2064"><span class="linenos">2064</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_free</span><span class="p">(</span><span class="o">*</span><span class="n">deps</span><span class="p">):</span>
</span><span id="Expr-2065"><a href="#Expr-2065"><span class="linenos">2065</span></a>                <span class="k">return</span> <span class="bp">self</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">()</span>
</span><span id="Expr-2066"><a href="#Expr-2066"><span class="linenos">2066</span></a>        <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">Zero</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="p">,)</span>
</span><span id="Expr-2067"><a href="#Expr-2067"><span class="linenos">2067</span></a>
</span><span id="Expr-2068"><a href="#Expr-2068"><span class="linenos">2068</span></a>    <span class="k">def</span> <span class="nf">primitive</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Expr-2069"><a href="#Expr-2069"><span class="linenos">2069</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the positive Rational that can be extracted non-recursively</span>
</span><span id="Expr-2070"><a href="#Expr-2070"><span class="linenos">2070</span></a><span class="sd">        from every term of self (i.e., self is treated like an Add). This is</span>
</span><span id="Expr-2071"><a href="#Expr-2071"><span class="linenos">2071</span></a><span class="sd">        like the as_coeff_Mul() method but primitive always extracts a positive</span>
</span><span id="Expr-2072"><a href="#Expr-2072"><span class="linenos">2072</span></a><span class="sd">        Rational (never a negative or a Float).</span>
</span><span id="Expr-2073"><a href="#Expr-2073"><span class="linenos">2073</span></a>
</span><span id="Expr-2074"><a href="#Expr-2074"><span class="linenos">2074</span></a><span class="sd">        Examples</span>
</span><span id="Expr-2075"><a href="#Expr-2075"><span class="linenos">2075</span></a><span class="sd">        ========</span>
</span><span id="Expr-2076"><a href="#Expr-2076"><span class="linenos">2076</span></a>
</span><span id="Expr-2077"><a href="#Expr-2077"><span class="linenos">2077</span></a><span class="sd">        &gt;&gt;&gt; from sympy.abc import x</span>
</span><span id="Expr-2078"><a href="#Expr-2078"><span class="linenos">2078</span></a><span class="sd">        &gt;&gt;&gt; (3*(x + 1)**2).primitive()</span>
</span><span id="Expr-2079"><a href="#Expr-2079"><span class="linenos">2079</span></a><span class="sd">        (3, (x + 1)**2)</span>
</span><span id="Expr-2080"><a href="#Expr-2080"><span class="linenos">2080</span></a><span class="sd">        &gt;&gt;&gt; a = (6*x + 2); a.primitive()</span>
</span><span id="Expr-2081"><a href="#Expr-2081"><span class="linenos">2081</span></a><span class="sd">        (2, 3*x + 1)</span>
</span><span id="Expr-2082"><a href="#Expr-2082"><span class="linenos">2082</span></a><span class="sd">        &gt;&gt;&gt; b = (x/2 + 3); b.primitive()</span>
</span><span id="Expr-2083"><a href="#Expr-2083"><span class="linenos">2083</span></a><span class="sd">        (1/2, x + 6)</span>
</span><span id="Expr-2084"><a href="#Expr-2084"><span class="linenos">2084</span></a><span class="sd">        &gt;&gt;&gt; (a*b).primitive() == (1, a*b)</span>
</span><span id="Expr-2085"><a href="#Expr-2085"><span class="linenos">2085</span></a><span class="sd">        True</span>
</span><span id="Expr-2086"><a href="#Expr-2086"><span class="linenos">2086</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Expr-2087"><a href="#Expr-2087"><span class="linenos">2087</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="p">:</span>
</span><span id="Expr-2088"><a href="#Expr-2088"><span class="linenos">2088</span></a>            <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">One</span><span class="p">,</span> <span class="n">S</span><span class="o">.</span><span class="n">Zero</span>
</span><span id="Expr-2089"><a href="#Expr-2089"><span class="linenos">2089</span></a>        <span class="n">c</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">as_coeff_Mul</span><span class="p">(</span><span class="n">rational</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="Expr-2090"><a href="#Expr-2090"><span class="linenos">2090</span></a>        <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">is_negative</span><span class="p">:</span>
</span><span id="Expr-2091"><a href="#Expr-2091"><span class="linenos">2091</span></a>            <span class="n">c</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="o">-</span><span class="n">c</span><span class="p">,</span> <span class="o">-</span><span class="n">r</span>
</span><span id="Expr-2092"><a href="#Expr-2092"><span class="linenos">2092</span></a>        <span class="k">return</span> <span class="n">c</span><span class="p">,</span> <span class="n">r</span>
</span><span id="Expr-2093"><a href="#Expr-2093"><span class="linenos">2093</span></a>
</span><span id="Expr-2094"><a href="#Expr-2094"><span class="linenos">2094</span></a>    <span class="k">def</span> <span class="nf">as_content_primitive</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">radical</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">clear</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="Expr-2095"><a href="#Expr-2095"><span class="linenos">2095</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;This method should recursively remove a Rational from all arguments</span>
</span><span id="Expr-2096"><a href="#Expr-2096"><span class="linenos">2096</span></a><span class="sd">        and return that (content) and the new self (primitive). The content</span>
</span><span id="Expr-2097"><a href="#Expr-2097"><span class="linenos">2097</span></a><span class="sd">        should always be positive and ``Mul(*foo.as_content_primitive()) == foo``.</span>
</span><span id="Expr-2098"><a href="#Expr-2098"><span class="linenos">2098</span></a><span class="sd">        The primitive need not be in canonical form and should try to preserve</span>
</span><span id="Expr-2099"><a href="#Expr-2099"><span class="linenos">2099</span></a><span class="sd">        the underlying structure if possible (i.e. expand_mul should not be</span>
</span><span id="Expr-2100"><a href="#Expr-2100"><span class="linenos">2100</span></a><span class="sd">        applied to self).</span>
</span><span id="Expr-2101"><a href="#Expr-2101"><span class="linenos">2101</span></a>
</span><span id="Expr-2102"><a href="#Expr-2102"><span class="linenos">2102</span></a><span class="sd">        Examples</span>
</span><span id="Expr-2103"><a href="#Expr-2103"><span class="linenos">2103</span></a><span class="sd">        ========</span>
</span><span id="Expr-2104"><a href="#Expr-2104"><span class="linenos">2104</span></a>
</span><span id="Expr-2105"><a href="#Expr-2105"><span class="linenos">2105</span></a><span class="sd">        &gt;&gt;&gt; from sympy import sqrt</span>
</span><span id="Expr-2106"><a href="#Expr-2106"><span class="linenos">2106</span></a><span class="sd">        &gt;&gt;&gt; from sympy.abc import x, y, z</span>
</span><span id="Expr-2107"><a href="#Expr-2107"><span class="linenos">2107</span></a>
</span><span id="Expr-2108"><a href="#Expr-2108"><span class="linenos">2108</span></a><span class="sd">        &gt;&gt;&gt; eq = 2 + 2*x + 2*y*(3 + 3*y)</span>
</span><span id="Expr-2109"><a href="#Expr-2109"><span class="linenos">2109</span></a>
</span><span id="Expr-2110"><a href="#Expr-2110"><span class="linenos">2110</span></a><span class="sd">        The as_content_primitive function is recursive and retains structure:</span>
</span><span id="Expr-2111"><a href="#Expr-2111"><span class="linenos">2111</span></a>
</span><span id="Expr-2112"><a href="#Expr-2112"><span class="linenos">2112</span></a><span class="sd">        &gt;&gt;&gt; eq.as_content_primitive()</span>
</span><span id="Expr-2113"><a href="#Expr-2113"><span class="linenos">2113</span></a><span class="sd">        (2, x + 3*y*(y + 1) + 1)</span>
</span><span id="Expr-2114"><a href="#Expr-2114"><span class="linenos">2114</span></a>
</span><span id="Expr-2115"><a href="#Expr-2115"><span class="linenos">2115</span></a><span class="sd">        Integer powers will have Rationals extracted from the base:</span>
</span><span id="Expr-2116"><a href="#Expr-2116"><span class="linenos">2116</span></a>
</span><span id="Expr-2117"><a href="#Expr-2117"><span class="linenos">2117</span></a><span class="sd">        &gt;&gt;&gt; ((2 + 6*x)**2).as_content_primitive()</span>
</span><span id="Expr-2118"><a href="#Expr-2118"><span class="linenos">2118</span></a><span class="sd">        (4, (3*x + 1)**2)</span>
</span><span id="Expr-2119"><a href="#Expr-2119"><span class="linenos">2119</span></a><span class="sd">        &gt;&gt;&gt; ((2 + 6*x)**(2*y)).as_content_primitive()</span>
</span><span id="Expr-2120"><a href="#Expr-2120"><span class="linenos">2120</span></a><span class="sd">        (1, (2*(3*x + 1))**(2*y))</span>
</span><span id="Expr-2121"><a href="#Expr-2121"><span class="linenos">2121</span></a>
</span><span id="Expr-2122"><a href="#Expr-2122"><span class="linenos">2122</span></a><span class="sd">        Terms may end up joining once their as_content_primitives are added:</span>
</span><span id="Expr-2123"><a href="#Expr-2123"><span class="linenos">2123</span></a>
</span><span id="Expr-2124"><a href="#Expr-2124"><span class="linenos">2124</span></a><span class="sd">        &gt;&gt;&gt; ((5*(x*(1 + y)) + 2*x*(3 + 3*y))).as_content_primitive()</span>
</span><span id="Expr-2125"><a href="#Expr-2125"><span class="linenos">2125</span></a><span class="sd">        (11, x*(y + 1))</span>
</span><span id="Expr-2126"><a href="#Expr-2126"><span class="linenos">2126</span></a><span class="sd">        &gt;&gt;&gt; ((3*(x*(1 + y)) + 2*x*(3 + 3*y))).as_content_primitive()</span>
</span><span id="Expr-2127"><a href="#Expr-2127"><span class="linenos">2127</span></a><span class="sd">        (9, x*(y + 1))</span>
</span><span id="Expr-2128"><a href="#Expr-2128"><span class="linenos">2128</span></a><span class="sd">        &gt;&gt;&gt; ((3*(z*(1 + y)) + 2.0*x*(3 + 3*y))).as_content_primitive()</span>
</span><span id="Expr-2129"><a href="#Expr-2129"><span class="linenos">2129</span></a><span class="sd">        (1, 6.0*x*(y + 1) + 3*z*(y + 1))</span>
</span><span id="Expr-2130"><a href="#Expr-2130"><span class="linenos">2130</span></a><span class="sd">        &gt;&gt;&gt; ((5*(x*(1 + y)) + 2*x*(3 + 3*y))**2).as_content_primitive()</span>
</span><span id="Expr-2131"><a href="#Expr-2131"><span class="linenos">2131</span></a><span class="sd">        (121, x**2*(y + 1)**2)</span>
</span><span id="Expr-2132"><a href="#Expr-2132"><span class="linenos">2132</span></a><span class="sd">        &gt;&gt;&gt; ((x*(1 + y) + 0.4*x*(3 + 3*y))**2).as_content_primitive()</span>
</span><span id="Expr-2133"><a href="#Expr-2133"><span class="linenos">2133</span></a><span class="sd">        (1, 4.84*x**2*(y + 1)**2)</span>
</span><span id="Expr-2134"><a href="#Expr-2134"><span class="linenos">2134</span></a>
</span><span id="Expr-2135"><a href="#Expr-2135"><span class="linenos">2135</span></a><span class="sd">        Radical content can also be factored out of the primitive:</span>
</span><span id="Expr-2136"><a href="#Expr-2136"><span class="linenos">2136</span></a>
</span><span id="Expr-2137"><a href="#Expr-2137"><span class="linenos">2137</span></a><span class="sd">        &gt;&gt;&gt; (2*sqrt(2) + 4*sqrt(10)).as_content_primitive(radical=True)</span>
</span><span id="Expr-2138"><a href="#Expr-2138"><span class="linenos">2138</span></a><span class="sd">        (2, sqrt(2)*(1 + 2*sqrt(5)))</span>
</span><span id="Expr-2139"><a href="#Expr-2139"><span class="linenos">2139</span></a>
</span><span id="Expr-2140"><a href="#Expr-2140"><span class="linenos">2140</span></a><span class="sd">        If clear=False (default is True) then content will not be removed</span>
</span><span id="Expr-2141"><a href="#Expr-2141"><span class="linenos">2141</span></a><span class="sd">        from an Add if it can be distributed to leave one or more</span>
</span><span id="Expr-2142"><a href="#Expr-2142"><span class="linenos">2142</span></a><span class="sd">        terms with integer coefficients.</span>
</span><span id="Expr-2143"><a href="#Expr-2143"><span class="linenos">2143</span></a>
</span><span id="Expr-2144"><a href="#Expr-2144"><span class="linenos">2144</span></a><span class="sd">        &gt;&gt;&gt; (x/2 + y).as_content_primitive()</span>
</span><span id="Expr-2145"><a href="#Expr-2145"><span class="linenos">2145</span></a><span class="sd">        (1/2, x + 2*y)</span>
</span><span id="Expr-2146"><a href="#Expr-2146"><span class="linenos">2146</span></a><span class="sd">        &gt;&gt;&gt; (x/2 + y).as_content_primitive(clear=False)</span>
</span><span id="Expr-2147"><a href="#Expr-2147"><span class="linenos">2147</span></a><span class="sd">        (1, x/2 + y)</span>
</span><span id="Expr-2148"><a href="#Expr-2148"><span class="linenos">2148</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Expr-2149"><a href="#Expr-2149"><span class="linenos">2149</span></a>        <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">One</span><span class="p">,</span> <span class="bp">self</span>
</span><span id="Expr-2150"><a href="#Expr-2150"><span class="linenos">2150</span></a>
</span><span id="Expr-2151"><a href="#Expr-2151"><span class="linenos">2151</span></a>    <span class="k">def</span> <span class="nf">as_numer_denom</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Expr-2152"><a href="#Expr-2152"><span class="linenos">2152</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; expression -&gt; a/b -&gt; a, b</span>
</span><span id="Expr-2153"><a href="#Expr-2153"><span class="linenos">2153</span></a>
</span><span id="Expr-2154"><a href="#Expr-2154"><span class="linenos">2154</span></a><span class="sd">        This is just a stub that should be defined by</span>
</span><span id="Expr-2155"><a href="#Expr-2155"><span class="linenos">2155</span></a><span class="sd">        an object&#39;s class methods to get anything else.</span>
</span><span id="Expr-2156"><a href="#Expr-2156"><span class="linenos">2156</span></a>
</span><span id="Expr-2157"><a href="#Expr-2157"><span class="linenos">2157</span></a><span class="sd">        See Also</span>
</span><span id="Expr-2158"><a href="#Expr-2158"><span class="linenos">2158</span></a><span class="sd">        ========</span>
</span><span id="Expr-2159"><a href="#Expr-2159"><span class="linenos">2159</span></a>
</span><span id="Expr-2160"><a href="#Expr-2160"><span class="linenos">2160</span></a><span class="sd">        normal: return ``a/b`` instead of ``(a, b)``</span>
</span><span id="Expr-2161"><a href="#Expr-2161"><span class="linenos">2161</span></a>
</span><span id="Expr-2162"><a href="#Expr-2162"><span class="linenos">2162</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Expr-2163"><a href="#Expr-2163"><span class="linenos">2163</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="p">,</span> <span class="n">S</span><span class="o">.</span><span class="n">One</span>
</span><span id="Expr-2164"><a href="#Expr-2164"><span class="linenos">2164</span></a>
</span><span id="Expr-2165"><a href="#Expr-2165"><span class="linenos">2165</span></a>    <span class="k">def</span> <span class="nf">normal</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Expr-2166"><a href="#Expr-2166"><span class="linenos">2166</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; expression -&gt; a/b</span>
</span><span id="Expr-2167"><a href="#Expr-2167"><span class="linenos">2167</span></a>
</span><span id="Expr-2168"><a href="#Expr-2168"><span class="linenos">2168</span></a><span class="sd">        See Also</span>
</span><span id="Expr-2169"><a href="#Expr-2169"><span class="linenos">2169</span></a><span class="sd">        ========</span>
</span><span id="Expr-2170"><a href="#Expr-2170"><span class="linenos">2170</span></a>
</span><span id="Expr-2171"><a href="#Expr-2171"><span class="linenos">2171</span></a><span class="sd">        as_numer_denom: return ``(a, b)`` instead of ``a/b``</span>
</span><span id="Expr-2172"><a href="#Expr-2172"><span class="linenos">2172</span></a>
</span><span id="Expr-2173"><a href="#Expr-2173"><span class="linenos">2173</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Expr-2174"><a href="#Expr-2174"><span class="linenos">2174</span></a>        <span class="kn">from</span> <span class="nn">.mul</span> <span class="kn">import</span> <span class="n">_unevaluated_Mul</span>
</span><span id="Expr-2175"><a href="#Expr-2175"><span class="linenos">2175</span></a>        <span class="n">n</span><span class="p">,</span> <span class="n">d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">as_numer_denom</span><span class="p">()</span>
</span><span id="Expr-2176"><a href="#Expr-2176"><span class="linenos">2176</span></a>        <span class="k">if</span> <span class="n">d</span> <span class="ow">is</span> <span class="n">S</span><span class="o">.</span><span class="n">One</span><span class="p">:</span>
</span><span id="Expr-2177"><a href="#Expr-2177"><span class="linenos">2177</span></a>            <span class="k">return</span> <span class="n">n</span>
</span><span id="Expr-2178"><a href="#Expr-2178"><span class="linenos">2178</span></a>        <span class="k">if</span> <span class="n">d</span><span class="o">.</span><span class="n">is_Number</span><span class="p">:</span>
</span><span id="Expr-2179"><a href="#Expr-2179"><span class="linenos">2179</span></a>            <span class="k">return</span> <span class="n">_unevaluated_Mul</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">d</span><span class="p">)</span>
</span><span id="Expr-2180"><a href="#Expr-2180"><span class="linenos">2180</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Expr-2181"><a href="#Expr-2181"><span class="linenos">2181</span></a>            <span class="k">return</span> <span class="n">n</span><span class="o">/</span><span class="n">d</span>
</span><span id="Expr-2182"><a href="#Expr-2182"><span class="linenos">2182</span></a>
</span><span id="Expr-2183"><a href="#Expr-2183"><span class="linenos">2183</span></a>    <span class="k">def</span> <span class="nf">extract_multiplicatively</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
</span><span id="Expr-2184"><a href="#Expr-2184"><span class="linenos">2184</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return None if it&#39;s not possible to make self in the form</span>
</span><span id="Expr-2185"><a href="#Expr-2185"><span class="linenos">2185</span></a><span class="sd">           c * something in a nice way, i.e. preserving the properties</span>
</span><span id="Expr-2186"><a href="#Expr-2186"><span class="linenos">2186</span></a><span class="sd">           of arguments of self.</span>
</span><span id="Expr-2187"><a href="#Expr-2187"><span class="linenos">2187</span></a>
</span><span id="Expr-2188"><a href="#Expr-2188"><span class="linenos">2188</span></a><span class="sd">           Examples</span>
</span><span id="Expr-2189"><a href="#Expr-2189"><span class="linenos">2189</span></a><span class="sd">           ========</span>
</span><span id="Expr-2190"><a href="#Expr-2190"><span class="linenos">2190</span></a>
</span><span id="Expr-2191"><a href="#Expr-2191"><span class="linenos">2191</span></a><span class="sd">           &gt;&gt;&gt; from sympy import symbols, Rational</span>
</span><span id="Expr-2192"><a href="#Expr-2192"><span class="linenos">2192</span></a>
</span><span id="Expr-2193"><a href="#Expr-2193"><span class="linenos">2193</span></a><span class="sd">           &gt;&gt;&gt; x, y = symbols(&#39;x,y&#39;, real=True)</span>
</span><span id="Expr-2194"><a href="#Expr-2194"><span class="linenos">2194</span></a>
</span><span id="Expr-2195"><a href="#Expr-2195"><span class="linenos">2195</span></a><span class="sd">           &gt;&gt;&gt; ((x*y)**3).extract_multiplicatively(x**2 * y)</span>
</span><span id="Expr-2196"><a href="#Expr-2196"><span class="linenos">2196</span></a><span class="sd">           x*y**2</span>
</span><span id="Expr-2197"><a href="#Expr-2197"><span class="linenos">2197</span></a>
</span><span id="Expr-2198"><a href="#Expr-2198"><span class="linenos">2198</span></a><span class="sd">           &gt;&gt;&gt; ((x*y)**3).extract_multiplicatively(x**4 * y)</span>
</span><span id="Expr-2199"><a href="#Expr-2199"><span class="linenos">2199</span></a>
</span><span id="Expr-2200"><a href="#Expr-2200"><span class="linenos">2200</span></a><span class="sd">           &gt;&gt;&gt; (2*x).extract_multiplicatively(2)</span>
</span><span id="Expr-2201"><a href="#Expr-2201"><span class="linenos">2201</span></a><span class="sd">           x</span>
</span><span id="Expr-2202"><a href="#Expr-2202"><span class="linenos">2202</span></a>
</span><span id="Expr-2203"><a href="#Expr-2203"><span class="linenos">2203</span></a><span class="sd">           &gt;&gt;&gt; (2*x).extract_multiplicatively(3)</span>
</span><span id="Expr-2204"><a href="#Expr-2204"><span class="linenos">2204</span></a>
</span><span id="Expr-2205"><a href="#Expr-2205"><span class="linenos">2205</span></a><span class="sd">           &gt;&gt;&gt; (Rational(1, 2)*x).extract_multiplicatively(3)</span>
</span><span id="Expr-2206"><a href="#Expr-2206"><span class="linenos">2206</span></a><span class="sd">           x/6</span>
</span><span id="Expr-2207"><a href="#Expr-2207"><span class="linenos">2207</span></a>
</span><span id="Expr-2208"><a href="#Expr-2208"><span class="linenos">2208</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Expr-2209"><a href="#Expr-2209"><span class="linenos">2209</span></a>        <span class="kn">from</span> <span class="nn">sympy.functions.elementary.exponential</span> <span class="kn">import</span> <span class="n">exp</span>
</span><span id="Expr-2210"><a href="#Expr-2210"><span class="linenos">2210</span></a>        <span class="kn">from</span> <span class="nn">.add</span> <span class="kn">import</span> <span class="n">_unevaluated_Add</span>
</span><span id="Expr-2211"><a href="#Expr-2211"><span class="linenos">2211</span></a>        <span class="n">c</span> <span class="o">=</span> <span class="n">sympify</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
</span><span id="Expr-2212"><a href="#Expr-2212"><span class="linenos">2212</span></a>        <span class="k">if</span> <span class="bp">self</span> <span class="ow">is</span> <span class="n">S</span><span class="o">.</span><span class="n">NaN</span><span class="p">:</span>
</span><span id="Expr-2213"><a href="#Expr-2213"><span class="linenos">2213</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="Expr-2214"><a href="#Expr-2214"><span class="linenos">2214</span></a>        <span class="k">if</span> <span class="n">c</span> <span class="ow">is</span> <span class="n">S</span><span class="o">.</span><span class="n">One</span><span class="p">:</span>
</span><span id="Expr-2215"><a href="#Expr-2215"><span class="linenos">2215</span></a>            <span class="k">return</span> <span class="bp">self</span>
</span><span id="Expr-2216"><a href="#Expr-2216"><span class="linenos">2216</span></a>        <span class="k">elif</span> <span class="n">c</span> <span class="o">==</span> <span class="bp">self</span><span class="p">:</span>
</span><span id="Expr-2217"><a href="#Expr-2217"><span class="linenos">2217</span></a>            <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">One</span>
</span><span id="Expr-2218"><a href="#Expr-2218"><span class="linenos">2218</span></a>
</span><span id="Expr-2219"><a href="#Expr-2219"><span class="linenos">2219</span></a>        <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">is_Add</span><span class="p">:</span>
</span><span id="Expr-2220"><a href="#Expr-2220"><span class="linenos">2220</span></a>            <span class="n">cc</span><span class="p">,</span> <span class="n">pc</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">primitive</span><span class="p">()</span>
</span><span id="Expr-2221"><a href="#Expr-2221"><span class="linenos">2221</span></a>            <span class="k">if</span> <span class="n">cc</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">S</span><span class="o">.</span><span class="n">One</span><span class="p">:</span>
</span><span id="Expr-2222"><a href="#Expr-2222"><span class="linenos">2222</span></a>                <span class="n">c</span> <span class="o">=</span> <span class="n">Mul</span><span class="p">(</span><span class="n">cc</span><span class="p">,</span> <span class="n">pc</span><span class="p">,</span> <span class="n">evaluate</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="Expr-2223"><a href="#Expr-2223"><span class="linenos">2223</span></a>
</span><span id="Expr-2224"><a href="#Expr-2224"><span class="linenos">2224</span></a>        <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">is_Mul</span><span class="p">:</span>
</span><span id="Expr-2225"><a href="#Expr-2225"><span class="linenos">2225</span></a>            <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">as_two_terms</span><span class="p">()</span>
</span><span id="Expr-2226"><a href="#Expr-2226"><span class="linenos">2226</span></a>            <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">extract_multiplicatively</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</span><span id="Expr-2227"><a href="#Expr-2227"><span class="linenos">2227</span></a>            <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Expr-2228"><a href="#Expr-2228"><span class="linenos">2228</span></a>                <span class="k">return</span> <span class="n">x</span><span class="o">.</span><span class="n">extract_multiplicatively</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
</span><span id="Expr-2229"><a href="#Expr-2229"><span class="linenos">2229</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Expr-2230"><a href="#Expr-2230"><span class="linenos">2230</span></a>                <span class="k">return</span> <span class="n">x</span>
</span><span id="Expr-2231"><a href="#Expr-2231"><span class="linenos">2231</span></a>
</span><span id="Expr-2232"><a href="#Expr-2232"><span class="linenos">2232</span></a>        <span class="n">quotient</span> <span class="o">=</span> <span class="bp">self</span> <span class="o">/</span> <span class="n">c</span>
</span><span id="Expr-2233"><a href="#Expr-2233"><span class="linenos">2233</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_Number</span><span class="p">:</span>
</span><span id="Expr-2234"><a href="#Expr-2234"><span class="linenos">2234</span></a>            <span class="k">if</span> <span class="bp">self</span> <span class="ow">is</span> <span class="n">S</span><span class="o">.</span><span class="n">Infinity</span><span class="p">:</span>
</span><span id="Expr-2235"><a href="#Expr-2235"><span class="linenos">2235</span></a>                <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">is_positive</span><span class="p">:</span>
</span><span id="Expr-2236"><a href="#Expr-2236"><span class="linenos">2236</span></a>                    <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">Infinity</span>
</span><span id="Expr-2237"><a href="#Expr-2237"><span class="linenos">2237</span></a>            <span class="k">elif</span> <span class="bp">self</span> <span class="ow">is</span> <span class="n">S</span><span class="o">.</span><span class="n">NegativeInfinity</span><span class="p">:</span>
</span><span id="Expr-2238"><a href="#Expr-2238"><span class="linenos">2238</span></a>                <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">is_negative</span><span class="p">:</span>
</span><span id="Expr-2239"><a href="#Expr-2239"><span class="linenos">2239</span></a>                    <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">Infinity</span>
</span><span id="Expr-2240"><a href="#Expr-2240"><span class="linenos">2240</span></a>                <span class="k">elif</span> <span class="n">c</span><span class="o">.</span><span class="n">is_positive</span><span class="p">:</span>
</span><span id="Expr-2241"><a href="#Expr-2241"><span class="linenos">2241</span></a>                    <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">NegativeInfinity</span>
</span><span id="Expr-2242"><a href="#Expr-2242"><span class="linenos">2242</span></a>            <span class="k">elif</span> <span class="bp">self</span> <span class="ow">is</span> <span class="n">S</span><span class="o">.</span><span class="n">ComplexInfinity</span><span class="p">:</span>
</span><span id="Expr-2243"><a href="#Expr-2243"><span class="linenos">2243</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">c</span><span class="o">.</span><span class="n">is_zero</span><span class="p">:</span>
</span><span id="Expr-2244"><a href="#Expr-2244"><span class="linenos">2244</span></a>                    <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">ComplexInfinity</span>
</span><span id="Expr-2245"><a href="#Expr-2245"><span class="linenos">2245</span></a>            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_Integer</span><span class="p">:</span>
</span><span id="Expr-2246"><a href="#Expr-2246"><span class="linenos">2246</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">quotient</span><span class="o">.</span><span class="n">is_Integer</span><span class="p">:</span>
</span><span id="Expr-2247"><a href="#Expr-2247"><span class="linenos">2247</span></a>                    <span class="k">return</span> <span class="kc">None</span>
</span><span id="Expr-2248"><a href="#Expr-2248"><span class="linenos">2248</span></a>                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_positive</span> <span class="ow">and</span> <span class="n">quotient</span><span class="o">.</span><span class="n">is_negative</span><span class="p">:</span>
</span><span id="Expr-2249"><a href="#Expr-2249"><span class="linenos">2249</span></a>                    <span class="k">return</span> <span class="kc">None</span>
</span><span id="Expr-2250"><a href="#Expr-2250"><span class="linenos">2250</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="Expr-2251"><a href="#Expr-2251"><span class="linenos">2251</span></a>                    <span class="k">return</span> <span class="n">quotient</span>
</span><span id="Expr-2252"><a href="#Expr-2252"><span class="linenos">2252</span></a>            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_Rational</span><span class="p">:</span>
</span><span id="Expr-2253"><a href="#Expr-2253"><span class="linenos">2253</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">quotient</span><span class="o">.</span><span class="n">is_Rational</span><span class="p">:</span>
</span><span id="Expr-2254"><a href="#Expr-2254"><span class="linenos">2254</span></a>                    <span class="k">return</span> <span class="kc">None</span>
</span><span id="Expr-2255"><a href="#Expr-2255"><span class="linenos">2255</span></a>                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_positive</span> <span class="ow">and</span> <span class="n">quotient</span><span class="o">.</span><span class="n">is_negative</span><span class="p">:</span>
</span><span id="Expr-2256"><a href="#Expr-2256"><span class="linenos">2256</span></a>                    <span class="k">return</span> <span class="kc">None</span>
</span><span id="Expr-2257"><a href="#Expr-2257"><span class="linenos">2257</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="Expr-2258"><a href="#Expr-2258"><span class="linenos">2258</span></a>                    <span class="k">return</span> <span class="n">quotient</span>
</span><span id="Expr-2259"><a href="#Expr-2259"><span class="linenos">2259</span></a>            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_Float</span><span class="p">:</span>
</span><span id="Expr-2260"><a href="#Expr-2260"><span class="linenos">2260</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">quotient</span><span class="o">.</span><span class="n">is_Float</span><span class="p">:</span>
</span><span id="Expr-2261"><a href="#Expr-2261"><span class="linenos">2261</span></a>                    <span class="k">return</span> <span class="kc">None</span>
</span><span id="Expr-2262"><a href="#Expr-2262"><span class="linenos">2262</span></a>                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_positive</span> <span class="ow">and</span> <span class="n">quotient</span><span class="o">.</span><span class="n">is_negative</span><span class="p">:</span>
</span><span id="Expr-2263"><a href="#Expr-2263"><span class="linenos">2263</span></a>                    <span class="k">return</span> <span class="kc">None</span>
</span><span id="Expr-2264"><a href="#Expr-2264"><span class="linenos">2264</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="Expr-2265"><a href="#Expr-2265"><span class="linenos">2265</span></a>                    <span class="k">return</span> <span class="n">quotient</span>
</span><span id="Expr-2266"><a href="#Expr-2266"><span class="linenos">2266</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_NumberSymbol</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_Symbol</span> <span class="ow">or</span> <span class="bp">self</span> <span class="ow">is</span> <span class="n">S</span><span class="o">.</span><span class="n">ImaginaryUnit</span><span class="p">:</span>
</span><span id="Expr-2267"><a href="#Expr-2267"><span class="linenos">2267</span></a>            <span class="k">if</span> <span class="n">quotient</span><span class="o">.</span><span class="n">is_Mul</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">quotient</span><span class="o">.</span><span class="n">args</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="Expr-2268"><a href="#Expr-2268"><span class="linenos">2268</span></a>                <span class="k">if</span> <span class="n">quotient</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">is_Integer</span> <span class="ow">and</span> <span class="n">quotient</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">is_positive</span> <span class="ow">and</span> <span class="n">quotient</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="bp">self</span><span class="p">:</span>
</span><span id="Expr-2269"><a href="#Expr-2269"><span class="linenos">2269</span></a>                    <span class="k">return</span> <span class="n">quotient</span>
</span><span id="Expr-2270"><a href="#Expr-2270"><span class="linenos">2270</span></a>            <span class="k">elif</span> <span class="n">quotient</span><span class="o">.</span><span class="n">is_Integer</span> <span class="ow">and</span> <span class="n">c</span><span class="o">.</span><span class="n">is_Number</span><span class="p">:</span>
</span><span id="Expr-2271"><a href="#Expr-2271"><span class="linenos">2271</span></a>                <span class="k">return</span> <span class="n">quotient</span>
</span><span id="Expr-2272"><a href="#Expr-2272"><span class="linenos">2272</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_Add</span><span class="p">:</span>
</span><span id="Expr-2273"><a href="#Expr-2273"><span class="linenos">2273</span></a>            <span class="n">cs</span><span class="p">,</span> <span class="n">ps</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">primitive</span><span class="p">()</span>
</span><span id="Expr-2274"><a href="#Expr-2274"><span class="linenos">2274</span></a>            <span class="c1"># assert cs &gt;= 1</span>
</span><span id="Expr-2275"><a href="#Expr-2275"><span class="linenos">2275</span></a>            <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">is_Number</span> <span class="ow">and</span> <span class="n">c</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">S</span><span class="o">.</span><span class="n">NegativeOne</span><span class="p">:</span>
</span><span id="Expr-2276"><a href="#Expr-2276"><span class="linenos">2276</span></a>                <span class="c1"># assert c != 1 (handled at top)</span>
</span><span id="Expr-2277"><a href="#Expr-2277"><span class="linenos">2277</span></a>                <span class="k">if</span> <span class="n">cs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">S</span><span class="o">.</span><span class="n">One</span><span class="p">:</span>
</span><span id="Expr-2278"><a href="#Expr-2278"><span class="linenos">2278</span></a>                    <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">is_negative</span><span class="p">:</span>
</span><span id="Expr-2279"><a href="#Expr-2279"><span class="linenos">2279</span></a>                        <span class="n">xc</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">cs</span><span class="o">.</span><span class="n">extract_multiplicatively</span><span class="p">(</span><span class="o">-</span><span class="n">c</span><span class="p">))</span>
</span><span id="Expr-2280"><a href="#Expr-2280"><span class="linenos">2280</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="Expr-2281"><a href="#Expr-2281"><span class="linenos">2281</span></a>                        <span class="n">xc</span> <span class="o">=</span> <span class="n">cs</span><span class="o">.</span><span class="n">extract_multiplicatively</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
</span><span id="Expr-2282"><a href="#Expr-2282"><span class="linenos">2282</span></a>                    <span class="k">if</span> <span class="n">xc</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Expr-2283"><a href="#Expr-2283"><span class="linenos">2283</span></a>                        <span class="k">return</span> <span class="n">xc</span><span class="o">*</span><span class="n">ps</span>  <span class="c1"># rely on 2-arg Mul to restore Add</span>
</span><span id="Expr-2284"><a href="#Expr-2284"><span class="linenos">2284</span></a>                <span class="k">return</span>  <span class="c1"># |c| != 1 can only be extracted from cs</span>
</span><span id="Expr-2285"><a href="#Expr-2285"><span class="linenos">2285</span></a>            <span class="k">if</span> <span class="n">c</span> <span class="o">==</span> <span class="n">ps</span><span class="p">:</span>
</span><span id="Expr-2286"><a href="#Expr-2286"><span class="linenos">2286</span></a>                <span class="k">return</span> <span class="n">cs</span>
</span><span id="Expr-2287"><a href="#Expr-2287"><span class="linenos">2287</span></a>            <span class="c1"># check args of ps</span>
</span><span id="Expr-2288"><a href="#Expr-2288"><span class="linenos">2288</span></a>            <span class="n">newargs</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Expr-2289"><a href="#Expr-2289"><span class="linenos">2289</span></a>            <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">ps</span><span class="o">.</span><span class="n">args</span><span class="p">:</span>
</span><span id="Expr-2290"><a href="#Expr-2290"><span class="linenos">2290</span></a>                <span class="n">newarg</span> <span class="o">=</span> <span class="n">arg</span><span class="o">.</span><span class="n">extract_multiplicatively</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
</span><span id="Expr-2291"><a href="#Expr-2291"><span class="linenos">2291</span></a>                <span class="k">if</span> <span class="n">newarg</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Expr-2292"><a href="#Expr-2292"><span class="linenos">2292</span></a>                    <span class="k">return</span>  <span class="c1"># all or nothing</span>
</span><span id="Expr-2293"><a href="#Expr-2293"><span class="linenos">2293</span></a>                <span class="n">newargs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">newarg</span><span class="p">)</span>
</span><span id="Expr-2294"><a href="#Expr-2294"><span class="linenos">2294</span></a>            <span class="k">if</span> <span class="n">cs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">S</span><span class="o">.</span><span class="n">One</span><span class="p">:</span>
</span><span id="Expr-2295"><a href="#Expr-2295"><span class="linenos">2295</span></a>                <span class="n">args</span> <span class="o">=</span> <span class="p">[</span><span class="n">cs</span><span class="o">*</span><span class="n">t</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">newargs</span><span class="p">]</span>
</span><span id="Expr-2296"><a href="#Expr-2296"><span class="linenos">2296</span></a>                <span class="c1"># args may be in different order</span>
</span><span id="Expr-2297"><a href="#Expr-2297"><span class="linenos">2297</span></a>                <span class="k">return</span> <span class="n">_unevaluated_Add</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
</span><span id="Expr-2298"><a href="#Expr-2298"><span class="linenos">2298</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Expr-2299"><a href="#Expr-2299"><span class="linenos">2299</span></a>                <span class="k">return</span> <span class="n">Add</span><span class="o">.</span><span class="n">_from_args</span><span class="p">(</span><span class="n">newargs</span><span class="p">)</span>
</span><span id="Expr-2300"><a href="#Expr-2300"><span class="linenos">2300</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_Mul</span><span class="p">:</span>
</span><span id="Expr-2301"><a href="#Expr-2301"><span class="linenos">2301</span></a>            <span class="n">args</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">)</span>
</span><span id="Expr-2302"><a href="#Expr-2302"><span class="linenos">2302</span></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">arg</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">args</span><span class="p">):</span>
</span><span id="Expr-2303"><a href="#Expr-2303"><span class="linenos">2303</span></a>                <span class="n">newarg</span> <span class="o">=</span> <span class="n">arg</span><span class="o">.</span><span class="n">extract_multiplicatively</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
</span><span id="Expr-2304"><a href="#Expr-2304"><span class="linenos">2304</span></a>                <span class="k">if</span> <span class="n">newarg</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Expr-2305"><a href="#Expr-2305"><span class="linenos">2305</span></a>                    <span class="n">args</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">newarg</span>
</span><span id="Expr-2306"><a href="#Expr-2306"><span class="linenos">2306</span></a>                    <span class="k">return</span> <span class="n">Mul</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
</span><span id="Expr-2307"><a href="#Expr-2307"><span class="linenos">2307</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_Pow</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exp</span><span class="p">):</span>
</span><span id="Expr-2308"><a href="#Expr-2308"><span class="linenos">2308</span></a>            <span class="n">sb</span><span class="p">,</span> <span class="n">se</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">as_base_exp</span><span class="p">()</span>
</span><span id="Expr-2309"><a href="#Expr-2309"><span class="linenos">2309</span></a>            <span class="n">cb</span><span class="p">,</span> <span class="n">ce</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">as_base_exp</span><span class="p">()</span>
</span><span id="Expr-2310"><a href="#Expr-2310"><span class="linenos">2310</span></a>            <span class="k">if</span> <span class="n">cb</span> <span class="o">==</span> <span class="n">sb</span><span class="p">:</span>
</span><span id="Expr-2311"><a href="#Expr-2311"><span class="linenos">2311</span></a>                <span class="n">new_exp</span> <span class="o">=</span> <span class="n">se</span><span class="o">.</span><span class="n">extract_additively</span><span class="p">(</span><span class="n">ce</span><span class="p">)</span>
</span><span id="Expr-2312"><a href="#Expr-2312"><span class="linenos">2312</span></a>                <span class="k">if</span> <span class="n">new_exp</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Expr-2313"><a href="#Expr-2313"><span class="linenos">2313</span></a>                    <span class="k">return</span> <span class="n">Pow</span><span class="p">(</span><span class="n">sb</span><span class="p">,</span> <span class="n">new_exp</span><span class="p">)</span>
</span><span id="Expr-2314"><a href="#Expr-2314"><span class="linenos">2314</span></a>            <span class="k">elif</span> <span class="n">c</span> <span class="o">==</span> <span class="n">sb</span><span class="p">:</span>
</span><span id="Expr-2315"><a href="#Expr-2315"><span class="linenos">2315</span></a>                <span class="n">new_exp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">exp</span><span class="o">.</span><span class="n">extract_additively</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span id="Expr-2316"><a href="#Expr-2316"><span class="linenos">2316</span></a>                <span class="k">if</span> <span class="n">new_exp</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Expr-2317"><a href="#Expr-2317"><span class="linenos">2317</span></a>                    <span class="k">return</span> <span class="n">Pow</span><span class="p">(</span><span class="n">sb</span><span class="p">,</span> <span class="n">new_exp</span><span class="p">)</span>
</span><span id="Expr-2318"><a href="#Expr-2318"><span class="linenos">2318</span></a>
</span><span id="Expr-2319"><a href="#Expr-2319"><span class="linenos">2319</span></a>    <span class="k">def</span> <span class="nf">extract_additively</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
</span><span id="Expr-2320"><a href="#Expr-2320"><span class="linenos">2320</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return self - c if it&#39;s possible to subtract c from self and</span>
</span><span id="Expr-2321"><a href="#Expr-2321"><span class="linenos">2321</span></a><span class="sd">        make all matching coefficients move towards zero, else return None.</span>
</span><span id="Expr-2322"><a href="#Expr-2322"><span class="linenos">2322</span></a>
</span><span id="Expr-2323"><a href="#Expr-2323"><span class="linenos">2323</span></a><span class="sd">        Examples</span>
</span><span id="Expr-2324"><a href="#Expr-2324"><span class="linenos">2324</span></a><span class="sd">        ========</span>
</span><span id="Expr-2325"><a href="#Expr-2325"><span class="linenos">2325</span></a>
</span><span id="Expr-2326"><a href="#Expr-2326"><span class="linenos">2326</span></a><span class="sd">        &gt;&gt;&gt; from sympy.abc import x, y</span>
</span><span id="Expr-2327"><a href="#Expr-2327"><span class="linenos">2327</span></a><span class="sd">        &gt;&gt;&gt; e = 2*x + 3</span>
</span><span id="Expr-2328"><a href="#Expr-2328"><span class="linenos">2328</span></a><span class="sd">        &gt;&gt;&gt; e.extract_additively(x + 1)</span>
</span><span id="Expr-2329"><a href="#Expr-2329"><span class="linenos">2329</span></a><span class="sd">        x + 2</span>
</span><span id="Expr-2330"><a href="#Expr-2330"><span class="linenos">2330</span></a><span class="sd">        &gt;&gt;&gt; e.extract_additively(3*x)</span>
</span><span id="Expr-2331"><a href="#Expr-2331"><span class="linenos">2331</span></a><span class="sd">        &gt;&gt;&gt; e.extract_additively(4)</span>
</span><span id="Expr-2332"><a href="#Expr-2332"><span class="linenos">2332</span></a><span class="sd">        &gt;&gt;&gt; (y*(x + 1)).extract_additively(x + 1)</span>
</span><span id="Expr-2333"><a href="#Expr-2333"><span class="linenos">2333</span></a><span class="sd">        &gt;&gt;&gt; ((x + 1)*(x + 2*y + 1) + 3).extract_additively(x + 1)</span>
</span><span id="Expr-2334"><a href="#Expr-2334"><span class="linenos">2334</span></a><span class="sd">        (x + 1)*(x + 2*y) + 3</span>
</span><span id="Expr-2335"><a href="#Expr-2335"><span class="linenos">2335</span></a>
</span><span id="Expr-2336"><a href="#Expr-2336"><span class="linenos">2336</span></a><span class="sd">        See Also</span>
</span><span id="Expr-2337"><a href="#Expr-2337"><span class="linenos">2337</span></a><span class="sd">        ========</span>
</span><span id="Expr-2338"><a href="#Expr-2338"><span class="linenos">2338</span></a><span class="sd">        extract_multiplicatively</span>
</span><span id="Expr-2339"><a href="#Expr-2339"><span class="linenos">2339</span></a><span class="sd">        coeff</span>
</span><span id="Expr-2340"><a href="#Expr-2340"><span class="linenos">2340</span></a><span class="sd">        as_coefficient</span>
</span><span id="Expr-2341"><a href="#Expr-2341"><span class="linenos">2341</span></a>
</span><span id="Expr-2342"><a href="#Expr-2342"><span class="linenos">2342</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Expr-2343"><a href="#Expr-2343"><span class="linenos">2343</span></a>
</span><span id="Expr-2344"><a href="#Expr-2344"><span class="linenos">2344</span></a>        <span class="n">c</span> <span class="o">=</span> <span class="n">sympify</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
</span><span id="Expr-2345"><a href="#Expr-2345"><span class="linenos">2345</span></a>        <span class="k">if</span> <span class="bp">self</span> <span class="ow">is</span> <span class="n">S</span><span class="o">.</span><span class="n">NaN</span><span class="p">:</span>
</span><span id="Expr-2346"><a href="#Expr-2346"><span class="linenos">2346</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="Expr-2347"><a href="#Expr-2347"><span class="linenos">2347</span></a>        <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">is_zero</span><span class="p">:</span>
</span><span id="Expr-2348"><a href="#Expr-2348"><span class="linenos">2348</span></a>            <span class="k">return</span> <span class="bp">self</span>
</span><span id="Expr-2349"><a href="#Expr-2349"><span class="linenos">2349</span></a>        <span class="k">elif</span> <span class="n">c</span> <span class="o">==</span> <span class="bp">self</span><span class="p">:</span>
</span><span id="Expr-2350"><a href="#Expr-2350"><span class="linenos">2350</span></a>            <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">Zero</span>
</span><span id="Expr-2351"><a href="#Expr-2351"><span class="linenos">2351</span></a>        <span class="k">elif</span> <span class="bp">self</span> <span class="o">==</span> <span class="n">S</span><span class="o">.</span><span class="n">Zero</span><span class="p">:</span>
</span><span id="Expr-2352"><a href="#Expr-2352"><span class="linenos">2352</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="Expr-2353"><a href="#Expr-2353"><span class="linenos">2353</span></a>
</span><span id="Expr-2354"><a href="#Expr-2354"><span class="linenos">2354</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_Number</span><span class="p">:</span>
</span><span id="Expr-2355"><a href="#Expr-2355"><span class="linenos">2355</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">c</span><span class="o">.</span><span class="n">is_Number</span><span class="p">:</span>
</span><span id="Expr-2356"><a href="#Expr-2356"><span class="linenos">2356</span></a>                <span class="k">return</span> <span class="kc">None</span>
</span><span id="Expr-2357"><a href="#Expr-2357"><span class="linenos">2357</span></a>            <span class="n">co</span> <span class="o">=</span> <span class="bp">self</span>
</span><span id="Expr-2358"><a href="#Expr-2358"><span class="linenos">2358</span></a>            <span class="n">diff</span> <span class="o">=</span> <span class="n">co</span> <span class="o">-</span> <span class="n">c</span>
</span><span id="Expr-2359"><a href="#Expr-2359"><span class="linenos">2359</span></a>            <span class="c1"># XXX should we match types? i.e should 3 - .1 succeed?</span>
</span><span id="Expr-2360"><a href="#Expr-2360"><span class="linenos">2360</span></a>            <span class="k">if</span> <span class="p">(</span><span class="n">co</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">diff</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">diff</span> <span class="o">&lt;</span> <span class="n">co</span> <span class="ow">or</span>
</span><span id="Expr-2361"><a href="#Expr-2361"><span class="linenos">2361</span></a>                    <span class="n">co</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">diff</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">diff</span> <span class="o">&gt;</span> <span class="n">co</span><span class="p">):</span>
</span><span id="Expr-2362"><a href="#Expr-2362"><span class="linenos">2362</span></a>                <span class="k">return</span> <span class="n">diff</span>
</span><span id="Expr-2363"><a href="#Expr-2363"><span class="linenos">2363</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="Expr-2364"><a href="#Expr-2364"><span class="linenos">2364</span></a>
</span><span id="Expr-2365"><a href="#Expr-2365"><span class="linenos">2365</span></a>        <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">is_Number</span><span class="p">:</span>
</span><span id="Expr-2366"><a href="#Expr-2366"><span class="linenos">2366</span></a>            <span class="n">co</span><span class="p">,</span> <span class="n">t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">as_coeff_Add</span><span class="p">()</span>
</span><span id="Expr-2367"><a href="#Expr-2367"><span class="linenos">2367</span></a>            <span class="n">xa</span> <span class="o">=</span> <span class="n">co</span><span class="o">.</span><span class="n">extract_additively</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
</span><span id="Expr-2368"><a href="#Expr-2368"><span class="linenos">2368</span></a>            <span class="k">if</span> <span class="n">xa</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Expr-2369"><a href="#Expr-2369"><span class="linenos">2369</span></a>                <span class="k">return</span> <span class="kc">None</span>
</span><span id="Expr-2370"><a href="#Expr-2370"><span class="linenos">2370</span></a>            <span class="k">return</span> <span class="n">xa</span> <span class="o">+</span> <span class="n">t</span>
</span><span id="Expr-2371"><a href="#Expr-2371"><span class="linenos">2371</span></a>
</span><span id="Expr-2372"><a href="#Expr-2372"><span class="linenos">2372</span></a>        <span class="c1"># handle the args[0].is_Number case separately</span>
</span><span id="Expr-2373"><a href="#Expr-2373"><span class="linenos">2373</span></a>        <span class="c1"># since we will have trouble looking for the coeff of</span>
</span><span id="Expr-2374"><a href="#Expr-2374"><span class="linenos">2374</span></a>        <span class="c1"># a number.</span>
</span><span id="Expr-2375"><a href="#Expr-2375"><span class="linenos">2375</span></a>        <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">is_Add</span> <span class="ow">and</span> <span class="n">c</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">is_Number</span><span class="p">:</span>
</span><span id="Expr-2376"><a href="#Expr-2376"><span class="linenos">2376</span></a>            <span class="c1"># whole term as a term factor</span>
</span><span id="Expr-2377"><a href="#Expr-2377"><span class="linenos">2377</span></a>            <span class="n">co</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coeff</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
</span><span id="Expr-2378"><a href="#Expr-2378"><span class="linenos">2378</span></a>            <span class="n">xa0</span> <span class="o">=</span> <span class="p">(</span><span class="n">co</span><span class="o">.</span><span class="n">extract_additively</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="ow">or</span> <span class="mi">0</span><span class="p">)</span><span class="o">*</span><span class="n">c</span>
</span><span id="Expr-2379"><a href="#Expr-2379"><span class="linenos">2379</span></a>            <span class="k">if</span> <span class="n">xa0</span><span class="p">:</span>
</span><span id="Expr-2380"><a href="#Expr-2380"><span class="linenos">2380</span></a>                <span class="n">diff</span> <span class="o">=</span> <span class="bp">self</span> <span class="o">-</span> <span class="n">co</span><span class="o">*</span><span class="n">c</span>
</span><span id="Expr-2381"><a href="#Expr-2381"><span class="linenos">2381</span></a>                <span class="k">return</span> <span class="p">(</span><span class="n">xa0</span> <span class="o">+</span> <span class="p">(</span><span class="n">diff</span><span class="o">.</span><span class="n">extract_additively</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="ow">or</span> <span class="n">diff</span><span class="p">))</span> <span class="ow">or</span> <span class="kc">None</span>
</span><span id="Expr-2382"><a href="#Expr-2382"><span class="linenos">2382</span></a>            <span class="c1"># term-wise</span>
</span><span id="Expr-2383"><a href="#Expr-2383"><span class="linenos">2383</span></a>            <span class="n">h</span><span class="p">,</span> <span class="n">t</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">as_coeff_Add</span><span class="p">()</span>
</span><span id="Expr-2384"><a href="#Expr-2384"><span class="linenos">2384</span></a>            <span class="n">sh</span><span class="p">,</span> <span class="n">st</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">as_coeff_Add</span><span class="p">()</span>
</span><span id="Expr-2385"><a href="#Expr-2385"><span class="linenos">2385</span></a>            <span class="n">xa</span> <span class="o">=</span> <span class="n">sh</span><span class="o">.</span><span class="n">extract_additively</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
</span><span id="Expr-2386"><a href="#Expr-2386"><span class="linenos">2386</span></a>            <span class="k">if</span> <span class="n">xa</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Expr-2387"><a href="#Expr-2387"><span class="linenos">2387</span></a>                <span class="k">return</span> <span class="kc">None</span>
</span><span id="Expr-2388"><a href="#Expr-2388"><span class="linenos">2388</span></a>            <span class="n">xa2</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">extract_additively</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
</span><span id="Expr-2389"><a href="#Expr-2389"><span class="linenos">2389</span></a>            <span class="k">if</span> <span class="n">xa2</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Expr-2390"><a href="#Expr-2390"><span class="linenos">2390</span></a>                <span class="k">return</span> <span class="kc">None</span>
</span><span id="Expr-2391"><a href="#Expr-2391"><span class="linenos">2391</span></a>            <span class="k">return</span> <span class="n">xa</span> <span class="o">+</span> <span class="n">xa2</span>
</span><span id="Expr-2392"><a href="#Expr-2392"><span class="linenos">2392</span></a>
</span><span id="Expr-2393"><a href="#Expr-2393"><span class="linenos">2393</span></a>        <span class="c1"># whole term as a term factor</span>
</span><span id="Expr-2394"><a href="#Expr-2394"><span class="linenos">2394</span></a>        <span class="n">co</span><span class="p">,</span> <span class="n">diff</span> <span class="o">=</span> <span class="n">_corem</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
</span><span id="Expr-2395"><a href="#Expr-2395"><span class="linenos">2395</span></a>        <span class="n">xa0</span> <span class="o">=</span> <span class="p">(</span><span class="n">co</span><span class="o">.</span><span class="n">extract_additively</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="ow">or</span> <span class="mi">0</span><span class="p">)</span><span class="o">*</span><span class="n">c</span>
</span><span id="Expr-2396"><a href="#Expr-2396"><span class="linenos">2396</span></a>        <span class="k">if</span> <span class="n">xa0</span><span class="p">:</span>
</span><span id="Expr-2397"><a href="#Expr-2397"><span class="linenos">2397</span></a>            <span class="k">return</span> <span class="p">(</span><span class="n">xa0</span> <span class="o">+</span> <span class="p">(</span><span class="n">diff</span><span class="o">.</span><span class="n">extract_additively</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="ow">or</span> <span class="n">diff</span><span class="p">))</span> <span class="ow">or</span> <span class="kc">None</span>
</span><span id="Expr-2398"><a href="#Expr-2398"><span class="linenos">2398</span></a>        <span class="c1"># term-wise</span>
</span><span id="Expr-2399"><a href="#Expr-2399"><span class="linenos">2399</span></a>        <span class="n">coeffs</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Expr-2400"><a href="#Expr-2400"><span class="linenos">2400</span></a>        <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">Add</span><span class="o">.</span><span class="n">make_args</span><span class="p">(</span><span class="n">c</span><span class="p">):</span>
</span><span id="Expr-2401"><a href="#Expr-2401"><span class="linenos">2401</span></a>            <span class="n">ac</span><span class="p">,</span> <span class="n">at</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">as_coeff_Mul</span><span class="p">()</span>
</span><span id="Expr-2402"><a href="#Expr-2402"><span class="linenos">2402</span></a>            <span class="n">co</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coeff</span><span class="p">(</span><span class="n">at</span><span class="p">)</span>
</span><span id="Expr-2403"><a href="#Expr-2403"><span class="linenos">2403</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">co</span><span class="p">:</span>
</span><span id="Expr-2404"><a href="#Expr-2404"><span class="linenos">2404</span></a>                <span class="k">return</span> <span class="kc">None</span>
</span><span id="Expr-2405"><a href="#Expr-2405"><span class="linenos">2405</span></a>            <span class="n">coc</span><span class="p">,</span> <span class="n">cot</span> <span class="o">=</span> <span class="n">co</span><span class="o">.</span><span class="n">as_coeff_Add</span><span class="p">()</span>
</span><span id="Expr-2406"><a href="#Expr-2406"><span class="linenos">2406</span></a>            <span class="n">xa</span> <span class="o">=</span> <span class="n">coc</span><span class="o">.</span><span class="n">extract_additively</span><span class="p">(</span><span class="n">ac</span><span class="p">)</span>
</span><span id="Expr-2407"><a href="#Expr-2407"><span class="linenos">2407</span></a>            <span class="k">if</span> <span class="n">xa</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Expr-2408"><a href="#Expr-2408"><span class="linenos">2408</span></a>                <span class="k">return</span> <span class="kc">None</span>
</span><span id="Expr-2409"><a href="#Expr-2409"><span class="linenos">2409</span></a>            <span class="bp">self</span> <span class="o">-=</span> <span class="n">co</span><span class="o">*</span><span class="n">at</span>
</span><span id="Expr-2410"><a href="#Expr-2410"><span class="linenos">2410</span></a>            <span class="n">coeffs</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">cot</span> <span class="o">+</span> <span class="n">xa</span><span class="p">)</span><span class="o">*</span><span class="n">at</span><span class="p">)</span>
</span><span id="Expr-2411"><a href="#Expr-2411"><span class="linenos">2411</span></a>        <span class="n">coeffs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="Expr-2412"><a href="#Expr-2412"><span class="linenos">2412</span></a>        <span class="k">return</span> <span class="n">Add</span><span class="p">(</span><span class="o">*</span><span class="n">coeffs</span><span class="p">)</span>
</span><span id="Expr-2413"><a href="#Expr-2413"><span class="linenos">2413</span></a>
</span><span id="Expr-2414"><a href="#Expr-2414"><span class="linenos">2414</span></a>    <span class="nd">@property</span>
</span><span id="Expr-2415"><a href="#Expr-2415"><span class="linenos">2415</span></a>    <span class="k">def</span> <span class="nf">expr_free_symbols</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Expr-2416"><a href="#Expr-2416"><span class="linenos">2416</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Expr-2417"><a href="#Expr-2417"><span class="linenos">2417</span></a><span class="sd">        Like ``free_symbols``, but returns the free symbols only if</span>
</span><span id="Expr-2418"><a href="#Expr-2418"><span class="linenos">2418</span></a><span class="sd">        they are contained in an expression node.</span>
</span><span id="Expr-2419"><a href="#Expr-2419"><span class="linenos">2419</span></a>
</span><span id="Expr-2420"><a href="#Expr-2420"><span class="linenos">2420</span></a><span class="sd">        Examples</span>
</span><span id="Expr-2421"><a href="#Expr-2421"><span class="linenos">2421</span></a><span class="sd">        ========</span>
</span><span id="Expr-2422"><a href="#Expr-2422"><span class="linenos">2422</span></a>
</span><span id="Expr-2423"><a href="#Expr-2423"><span class="linenos">2423</span></a><span class="sd">        &gt;&gt;&gt; from sympy.abc import x, y</span>
</span><span id="Expr-2424"><a href="#Expr-2424"><span class="linenos">2424</span></a><span class="sd">        &gt;&gt;&gt; (x + y).expr_free_symbols # doctest: +SKIP</span>
</span><span id="Expr-2425"><a href="#Expr-2425"><span class="linenos">2425</span></a><span class="sd">        {x, y}</span>
</span><span id="Expr-2426"><a href="#Expr-2426"><span class="linenos">2426</span></a>
</span><span id="Expr-2427"><a href="#Expr-2427"><span class="linenos">2427</span></a><span class="sd">        If the expression is contained in a non-expression object, do not return</span>
</span><span id="Expr-2428"><a href="#Expr-2428"><span class="linenos">2428</span></a><span class="sd">        the free symbols. Compare:</span>
</span><span id="Expr-2429"><a href="#Expr-2429"><span class="linenos">2429</span></a>
</span><span id="Expr-2430"><a href="#Expr-2430"><span class="linenos">2430</span></a><span class="sd">        &gt;&gt;&gt; from sympy import Tuple</span>
</span><span id="Expr-2431"><a href="#Expr-2431"><span class="linenos">2431</span></a><span class="sd">        &gt;&gt;&gt; t = Tuple(x + y)</span>
</span><span id="Expr-2432"><a href="#Expr-2432"><span class="linenos">2432</span></a><span class="sd">        &gt;&gt;&gt; t.expr_free_symbols # doctest: +SKIP</span>
</span><span id="Expr-2433"><a href="#Expr-2433"><span class="linenos">2433</span></a><span class="sd">        set()</span>
</span><span id="Expr-2434"><a href="#Expr-2434"><span class="linenos">2434</span></a><span class="sd">        &gt;&gt;&gt; t.free_symbols</span>
</span><span id="Expr-2435"><a href="#Expr-2435"><span class="linenos">2435</span></a><span class="sd">        {x, y}</span>
</span><span id="Expr-2436"><a href="#Expr-2436"><span class="linenos">2436</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Expr-2437"><a href="#Expr-2437"><span class="linenos">2437</span></a>        <span class="n">sympy_deprecation_warning</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
</span><span id="Expr-2438"><a href="#Expr-2438"><span class="linenos">2438</span></a><span class="s2">        The expr_free_symbols property is deprecated. Use free_symbols to get</span>
</span><span id="Expr-2439"><a href="#Expr-2439"><span class="linenos">2439</span></a><span class="s2">        the free symbols of an expression.</span>
</span><span id="Expr-2440"><a href="#Expr-2440"><span class="linenos">2440</span></a><span class="s2">        &quot;&quot;&quot;</span><span class="p">,</span>
</span><span id="Expr-2441"><a href="#Expr-2441"><span class="linenos">2441</span></a>            <span class="n">deprecated_since_version</span><span class="o">=</span><span class="s2">&quot;1.9&quot;</span><span class="p">,</span>
</span><span id="Expr-2442"><a href="#Expr-2442"><span class="linenos">2442</span></a>            <span class="n">active_deprecations_target</span><span class="o">=</span><span class="s2">&quot;deprecated-expr-free-symbols&quot;</span><span class="p">)</span>
</span><span id="Expr-2443"><a href="#Expr-2443"><span class="linenos">2443</span></a>        <span class="k">return</span> <span class="p">{</span><span class="n">j</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">i</span><span class="o">.</span><span class="n">expr_free_symbols</span><span class="p">}</span>
</span><span id="Expr-2444"><a href="#Expr-2444"><span class="linenos">2444</span></a>
</span><span id="Expr-2445"><a href="#Expr-2445"><span class="linenos">2445</span></a>    <span class="k">def</span> <span class="nf">could_extract_minus_sign</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Expr-2446"><a href="#Expr-2446"><span class="linenos">2446</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return True if self has -1 as a leading factor or has</span>
</span><span id="Expr-2447"><a href="#Expr-2447"><span class="linenos">2447</span></a><span class="sd">        more literal negative signs than positive signs in a sum,</span>
</span><span id="Expr-2448"><a href="#Expr-2448"><span class="linenos">2448</span></a><span class="sd">        otherwise False.</span>
</span><span id="Expr-2449"><a href="#Expr-2449"><span class="linenos">2449</span></a>
</span><span id="Expr-2450"><a href="#Expr-2450"><span class="linenos">2450</span></a><span class="sd">        Examples</span>
</span><span id="Expr-2451"><a href="#Expr-2451"><span class="linenos">2451</span></a><span class="sd">        ========</span>
</span><span id="Expr-2452"><a href="#Expr-2452"><span class="linenos">2452</span></a>
</span><span id="Expr-2453"><a href="#Expr-2453"><span class="linenos">2453</span></a><span class="sd">        &gt;&gt;&gt; from sympy.abc import x, y</span>
</span><span id="Expr-2454"><a href="#Expr-2454"><span class="linenos">2454</span></a><span class="sd">        &gt;&gt;&gt; e = x - y</span>
</span><span id="Expr-2455"><a href="#Expr-2455"><span class="linenos">2455</span></a><span class="sd">        &gt;&gt;&gt; {i.could_extract_minus_sign() for i in (e, -e)}</span>
</span><span id="Expr-2456"><a href="#Expr-2456"><span class="linenos">2456</span></a><span class="sd">        {False, True}</span>
</span><span id="Expr-2457"><a href="#Expr-2457"><span class="linenos">2457</span></a>
</span><span id="Expr-2458"><a href="#Expr-2458"><span class="linenos">2458</span></a><span class="sd">        Though the ``y - x`` is considered like ``-(x - y)``, since it</span>
</span><span id="Expr-2459"><a href="#Expr-2459"><span class="linenos">2459</span></a><span class="sd">        is in a product without a leading factor of -1, the result is</span>
</span><span id="Expr-2460"><a href="#Expr-2460"><span class="linenos">2460</span></a><span class="sd">        false below:</span>
</span><span id="Expr-2461"><a href="#Expr-2461"><span class="linenos">2461</span></a>
</span><span id="Expr-2462"><a href="#Expr-2462"><span class="linenos">2462</span></a><span class="sd">        &gt;&gt;&gt; (x*(y - x)).could_extract_minus_sign()</span>
</span><span id="Expr-2463"><a href="#Expr-2463"><span class="linenos">2463</span></a><span class="sd">        False</span>
</span><span id="Expr-2464"><a href="#Expr-2464"><span class="linenos">2464</span></a>
</span><span id="Expr-2465"><a href="#Expr-2465"><span class="linenos">2465</span></a><span class="sd">        To put something in canonical form wrt to sign, use `signsimp`:</span>
</span><span id="Expr-2466"><a href="#Expr-2466"><span class="linenos">2466</span></a>
</span><span id="Expr-2467"><a href="#Expr-2467"><span class="linenos">2467</span></a><span class="sd">        &gt;&gt;&gt; from sympy import signsimp</span>
</span><span id="Expr-2468"><a href="#Expr-2468"><span class="linenos">2468</span></a><span class="sd">        &gt;&gt;&gt; signsimp(x*(y - x))</span>
</span><span id="Expr-2469"><a href="#Expr-2469"><span class="linenos">2469</span></a><span class="sd">        -x*(x - y)</span>
</span><span id="Expr-2470"><a href="#Expr-2470"><span class="linenos">2470</span></a><span class="sd">        &gt;&gt;&gt; _.could_extract_minus_sign()</span>
</span><span id="Expr-2471"><a href="#Expr-2471"><span class="linenos">2471</span></a><span class="sd">        True</span>
</span><span id="Expr-2472"><a href="#Expr-2472"><span class="linenos">2472</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Expr-2473"><a href="#Expr-2473"><span class="linenos">2473</span></a>        <span class="k">return</span> <span class="kc">False</span>
</span><span id="Expr-2474"><a href="#Expr-2474"><span class="linenos">2474</span></a>
</span><span id="Expr-2475"><a href="#Expr-2475"><span class="linenos">2475</span></a>    <span class="k">def</span> <span class="nf">extract_branch_factor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">allow_half</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="Expr-2476"><a href="#Expr-2476"><span class="linenos">2476</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Expr-2477"><a href="#Expr-2477"><span class="linenos">2477</span></a><span class="sd">        Try to write self as ``exp_polar(2*pi*I*n)*z`` in a nice way.</span>
</span><span id="Expr-2478"><a href="#Expr-2478"><span class="linenos">2478</span></a><span class="sd">        Return (z, n).</span>
</span><span id="Expr-2479"><a href="#Expr-2479"><span class="linenos">2479</span></a>
</span><span id="Expr-2480"><a href="#Expr-2480"><span class="linenos">2480</span></a><span class="sd">        &gt;&gt;&gt; from sympy import exp_polar, I, pi</span>
</span><span id="Expr-2481"><a href="#Expr-2481"><span class="linenos">2481</span></a><span class="sd">        &gt;&gt;&gt; from sympy.abc import x, y</span>
</span><span id="Expr-2482"><a href="#Expr-2482"><span class="linenos">2482</span></a><span class="sd">        &gt;&gt;&gt; exp_polar(I*pi).extract_branch_factor()</span>
</span><span id="Expr-2483"><a href="#Expr-2483"><span class="linenos">2483</span></a><span class="sd">        (exp_polar(I*pi), 0)</span>
</span><span id="Expr-2484"><a href="#Expr-2484"><span class="linenos">2484</span></a><span class="sd">        &gt;&gt;&gt; exp_polar(2*I*pi).extract_branch_factor()</span>
</span><span id="Expr-2485"><a href="#Expr-2485"><span class="linenos">2485</span></a><span class="sd">        (1, 1)</span>
</span><span id="Expr-2486"><a href="#Expr-2486"><span class="linenos">2486</span></a><span class="sd">        &gt;&gt;&gt; exp_polar(-pi*I).extract_branch_factor()</span>
</span><span id="Expr-2487"><a href="#Expr-2487"><span class="linenos">2487</span></a><span class="sd">        (exp_polar(I*pi), -1)</span>
</span><span id="Expr-2488"><a href="#Expr-2488"><span class="linenos">2488</span></a><span class="sd">        &gt;&gt;&gt; exp_polar(3*pi*I + x).extract_branch_factor()</span>
</span><span id="Expr-2489"><a href="#Expr-2489"><span class="linenos">2489</span></a><span class="sd">        (exp_polar(x + I*pi), 1)</span>
</span><span id="Expr-2490"><a href="#Expr-2490"><span class="linenos">2490</span></a><span class="sd">        &gt;&gt;&gt; (y*exp_polar(-5*pi*I)*exp_polar(3*pi*I + 2*pi*x)).extract_branch_factor()</span>
</span><span id="Expr-2491"><a href="#Expr-2491"><span class="linenos">2491</span></a><span class="sd">        (y*exp_polar(2*pi*x), -1)</span>
</span><span id="Expr-2492"><a href="#Expr-2492"><span class="linenos">2492</span></a><span class="sd">        &gt;&gt;&gt; exp_polar(-I*pi/2).extract_branch_factor()</span>
</span><span id="Expr-2493"><a href="#Expr-2493"><span class="linenos">2493</span></a><span class="sd">        (exp_polar(-I*pi/2), 0)</span>
</span><span id="Expr-2494"><a href="#Expr-2494"><span class="linenos">2494</span></a>
</span><span id="Expr-2495"><a href="#Expr-2495"><span class="linenos">2495</span></a><span class="sd">        If allow_half is True, also extract exp_polar(I*pi):</span>
</span><span id="Expr-2496"><a href="#Expr-2496"><span class="linenos">2496</span></a>
</span><span id="Expr-2497"><a href="#Expr-2497"><span class="linenos">2497</span></a><span class="sd">        &gt;&gt;&gt; exp_polar(I*pi).extract_branch_factor(allow_half=True)</span>
</span><span id="Expr-2498"><a href="#Expr-2498"><span class="linenos">2498</span></a><span class="sd">        (1, 1/2)</span>
</span><span id="Expr-2499"><a href="#Expr-2499"><span class="linenos">2499</span></a><span class="sd">        &gt;&gt;&gt; exp_polar(2*I*pi).extract_branch_factor(allow_half=True)</span>
</span><span id="Expr-2500"><a href="#Expr-2500"><span class="linenos">2500</span></a><span class="sd">        (1, 1)</span>
</span><span id="Expr-2501"><a href="#Expr-2501"><span class="linenos">2501</span></a><span class="sd">        &gt;&gt;&gt; exp_polar(3*I*pi).extract_branch_factor(allow_half=True)</span>
</span><span id="Expr-2502"><a href="#Expr-2502"><span class="linenos">2502</span></a><span class="sd">        (1, 3/2)</span>
</span><span id="Expr-2503"><a href="#Expr-2503"><span class="linenos">2503</span></a><span class="sd">        &gt;&gt;&gt; exp_polar(-I*pi).extract_branch_factor(allow_half=True)</span>
</span><span id="Expr-2504"><a href="#Expr-2504"><span class="linenos">2504</span></a><span class="sd">        (1, -1/2)</span>
</span><span id="Expr-2505"><a href="#Expr-2505"><span class="linenos">2505</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Expr-2506"><a href="#Expr-2506"><span class="linenos">2506</span></a>        <span class="kn">from</span> <span class="nn">sympy.functions.elementary.exponential</span> <span class="kn">import</span> <span class="n">exp_polar</span>
</span><span id="Expr-2507"><a href="#Expr-2507"><span class="linenos">2507</span></a>        <span class="kn">from</span> <span class="nn">sympy.functions.elementary.integers</span> <span class="kn">import</span> <span class="n">ceiling</span>
</span><span id="Expr-2508"><a href="#Expr-2508"><span class="linenos">2508</span></a>
</span><span id="Expr-2509"><a href="#Expr-2509"><span class="linenos">2509</span></a>        <span class="n">n</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">Zero</span>
</span><span id="Expr-2510"><a href="#Expr-2510"><span class="linenos">2510</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">One</span>
</span><span id="Expr-2511"><a href="#Expr-2511"><span class="linenos">2511</span></a>        <span class="n">args</span> <span class="o">=</span> <span class="n">Mul</span><span class="o">.</span><span class="n">make_args</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="Expr-2512"><a href="#Expr-2512"><span class="linenos">2512</span></a>        <span class="n">exps</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Expr-2513"><a href="#Expr-2513"><span class="linenos">2513</span></a>        <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">args</span><span class="p">:</span>
</span><span id="Expr-2514"><a href="#Expr-2514"><span class="linenos">2514</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="n">exp_polar</span><span class="p">):</span>
</span><span id="Expr-2515"><a href="#Expr-2515"><span class="linenos">2515</span></a>                <span class="n">exps</span> <span class="o">+=</span> <span class="p">[</span><span class="n">arg</span><span class="o">.</span><span class="n">exp</span><span class="p">]</span>
</span><span id="Expr-2516"><a href="#Expr-2516"><span class="linenos">2516</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Expr-2517"><a href="#Expr-2517"><span class="linenos">2517</span></a>                <span class="n">res</span> <span class="o">*=</span> <span class="n">arg</span>
</span><span id="Expr-2518"><a href="#Expr-2518"><span class="linenos">2518</span></a>        <span class="n">piimult</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">Zero</span>
</span><span id="Expr-2519"><a href="#Expr-2519"><span class="linenos">2519</span></a>        <span class="n">extras</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Expr-2520"><a href="#Expr-2520"><span class="linenos">2520</span></a>
</span><span id="Expr-2521"><a href="#Expr-2521"><span class="linenos">2521</span></a>        <span class="n">ipi</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">Pi</span><span class="o">*</span><span class="n">S</span><span class="o">.</span><span class="n">ImaginaryUnit</span>
</span><span id="Expr-2522"><a href="#Expr-2522"><span class="linenos">2522</span></a>        <span class="k">while</span> <span class="n">exps</span><span class="p">:</span>
</span><span id="Expr-2523"><a href="#Expr-2523"><span class="linenos">2523</span></a>            <span class="n">exp</span> <span class="o">=</span> <span class="n">exps</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
</span><span id="Expr-2524"><a href="#Expr-2524"><span class="linenos">2524</span></a>            <span class="k">if</span> <span class="n">exp</span><span class="o">.</span><span class="n">is_Add</span><span class="p">:</span>
</span><span id="Expr-2525"><a href="#Expr-2525"><span class="linenos">2525</span></a>                <span class="n">exps</span> <span class="o">+=</span> <span class="n">exp</span><span class="o">.</span><span class="n">args</span>
</span><span id="Expr-2526"><a href="#Expr-2526"><span class="linenos">2526</span></a>                <span class="k">continue</span>
</span><span id="Expr-2527"><a href="#Expr-2527"><span class="linenos">2527</span></a>            <span class="k">if</span> <span class="n">exp</span><span class="o">.</span><span class="n">is_Mul</span><span class="p">:</span>
</span><span id="Expr-2528"><a href="#Expr-2528"><span class="linenos">2528</span></a>                <span class="n">coeff</span> <span class="o">=</span> <span class="n">exp</span><span class="o">.</span><span class="n">as_coefficient</span><span class="p">(</span><span class="n">ipi</span><span class="p">)</span>
</span><span id="Expr-2529"><a href="#Expr-2529"><span class="linenos">2529</span></a>                <span class="k">if</span> <span class="n">coeff</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Expr-2530"><a href="#Expr-2530"><span class="linenos">2530</span></a>                    <span class="n">piimult</span> <span class="o">+=</span> <span class="n">coeff</span>
</span><span id="Expr-2531"><a href="#Expr-2531"><span class="linenos">2531</span></a>                    <span class="k">continue</span>
</span><span id="Expr-2532"><a href="#Expr-2532"><span class="linenos">2532</span></a>            <span class="n">extras</span> <span class="o">+=</span> <span class="p">[</span><span class="n">exp</span><span class="p">]</span>
</span><span id="Expr-2533"><a href="#Expr-2533"><span class="linenos">2533</span></a>        <span class="k">if</span> <span class="n">piimult</span><span class="o">.</span><span class="n">is_number</span><span class="p">:</span>
</span><span id="Expr-2534"><a href="#Expr-2534"><span class="linenos">2534</span></a>            <span class="n">coeff</span> <span class="o">=</span> <span class="n">piimult</span>
</span><span id="Expr-2535"><a href="#Expr-2535"><span class="linenos">2535</span></a>            <span class="n">tail</span> <span class="o">=</span> <span class="p">()</span>
</span><span id="Expr-2536"><a href="#Expr-2536"><span class="linenos">2536</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Expr-2537"><a href="#Expr-2537"><span class="linenos">2537</span></a>            <span class="n">coeff</span><span class="p">,</span> <span class="n">tail</span> <span class="o">=</span> <span class="n">piimult</span><span class="o">.</span><span class="n">as_coeff_add</span><span class="p">(</span><span class="o">*</span><span class="n">piimult</span><span class="o">.</span><span class="n">free_symbols</span><span class="p">)</span>
</span><span id="Expr-2538"><a href="#Expr-2538"><span class="linenos">2538</span></a>        <span class="c1"># round down to nearest multiple of 2</span>
</span><span id="Expr-2539"><a href="#Expr-2539"><span class="linenos">2539</span></a>        <span class="n">branchfact</span> <span class="o">=</span> <span class="n">ceiling</span><span class="p">(</span><span class="n">coeff</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span> <span class="n">S</span><span class="o">.</span><span class="n">Half</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span>
</span><span id="Expr-2540"><a href="#Expr-2540"><span class="linenos">2540</span></a>        <span class="n">n</span> <span class="o">+=</span> <span class="n">branchfact</span><span class="o">/</span><span class="mi">2</span>
</span><span id="Expr-2541"><a href="#Expr-2541"><span class="linenos">2541</span></a>        <span class="n">c</span> <span class="o">=</span> <span class="n">coeff</span> <span class="o">-</span> <span class="n">branchfact</span>
</span><span id="Expr-2542"><a href="#Expr-2542"><span class="linenos">2542</span></a>        <span class="k">if</span> <span class="n">allow_half</span><span class="p">:</span>
</span><span id="Expr-2543"><a href="#Expr-2543"><span class="linenos">2543</span></a>            <span class="n">nc</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">extract_additively</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span id="Expr-2544"><a href="#Expr-2544"><span class="linenos">2544</span></a>            <span class="k">if</span> <span class="n">nc</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Expr-2545"><a href="#Expr-2545"><span class="linenos">2545</span></a>                <span class="n">n</span> <span class="o">+=</span> <span class="n">S</span><span class="o">.</span><span class="n">Half</span>
</span><span id="Expr-2546"><a href="#Expr-2546"><span class="linenos">2546</span></a>                <span class="n">c</span> <span class="o">=</span> <span class="n">nc</span>
</span><span id="Expr-2547"><a href="#Expr-2547"><span class="linenos">2547</span></a>        <span class="n">newexp</span> <span class="o">=</span> <span class="n">ipi</span><span class="o">*</span><span class="n">Add</span><span class="p">(</span><span class="o">*</span><span class="p">((</span><span class="n">c</span><span class="p">,</span> <span class="p">)</span> <span class="o">+</span> <span class="n">tail</span><span class="p">))</span> <span class="o">+</span> <span class="n">Add</span><span class="p">(</span><span class="o">*</span><span class="n">extras</span><span class="p">)</span>
</span><span id="Expr-2548"><a href="#Expr-2548"><span class="linenos">2548</span></a>        <span class="k">if</span> <span class="n">newexp</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Expr-2549"><a href="#Expr-2549"><span class="linenos">2549</span></a>            <span class="n">res</span> <span class="o">*=</span> <span class="n">exp_polar</span><span class="p">(</span><span class="n">newexp</span><span class="p">)</span>
</span><span id="Expr-2550"><a href="#Expr-2550"><span class="linenos">2550</span></a>        <span class="k">return</span> <span class="n">res</span><span class="p">,</span> <span class="n">n</span>
</span><span id="Expr-2551"><a href="#Expr-2551"><span class="linenos">2551</span></a>
</span><span id="Expr-2552"><a href="#Expr-2552"><span class="linenos">2552</span></a>    <span class="k">def</span> <span class="nf">is_polynomial</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">syms</span><span class="p">):</span>
</span><span id="Expr-2553"><a href="#Expr-2553"><span class="linenos">2553</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Expr-2554"><a href="#Expr-2554"><span class="linenos">2554</span></a><span class="sd">        Return True if self is a polynomial in syms and False otherwise.</span>
</span><span id="Expr-2555"><a href="#Expr-2555"><span class="linenos">2555</span></a>
</span><span id="Expr-2556"><a href="#Expr-2556"><span class="linenos">2556</span></a><span class="sd">        This checks if self is an exact polynomial in syms.  This function</span>
</span><span id="Expr-2557"><a href="#Expr-2557"><span class="linenos">2557</span></a><span class="sd">        returns False for expressions that are &quot;polynomials&quot; with symbolic</span>
</span><span id="Expr-2558"><a href="#Expr-2558"><span class="linenos">2558</span></a><span class="sd">        exponents.  Thus, you should be able to apply polynomial algorithms to</span>
</span><span id="Expr-2559"><a href="#Expr-2559"><span class="linenos">2559</span></a><span class="sd">        expressions for which this returns True, and Poly(expr, \*syms) should</span>
</span><span id="Expr-2560"><a href="#Expr-2560"><span class="linenos">2560</span></a><span class="sd">        work if and only if expr.is_polynomial(\*syms) returns True. The</span>
</span><span id="Expr-2561"><a href="#Expr-2561"><span class="linenos">2561</span></a><span class="sd">        polynomial does not have to be in expanded form.  If no symbols are</span>
</span><span id="Expr-2562"><a href="#Expr-2562"><span class="linenos">2562</span></a><span class="sd">        given, all free symbols in the expression will be used.</span>
</span><span id="Expr-2563"><a href="#Expr-2563"><span class="linenos">2563</span></a>
</span><span id="Expr-2564"><a href="#Expr-2564"><span class="linenos">2564</span></a><span class="sd">        This is not part of the assumptions system.  You cannot do</span>
</span><span id="Expr-2565"><a href="#Expr-2565"><span class="linenos">2565</span></a><span class="sd">        Symbol(&#39;z&#39;, polynomial=True).</span>
</span><span id="Expr-2566"><a href="#Expr-2566"><span class="linenos">2566</span></a>
</span><span id="Expr-2567"><a href="#Expr-2567"><span class="linenos">2567</span></a><span class="sd">        Examples</span>
</span><span id="Expr-2568"><a href="#Expr-2568"><span class="linenos">2568</span></a><span class="sd">        ========</span>
</span><span id="Expr-2569"><a href="#Expr-2569"><span class="linenos">2569</span></a>
</span><span id="Expr-2570"><a href="#Expr-2570"><span class="linenos">2570</span></a><span class="sd">        &gt;&gt;&gt; from sympy import Symbol, Function</span>
</span><span id="Expr-2571"><a href="#Expr-2571"><span class="linenos">2571</span></a><span class="sd">        &gt;&gt;&gt; x = Symbol(&#39;x&#39;)</span>
</span><span id="Expr-2572"><a href="#Expr-2572"><span class="linenos">2572</span></a><span class="sd">        &gt;&gt;&gt; ((x**2 + 1)**4).is_polynomial(x)</span>
</span><span id="Expr-2573"><a href="#Expr-2573"><span class="linenos">2573</span></a><span class="sd">        True</span>
</span><span id="Expr-2574"><a href="#Expr-2574"><span class="linenos">2574</span></a><span class="sd">        &gt;&gt;&gt; ((x**2 + 1)**4).is_polynomial()</span>
</span><span id="Expr-2575"><a href="#Expr-2575"><span class="linenos">2575</span></a><span class="sd">        True</span>
</span><span id="Expr-2576"><a href="#Expr-2576"><span class="linenos">2576</span></a><span class="sd">        &gt;&gt;&gt; (2**x + 1).is_polynomial(x)</span>
</span><span id="Expr-2577"><a href="#Expr-2577"><span class="linenos">2577</span></a><span class="sd">        False</span>
</span><span id="Expr-2578"><a href="#Expr-2578"><span class="linenos">2578</span></a><span class="sd">        &gt;&gt;&gt; (2**x + 1).is_polynomial(2**x)</span>
</span><span id="Expr-2579"><a href="#Expr-2579"><span class="linenos">2579</span></a><span class="sd">        True</span>
</span><span id="Expr-2580"><a href="#Expr-2580"><span class="linenos">2580</span></a><span class="sd">        &gt;&gt;&gt; f = Function(&#39;f&#39;)</span>
</span><span id="Expr-2581"><a href="#Expr-2581"><span class="linenos">2581</span></a><span class="sd">        &gt;&gt;&gt; (f(x) + 1).is_polynomial(x)</span>
</span><span id="Expr-2582"><a href="#Expr-2582"><span class="linenos">2582</span></a><span class="sd">        False</span>
</span><span id="Expr-2583"><a href="#Expr-2583"><span class="linenos">2583</span></a><span class="sd">        &gt;&gt;&gt; (f(x) + 1).is_polynomial(f(x))</span>
</span><span id="Expr-2584"><a href="#Expr-2584"><span class="linenos">2584</span></a><span class="sd">        True</span>
</span><span id="Expr-2585"><a href="#Expr-2585"><span class="linenos">2585</span></a><span class="sd">        &gt;&gt;&gt; (1/f(x) + 1).is_polynomial(f(x))</span>
</span><span id="Expr-2586"><a href="#Expr-2586"><span class="linenos">2586</span></a><span class="sd">        False</span>
</span><span id="Expr-2587"><a href="#Expr-2587"><span class="linenos">2587</span></a>
</span><span id="Expr-2588"><a href="#Expr-2588"><span class="linenos">2588</span></a><span class="sd">        &gt;&gt;&gt; n = Symbol(&#39;n&#39;, nonnegative=True, integer=True)</span>
</span><span id="Expr-2589"><a href="#Expr-2589"><span class="linenos">2589</span></a><span class="sd">        &gt;&gt;&gt; (x**n + 1).is_polynomial(x)</span>
</span><span id="Expr-2590"><a href="#Expr-2590"><span class="linenos">2590</span></a><span class="sd">        False</span>
</span><span id="Expr-2591"><a href="#Expr-2591"><span class="linenos">2591</span></a>
</span><span id="Expr-2592"><a href="#Expr-2592"><span class="linenos">2592</span></a><span class="sd">        This function does not attempt any nontrivial simplifications that may</span>
</span><span id="Expr-2593"><a href="#Expr-2593"><span class="linenos">2593</span></a><span class="sd">        result in an expression that does not appear to be a polynomial to</span>
</span><span id="Expr-2594"><a href="#Expr-2594"><span class="linenos">2594</span></a><span class="sd">        become one.</span>
</span><span id="Expr-2595"><a href="#Expr-2595"><span class="linenos">2595</span></a>
</span><span id="Expr-2596"><a href="#Expr-2596"><span class="linenos">2596</span></a><span class="sd">        &gt;&gt;&gt; from sympy import sqrt, factor, cancel</span>
</span><span id="Expr-2597"><a href="#Expr-2597"><span class="linenos">2597</span></a><span class="sd">        &gt;&gt;&gt; y = Symbol(&#39;y&#39;, positive=True)</span>
</span><span id="Expr-2598"><a href="#Expr-2598"><span class="linenos">2598</span></a><span class="sd">        &gt;&gt;&gt; a = sqrt(y**2 + 2*y + 1)</span>
</span><span id="Expr-2599"><a href="#Expr-2599"><span class="linenos">2599</span></a><span class="sd">        &gt;&gt;&gt; a.is_polynomial(y)</span>
</span><span id="Expr-2600"><a href="#Expr-2600"><span class="linenos">2600</span></a><span class="sd">        False</span>
</span><span id="Expr-2601"><a href="#Expr-2601"><span class="linenos">2601</span></a><span class="sd">        &gt;&gt;&gt; factor(a)</span>
</span><span id="Expr-2602"><a href="#Expr-2602"><span class="linenos">2602</span></a><span class="sd">        y + 1</span>
</span><span id="Expr-2603"><a href="#Expr-2603"><span class="linenos">2603</span></a><span class="sd">        &gt;&gt;&gt; factor(a).is_polynomial(y)</span>
</span><span id="Expr-2604"><a href="#Expr-2604"><span class="linenos">2604</span></a><span class="sd">        True</span>
</span><span id="Expr-2605"><a href="#Expr-2605"><span class="linenos">2605</span></a>
</span><span id="Expr-2606"><a href="#Expr-2606"><span class="linenos">2606</span></a><span class="sd">        &gt;&gt;&gt; b = (y**2 + 2*y + 1)/(y + 1)</span>
</span><span id="Expr-2607"><a href="#Expr-2607"><span class="linenos">2607</span></a><span class="sd">        &gt;&gt;&gt; b.is_polynomial(y)</span>
</span><span id="Expr-2608"><a href="#Expr-2608"><span class="linenos">2608</span></a><span class="sd">        False</span>
</span><span id="Expr-2609"><a href="#Expr-2609"><span class="linenos">2609</span></a><span class="sd">        &gt;&gt;&gt; cancel(b)</span>
</span><span id="Expr-2610"><a href="#Expr-2610"><span class="linenos">2610</span></a><span class="sd">        y + 1</span>
</span><span id="Expr-2611"><a href="#Expr-2611"><span class="linenos">2611</span></a><span class="sd">        &gt;&gt;&gt; cancel(b).is_polynomial(y)</span>
</span><span id="Expr-2612"><a href="#Expr-2612"><span class="linenos">2612</span></a><span class="sd">        True</span>
</span><span id="Expr-2613"><a href="#Expr-2613"><span class="linenos">2613</span></a>
</span><span id="Expr-2614"><a href="#Expr-2614"><span class="linenos">2614</span></a><span class="sd">        See also .is_rational_function()</span>
</span><span id="Expr-2615"><a href="#Expr-2615"><span class="linenos">2615</span></a>
</span><span id="Expr-2616"><a href="#Expr-2616"><span class="linenos">2616</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Expr-2617"><a href="#Expr-2617"><span class="linenos">2617</span></a>        <span class="k">if</span> <span class="n">syms</span><span class="p">:</span>
</span><span id="Expr-2618"><a href="#Expr-2618"><span class="linenos">2618</span></a>            <span class="n">syms</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">sympify</span><span class="p">,</span> <span class="n">syms</span><span class="p">))</span>
</span><span id="Expr-2619"><a href="#Expr-2619"><span class="linenos">2619</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Expr-2620"><a href="#Expr-2620"><span class="linenos">2620</span></a>            <span class="n">syms</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">free_symbols</span>
</span><span id="Expr-2621"><a href="#Expr-2621"><span class="linenos">2621</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">syms</span><span class="p">:</span>
</span><span id="Expr-2622"><a href="#Expr-2622"><span class="linenos">2622</span></a>                <span class="k">return</span> <span class="kc">True</span>
</span><span id="Expr-2623"><a href="#Expr-2623"><span class="linenos">2623</span></a>
</span><span id="Expr-2624"><a href="#Expr-2624"><span class="linenos">2624</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_eval_is_polynomial</span><span class="p">(</span><span class="n">syms</span><span class="p">)</span>
</span><span id="Expr-2625"><a href="#Expr-2625"><span class="linenos">2625</span></a>
</span><span id="Expr-2626"><a href="#Expr-2626"><span class="linenos">2626</span></a>    <span class="k">def</span> <span class="nf">_eval_is_polynomial</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">syms</span><span class="p">):</span>
</span><span id="Expr-2627"><a href="#Expr-2627"><span class="linenos">2627</span></a>        <span class="k">if</span> <span class="bp">self</span> <span class="ow">in</span> <span class="n">syms</span><span class="p">:</span>
</span><span id="Expr-2628"><a href="#Expr-2628"><span class="linenos">2628</span></a>            <span class="k">return</span> <span class="kc">True</span>
</span><span id="Expr-2629"><a href="#Expr-2629"><span class="linenos">2629</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_free</span><span class="p">(</span><span class="o">*</span><span class="n">syms</span><span class="p">):</span>
</span><span id="Expr-2630"><a href="#Expr-2630"><span class="linenos">2630</span></a>            <span class="c1"># constant polynomial</span>
</span><span id="Expr-2631"><a href="#Expr-2631"><span class="linenos">2631</span></a>            <span class="k">return</span> <span class="kc">True</span>
</span><span id="Expr-2632"><a href="#Expr-2632"><span class="linenos">2632</span></a>        <span class="c1"># subclasses should return True or False</span>
</span><span id="Expr-2633"><a href="#Expr-2633"><span class="linenos">2633</span></a>
</span><span id="Expr-2634"><a href="#Expr-2634"><span class="linenos">2634</span></a>    <span class="k">def</span> <span class="nf">is_rational_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">syms</span><span class="p">):</span>
</span><span id="Expr-2635"><a href="#Expr-2635"><span class="linenos">2635</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Expr-2636"><a href="#Expr-2636"><span class="linenos">2636</span></a><span class="sd">        Test whether function is a ratio of two polynomials in the given</span>
</span><span id="Expr-2637"><a href="#Expr-2637"><span class="linenos">2637</span></a><span class="sd">        symbols, syms. When syms is not given, all free symbols will be used.</span>
</span><span id="Expr-2638"><a href="#Expr-2638"><span class="linenos">2638</span></a><span class="sd">        The rational function does not have to be in expanded or in any kind of</span>
</span><span id="Expr-2639"><a href="#Expr-2639"><span class="linenos">2639</span></a><span class="sd">        canonical form.</span>
</span><span id="Expr-2640"><a href="#Expr-2640"><span class="linenos">2640</span></a>
</span><span id="Expr-2641"><a href="#Expr-2641"><span class="linenos">2641</span></a><span class="sd">        This function returns False for expressions that are &quot;rational</span>
</span><span id="Expr-2642"><a href="#Expr-2642"><span class="linenos">2642</span></a><span class="sd">        functions&quot; with symbolic exponents.  Thus, you should be able to call</span>
</span><span id="Expr-2643"><a href="#Expr-2643"><span class="linenos">2643</span></a><span class="sd">        .as_numer_denom() and apply polynomial algorithms to the result for</span>
</span><span id="Expr-2644"><a href="#Expr-2644"><span class="linenos">2644</span></a><span class="sd">        expressions for which this returns True.</span>
</span><span id="Expr-2645"><a href="#Expr-2645"><span class="linenos">2645</span></a>
</span><span id="Expr-2646"><a href="#Expr-2646"><span class="linenos">2646</span></a><span class="sd">        This is not part of the assumptions system.  You cannot do</span>
</span><span id="Expr-2647"><a href="#Expr-2647"><span class="linenos">2647</span></a><span class="sd">        Symbol(&#39;z&#39;, rational_function=True).</span>
</span><span id="Expr-2648"><a href="#Expr-2648"><span class="linenos">2648</span></a>
</span><span id="Expr-2649"><a href="#Expr-2649"><span class="linenos">2649</span></a><span class="sd">        Examples</span>
</span><span id="Expr-2650"><a href="#Expr-2650"><span class="linenos">2650</span></a><span class="sd">        ========</span>
</span><span id="Expr-2651"><a href="#Expr-2651"><span class="linenos">2651</span></a>
</span><span id="Expr-2652"><a href="#Expr-2652"><span class="linenos">2652</span></a><span class="sd">        &gt;&gt;&gt; from sympy import Symbol, sin</span>
</span><span id="Expr-2653"><a href="#Expr-2653"><span class="linenos">2653</span></a><span class="sd">        &gt;&gt;&gt; from sympy.abc import x, y</span>
</span><span id="Expr-2654"><a href="#Expr-2654"><span class="linenos">2654</span></a>
</span><span id="Expr-2655"><a href="#Expr-2655"><span class="linenos">2655</span></a><span class="sd">        &gt;&gt;&gt; (x/y).is_rational_function()</span>
</span><span id="Expr-2656"><a href="#Expr-2656"><span class="linenos">2656</span></a><span class="sd">        True</span>
</span><span id="Expr-2657"><a href="#Expr-2657"><span class="linenos">2657</span></a>
</span><span id="Expr-2658"><a href="#Expr-2658"><span class="linenos">2658</span></a><span class="sd">        &gt;&gt;&gt; (x**2).is_rational_function()</span>
</span><span id="Expr-2659"><a href="#Expr-2659"><span class="linenos">2659</span></a><span class="sd">        True</span>
</span><span id="Expr-2660"><a href="#Expr-2660"><span class="linenos">2660</span></a>
</span><span id="Expr-2661"><a href="#Expr-2661"><span class="linenos">2661</span></a><span class="sd">        &gt;&gt;&gt; (x/sin(y)).is_rational_function(y)</span>
</span><span id="Expr-2662"><a href="#Expr-2662"><span class="linenos">2662</span></a><span class="sd">        False</span>
</span><span id="Expr-2663"><a href="#Expr-2663"><span class="linenos">2663</span></a>
</span><span id="Expr-2664"><a href="#Expr-2664"><span class="linenos">2664</span></a><span class="sd">        &gt;&gt;&gt; n = Symbol(&#39;n&#39;, integer=True)</span>
</span><span id="Expr-2665"><a href="#Expr-2665"><span class="linenos">2665</span></a><span class="sd">        &gt;&gt;&gt; (x**n + 1).is_rational_function(x)</span>
</span><span id="Expr-2666"><a href="#Expr-2666"><span class="linenos">2666</span></a><span class="sd">        False</span>
</span><span id="Expr-2667"><a href="#Expr-2667"><span class="linenos">2667</span></a>
</span><span id="Expr-2668"><a href="#Expr-2668"><span class="linenos">2668</span></a><span class="sd">        This function does not attempt any nontrivial simplifications that may</span>
</span><span id="Expr-2669"><a href="#Expr-2669"><span class="linenos">2669</span></a><span class="sd">        result in an expression that does not appear to be a rational function</span>
</span><span id="Expr-2670"><a href="#Expr-2670"><span class="linenos">2670</span></a><span class="sd">        to become one.</span>
</span><span id="Expr-2671"><a href="#Expr-2671"><span class="linenos">2671</span></a>
</span><span id="Expr-2672"><a href="#Expr-2672"><span class="linenos">2672</span></a><span class="sd">        &gt;&gt;&gt; from sympy import sqrt, factor</span>
</span><span id="Expr-2673"><a href="#Expr-2673"><span class="linenos">2673</span></a><span class="sd">        &gt;&gt;&gt; y = Symbol(&#39;y&#39;, positive=True)</span>
</span><span id="Expr-2674"><a href="#Expr-2674"><span class="linenos">2674</span></a><span class="sd">        &gt;&gt;&gt; a = sqrt(y**2 + 2*y + 1)/y</span>
</span><span id="Expr-2675"><a href="#Expr-2675"><span class="linenos">2675</span></a><span class="sd">        &gt;&gt;&gt; a.is_rational_function(y)</span>
</span><span id="Expr-2676"><a href="#Expr-2676"><span class="linenos">2676</span></a><span class="sd">        False</span>
</span><span id="Expr-2677"><a href="#Expr-2677"><span class="linenos">2677</span></a><span class="sd">        &gt;&gt;&gt; factor(a)</span>
</span><span id="Expr-2678"><a href="#Expr-2678"><span class="linenos">2678</span></a><span class="sd">        (y + 1)/y</span>
</span><span id="Expr-2679"><a href="#Expr-2679"><span class="linenos">2679</span></a><span class="sd">        &gt;&gt;&gt; factor(a).is_rational_function(y)</span>
</span><span id="Expr-2680"><a href="#Expr-2680"><span class="linenos">2680</span></a><span class="sd">        True</span>
</span><span id="Expr-2681"><a href="#Expr-2681"><span class="linenos">2681</span></a>
</span><span id="Expr-2682"><a href="#Expr-2682"><span class="linenos">2682</span></a><span class="sd">        See also is_algebraic_expr().</span>
</span><span id="Expr-2683"><a href="#Expr-2683"><span class="linenos">2683</span></a>
</span><span id="Expr-2684"><a href="#Expr-2684"><span class="linenos">2684</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Expr-2685"><a href="#Expr-2685"><span class="linenos">2685</span></a>        <span class="k">if</span> <span class="bp">self</span> <span class="ow">in</span> <span class="p">[</span><span class="n">S</span><span class="o">.</span><span class="n">NaN</span><span class="p">,</span> <span class="n">S</span><span class="o">.</span><span class="n">Infinity</span><span class="p">,</span> <span class="n">S</span><span class="o">.</span><span class="n">NegativeInfinity</span><span class="p">,</span> <span class="n">S</span><span class="o">.</span><span class="n">ComplexInfinity</span><span class="p">]:</span>
</span><span id="Expr-2686"><a href="#Expr-2686"><span class="linenos">2686</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="Expr-2687"><a href="#Expr-2687"><span class="linenos">2687</span></a>
</span><span id="Expr-2688"><a href="#Expr-2688"><span class="linenos">2688</span></a>        <span class="k">if</span> <span class="n">syms</span><span class="p">:</span>
</span><span id="Expr-2689"><a href="#Expr-2689"><span class="linenos">2689</span></a>            <span class="n">syms</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">sympify</span><span class="p">,</span> <span class="n">syms</span><span class="p">))</span>
</span><span id="Expr-2690"><a href="#Expr-2690"><span class="linenos">2690</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Expr-2691"><a href="#Expr-2691"><span class="linenos">2691</span></a>            <span class="n">syms</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">free_symbols</span>
</span><span id="Expr-2692"><a href="#Expr-2692"><span class="linenos">2692</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">syms</span><span class="p">:</span>
</span><span id="Expr-2693"><a href="#Expr-2693"><span class="linenos">2693</span></a>                <span class="k">return</span> <span class="kc">True</span>
</span><span id="Expr-2694"><a href="#Expr-2694"><span class="linenos">2694</span></a>
</span><span id="Expr-2695"><a href="#Expr-2695"><span class="linenos">2695</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_eval_is_rational_function</span><span class="p">(</span><span class="n">syms</span><span class="p">)</span>
</span><span id="Expr-2696"><a href="#Expr-2696"><span class="linenos">2696</span></a>
</span><span id="Expr-2697"><a href="#Expr-2697"><span class="linenos">2697</span></a>    <span class="k">def</span> <span class="nf">_eval_is_rational_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">syms</span><span class="p">):</span>
</span><span id="Expr-2698"><a href="#Expr-2698"><span class="linenos">2698</span></a>        <span class="k">if</span> <span class="bp">self</span> <span class="ow">in</span> <span class="n">syms</span><span class="p">:</span>
</span><span id="Expr-2699"><a href="#Expr-2699"><span class="linenos">2699</span></a>            <span class="k">return</span> <span class="kc">True</span>
</span><span id="Expr-2700"><a href="#Expr-2700"><span class="linenos">2700</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_free</span><span class="p">(</span><span class="o">*</span><span class="n">syms</span><span class="p">):</span>
</span><span id="Expr-2701"><a href="#Expr-2701"><span class="linenos">2701</span></a>            <span class="k">return</span> <span class="kc">True</span>
</span><span id="Expr-2702"><a href="#Expr-2702"><span class="linenos">2702</span></a>        <span class="c1"># subclasses should return True or False</span>
</span><span id="Expr-2703"><a href="#Expr-2703"><span class="linenos">2703</span></a>
</span><span id="Expr-2704"><a href="#Expr-2704"><span class="linenos">2704</span></a>    <span class="k">def</span> <span class="nf">is_meromorphic</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
</span><span id="Expr-2705"><a href="#Expr-2705"><span class="linenos">2705</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Expr-2706"><a href="#Expr-2706"><span class="linenos">2706</span></a><span class="sd">        This tests whether an expression is meromorphic as</span>
</span><span id="Expr-2707"><a href="#Expr-2707"><span class="linenos">2707</span></a><span class="sd">        a function of the given symbol ``x`` at the point ``a``.</span>
</span><span id="Expr-2708"><a href="#Expr-2708"><span class="linenos">2708</span></a>
</span><span id="Expr-2709"><a href="#Expr-2709"><span class="linenos">2709</span></a><span class="sd">        This method is intended as a quick test that will return</span>
</span><span id="Expr-2710"><a href="#Expr-2710"><span class="linenos">2710</span></a><span class="sd">        None if no decision can be made without simplification or</span>
</span><span id="Expr-2711"><a href="#Expr-2711"><span class="linenos">2711</span></a><span class="sd">        more detailed analysis.</span>
</span><span id="Expr-2712"><a href="#Expr-2712"><span class="linenos">2712</span></a>
</span><span id="Expr-2713"><a href="#Expr-2713"><span class="linenos">2713</span></a><span class="sd">        Examples</span>
</span><span id="Expr-2714"><a href="#Expr-2714"><span class="linenos">2714</span></a><span class="sd">        ========</span>
</span><span id="Expr-2715"><a href="#Expr-2715"><span class="linenos">2715</span></a>
</span><span id="Expr-2716"><a href="#Expr-2716"><span class="linenos">2716</span></a><span class="sd">        &gt;&gt;&gt; from sympy import zoo, log, sin, sqrt</span>
</span><span id="Expr-2717"><a href="#Expr-2717"><span class="linenos">2717</span></a><span class="sd">        &gt;&gt;&gt; from sympy.abc import x</span>
</span><span id="Expr-2718"><a href="#Expr-2718"><span class="linenos">2718</span></a>
</span><span id="Expr-2719"><a href="#Expr-2719"><span class="linenos">2719</span></a><span class="sd">        &gt;&gt;&gt; f = 1/x**2 + 1 - 2*x**3</span>
</span><span id="Expr-2720"><a href="#Expr-2720"><span class="linenos">2720</span></a><span class="sd">        &gt;&gt;&gt; f.is_meromorphic(x, 0)</span>
</span><span id="Expr-2721"><a href="#Expr-2721"><span class="linenos">2721</span></a><span class="sd">        True</span>
</span><span id="Expr-2722"><a href="#Expr-2722"><span class="linenos">2722</span></a><span class="sd">        &gt;&gt;&gt; f.is_meromorphic(x, 1)</span>
</span><span id="Expr-2723"><a href="#Expr-2723"><span class="linenos">2723</span></a><span class="sd">        True</span>
</span><span id="Expr-2724"><a href="#Expr-2724"><span class="linenos">2724</span></a><span class="sd">        &gt;&gt;&gt; f.is_meromorphic(x, zoo)</span>
</span><span id="Expr-2725"><a href="#Expr-2725"><span class="linenos">2725</span></a><span class="sd">        True</span>
</span><span id="Expr-2726"><a href="#Expr-2726"><span class="linenos">2726</span></a>
</span><span id="Expr-2727"><a href="#Expr-2727"><span class="linenos">2727</span></a><span class="sd">        &gt;&gt;&gt; g = x**log(3)</span>
</span><span id="Expr-2728"><a href="#Expr-2728"><span class="linenos">2728</span></a><span class="sd">        &gt;&gt;&gt; g.is_meromorphic(x, 0)</span>
</span><span id="Expr-2729"><a href="#Expr-2729"><span class="linenos">2729</span></a><span class="sd">        False</span>
</span><span id="Expr-2730"><a href="#Expr-2730"><span class="linenos">2730</span></a><span class="sd">        &gt;&gt;&gt; g.is_meromorphic(x, 1)</span>
</span><span id="Expr-2731"><a href="#Expr-2731"><span class="linenos">2731</span></a><span class="sd">        True</span>
</span><span id="Expr-2732"><a href="#Expr-2732"><span class="linenos">2732</span></a><span class="sd">        &gt;&gt;&gt; g.is_meromorphic(x, zoo)</span>
</span><span id="Expr-2733"><a href="#Expr-2733"><span class="linenos">2733</span></a><span class="sd">        False</span>
</span><span id="Expr-2734"><a href="#Expr-2734"><span class="linenos">2734</span></a>
</span><span id="Expr-2735"><a href="#Expr-2735"><span class="linenos">2735</span></a><span class="sd">        &gt;&gt;&gt; h = sin(1/x)*x**2</span>
</span><span id="Expr-2736"><a href="#Expr-2736"><span class="linenos">2736</span></a><span class="sd">        &gt;&gt;&gt; h.is_meromorphic(x, 0)</span>
</span><span id="Expr-2737"><a href="#Expr-2737"><span class="linenos">2737</span></a><span class="sd">        False</span>
</span><span id="Expr-2738"><a href="#Expr-2738"><span class="linenos">2738</span></a><span class="sd">        &gt;&gt;&gt; h.is_meromorphic(x, 1)</span>
</span><span id="Expr-2739"><a href="#Expr-2739"><span class="linenos">2739</span></a><span class="sd">        True</span>
</span><span id="Expr-2740"><a href="#Expr-2740"><span class="linenos">2740</span></a><span class="sd">        &gt;&gt;&gt; h.is_meromorphic(x, zoo)</span>
</span><span id="Expr-2741"><a href="#Expr-2741"><span class="linenos">2741</span></a><span class="sd">        True</span>
</span><span id="Expr-2742"><a href="#Expr-2742"><span class="linenos">2742</span></a>
</span><span id="Expr-2743"><a href="#Expr-2743"><span class="linenos">2743</span></a><span class="sd">        Multivalued functions are considered meromorphic when their</span>
</span><span id="Expr-2744"><a href="#Expr-2744"><span class="linenos">2744</span></a><span class="sd">        branches are meromorphic. Thus most functions are meromorphic</span>
</span><span id="Expr-2745"><a href="#Expr-2745"><span class="linenos">2745</span></a><span class="sd">        everywhere except at essential singularities and branch points.</span>
</span><span id="Expr-2746"><a href="#Expr-2746"><span class="linenos">2746</span></a><span class="sd">        In particular, they will be meromorphic also on branch cuts</span>
</span><span id="Expr-2747"><a href="#Expr-2747"><span class="linenos">2747</span></a><span class="sd">        except at their endpoints.</span>
</span><span id="Expr-2748"><a href="#Expr-2748"><span class="linenos">2748</span></a>
</span><span id="Expr-2749"><a href="#Expr-2749"><span class="linenos">2749</span></a><span class="sd">        &gt;&gt;&gt; log(x).is_meromorphic(x, -1)</span>
</span><span id="Expr-2750"><a href="#Expr-2750"><span class="linenos">2750</span></a><span class="sd">        True</span>
</span><span id="Expr-2751"><a href="#Expr-2751"><span class="linenos">2751</span></a><span class="sd">        &gt;&gt;&gt; log(x).is_meromorphic(x, 0)</span>
</span><span id="Expr-2752"><a href="#Expr-2752"><span class="linenos">2752</span></a><span class="sd">        False</span>
</span><span id="Expr-2753"><a href="#Expr-2753"><span class="linenos">2753</span></a><span class="sd">        &gt;&gt;&gt; sqrt(x).is_meromorphic(x, -1)</span>
</span><span id="Expr-2754"><a href="#Expr-2754"><span class="linenos">2754</span></a><span class="sd">        True</span>
</span><span id="Expr-2755"><a href="#Expr-2755"><span class="linenos">2755</span></a><span class="sd">        &gt;&gt;&gt; sqrt(x).is_meromorphic(x, 0)</span>
</span><span id="Expr-2756"><a href="#Expr-2756"><span class="linenos">2756</span></a><span class="sd">        False</span>
</span><span id="Expr-2757"><a href="#Expr-2757"><span class="linenos">2757</span></a>
</span><span id="Expr-2758"><a href="#Expr-2758"><span class="linenos">2758</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Expr-2759"><a href="#Expr-2759"><span class="linenos">2759</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">x</span><span class="o">.</span><span class="n">is_symbol</span><span class="p">:</span>
</span><span id="Expr-2760"><a href="#Expr-2760"><span class="linenos">2760</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> should be of symbol type&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</span><span id="Expr-2761"><a href="#Expr-2761"><span class="linenos">2761</span></a>        <span class="n">a</span> <span class="o">=</span> <span class="n">sympify</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</span><span id="Expr-2762"><a href="#Expr-2762"><span class="linenos">2762</span></a>
</span><span id="Expr-2763"><a href="#Expr-2763"><span class="linenos">2763</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_eval_is_meromorphic</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
</span><span id="Expr-2764"><a href="#Expr-2764"><span class="linenos">2764</span></a>
</span><span id="Expr-2765"><a href="#Expr-2765"><span class="linenos">2765</span></a>    <span class="k">def</span> <span class="nf">_eval_is_meromorphic</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
</span><span id="Expr-2766"><a href="#Expr-2766"><span class="linenos">2766</span></a>        <span class="k">if</span> <span class="bp">self</span> <span class="o">==</span> <span class="n">x</span><span class="p">:</span>
</span><span id="Expr-2767"><a href="#Expr-2767"><span class="linenos">2767</span></a>            <span class="k">return</span> <span class="kc">True</span>
</span><span id="Expr-2768"><a href="#Expr-2768"><span class="linenos">2768</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_free</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
</span><span id="Expr-2769"><a href="#Expr-2769"><span class="linenos">2769</span></a>            <span class="k">return</span> <span class="kc">True</span>
</span><span id="Expr-2770"><a href="#Expr-2770"><span class="linenos">2770</span></a>        <span class="c1"># subclasses should return True or False</span>
</span><span id="Expr-2771"><a href="#Expr-2771"><span class="linenos">2771</span></a>
</span><span id="Expr-2772"><a href="#Expr-2772"><span class="linenos">2772</span></a>    <span class="k">def</span> <span class="nf">is_algebraic_expr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">syms</span><span class="p">):</span>
</span><span id="Expr-2773"><a href="#Expr-2773"><span class="linenos">2773</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Expr-2774"><a href="#Expr-2774"><span class="linenos">2774</span></a><span class="sd">        This tests whether a given expression is algebraic or not, in the</span>
</span><span id="Expr-2775"><a href="#Expr-2775"><span class="linenos">2775</span></a><span class="sd">        given symbols, syms. When syms is not given, all free symbols</span>
</span><span id="Expr-2776"><a href="#Expr-2776"><span class="linenos">2776</span></a><span class="sd">        will be used. The rational function does not have to be in expanded</span>
</span><span id="Expr-2777"><a href="#Expr-2777"><span class="linenos">2777</span></a><span class="sd">        or in any kind of canonical form.</span>
</span><span id="Expr-2778"><a href="#Expr-2778"><span class="linenos">2778</span></a>
</span><span id="Expr-2779"><a href="#Expr-2779"><span class="linenos">2779</span></a><span class="sd">        This function returns False for expressions that are &quot;algebraic</span>
</span><span id="Expr-2780"><a href="#Expr-2780"><span class="linenos">2780</span></a><span class="sd">        expressions&quot; with symbolic exponents. This is a simple extension to the</span>
</span><span id="Expr-2781"><a href="#Expr-2781"><span class="linenos">2781</span></a><span class="sd">        is_rational_function, including rational exponentiation.</span>
</span><span id="Expr-2782"><a href="#Expr-2782"><span class="linenos">2782</span></a>
</span><span id="Expr-2783"><a href="#Expr-2783"><span class="linenos">2783</span></a><span class="sd">        Examples</span>
</span><span id="Expr-2784"><a href="#Expr-2784"><span class="linenos">2784</span></a><span class="sd">        ========</span>
</span><span id="Expr-2785"><a href="#Expr-2785"><span class="linenos">2785</span></a>
</span><span id="Expr-2786"><a href="#Expr-2786"><span class="linenos">2786</span></a><span class="sd">        &gt;&gt;&gt; from sympy import Symbol, sqrt</span>
</span><span id="Expr-2787"><a href="#Expr-2787"><span class="linenos">2787</span></a><span class="sd">        &gt;&gt;&gt; x = Symbol(&#39;x&#39;, real=True)</span>
</span><span id="Expr-2788"><a href="#Expr-2788"><span class="linenos">2788</span></a><span class="sd">        &gt;&gt;&gt; sqrt(1 + x).is_rational_function()</span>
</span><span id="Expr-2789"><a href="#Expr-2789"><span class="linenos">2789</span></a><span class="sd">        False</span>
</span><span id="Expr-2790"><a href="#Expr-2790"><span class="linenos">2790</span></a><span class="sd">        &gt;&gt;&gt; sqrt(1 + x).is_algebraic_expr()</span>
</span><span id="Expr-2791"><a href="#Expr-2791"><span class="linenos">2791</span></a><span class="sd">        True</span>
</span><span id="Expr-2792"><a href="#Expr-2792"><span class="linenos">2792</span></a>
</span><span id="Expr-2793"><a href="#Expr-2793"><span class="linenos">2793</span></a><span class="sd">        This function does not attempt any nontrivial simplifications that may</span>
</span><span id="Expr-2794"><a href="#Expr-2794"><span class="linenos">2794</span></a><span class="sd">        result in an expression that does not appear to be an algebraic</span>
</span><span id="Expr-2795"><a href="#Expr-2795"><span class="linenos">2795</span></a><span class="sd">        expression to become one.</span>
</span><span id="Expr-2796"><a href="#Expr-2796"><span class="linenos">2796</span></a>
</span><span id="Expr-2797"><a href="#Expr-2797"><span class="linenos">2797</span></a><span class="sd">        &gt;&gt;&gt; from sympy import exp, factor</span>
</span><span id="Expr-2798"><a href="#Expr-2798"><span class="linenos">2798</span></a><span class="sd">        &gt;&gt;&gt; a = sqrt(exp(x)**2 + 2*exp(x) + 1)/(exp(x) + 1)</span>
</span><span id="Expr-2799"><a href="#Expr-2799"><span class="linenos">2799</span></a><span class="sd">        &gt;&gt;&gt; a.is_algebraic_expr(x)</span>
</span><span id="Expr-2800"><a href="#Expr-2800"><span class="linenos">2800</span></a><span class="sd">        False</span>
</span><span id="Expr-2801"><a href="#Expr-2801"><span class="linenos">2801</span></a><span class="sd">        &gt;&gt;&gt; factor(a).is_algebraic_expr()</span>
</span><span id="Expr-2802"><a href="#Expr-2802"><span class="linenos">2802</span></a><span class="sd">        True</span>
</span><span id="Expr-2803"><a href="#Expr-2803"><span class="linenos">2803</span></a>
</span><span id="Expr-2804"><a href="#Expr-2804"><span class="linenos">2804</span></a><span class="sd">        See Also</span>
</span><span id="Expr-2805"><a href="#Expr-2805"><span class="linenos">2805</span></a><span class="sd">        ========</span>
</span><span id="Expr-2806"><a href="#Expr-2806"><span class="linenos">2806</span></a><span class="sd">        is_rational_function()</span>
</span><span id="Expr-2807"><a href="#Expr-2807"><span class="linenos">2807</span></a>
</span><span id="Expr-2808"><a href="#Expr-2808"><span class="linenos">2808</span></a><span class="sd">        References</span>
</span><span id="Expr-2809"><a href="#Expr-2809"><span class="linenos">2809</span></a><span class="sd">        ==========</span>
</span><span id="Expr-2810"><a href="#Expr-2810"><span class="linenos">2810</span></a>
</span><span id="Expr-2811"><a href="#Expr-2811"><span class="linenos">2811</span></a><span class="sd">        .. [1] https://en.wikipedia.org/wiki/Algebraic_expression</span>
</span><span id="Expr-2812"><a href="#Expr-2812"><span class="linenos">2812</span></a>
</span><span id="Expr-2813"><a href="#Expr-2813"><span class="linenos">2813</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Expr-2814"><a href="#Expr-2814"><span class="linenos">2814</span></a>        <span class="k">if</span> <span class="n">syms</span><span class="p">:</span>
</span><span id="Expr-2815"><a href="#Expr-2815"><span class="linenos">2815</span></a>            <span class="n">syms</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">sympify</span><span class="p">,</span> <span class="n">syms</span><span class="p">))</span>
</span><span id="Expr-2816"><a href="#Expr-2816"><span class="linenos">2816</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Expr-2817"><a href="#Expr-2817"><span class="linenos">2817</span></a>            <span class="n">syms</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">free_symbols</span>
</span><span id="Expr-2818"><a href="#Expr-2818"><span class="linenos">2818</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">syms</span><span class="p">:</span>
</span><span id="Expr-2819"><a href="#Expr-2819"><span class="linenos">2819</span></a>                <span class="k">return</span> <span class="kc">True</span>
</span><span id="Expr-2820"><a href="#Expr-2820"><span class="linenos">2820</span></a>
</span><span id="Expr-2821"><a href="#Expr-2821"><span class="linenos">2821</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_eval_is_algebraic_expr</span><span class="p">(</span><span class="n">syms</span><span class="p">)</span>
</span><span id="Expr-2822"><a href="#Expr-2822"><span class="linenos">2822</span></a>
</span><span id="Expr-2823"><a href="#Expr-2823"><span class="linenos">2823</span></a>    <span class="k">def</span> <span class="nf">_eval_is_algebraic_expr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">syms</span><span class="p">):</span>
</span><span id="Expr-2824"><a href="#Expr-2824"><span class="linenos">2824</span></a>        <span class="k">if</span> <span class="bp">self</span> <span class="ow">in</span> <span class="n">syms</span><span class="p">:</span>
</span><span id="Expr-2825"><a href="#Expr-2825"><span class="linenos">2825</span></a>            <span class="k">return</span> <span class="kc">True</span>
</span><span id="Expr-2826"><a href="#Expr-2826"><span class="linenos">2826</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_free</span><span class="p">(</span><span class="o">*</span><span class="n">syms</span><span class="p">):</span>
</span><span id="Expr-2827"><a href="#Expr-2827"><span class="linenos">2827</span></a>            <span class="k">return</span> <span class="kc">True</span>
</span><span id="Expr-2828"><a href="#Expr-2828"><span class="linenos">2828</span></a>        <span class="c1"># subclasses should return True or False</span>
</span><span id="Expr-2829"><a href="#Expr-2829"><span class="linenos">2829</span></a>
</span><span id="Expr-2830"><a href="#Expr-2830"><span class="linenos">2830</span></a>    <span class="c1">###################################################################################</span>
</span><span id="Expr-2831"><a href="#Expr-2831"><span class="linenos">2831</span></a>    <span class="c1">##################### SERIES, LEADING TERM, LIMIT, ORDER METHODS ##################</span>
</span><span id="Expr-2832"><a href="#Expr-2832"><span class="linenos">2832</span></a>    <span class="c1">###################################################################################</span>
</span><span id="Expr-2833"><a href="#Expr-2833"><span class="linenos">2833</span></a>
</span><span id="Expr-2834"><a href="#Expr-2834"><span class="linenos">2834</span></a>    <span class="k">def</span> <span class="nf">series</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="nb">dir</span><span class="o">=</span><span class="s2">&quot;+&quot;</span><span class="p">,</span> <span class="n">logx</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cdir</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
</span><span id="Expr-2835"><a href="#Expr-2835"><span class="linenos">2835</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Expr-2836"><a href="#Expr-2836"><span class="linenos">2836</span></a><span class="sd">        Series expansion of &quot;self&quot; around ``x = x0`` yielding either terms of</span>
</span><span id="Expr-2837"><a href="#Expr-2837"><span class="linenos">2837</span></a><span class="sd">        the series one by one (the lazy series given when n=None), else</span>
</span><span id="Expr-2838"><a href="#Expr-2838"><span class="linenos">2838</span></a><span class="sd">        all the terms at once when n != None.</span>
</span><span id="Expr-2839"><a href="#Expr-2839"><span class="linenos">2839</span></a>
</span><span id="Expr-2840"><a href="#Expr-2840"><span class="linenos">2840</span></a><span class="sd">        Returns the series expansion of &quot;self&quot; around the point ``x = x0``</span>
</span><span id="Expr-2841"><a href="#Expr-2841"><span class="linenos">2841</span></a><span class="sd">        with respect to ``x`` up to ``O((x - x0)**n, x, x0)`` (default n is 6).</span>
</span><span id="Expr-2842"><a href="#Expr-2842"><span class="linenos">2842</span></a>
</span><span id="Expr-2843"><a href="#Expr-2843"><span class="linenos">2843</span></a><span class="sd">        If ``x=None`` and ``self`` is univariate, the univariate symbol will</span>
</span><span id="Expr-2844"><a href="#Expr-2844"><span class="linenos">2844</span></a><span class="sd">        be supplied, otherwise an error will be raised.</span>
</span><span id="Expr-2845"><a href="#Expr-2845"><span class="linenos">2845</span></a>
</span><span id="Expr-2846"><a href="#Expr-2846"><span class="linenos">2846</span></a><span class="sd">        Parameters</span>
</span><span id="Expr-2847"><a href="#Expr-2847"><span class="linenos">2847</span></a><span class="sd">        ==========</span>
</span><span id="Expr-2848"><a href="#Expr-2848"><span class="linenos">2848</span></a>
</span><span id="Expr-2849"><a href="#Expr-2849"><span class="linenos">2849</span></a><span class="sd">        expr : Expression</span>
</span><span id="Expr-2850"><a href="#Expr-2850"><span class="linenos">2850</span></a><span class="sd">               The expression whose series is to be expanded.</span>
</span><span id="Expr-2851"><a href="#Expr-2851"><span class="linenos">2851</span></a>
</span><span id="Expr-2852"><a href="#Expr-2852"><span class="linenos">2852</span></a><span class="sd">        x : Symbol</span>
</span><span id="Expr-2853"><a href="#Expr-2853"><span class="linenos">2853</span></a><span class="sd">            It is the variable of the expression to be calculated.</span>
</span><span id="Expr-2854"><a href="#Expr-2854"><span class="linenos">2854</span></a>
</span><span id="Expr-2855"><a href="#Expr-2855"><span class="linenos">2855</span></a><span class="sd">        x0 : Value</span>
</span><span id="Expr-2856"><a href="#Expr-2856"><span class="linenos">2856</span></a><span class="sd">             The value around which ``x`` is calculated. Can be any value</span>
</span><span id="Expr-2857"><a href="#Expr-2857"><span class="linenos">2857</span></a><span class="sd">             from ``-oo`` to ``oo``.</span>
</span><span id="Expr-2858"><a href="#Expr-2858"><span class="linenos">2858</span></a>
</span><span id="Expr-2859"><a href="#Expr-2859"><span class="linenos">2859</span></a><span class="sd">        n : Value</span>
</span><span id="Expr-2860"><a href="#Expr-2860"><span class="linenos">2860</span></a><span class="sd">            The number of terms upto which the series is to be expanded.</span>
</span><span id="Expr-2861"><a href="#Expr-2861"><span class="linenos">2861</span></a>
</span><span id="Expr-2862"><a href="#Expr-2862"><span class="linenos">2862</span></a><span class="sd">        dir : String, optional</span>
</span><span id="Expr-2863"><a href="#Expr-2863"><span class="linenos">2863</span></a><span class="sd">              The series-expansion can be bi-directional. If ``dir=&quot;+&quot;``,</span>
</span><span id="Expr-2864"><a href="#Expr-2864"><span class="linenos">2864</span></a><span class="sd">              then (x-&gt;x0+). If ``dir=&quot;-&quot;, then (x-&gt;x0-). For infinite</span>
</span><span id="Expr-2865"><a href="#Expr-2865"><span class="linenos">2865</span></a><span class="sd">              ``x0`` (``oo`` or ``-oo``), the ``dir`` argument is determined</span>
</span><span id="Expr-2866"><a href="#Expr-2866"><span class="linenos">2866</span></a><span class="sd">              from the direction of the infinity (i.e., ``dir=&quot;-&quot;`` for</span>
</span><span id="Expr-2867"><a href="#Expr-2867"><span class="linenos">2867</span></a><span class="sd">              ``oo``).</span>
</span><span id="Expr-2868"><a href="#Expr-2868"><span class="linenos">2868</span></a>
</span><span id="Expr-2869"><a href="#Expr-2869"><span class="linenos">2869</span></a><span class="sd">        logx : optional</span>
</span><span id="Expr-2870"><a href="#Expr-2870"><span class="linenos">2870</span></a><span class="sd">               It is used to replace any log(x) in the returned series with a</span>
</span><span id="Expr-2871"><a href="#Expr-2871"><span class="linenos">2871</span></a><span class="sd">               symbolic value rather than evaluating the actual value.</span>
</span><span id="Expr-2872"><a href="#Expr-2872"><span class="linenos">2872</span></a>
</span><span id="Expr-2873"><a href="#Expr-2873"><span class="linenos">2873</span></a><span class="sd">        cdir : optional</span>
</span><span id="Expr-2874"><a href="#Expr-2874"><span class="linenos">2874</span></a><span class="sd">               It stands for complex direction, and indicates the direction</span>
</span><span id="Expr-2875"><a href="#Expr-2875"><span class="linenos">2875</span></a><span class="sd">               from which the expansion needs to be evaluated.</span>
</span><span id="Expr-2876"><a href="#Expr-2876"><span class="linenos">2876</span></a>
</span><span id="Expr-2877"><a href="#Expr-2877"><span class="linenos">2877</span></a><span class="sd">        Examples</span>
</span><span id="Expr-2878"><a href="#Expr-2878"><span class="linenos">2878</span></a><span class="sd">        ========</span>
</span><span id="Expr-2879"><a href="#Expr-2879"><span class="linenos">2879</span></a>
</span><span id="Expr-2880"><a href="#Expr-2880"><span class="linenos">2880</span></a><span class="sd">        &gt;&gt;&gt; from sympy import cos, exp, tan</span>
</span><span id="Expr-2881"><a href="#Expr-2881"><span class="linenos">2881</span></a><span class="sd">        &gt;&gt;&gt; from sympy.abc import x, y</span>
</span><span id="Expr-2882"><a href="#Expr-2882"><span class="linenos">2882</span></a><span class="sd">        &gt;&gt;&gt; cos(x).series()</span>
</span><span id="Expr-2883"><a href="#Expr-2883"><span class="linenos">2883</span></a><span class="sd">        1 - x**2/2 + x**4/24 + O(x**6)</span>
</span><span id="Expr-2884"><a href="#Expr-2884"><span class="linenos">2884</span></a><span class="sd">        &gt;&gt;&gt; cos(x).series(n=4)</span>
</span><span id="Expr-2885"><a href="#Expr-2885"><span class="linenos">2885</span></a><span class="sd">        1 - x**2/2 + O(x**4)</span>
</span><span id="Expr-2886"><a href="#Expr-2886"><span class="linenos">2886</span></a><span class="sd">        &gt;&gt;&gt; cos(x).series(x, x0=1, n=2)</span>
</span><span id="Expr-2887"><a href="#Expr-2887"><span class="linenos">2887</span></a><span class="sd">        cos(1) - (x - 1)*sin(1) + O((x - 1)**2, (x, 1))</span>
</span><span id="Expr-2888"><a href="#Expr-2888"><span class="linenos">2888</span></a><span class="sd">        &gt;&gt;&gt; e = cos(x + exp(y))</span>
</span><span id="Expr-2889"><a href="#Expr-2889"><span class="linenos">2889</span></a><span class="sd">        &gt;&gt;&gt; e.series(y, n=2)</span>
</span><span id="Expr-2890"><a href="#Expr-2890"><span class="linenos">2890</span></a><span class="sd">        cos(x + 1) - y*sin(x + 1) + O(y**2)</span>
</span><span id="Expr-2891"><a href="#Expr-2891"><span class="linenos">2891</span></a><span class="sd">        &gt;&gt;&gt; e.series(x, n=2)</span>
</span><span id="Expr-2892"><a href="#Expr-2892"><span class="linenos">2892</span></a><span class="sd">        cos(exp(y)) - x*sin(exp(y)) + O(x**2)</span>
</span><span id="Expr-2893"><a href="#Expr-2893"><span class="linenos">2893</span></a>
</span><span id="Expr-2894"><a href="#Expr-2894"><span class="linenos">2894</span></a><span class="sd">        If ``n=None`` then a generator of the series terms will be returned.</span>
</span><span id="Expr-2895"><a href="#Expr-2895"><span class="linenos">2895</span></a>
</span><span id="Expr-2896"><a href="#Expr-2896"><span class="linenos">2896</span></a><span class="sd">        &gt;&gt;&gt; term=cos(x).series(n=None)</span>
</span><span id="Expr-2897"><a href="#Expr-2897"><span class="linenos">2897</span></a><span class="sd">        &gt;&gt;&gt; [next(term) for i in range(2)]</span>
</span><span id="Expr-2898"><a href="#Expr-2898"><span class="linenos">2898</span></a><span class="sd">        [1, -x**2/2]</span>
</span><span id="Expr-2899"><a href="#Expr-2899"><span class="linenos">2899</span></a>
</span><span id="Expr-2900"><a href="#Expr-2900"><span class="linenos">2900</span></a><span class="sd">        For ``dir=+`` (default) the series is calculated from the right and</span>
</span><span id="Expr-2901"><a href="#Expr-2901"><span class="linenos">2901</span></a><span class="sd">        for ``dir=-`` the series from the left. For smooth functions this</span>
</span><span id="Expr-2902"><a href="#Expr-2902"><span class="linenos">2902</span></a><span class="sd">        flag will not alter the results.</span>
</span><span id="Expr-2903"><a href="#Expr-2903"><span class="linenos">2903</span></a>
</span><span id="Expr-2904"><a href="#Expr-2904"><span class="linenos">2904</span></a><span class="sd">        &gt;&gt;&gt; abs(x).series(dir=&quot;+&quot;)</span>
</span><span id="Expr-2905"><a href="#Expr-2905"><span class="linenos">2905</span></a><span class="sd">        x</span>
</span><span id="Expr-2906"><a href="#Expr-2906"><span class="linenos">2906</span></a><span class="sd">        &gt;&gt;&gt; abs(x).series(dir=&quot;-&quot;)</span>
</span><span id="Expr-2907"><a href="#Expr-2907"><span class="linenos">2907</span></a><span class="sd">        -x</span>
</span><span id="Expr-2908"><a href="#Expr-2908"><span class="linenos">2908</span></a><span class="sd">        &gt;&gt;&gt; f = tan(x)</span>
</span><span id="Expr-2909"><a href="#Expr-2909"><span class="linenos">2909</span></a><span class="sd">        &gt;&gt;&gt; f.series(x, 2, 6, &quot;+&quot;)</span>
</span><span id="Expr-2910"><a href="#Expr-2910"><span class="linenos">2910</span></a><span class="sd">        tan(2) + (1 + tan(2)**2)*(x - 2) + (x - 2)**2*(tan(2)**3 + tan(2)) +</span>
</span><span id="Expr-2911"><a href="#Expr-2911"><span class="linenos">2911</span></a><span class="sd">        (x - 2)**3*(1/3 + 4*tan(2)**2/3 + tan(2)**4) + (x - 2)**4*(tan(2)**5 +</span>
</span><span id="Expr-2912"><a href="#Expr-2912"><span class="linenos">2912</span></a><span class="sd">        5*tan(2)**3/3 + 2*tan(2)/3) + (x - 2)**5*(2/15 + 17*tan(2)**2/15 +</span>
</span><span id="Expr-2913"><a href="#Expr-2913"><span class="linenos">2913</span></a><span class="sd">        2*tan(2)**4 + tan(2)**6) + O((x - 2)**6, (x, 2))</span>
</span><span id="Expr-2914"><a href="#Expr-2914"><span class="linenos">2914</span></a>
</span><span id="Expr-2915"><a href="#Expr-2915"><span class="linenos">2915</span></a><span class="sd">        &gt;&gt;&gt; f.series(x, 2, 3, &quot;-&quot;)</span>
</span><span id="Expr-2916"><a href="#Expr-2916"><span class="linenos">2916</span></a><span class="sd">        tan(2) + (2 - x)*(-tan(2)**2 - 1) + (2 - x)**2*(tan(2)**3 + tan(2))</span>
</span><span id="Expr-2917"><a href="#Expr-2917"><span class="linenos">2917</span></a><span class="sd">        + O((x - 2)**3, (x, 2))</span>
</span><span id="Expr-2918"><a href="#Expr-2918"><span class="linenos">2918</span></a>
</span><span id="Expr-2919"><a href="#Expr-2919"><span class="linenos">2919</span></a><span class="sd">        Returns</span>
</span><span id="Expr-2920"><a href="#Expr-2920"><span class="linenos">2920</span></a><span class="sd">        =======</span>
</span><span id="Expr-2921"><a href="#Expr-2921"><span class="linenos">2921</span></a>
</span><span id="Expr-2922"><a href="#Expr-2922"><span class="linenos">2922</span></a><span class="sd">        Expr : Expression</span>
</span><span id="Expr-2923"><a href="#Expr-2923"><span class="linenos">2923</span></a><span class="sd">            Series expansion of the expression about x0</span>
</span><span id="Expr-2924"><a href="#Expr-2924"><span class="linenos">2924</span></a>
</span><span id="Expr-2925"><a href="#Expr-2925"><span class="linenos">2925</span></a><span class="sd">        Raises</span>
</span><span id="Expr-2926"><a href="#Expr-2926"><span class="linenos">2926</span></a><span class="sd">        ======</span>
</span><span id="Expr-2927"><a href="#Expr-2927"><span class="linenos">2927</span></a>
</span><span id="Expr-2928"><a href="#Expr-2928"><span class="linenos">2928</span></a><span class="sd">        TypeError</span>
</span><span id="Expr-2929"><a href="#Expr-2929"><span class="linenos">2929</span></a><span class="sd">            If &quot;n&quot; and &quot;x0&quot; are infinity objects</span>
</span><span id="Expr-2930"><a href="#Expr-2930"><span class="linenos">2930</span></a>
</span><span id="Expr-2931"><a href="#Expr-2931"><span class="linenos">2931</span></a><span class="sd">        PoleError</span>
</span><span id="Expr-2932"><a href="#Expr-2932"><span class="linenos">2932</span></a><span class="sd">            If &quot;x0&quot; is an infinity object</span>
</span><span id="Expr-2933"><a href="#Expr-2933"><span class="linenos">2933</span></a>
</span><span id="Expr-2934"><a href="#Expr-2934"><span class="linenos">2934</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Expr-2935"><a href="#Expr-2935"><span class="linenos">2935</span></a>        <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Expr-2936"><a href="#Expr-2936"><span class="linenos">2936</span></a>            <span class="n">syms</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">free_symbols</span>
</span><span id="Expr-2937"><a href="#Expr-2937"><span class="linenos">2937</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">syms</span><span class="p">:</span>
</span><span id="Expr-2938"><a href="#Expr-2938"><span class="linenos">2938</span></a>                <span class="k">return</span> <span class="bp">self</span>
</span><span id="Expr-2939"><a href="#Expr-2939"><span class="linenos">2939</span></a>            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">syms</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Expr-2940"><a href="#Expr-2940"><span class="linenos">2940</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;x must be given for multivariate functions.&#39;</span><span class="p">)</span>
</span><span id="Expr-2941"><a href="#Expr-2941"><span class="linenos">2941</span></a>            <span class="n">x</span> <span class="o">=</span> <span class="n">syms</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
</span><span id="Expr-2942"><a href="#Expr-2942"><span class="linenos">2942</span></a>
</span><span id="Expr-2943"><a href="#Expr-2943"><span class="linenos">2943</span></a>        <span class="kn">from</span> <span class="nn">.symbol</span> <span class="kn">import</span> <span class="n">Dummy</span><span class="p">,</span> <span class="n">Symbol</span>
</span><span id="Expr-2944"><a href="#Expr-2944"><span class="linenos">2944</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Symbol</span><span class="p">):</span>
</span><span id="Expr-2945"><a href="#Expr-2945"><span class="linenos">2945</span></a>            <span class="n">dep</span> <span class="o">=</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">free_symbols</span>
</span><span id="Expr-2946"><a href="#Expr-2946"><span class="linenos">2946</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Expr-2947"><a href="#Expr-2947"><span class="linenos">2947</span></a>            <span class="n">d</span> <span class="o">=</span> <span class="n">Dummy</span><span class="p">()</span>
</span><span id="Expr-2948"><a href="#Expr-2948"><span class="linenos">2948</span></a>            <span class="n">dep</span> <span class="o">=</span> <span class="n">d</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">xreplace</span><span class="p">({</span><span class="n">x</span><span class="p">:</span> <span class="n">d</span><span class="p">})</span><span class="o">.</span><span class="n">free_symbols</span>
</span><span id="Expr-2949"><a href="#Expr-2949"><span class="linenos">2949</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">dep</span><span class="p">:</span>
</span><span id="Expr-2950"><a href="#Expr-2950"><span class="linenos">2950</span></a>            <span class="k">if</span> <span class="n">n</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Expr-2951"><a href="#Expr-2951"><span class="linenos">2951</span></a>                <span class="k">return</span> <span class="p">(</span><span class="n">s</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="p">[</span><span class="bp">self</span><span class="p">])</span>
</span><span id="Expr-2952"><a href="#Expr-2952"><span class="linenos">2952</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Expr-2953"><a href="#Expr-2953"><span class="linenos">2953</span></a>                <span class="k">return</span> <span class="bp">self</span>
</span><span id="Expr-2954"><a href="#Expr-2954"><span class="linenos">2954</span></a>
</span><span id="Expr-2955"><a href="#Expr-2955"><span class="linenos">2955</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">dir</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span> <span class="ow">or</span> <span class="nb">dir</span> <span class="ow">not</span> <span class="ow">in</span> <span class="s1">&#39;+-&#39;</span><span class="p">:</span>
</span><span id="Expr-2956"><a href="#Expr-2956"><span class="linenos">2956</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Dir must be &#39;+&#39; or &#39;-&#39;&quot;</span><span class="p">)</span>
</span><span id="Expr-2957"><a href="#Expr-2957"><span class="linenos">2957</span></a>
</span><span id="Expr-2958"><a href="#Expr-2958"><span class="linenos">2958</span></a>        <span class="k">if</span> <span class="n">x0</span> <span class="ow">in</span> <span class="p">[</span><span class="n">S</span><span class="o">.</span><span class="n">Infinity</span><span class="p">,</span> <span class="n">S</span><span class="o">.</span><span class="n">NegativeInfinity</span><span class="p">]:</span>
</span><span id="Expr-2959"><a href="#Expr-2959"><span class="linenos">2959</span></a>            <span class="kn">from</span> <span class="nn">.function</span> <span class="kn">import</span> <span class="n">PoleError</span>
</span><span id="Expr-2960"><a href="#Expr-2960"><span class="linenos">2960</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="Expr-2961"><a href="#Expr-2961"><span class="linenos">2961</span></a>                <span class="n">sgn</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">x0</span> <span class="ow">is</span> <span class="n">S</span><span class="o">.</span><span class="n">Infinity</span> <span class="k">else</span> <span class="o">-</span><span class="mi">1</span>
</span><span id="Expr-2962"><a href="#Expr-2962"><span class="linenos">2962</span></a>                <span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">sgn</span><span class="o">/</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">series</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="nb">dir</span><span class="o">=</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="n">cdir</span><span class="o">=</span><span class="n">cdir</span><span class="p">)</span>
</span><span id="Expr-2963"><a href="#Expr-2963"><span class="linenos">2963</span></a>                <span class="k">if</span> <span class="n">n</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Expr-2964"><a href="#Expr-2964"><span class="linenos">2964</span></a>                    <span class="k">return</span> <span class="p">(</span><span class="n">si</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">sgn</span><span class="o">/</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">si</span> <span class="ow">in</span> <span class="n">s</span><span class="p">)</span>
</span><span id="Expr-2965"><a href="#Expr-2965"><span class="linenos">2965</span></a>                <span class="k">return</span> <span class="n">s</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">sgn</span><span class="o">/</span><span class="n">x</span><span class="p">)</span>
</span><span id="Expr-2966"><a href="#Expr-2966"><span class="linenos">2966</span></a>            <span class="k">except</span> <span class="n">PoleError</span><span class="p">:</span>
</span><span id="Expr-2967"><a href="#Expr-2967"><span class="linenos">2967</span></a>                <span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">sgn</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">aseries</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
</span><span id="Expr-2968"><a href="#Expr-2968"><span class="linenos">2968</span></a>                <span class="k">return</span> <span class="n">s</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">sgn</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
</span><span id="Expr-2969"><a href="#Expr-2969"><span class="linenos">2969</span></a>
</span><span id="Expr-2970"><a href="#Expr-2970"><span class="linenos">2970</span></a>        <span class="c1"># use rep to shift origin to x0 and change sign (if dir is negative)</span>
</span><span id="Expr-2971"><a href="#Expr-2971"><span class="linenos">2971</span></a>        <span class="c1"># and undo the process with rep2</span>
</span><span id="Expr-2972"><a href="#Expr-2972"><span class="linenos">2972</span></a>        <span class="k">if</span> <span class="n">x0</span> <span class="ow">or</span> <span class="nb">dir</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span><span class="p">:</span>
</span><span id="Expr-2973"><a href="#Expr-2973"><span class="linenos">2973</span></a>            <span class="k">if</span> <span class="nb">dir</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span><span class="p">:</span>
</span><span id="Expr-2974"><a href="#Expr-2974"><span class="linenos">2974</span></a>                <span class="n">rep</span> <span class="o">=</span> <span class="o">-</span><span class="n">x</span> <span class="o">+</span> <span class="n">x0</span>
</span><span id="Expr-2975"><a href="#Expr-2975"><span class="linenos">2975</span></a>                <span class="n">rep2</span> <span class="o">=</span> <span class="o">-</span><span class="n">x</span>
</span><span id="Expr-2976"><a href="#Expr-2976"><span class="linenos">2976</span></a>                <span class="n">rep2b</span> <span class="o">=</span> <span class="n">x0</span>
</span><span id="Expr-2977"><a href="#Expr-2977"><span class="linenos">2977</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Expr-2978"><a href="#Expr-2978"><span class="linenos">2978</span></a>                <span class="n">rep</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">x0</span>
</span><span id="Expr-2979"><a href="#Expr-2979"><span class="linenos">2979</span></a>                <span class="n">rep2</span> <span class="o">=</span> <span class="n">x</span>
</span><span id="Expr-2980"><a href="#Expr-2980"><span class="linenos">2980</span></a>                <span class="n">rep2b</span> <span class="o">=</span> <span class="o">-</span><span class="n">x0</span>
</span><span id="Expr-2981"><a href="#Expr-2981"><span class="linenos">2981</span></a>            <span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">rep</span><span class="p">)</span><span class="o">.</span><span class="n">series</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="nb">dir</span><span class="o">=</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="n">logx</span><span class="o">=</span><span class="n">logx</span><span class="p">,</span> <span class="n">cdir</span><span class="o">=</span><span class="n">cdir</span><span class="p">)</span>
</span><span id="Expr-2982"><a href="#Expr-2982"><span class="linenos">2982</span></a>            <span class="k">if</span> <span class="n">n</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># lseries...</span>
</span><span id="Expr-2983"><a href="#Expr-2983"><span class="linenos">2983</span></a>                <span class="k">return</span> <span class="p">(</span><span class="n">si</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">rep2</span> <span class="o">+</span> <span class="n">rep2b</span><span class="p">)</span> <span class="k">for</span> <span class="n">si</span> <span class="ow">in</span> <span class="n">s</span><span class="p">)</span>
</span><span id="Expr-2984"><a href="#Expr-2984"><span class="linenos">2984</span></a>            <span class="k">return</span> <span class="n">s</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">rep2</span> <span class="o">+</span> <span class="n">rep2b</span><span class="p">)</span>
</span><span id="Expr-2985"><a href="#Expr-2985"><span class="linenos">2985</span></a>
</span><span id="Expr-2986"><a href="#Expr-2986"><span class="linenos">2986</span></a>        <span class="c1"># from here on it&#39;s x0=0 and dir=&#39;+&#39; handling</span>
</span><span id="Expr-2987"><a href="#Expr-2987"><span class="linenos">2987</span></a>
</span><span id="Expr-2988"><a href="#Expr-2988"><span class="linenos">2988</span></a>        <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">is_positive</span> <span class="ow">is</span> <span class="n">x</span><span class="o">.</span><span class="n">is_negative</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">x</span><span class="o">.</span><span class="n">is_Symbol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="Expr-2989"><a href="#Expr-2989"><span class="linenos">2989</span></a>            <span class="c1"># replace x with an x that has a positive assumption</span>
</span><span id="Expr-2990"><a href="#Expr-2990"><span class="linenos">2990</span></a>            <span class="n">xpos</span> <span class="o">=</span> <span class="n">Dummy</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">positive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="Expr-2991"><a href="#Expr-2991"><span class="linenos">2991</span></a>            <span class="n">rv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">xpos</span><span class="p">)</span><span class="o">.</span><span class="n">series</span><span class="p">(</span><span class="n">xpos</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="nb">dir</span><span class="p">,</span> <span class="n">logx</span><span class="o">=</span><span class="n">logx</span><span class="p">,</span> <span class="n">cdir</span><span class="o">=</span><span class="n">cdir</span><span class="p">)</span>
</span><span id="Expr-2992"><a href="#Expr-2992"><span class="linenos">2992</span></a>            <span class="k">if</span> <span class="n">n</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Expr-2993"><a href="#Expr-2993"><span class="linenos">2993</span></a>                <span class="k">return</span> <span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">xpos</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">rv</span><span class="p">)</span>
</span><span id="Expr-2994"><a href="#Expr-2994"><span class="linenos">2994</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Expr-2995"><a href="#Expr-2995"><span class="linenos">2995</span></a>                <span class="k">return</span> <span class="n">rv</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">xpos</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</span><span id="Expr-2996"><a href="#Expr-2996"><span class="linenos">2996</span></a>
</span><span id="Expr-2997"><a href="#Expr-2997"><span class="linenos">2997</span></a>        <span class="kn">from</span> <span class="nn">sympy.series.order</span> <span class="kn">import</span> <span class="n">Order</span>
</span><span id="Expr-2998"><a href="#Expr-2998"><span class="linenos">2998</span></a>        <span class="k">if</span> <span class="n">n</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># nseries handling</span>
</span><span id="Expr-2999"><a href="#Expr-2999"><span class="linenos">2999</span></a>            <span class="n">s1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_eval_nseries</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">logx</span><span class="o">=</span><span class="n">logx</span><span class="p">,</span> <span class="n">cdir</span><span class="o">=</span><span class="n">cdir</span><span class="p">)</span>
</span><span id="Expr-3000"><a href="#Expr-3000"><span class="linenos">3000</span></a>            <span class="n">o</span> <span class="o">=</span> <span class="n">s1</span><span class="o">.</span><span class="n">getO</span><span class="p">()</span> <span class="ow">or</span> <span class="n">S</span><span class="o">.</span><span class="n">Zero</span>
</span><span id="Expr-3001"><a href="#Expr-3001"><span class="linenos">3001</span></a>            <span class="k">if</span> <span class="n">o</span><span class="p">:</span>
</span><span id="Expr-3002"><a href="#Expr-3002"><span class="linenos">3002</span></a>                <span class="c1"># make sure the requested order is returned</span>
</span><span id="Expr-3003"><a href="#Expr-3003"><span class="linenos">3003</span></a>                <span class="n">ngot</span> <span class="o">=</span> <span class="n">o</span><span class="o">.</span><span class="n">getn</span><span class="p">()</span>
</span><span id="Expr-3004"><a href="#Expr-3004"><span class="linenos">3004</span></a>                <span class="k">if</span> <span class="n">ngot</span> <span class="o">&gt;</span> <span class="n">n</span><span class="p">:</span>
</span><span id="Expr-3005"><a href="#Expr-3005"><span class="linenos">3005</span></a>                    <span class="c1"># leave o in its current form (e.g. with x*log(x)) so</span>
</span><span id="Expr-3006"><a href="#Expr-3006"><span class="linenos">3006</span></a>                    <span class="c1"># it eats terms properly, then replace it below</span>
</span><span id="Expr-3007"><a href="#Expr-3007"><span class="linenos">3007</span></a>                    <span class="k">if</span> <span class="n">n</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Expr-3008"><a href="#Expr-3008"><span class="linenos">3008</span></a>                        <span class="n">s1</span> <span class="o">+=</span> <span class="n">o</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">**</span><span class="n">Rational</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">ngot</span><span class="p">))</span>
</span><span id="Expr-3009"><a href="#Expr-3009"><span class="linenos">3009</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="Expr-3010"><a href="#Expr-3010"><span class="linenos">3010</span></a>                        <span class="n">s1</span> <span class="o">+=</span> <span class="n">Order</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</span><span id="Expr-3011"><a href="#Expr-3011"><span class="linenos">3011</span></a>                <span class="k">elif</span> <span class="n">ngot</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">:</span>
</span><span id="Expr-3012"><a href="#Expr-3012"><span class="linenos">3012</span></a>                    <span class="c1"># increase the requested number of terms to get the desired</span>
</span><span id="Expr-3013"><a href="#Expr-3013"><span class="linenos">3013</span></a>                    <span class="c1"># number keep increasing (up to 9) until the received order</span>
</span><span id="Expr-3014"><a href="#Expr-3014"><span class="linenos">3014</span></a>                    <span class="c1"># is different than the original order and then predict how</span>
</span><span id="Expr-3015"><a href="#Expr-3015"><span class="linenos">3015</span></a>                    <span class="c1"># many additional terms are needed</span>
</span><span id="Expr-3016"><a href="#Expr-3016"><span class="linenos">3016</span></a>                    <span class="kn">from</span> <span class="nn">sympy.functions.elementary.integers</span> <span class="kn">import</span> <span class="n">ceiling</span>
</span><span id="Expr-3017"><a href="#Expr-3017"><span class="linenos">3017</span></a>                    <span class="k">for</span> <span class="n">more</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">9</span><span class="p">):</span>
</span><span id="Expr-3018"><a href="#Expr-3018"><span class="linenos">3018</span></a>                        <span class="n">s1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_eval_nseries</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">n</span> <span class="o">+</span> <span class="n">more</span><span class="p">,</span> <span class="n">logx</span><span class="o">=</span><span class="n">logx</span><span class="p">,</span> <span class="n">cdir</span><span class="o">=</span><span class="n">cdir</span><span class="p">)</span>
</span><span id="Expr-3019"><a href="#Expr-3019"><span class="linenos">3019</span></a>                        <span class="n">newn</span> <span class="o">=</span> <span class="n">s1</span><span class="o">.</span><span class="n">getn</span><span class="p">()</span>
</span><span id="Expr-3020"><a href="#Expr-3020"><span class="linenos">3020</span></a>                        <span class="k">if</span> <span class="n">newn</span> <span class="o">!=</span> <span class="n">ngot</span><span class="p">:</span>
</span><span id="Expr-3021"><a href="#Expr-3021"><span class="linenos">3021</span></a>                            <span class="n">ndo</span> <span class="o">=</span> <span class="n">n</span> <span class="o">+</span> <span class="n">ceiling</span><span class="p">((</span><span class="n">n</span> <span class="o">-</span> <span class="n">ngot</span><span class="p">)</span><span class="o">*</span><span class="n">more</span><span class="o">/</span><span class="p">(</span><span class="n">newn</span> <span class="o">-</span> <span class="n">ngot</span><span class="p">))</span>
</span><span id="Expr-3022"><a href="#Expr-3022"><span class="linenos">3022</span></a>                            <span class="n">s1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_eval_nseries</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">ndo</span><span class="p">,</span> <span class="n">logx</span><span class="o">=</span><span class="n">logx</span><span class="p">,</span> <span class="n">cdir</span><span class="o">=</span><span class="n">cdir</span><span class="p">)</span>
</span><span id="Expr-3023"><a href="#Expr-3023"><span class="linenos">3023</span></a>                            <span class="k">while</span> <span class="n">s1</span><span class="o">.</span><span class="n">getn</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">:</span>
</span><span id="Expr-3024"><a href="#Expr-3024"><span class="linenos">3024</span></a>                                <span class="n">s1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_eval_nseries</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">ndo</span><span class="p">,</span> <span class="n">logx</span><span class="o">=</span><span class="n">logx</span><span class="p">,</span> <span class="n">cdir</span><span class="o">=</span><span class="n">cdir</span><span class="p">)</span>
</span><span id="Expr-3025"><a href="#Expr-3025"><span class="linenos">3025</span></a>                                <span class="n">ndo</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="Expr-3026"><a href="#Expr-3026"><span class="linenos">3026</span></a>                            <span class="k">break</span>
</span><span id="Expr-3027"><a href="#Expr-3027"><span class="linenos">3027</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="Expr-3028"><a href="#Expr-3028"><span class="linenos">3028</span></a>                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Could not calculate </span><span class="si">%s</span><span class="s1"> terms for </span><span class="si">%s</span><span class="s1">&#39;</span>
</span><span id="Expr-3029"><a href="#Expr-3029"><span class="linenos">3029</span></a>                                         <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">),</span> <span class="bp">self</span><span class="p">))</span>
</span><span id="Expr-3030"><a href="#Expr-3030"><span class="linenos">3030</span></a>                    <span class="n">s1</span> <span class="o">+=</span> <span class="n">Order</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="n">n</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</span><span id="Expr-3031"><a href="#Expr-3031"><span class="linenos">3031</span></a>                <span class="n">o</span> <span class="o">=</span> <span class="n">s1</span><span class="o">.</span><span class="n">getO</span><span class="p">()</span>
</span><span id="Expr-3032"><a href="#Expr-3032"><span class="linenos">3032</span></a>                <span class="n">s1</span> <span class="o">=</span> <span class="n">s1</span><span class="o">.</span><span class="n">removeO</span><span class="p">()</span>
</span><span id="Expr-3033"><a href="#Expr-3033"><span class="linenos">3033</span></a>            <span class="k">elif</span> <span class="n">s1</span><span class="o">.</span><span class="n">has</span><span class="p">(</span><span class="n">Order</span><span class="p">):</span>
</span><span id="Expr-3034"><a href="#Expr-3034"><span class="linenos">3034</span></a>                <span class="c1"># asymptotic expansion</span>
</span><span id="Expr-3035"><a href="#Expr-3035"><span class="linenos">3035</span></a>                <span class="k">return</span> <span class="n">s1</span>
</span><span id="Expr-3036"><a href="#Expr-3036"><span class="linenos">3036</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Expr-3037"><a href="#Expr-3037"><span class="linenos">3037</span></a>                <span class="n">o</span> <span class="o">=</span> <span class="n">Order</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="n">n</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</span><span id="Expr-3038"><a href="#Expr-3038"><span class="linenos">3038</span></a>                <span class="n">s1done</span> <span class="o">=</span> <span class="n">s1</span><span class="o">.</span><span class="n">doit</span><span class="p">()</span>
</span><span id="Expr-3039"><a href="#Expr-3039"><span class="linenos">3039</span></a>                <span class="k">if</span> <span class="p">(</span><span class="n">s1done</span> <span class="o">+</span> <span class="n">o</span><span class="p">)</span><span class="o">.</span><span class="n">removeO</span><span class="p">()</span> <span class="o">==</span> <span class="n">s1done</span><span class="p">:</span>
</span><span id="Expr-3040"><a href="#Expr-3040"><span class="linenos">3040</span></a>                    <span class="n">o</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">Zero</span>
</span><span id="Expr-3041"><a href="#Expr-3041"><span class="linenos">3041</span></a>
</span><span id="Expr-3042"><a href="#Expr-3042"><span class="linenos">3042</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="Expr-3043"><a href="#Expr-3043"><span class="linenos">3043</span></a>                <span class="kn">from</span> <span class="nn">sympy.simplify.radsimp</span> <span class="kn">import</span> <span class="n">collect</span>
</span><span id="Expr-3044"><a href="#Expr-3044"><span class="linenos">3044</span></a>                <span class="k">return</span> <span class="n">collect</span><span class="p">(</span><span class="n">s1</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">o</span>
</span><span id="Expr-3045"><a href="#Expr-3045"><span class="linenos">3045</span></a>            <span class="k">except</span> <span class="ne">NotImplementedError</span><span class="p">:</span>
</span><span id="Expr-3046"><a href="#Expr-3046"><span class="linenos">3046</span></a>                <span class="k">return</span> <span class="n">s1</span> <span class="o">+</span> <span class="n">o</span>
</span><span id="Expr-3047"><a href="#Expr-3047"><span class="linenos">3047</span></a>
</span><span id="Expr-3048"><a href="#Expr-3048"><span class="linenos">3048</span></a>        <span class="k">else</span><span class="p">:</span>  <span class="c1"># lseries handling</span>
</span><span id="Expr-3049"><a href="#Expr-3049"><span class="linenos">3049</span></a>            <span class="k">def</span> <span class="nf">yield_lseries</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
</span><span id="Expr-3050"><a href="#Expr-3050"><span class="linenos">3050</span></a><span class="w">                </span><span class="sd">&quot;&quot;&quot;Return terms of lseries one at a time.&quot;&quot;&quot;</span>
</span><span id="Expr-3051"><a href="#Expr-3051"><span class="linenos">3051</span></a>                <span class="k">for</span> <span class="n">si</span> <span class="ow">in</span> <span class="n">s</span><span class="p">:</span>
</span><span id="Expr-3052"><a href="#Expr-3052"><span class="linenos">3052</span></a>                    <span class="k">if</span> <span class="ow">not</span> <span class="n">si</span><span class="o">.</span><span class="n">is_Add</span><span class="p">:</span>
</span><span id="Expr-3053"><a href="#Expr-3053"><span class="linenos">3053</span></a>                        <span class="k">yield</span> <span class="n">si</span>
</span><span id="Expr-3054"><a href="#Expr-3054"><span class="linenos">3054</span></a>                        <span class="k">continue</span>
</span><span id="Expr-3055"><a href="#Expr-3055"><span class="linenos">3055</span></a>                    <span class="c1"># yield terms 1 at a time if possible</span>
</span><span id="Expr-3056"><a href="#Expr-3056"><span class="linenos">3056</span></a>                    <span class="c1"># by increasing order until all the</span>
</span><span id="Expr-3057"><a href="#Expr-3057"><span class="linenos">3057</span></a>                    <span class="c1"># terms have been returned</span>
</span><span id="Expr-3058"><a href="#Expr-3058"><span class="linenos">3058</span></a>                    <span class="n">yielded</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Expr-3059"><a href="#Expr-3059"><span class="linenos">3059</span></a>                    <span class="n">o</span> <span class="o">=</span> <span class="n">Order</span><span class="p">(</span><span class="n">si</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">x</span>
</span><span id="Expr-3060"><a href="#Expr-3060"><span class="linenos">3060</span></a>                    <span class="n">ndid</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Expr-3061"><a href="#Expr-3061"><span class="linenos">3061</span></a>                    <span class="n">ndo</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">si</span><span class="o">.</span><span class="n">args</span><span class="p">)</span>
</span><span id="Expr-3062"><a href="#Expr-3062"><span class="linenos">3062</span></a>                    <span class="k">while</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Expr-3063"><a href="#Expr-3063"><span class="linenos">3063</span></a>                        <span class="n">do</span> <span class="o">=</span> <span class="p">(</span><span class="n">si</span> <span class="o">-</span> <span class="n">yielded</span> <span class="o">+</span> <span class="n">o</span><span class="p">)</span><span class="o">.</span><span class="n">removeO</span><span class="p">()</span>
</span><span id="Expr-3064"><a href="#Expr-3064"><span class="linenos">3064</span></a>                        <span class="n">o</span> <span class="o">*=</span> <span class="n">x</span>
</span><span id="Expr-3065"><a href="#Expr-3065"><span class="linenos">3065</span></a>                        <span class="k">if</span> <span class="ow">not</span> <span class="n">do</span> <span class="ow">or</span> <span class="n">do</span><span class="o">.</span><span class="n">is_Order</span><span class="p">:</span>
</span><span id="Expr-3066"><a href="#Expr-3066"><span class="linenos">3066</span></a>                            <span class="k">continue</span>
</span><span id="Expr-3067"><a href="#Expr-3067"><span class="linenos">3067</span></a>                        <span class="k">if</span> <span class="n">do</span><span class="o">.</span><span class="n">is_Add</span><span class="p">:</span>
</span><span id="Expr-3068"><a href="#Expr-3068"><span class="linenos">3068</span></a>                            <span class="n">ndid</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">do</span><span class="o">.</span><span class="n">args</span><span class="p">)</span>
</span><span id="Expr-3069"><a href="#Expr-3069"><span class="linenos">3069</span></a>                        <span class="k">else</span><span class="p">:</span>
</span><span id="Expr-3070"><a href="#Expr-3070"><span class="linenos">3070</span></a>                            <span class="n">ndid</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="Expr-3071"><a href="#Expr-3071"><span class="linenos">3071</span></a>                        <span class="k">yield</span> <span class="n">do</span>
</span><span id="Expr-3072"><a href="#Expr-3072"><span class="linenos">3072</span></a>                        <span class="k">if</span> <span class="n">ndid</span> <span class="o">==</span> <span class="n">ndo</span><span class="p">:</span>
</span><span id="Expr-3073"><a href="#Expr-3073"><span class="linenos">3073</span></a>                            <span class="k">break</span>
</span><span id="Expr-3074"><a href="#Expr-3074"><span class="linenos">3074</span></a>                        <span class="n">yielded</span> <span class="o">+=</span> <span class="n">do</span>
</span><span id="Expr-3075"><a href="#Expr-3075"><span class="linenos">3075</span></a>
</span><span id="Expr-3076"><a href="#Expr-3076"><span class="linenos">3076</span></a>            <span class="k">return</span> <span class="n">yield_lseries</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">removeO</span><span class="p">()</span><span class="o">.</span><span class="n">_eval_lseries</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">logx</span><span class="o">=</span><span class="n">logx</span><span class="p">,</span> <span class="n">cdir</span><span class="o">=</span><span class="n">cdir</span><span class="p">))</span>
</span><span id="Expr-3077"><a href="#Expr-3077"><span class="linenos">3077</span></a>
</span><span id="Expr-3078"><a href="#Expr-3078"><span class="linenos">3078</span></a>    <span class="k">def</span> <span class="nf">aseries</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">bound</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">hir</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="Expr-3079"><a href="#Expr-3079"><span class="linenos">3079</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Asymptotic Series expansion of self.</span>
</span><span id="Expr-3080"><a href="#Expr-3080"><span class="linenos">3080</span></a><span class="sd">        This is equivalent to ``self.series(x, oo, n)``.</span>
</span><span id="Expr-3081"><a href="#Expr-3081"><span class="linenos">3081</span></a>
</span><span id="Expr-3082"><a href="#Expr-3082"><span class="linenos">3082</span></a><span class="sd">        Parameters</span>
</span><span id="Expr-3083"><a href="#Expr-3083"><span class="linenos">3083</span></a><span class="sd">        ==========</span>
</span><span id="Expr-3084"><a href="#Expr-3084"><span class="linenos">3084</span></a>
</span><span id="Expr-3085"><a href="#Expr-3085"><span class="linenos">3085</span></a><span class="sd">        self : Expression</span>
</span><span id="Expr-3086"><a href="#Expr-3086"><span class="linenos">3086</span></a><span class="sd">               The expression whose series is to be expanded.</span>
</span><span id="Expr-3087"><a href="#Expr-3087"><span class="linenos">3087</span></a>
</span><span id="Expr-3088"><a href="#Expr-3088"><span class="linenos">3088</span></a><span class="sd">        x : Symbol</span>
</span><span id="Expr-3089"><a href="#Expr-3089"><span class="linenos">3089</span></a><span class="sd">            It is the variable of the expression to be calculated.</span>
</span><span id="Expr-3090"><a href="#Expr-3090"><span class="linenos">3090</span></a>
</span><span id="Expr-3091"><a href="#Expr-3091"><span class="linenos">3091</span></a><span class="sd">        n : Value</span>
</span><span id="Expr-3092"><a href="#Expr-3092"><span class="linenos">3092</span></a><span class="sd">            The number of terms upto which the series is to be expanded.</span>
</span><span id="Expr-3093"><a href="#Expr-3093"><span class="linenos">3093</span></a>
</span><span id="Expr-3094"><a href="#Expr-3094"><span class="linenos">3094</span></a><span class="sd">        hir : Boolean</span>
</span><span id="Expr-3095"><a href="#Expr-3095"><span class="linenos">3095</span></a><span class="sd">              Set this parameter to be True to produce hierarchical series.</span>
</span><span id="Expr-3096"><a href="#Expr-3096"><span class="linenos">3096</span></a><span class="sd">              It stops the recursion at an early level and may provide nicer</span>
</span><span id="Expr-3097"><a href="#Expr-3097"><span class="linenos">3097</span></a><span class="sd">              and more useful results.</span>
</span><span id="Expr-3098"><a href="#Expr-3098"><span class="linenos">3098</span></a>
</span><span id="Expr-3099"><a href="#Expr-3099"><span class="linenos">3099</span></a><span class="sd">        bound : Value, Integer</span>
</span><span id="Expr-3100"><a href="#Expr-3100"><span class="linenos">3100</span></a><span class="sd">                Use the ``bound`` parameter to give limit on rewriting</span>
</span><span id="Expr-3101"><a href="#Expr-3101"><span class="linenos">3101</span></a><span class="sd">                coefficients in its normalised form.</span>
</span><span id="Expr-3102"><a href="#Expr-3102"><span class="linenos">3102</span></a>
</span><span id="Expr-3103"><a href="#Expr-3103"><span class="linenos">3103</span></a><span class="sd">        Examples</span>
</span><span id="Expr-3104"><a href="#Expr-3104"><span class="linenos">3104</span></a><span class="sd">        ========</span>
</span><span id="Expr-3105"><a href="#Expr-3105"><span class="linenos">3105</span></a>
</span><span id="Expr-3106"><a href="#Expr-3106"><span class="linenos">3106</span></a><span class="sd">        &gt;&gt;&gt; from sympy import sin, exp</span>
</span><span id="Expr-3107"><a href="#Expr-3107"><span class="linenos">3107</span></a><span class="sd">        &gt;&gt;&gt; from sympy.abc import x</span>
</span><span id="Expr-3108"><a href="#Expr-3108"><span class="linenos">3108</span></a>
</span><span id="Expr-3109"><a href="#Expr-3109"><span class="linenos">3109</span></a><span class="sd">        &gt;&gt;&gt; e = sin(1/x + exp(-x)) - sin(1/x)</span>
</span><span id="Expr-3110"><a href="#Expr-3110"><span class="linenos">3110</span></a>
</span><span id="Expr-3111"><a href="#Expr-3111"><span class="linenos">3111</span></a><span class="sd">        &gt;&gt;&gt; e.aseries(x)</span>
</span><span id="Expr-3112"><a href="#Expr-3112"><span class="linenos">3112</span></a><span class="sd">        (1/(24*x**4) - 1/(2*x**2) + 1 + O(x**(-6), (x, oo)))*exp(-x)</span>
</span><span id="Expr-3113"><a href="#Expr-3113"><span class="linenos">3113</span></a>
</span><span id="Expr-3114"><a href="#Expr-3114"><span class="linenos">3114</span></a><span class="sd">        &gt;&gt;&gt; e.aseries(x, n=3, hir=True)</span>
</span><span id="Expr-3115"><a href="#Expr-3115"><span class="linenos">3115</span></a><span class="sd">        -exp(-2*x)*sin(1/x)/2 + exp(-x)*cos(1/x) + O(exp(-3*x), (x, oo))</span>
</span><span id="Expr-3116"><a href="#Expr-3116"><span class="linenos">3116</span></a>
</span><span id="Expr-3117"><a href="#Expr-3117"><span class="linenos">3117</span></a><span class="sd">        &gt;&gt;&gt; e = exp(exp(x)/(1 - 1/x))</span>
</span><span id="Expr-3118"><a href="#Expr-3118"><span class="linenos">3118</span></a>
</span><span id="Expr-3119"><a href="#Expr-3119"><span class="linenos">3119</span></a><span class="sd">        &gt;&gt;&gt; e.aseries(x)</span>
</span><span id="Expr-3120"><a href="#Expr-3120"><span class="linenos">3120</span></a><span class="sd">        exp(exp(x)/(1 - 1/x))</span>
</span><span id="Expr-3121"><a href="#Expr-3121"><span class="linenos">3121</span></a>
</span><span id="Expr-3122"><a href="#Expr-3122"><span class="linenos">3122</span></a><span class="sd">        &gt;&gt;&gt; e.aseries(x, bound=3) # doctest: +SKIP</span>
</span><span id="Expr-3123"><a href="#Expr-3123"><span class="linenos">3123</span></a><span class="sd">        exp(exp(x)/x**2)*exp(exp(x)/x)*exp(-exp(x) + exp(x)/(1 - 1/x) - exp(x)/x - exp(x)/x**2)*exp(exp(x))</span>
</span><span id="Expr-3124"><a href="#Expr-3124"><span class="linenos">3124</span></a>
</span><span id="Expr-3125"><a href="#Expr-3125"><span class="linenos">3125</span></a><span class="sd">        Returns</span>
</span><span id="Expr-3126"><a href="#Expr-3126"><span class="linenos">3126</span></a><span class="sd">        =======</span>
</span><span id="Expr-3127"><a href="#Expr-3127"><span class="linenos">3127</span></a>
</span><span id="Expr-3128"><a href="#Expr-3128"><span class="linenos">3128</span></a><span class="sd">        Expr</span>
</span><span id="Expr-3129"><a href="#Expr-3129"><span class="linenos">3129</span></a><span class="sd">            Asymptotic series expansion of the expression.</span>
</span><span id="Expr-3130"><a href="#Expr-3130"><span class="linenos">3130</span></a>
</span><span id="Expr-3131"><a href="#Expr-3131"><span class="linenos">3131</span></a><span class="sd">        Notes</span>
</span><span id="Expr-3132"><a href="#Expr-3132"><span class="linenos">3132</span></a><span class="sd">        =====</span>
</span><span id="Expr-3133"><a href="#Expr-3133"><span class="linenos">3133</span></a>
</span><span id="Expr-3134"><a href="#Expr-3134"><span class="linenos">3134</span></a><span class="sd">        This algorithm is directly induced from the limit computational algorithm provided by Gruntz.</span>
</span><span id="Expr-3135"><a href="#Expr-3135"><span class="linenos">3135</span></a><span class="sd">        It majorly uses the mrv and rewrite sub-routines. The overall idea of this algorithm is first</span>
</span><span id="Expr-3136"><a href="#Expr-3136"><span class="linenos">3136</span></a><span class="sd">        to look for the most rapidly varying subexpression w of a given expression f and then expands f</span>
</span><span id="Expr-3137"><a href="#Expr-3137"><span class="linenos">3137</span></a><span class="sd">        in a series in w. Then same thing is recursively done on the leading coefficient</span>
</span><span id="Expr-3138"><a href="#Expr-3138"><span class="linenos">3138</span></a><span class="sd">        till we get constant coefficients.</span>
</span><span id="Expr-3139"><a href="#Expr-3139"><span class="linenos">3139</span></a>
</span><span id="Expr-3140"><a href="#Expr-3140"><span class="linenos">3140</span></a><span class="sd">        If the most rapidly varying subexpression of a given expression f is f itself,</span>
</span><span id="Expr-3141"><a href="#Expr-3141"><span class="linenos">3141</span></a><span class="sd">        the algorithm tries to find a normalised representation of the mrv set and rewrites f</span>
</span><span id="Expr-3142"><a href="#Expr-3142"><span class="linenos">3142</span></a><span class="sd">        using this normalised representation.</span>
</span><span id="Expr-3143"><a href="#Expr-3143"><span class="linenos">3143</span></a>
</span><span id="Expr-3144"><a href="#Expr-3144"><span class="linenos">3144</span></a><span class="sd">        If the expansion contains an order term, it will be either ``O(x ** (-n))`` or ``O(w ** (-n))``</span>
</span><span id="Expr-3145"><a href="#Expr-3145"><span class="linenos">3145</span></a><span class="sd">        where ``w`` belongs to the most rapidly varying expression of ``self``.</span>
</span><span id="Expr-3146"><a href="#Expr-3146"><span class="linenos">3146</span></a>
</span><span id="Expr-3147"><a href="#Expr-3147"><span class="linenos">3147</span></a><span class="sd">        References</span>
</span><span id="Expr-3148"><a href="#Expr-3148"><span class="linenos">3148</span></a><span class="sd">        ==========</span>
</span><span id="Expr-3149"><a href="#Expr-3149"><span class="linenos">3149</span></a>
</span><span id="Expr-3150"><a href="#Expr-3150"><span class="linenos">3150</span></a><span class="sd">        .. [1] Gruntz, Dominik. A new algorithm for computing asymptotic series.</span>
</span><span id="Expr-3151"><a href="#Expr-3151"><span class="linenos">3151</span></a><span class="sd">               In: Proc. 1993 Int. Symp. Symbolic and Algebraic Computation. 1993.</span>
</span><span id="Expr-3152"><a href="#Expr-3152"><span class="linenos">3152</span></a><span class="sd">               pp. 239-244.</span>
</span><span id="Expr-3153"><a href="#Expr-3153"><span class="linenos">3153</span></a><span class="sd">        .. [2] Gruntz thesis - p90</span>
</span><span id="Expr-3154"><a href="#Expr-3154"><span class="linenos">3154</span></a><span class="sd">        .. [3] http://en.wikipedia.org/wiki/Asymptotic_expansion</span>
</span><span id="Expr-3155"><a href="#Expr-3155"><span class="linenos">3155</span></a>
</span><span id="Expr-3156"><a href="#Expr-3156"><span class="linenos">3156</span></a><span class="sd">        See Also</span>
</span><span id="Expr-3157"><a href="#Expr-3157"><span class="linenos">3157</span></a><span class="sd">        ========</span>
</span><span id="Expr-3158"><a href="#Expr-3158"><span class="linenos">3158</span></a>
</span><span id="Expr-3159"><a href="#Expr-3159"><span class="linenos">3159</span></a><span class="sd">        Expr.aseries: See the docstring of this function for complete details of this wrapper.</span>
</span><span id="Expr-3160"><a href="#Expr-3160"><span class="linenos">3160</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Expr-3161"><a href="#Expr-3161"><span class="linenos">3161</span></a>
</span><span id="Expr-3162"><a href="#Expr-3162"><span class="linenos">3162</span></a>        <span class="kn">from</span> <span class="nn">.symbol</span> <span class="kn">import</span> <span class="n">Dummy</span>
</span><span id="Expr-3163"><a href="#Expr-3163"><span class="linenos">3163</span></a>
</span><span id="Expr-3164"><a href="#Expr-3164"><span class="linenos">3164</span></a>        <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">is_positive</span> <span class="ow">is</span> <span class="n">x</span><span class="o">.</span><span class="n">is_negative</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Expr-3165"><a href="#Expr-3165"><span class="linenos">3165</span></a>            <span class="n">xpos</span> <span class="o">=</span> <span class="n">Dummy</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">positive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="Expr-3166"><a href="#Expr-3166"><span class="linenos">3166</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">xpos</span><span class="p">)</span><span class="o">.</span><span class="n">aseries</span><span class="p">(</span><span class="n">xpos</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">bound</span><span class="p">,</span> <span class="n">hir</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">xpos</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</span><span id="Expr-3167"><a href="#Expr-3167"><span class="linenos">3167</span></a>
</span><span id="Expr-3168"><a href="#Expr-3168"><span class="linenos">3168</span></a>        <span class="kn">from</span> <span class="nn">.function</span> <span class="kn">import</span> <span class="n">PoleError</span>
</span><span id="Expr-3169"><a href="#Expr-3169"><span class="linenos">3169</span></a>        <span class="kn">from</span> <span class="nn">sympy.series.gruntz</span> <span class="kn">import</span> <span class="n">mrv</span><span class="p">,</span> <span class="n">rewrite</span>
</span><span id="Expr-3170"><a href="#Expr-3170"><span class="linenos">3170</span></a>
</span><span id="Expr-3171"><a href="#Expr-3171"><span class="linenos">3171</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="Expr-3172"><a href="#Expr-3172"><span class="linenos">3172</span></a>            <span class="n">om</span><span class="p">,</span> <span class="n">exps</span> <span class="o">=</span> <span class="n">mrv</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</span><span id="Expr-3173"><a href="#Expr-3173"><span class="linenos">3173</span></a>        <span class="k">except</span> <span class="n">PoleError</span><span class="p">:</span>
</span><span id="Expr-3174"><a href="#Expr-3174"><span class="linenos">3174</span></a>            <span class="k">return</span> <span class="bp">self</span>
</span><span id="Expr-3175"><a href="#Expr-3175"><span class="linenos">3175</span></a>
</span><span id="Expr-3176"><a href="#Expr-3176"><span class="linenos">3176</span></a>        <span class="c1"># We move one level up by replacing `x` by `exp(x)`, and then</span>
</span><span id="Expr-3177"><a href="#Expr-3177"><span class="linenos">3177</span></a>        <span class="c1"># computing the asymptotic series for f(exp(x)). Then asymptotic series</span>
</span><span id="Expr-3178"><a href="#Expr-3178"><span class="linenos">3178</span></a>        <span class="c1"># can be obtained by moving one-step back, by replacing x by ln(x).</span>
</span><span id="Expr-3179"><a href="#Expr-3179"><span class="linenos">3179</span></a>
</span><span id="Expr-3180"><a href="#Expr-3180"><span class="linenos">3180</span></a>        <span class="kn">from</span> <span class="nn">sympy.functions.elementary.exponential</span> <span class="kn">import</span> <span class="n">exp</span><span class="p">,</span> <span class="n">log</span>
</span><span id="Expr-3181"><a href="#Expr-3181"><span class="linenos">3181</span></a>        <span class="kn">from</span> <span class="nn">sympy.series.order</span> <span class="kn">import</span> <span class="n">Order</span>
</span><span id="Expr-3182"><a href="#Expr-3182"><span class="linenos">3182</span></a>
</span><span id="Expr-3183"><a href="#Expr-3183"><span class="linenos">3183</span></a>        <span class="k">if</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">om</span><span class="p">:</span>
</span><span id="Expr-3184"><a href="#Expr-3184"><span class="linenos">3184</span></a>            <span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">.</span><span class="n">aseries</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">bound</span><span class="p">,</span> <span class="n">hir</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</span><span id="Expr-3185"><a href="#Expr-3185"><span class="linenos">3185</span></a>            <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">getO</span><span class="p">():</span>
</span><span id="Expr-3186"><a href="#Expr-3186"><span class="linenos">3186</span></a>                <span class="k">return</span> <span class="n">s</span> <span class="o">+</span> <span class="n">Order</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">x</span><span class="o">**</span><span class="n">n</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">S</span><span class="o">.</span><span class="n">Infinity</span><span class="p">))</span>
</span><span id="Expr-3187"><a href="#Expr-3187"><span class="linenos">3187</span></a>            <span class="k">return</span> <span class="n">s</span>
</span><span id="Expr-3188"><a href="#Expr-3188"><span class="linenos">3188</span></a>
</span><span id="Expr-3189"><a href="#Expr-3189"><span class="linenos">3189</span></a>        <span class="n">k</span> <span class="o">=</span> <span class="n">Dummy</span><span class="p">(</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">positive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="Expr-3190"><a href="#Expr-3190"><span class="linenos">3190</span></a>        <span class="c1"># f is rewritten in terms of omega</span>
</span><span id="Expr-3191"><a href="#Expr-3191"><span class="linenos">3191</span></a>        <span class="n">func</span><span class="p">,</span> <span class="n">logw</span> <span class="o">=</span> <span class="n">rewrite</span><span class="p">(</span><span class="n">exps</span><span class="p">,</span> <span class="n">om</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
</span><span id="Expr-3192"><a href="#Expr-3192"><span class="linenos">3192</span></a>
</span><span id="Expr-3193"><a href="#Expr-3193"><span class="linenos">3193</span></a>        <span class="k">if</span> <span class="bp">self</span> <span class="ow">in</span> <span class="n">om</span><span class="p">:</span>
</span><span id="Expr-3194"><a href="#Expr-3194"><span class="linenos">3194</span></a>            <span class="k">if</span> <span class="n">bound</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Expr-3195"><a href="#Expr-3195"><span class="linenos">3195</span></a>                <span class="k">return</span> <span class="bp">self</span>
</span><span id="Expr-3196"><a href="#Expr-3196"><span class="linenos">3196</span></a>            <span class="n">s</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">exp</span><span class="p">)</span><span class="o">.</span><span class="n">aseries</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">bound</span><span class="o">=</span><span class="n">bound</span><span class="p">)</span>
</span><span id="Expr-3197"><a href="#Expr-3197"><span class="linenos">3197</span></a>            <span class="n">s</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">removeO</span><span class="p">()</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">s</span><span class="o">.</span><span class="n">args</span><span class="p">])</span>
</span><span id="Expr-3198"><a href="#Expr-3198"><span class="linenos">3198</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="Expr-3199"><a href="#Expr-3199"><span class="linenos">3199</span></a>                <span class="n">res</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">as_leading_term</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">x</span><span class="p">))</span>
</span><span id="Expr-3200"><a href="#Expr-3200"><span class="linenos">3200</span></a>            <span class="k">except</span> <span class="n">PoleError</span><span class="p">:</span>
</span><span id="Expr-3201"><a href="#Expr-3201"><span class="linenos">3201</span></a>                <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span>
</span><span id="Expr-3202"><a href="#Expr-3202"><span class="linenos">3202</span></a>
</span><span id="Expr-3203"><a href="#Expr-3203"><span class="linenos">3203</span></a>            <span class="n">func</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">res</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="n">k</span>
</span><span id="Expr-3204"><a href="#Expr-3204"><span class="linenos">3204</span></a>            <span class="n">logw</span> <span class="o">=</span> <span class="n">log</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">res</span><span class="p">)</span>
</span><span id="Expr-3205"><a href="#Expr-3205"><span class="linenos">3205</span></a>
</span><span id="Expr-3206"><a href="#Expr-3206"><span class="linenos">3206</span></a>        <span class="n">s</span> <span class="o">=</span> <span class="n">func</span><span class="o">.</span><span class="n">series</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
</span><span id="Expr-3207"><a href="#Expr-3207"><span class="linenos">3207</span></a>
</span><span id="Expr-3208"><a href="#Expr-3208"><span class="linenos">3208</span></a>        <span class="c1"># Hierarchical series</span>
</span><span id="Expr-3209"><a href="#Expr-3209"><span class="linenos">3209</span></a>        <span class="k">if</span> <span class="n">hir</span><span class="p">:</span>
</span><span id="Expr-3210"><a href="#Expr-3210"><span class="linenos">3210</span></a>            <span class="k">return</span> <span class="n">s</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">exp</span><span class="p">(</span><span class="n">logw</span><span class="p">))</span>
</span><span id="Expr-3211"><a href="#Expr-3211"><span class="linenos">3211</span></a>
</span><span id="Expr-3212"><a href="#Expr-3212"><span class="linenos">3212</span></a>        <span class="n">o</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">getO</span><span class="p">()</span>
</span><span id="Expr-3213"><a href="#Expr-3213"><span class="linenos">3213</span></a>        <span class="n">terms</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">Add</span><span class="o">.</span><span class="n">make_args</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">removeO</span><span class="p">()),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">as_coeff_exponent</span><span class="p">(</span><span class="n">k</span><span class="p">)[</span><span class="mi">1</span><span class="p">]))</span>
</span><span id="Expr-3214"><a href="#Expr-3214"><span class="linenos">3214</span></a>        <span class="n">s</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">Zero</span>
</span><span id="Expr-3215"><a href="#Expr-3215"><span class="linenos">3215</span></a>        <span class="n">has_ord</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="Expr-3216"><a href="#Expr-3216"><span class="linenos">3216</span></a>
</span><span id="Expr-3217"><a href="#Expr-3217"><span class="linenos">3217</span></a>        <span class="c1"># Then we recursively expand these coefficients one by one into</span>
</span><span id="Expr-3218"><a href="#Expr-3218"><span class="linenos">3218</span></a>        <span class="c1"># their asymptotic series in terms of their most rapidly varying subexpressions.</span>
</span><span id="Expr-3219"><a href="#Expr-3219"><span class="linenos">3219</span></a>        <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">terms</span><span class="p">:</span>
</span><span id="Expr-3220"><a href="#Expr-3220"><span class="linenos">3220</span></a>            <span class="n">coeff</span><span class="p">,</span> <span class="n">expo</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">as_coeff_exponent</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
</span><span id="Expr-3221"><a href="#Expr-3221"><span class="linenos">3221</span></a>            <span class="k">if</span> <span class="n">coeff</span><span class="o">.</span><span class="n">has</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
</span><span id="Expr-3222"><a href="#Expr-3222"><span class="linenos">3222</span></a>                <span class="c1"># Recursive step</span>
</span><span id="Expr-3223"><a href="#Expr-3223"><span class="linenos">3223</span></a>                <span class="n">snew</span> <span class="o">=</span> <span class="n">coeff</span><span class="o">.</span><span class="n">aseries</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">bound</span><span class="o">=</span><span class="n">bound</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span><span id="Expr-3224"><a href="#Expr-3224"><span class="linenos">3224</span></a>                <span class="k">if</span> <span class="n">has_ord</span> <span class="ow">and</span> <span class="n">snew</span><span class="o">.</span><span class="n">getO</span><span class="p">():</span>
</span><span id="Expr-3225"><a href="#Expr-3225"><span class="linenos">3225</span></a>                    <span class="k">break</span>
</span><span id="Expr-3226"><a href="#Expr-3226"><span class="linenos">3226</span></a>                <span class="k">elif</span> <span class="n">snew</span><span class="o">.</span><span class="n">getO</span><span class="p">():</span>
</span><span id="Expr-3227"><a href="#Expr-3227"><span class="linenos">3227</span></a>                    <span class="n">has_ord</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="Expr-3228"><a href="#Expr-3228"><span class="linenos">3228</span></a>                <span class="n">s</span> <span class="o">+=</span> <span class="p">(</span><span class="n">snew</span> <span class="o">*</span> <span class="n">k</span><span class="o">**</span><span class="n">expo</span><span class="p">)</span>
</span><span id="Expr-3229"><a href="#Expr-3229"><span class="linenos">3229</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Expr-3230"><a href="#Expr-3230"><span class="linenos">3230</span></a>                <span class="n">s</span> <span class="o">+=</span> <span class="n">t</span>
</span><span id="Expr-3231"><a href="#Expr-3231"><span class="linenos">3231</span></a>
</span><span id="Expr-3232"><a href="#Expr-3232"><span class="linenos">3232</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">o</span> <span class="ow">or</span> <span class="n">has_ord</span><span class="p">:</span>
</span><span id="Expr-3233"><a href="#Expr-3233"><span class="linenos">3233</span></a>            <span class="k">return</span> <span class="n">s</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">exp</span><span class="p">(</span><span class="n">logw</span><span class="p">))</span>
</span><span id="Expr-3234"><a href="#Expr-3234"><span class="linenos">3234</span></a>        <span class="k">return</span> <span class="p">(</span><span class="n">s</span> <span class="o">+</span> <span class="n">o</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">exp</span><span class="p">(</span><span class="n">logw</span><span class="p">))</span>
</span><span id="Expr-3235"><a href="#Expr-3235"><span class="linenos">3235</span></a>
</span><span id="Expr-3236"><a href="#Expr-3236"><span class="linenos">3236</span></a>
</span><span id="Expr-3237"><a href="#Expr-3237"><span class="linenos">3237</span></a>    <span class="k">def</span> <span class="nf">taylor_term</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">previous_terms</span><span class="p">):</span>
</span><span id="Expr-3238"><a href="#Expr-3238"><span class="linenos">3238</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;General method for the taylor term.</span>
</span><span id="Expr-3239"><a href="#Expr-3239"><span class="linenos">3239</span></a>
</span><span id="Expr-3240"><a href="#Expr-3240"><span class="linenos">3240</span></a><span class="sd">        This method is slow, because it differentiates n-times. Subclasses can</span>
</span><span id="Expr-3241"><a href="#Expr-3241"><span class="linenos">3241</span></a><span class="sd">        redefine it to make it faster by using the &quot;previous_terms&quot;.</span>
</span><span id="Expr-3242"><a href="#Expr-3242"><span class="linenos">3242</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Expr-3243"><a href="#Expr-3243"><span class="linenos">3243</span></a>        <span class="kn">from</span> <span class="nn">.symbol</span> <span class="kn">import</span> <span class="n">Dummy</span>
</span><span id="Expr-3244"><a href="#Expr-3244"><span class="linenos">3244</span></a>        <span class="kn">from</span> <span class="nn">sympy.functions.combinatorial.factorials</span> <span class="kn">import</span> <span class="n">factorial</span>
</span><span id="Expr-3245"><a href="#Expr-3245"><span class="linenos">3245</span></a>
</span><span id="Expr-3246"><a href="#Expr-3246"><span class="linenos">3246</span></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">sympify</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span><span id="Expr-3247"><a href="#Expr-3247"><span class="linenos">3247</span></a>        <span class="n">_x</span> <span class="o">=</span> <span class="n">Dummy</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
</span><span id="Expr-3248"><a href="#Expr-3248"><span class="linenos">3248</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">_x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">_x</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">_x</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="n">n</span> <span class="o">/</span> <span class="n">factorial</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
</span><span id="Expr-3249"><a href="#Expr-3249"><span class="linenos">3249</span></a>
</span><span id="Expr-3250"><a href="#Expr-3250"><span class="linenos">3250</span></a>    <span class="k">def</span> <span class="nf">lseries</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">dir</span><span class="o">=</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="n">logx</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cdir</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
</span><span id="Expr-3251"><a href="#Expr-3251"><span class="linenos">3251</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Expr-3252"><a href="#Expr-3252"><span class="linenos">3252</span></a><span class="sd">        Wrapper for series yielding an iterator of the terms of the series.</span>
</span><span id="Expr-3253"><a href="#Expr-3253"><span class="linenos">3253</span></a>
</span><span id="Expr-3254"><a href="#Expr-3254"><span class="linenos">3254</span></a><span class="sd">        Note: an infinite series will yield an infinite iterator. The following,</span>
</span><span id="Expr-3255"><a href="#Expr-3255"><span class="linenos">3255</span></a><span class="sd">        for exaxmple, will never terminate. It will just keep printing terms</span>
</span><span id="Expr-3256"><a href="#Expr-3256"><span class="linenos">3256</span></a><span class="sd">        of the sin(x) series::</span>
</span><span id="Expr-3257"><a href="#Expr-3257"><span class="linenos">3257</span></a>
</span><span id="Expr-3258"><a href="#Expr-3258"><span class="linenos">3258</span></a><span class="sd">          for term in sin(x).lseries(x):</span>
</span><span id="Expr-3259"><a href="#Expr-3259"><span class="linenos">3259</span></a><span class="sd">              print term</span>
</span><span id="Expr-3260"><a href="#Expr-3260"><span class="linenos">3260</span></a>
</span><span id="Expr-3261"><a href="#Expr-3261"><span class="linenos">3261</span></a><span class="sd">        The advantage of lseries() over nseries() is that many times you are</span>
</span><span id="Expr-3262"><a href="#Expr-3262"><span class="linenos">3262</span></a><span class="sd">        just interested in the next term in the series (i.e. the first term for</span>
</span><span id="Expr-3263"><a href="#Expr-3263"><span class="linenos">3263</span></a><span class="sd">        example), but you do not know how many you should ask for in nseries()</span>
</span><span id="Expr-3264"><a href="#Expr-3264"><span class="linenos">3264</span></a><span class="sd">        using the &quot;n&quot; parameter.</span>
</span><span id="Expr-3265"><a href="#Expr-3265"><span class="linenos">3265</span></a>
</span><span id="Expr-3266"><a href="#Expr-3266"><span class="linenos">3266</span></a><span class="sd">        See also nseries().</span>
</span><span id="Expr-3267"><a href="#Expr-3267"><span class="linenos">3267</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Expr-3268"><a href="#Expr-3268"><span class="linenos">3268</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">series</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">dir</span><span class="o">=</span><span class="nb">dir</span><span class="p">,</span> <span class="n">logx</span><span class="o">=</span><span class="n">logx</span><span class="p">,</span> <span class="n">cdir</span><span class="o">=</span><span class="n">cdir</span><span class="p">)</span>
</span><span id="Expr-3269"><a href="#Expr-3269"><span class="linenos">3269</span></a>
</span><span id="Expr-3270"><a href="#Expr-3270"><span class="linenos">3270</span></a>    <span class="k">def</span> <span class="nf">_eval_lseries</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">logx</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cdir</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
</span><span id="Expr-3271"><a href="#Expr-3271"><span class="linenos">3271</span></a>        <span class="c1"># default implementation of lseries is using nseries(), and adaptively</span>
</span><span id="Expr-3272"><a href="#Expr-3272"><span class="linenos">3272</span></a>        <span class="c1"># increasing the &quot;n&quot;. As you can see, it is not very efficient, because</span>
</span><span id="Expr-3273"><a href="#Expr-3273"><span class="linenos">3273</span></a>        <span class="c1"># we are calculating the series over and over again. Subclasses should</span>
</span><span id="Expr-3274"><a href="#Expr-3274"><span class="linenos">3274</span></a>        <span class="c1"># override this method and implement much more efficient yielding of</span>
</span><span id="Expr-3275"><a href="#Expr-3275"><span class="linenos">3275</span></a>        <span class="c1"># terms.</span>
</span><span id="Expr-3276"><a href="#Expr-3276"><span class="linenos">3276</span></a>        <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Expr-3277"><a href="#Expr-3277"><span class="linenos">3277</span></a>        <span class="n">series</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_eval_nseries</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">logx</span><span class="o">=</span><span class="n">logx</span><span class="p">,</span> <span class="n">cdir</span><span class="o">=</span><span class="n">cdir</span><span class="p">)</span>
</span><span id="Expr-3278"><a href="#Expr-3278"><span class="linenos">3278</span></a>
</span><span id="Expr-3279"><a href="#Expr-3279"><span class="linenos">3279</span></a>        <span class="k">while</span> <span class="n">series</span><span class="o">.</span><span class="n">is_Order</span><span class="p">:</span>
</span><span id="Expr-3280"><a href="#Expr-3280"><span class="linenos">3280</span></a>            <span class="n">n</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="Expr-3281"><a href="#Expr-3281"><span class="linenos">3281</span></a>            <span class="n">series</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_eval_nseries</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">logx</span><span class="o">=</span><span class="n">logx</span><span class="p">,</span> <span class="n">cdir</span><span class="o">=</span><span class="n">cdir</span><span class="p">)</span>
</span><span id="Expr-3282"><a href="#Expr-3282"><span class="linenos">3282</span></a>
</span><span id="Expr-3283"><a href="#Expr-3283"><span class="linenos">3283</span></a>        <span class="n">e</span> <span class="o">=</span> <span class="n">series</span><span class="o">.</span><span class="n">removeO</span><span class="p">()</span>
</span><span id="Expr-3284"><a href="#Expr-3284"><span class="linenos">3284</span></a>        <span class="k">yield</span> <span class="n">e</span>
</span><span id="Expr-3285"><a href="#Expr-3285"><span class="linenos">3285</span></a>        <span class="k">if</span> <span class="n">e</span> <span class="ow">is</span> <span class="n">S</span><span class="o">.</span><span class="n">Zero</span><span class="p">:</span>
</span><span id="Expr-3286"><a href="#Expr-3286"><span class="linenos">3286</span></a>            <span class="k">return</span>
</span><span id="Expr-3287"><a href="#Expr-3287"><span class="linenos">3287</span></a>
</span><span id="Expr-3288"><a href="#Expr-3288"><span class="linenos">3288</span></a>        <span class="k">while</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Expr-3289"><a href="#Expr-3289"><span class="linenos">3289</span></a>            <span class="k">while</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Expr-3290"><a href="#Expr-3290"><span class="linenos">3290</span></a>                <span class="n">n</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="Expr-3291"><a href="#Expr-3291"><span class="linenos">3291</span></a>                <span class="n">series</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_eval_nseries</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">logx</span><span class="o">=</span><span class="n">logx</span><span class="p">,</span> <span class="n">cdir</span><span class="o">=</span><span class="n">cdir</span><span class="p">)</span><span class="o">.</span><span class="n">removeO</span><span class="p">()</span>
</span><span id="Expr-3292"><a href="#Expr-3292"><span class="linenos">3292</span></a>                <span class="k">if</span> <span class="n">e</span> <span class="o">!=</span> <span class="n">series</span><span class="p">:</span>
</span><span id="Expr-3293"><a href="#Expr-3293"><span class="linenos">3293</span></a>                    <span class="k">break</span>
</span><span id="Expr-3294"><a href="#Expr-3294"><span class="linenos">3294</span></a>                <span class="k">if</span> <span class="p">(</span><span class="n">series</span> <span class="o">-</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">cancel</span><span class="p">()</span> <span class="ow">is</span> <span class="n">S</span><span class="o">.</span><span class="n">Zero</span><span class="p">:</span>
</span><span id="Expr-3295"><a href="#Expr-3295"><span class="linenos">3295</span></a>                    <span class="k">return</span>
</span><span id="Expr-3296"><a href="#Expr-3296"><span class="linenos">3296</span></a>            <span class="k">yield</span> <span class="n">series</span> <span class="o">-</span> <span class="n">e</span>
</span><span id="Expr-3297"><a href="#Expr-3297"><span class="linenos">3297</span></a>            <span class="n">e</span> <span class="o">=</span> <span class="n">series</span>
</span><span id="Expr-3298"><a href="#Expr-3298"><span class="linenos">3298</span></a>
</span><span id="Expr-3299"><a href="#Expr-3299"><span class="linenos">3299</span></a>    <span class="k">def</span> <span class="nf">nseries</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="nb">dir</span><span class="o">=</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="n">logx</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cdir</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
</span><span id="Expr-3300"><a href="#Expr-3300"><span class="linenos">3300</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Expr-3301"><a href="#Expr-3301"><span class="linenos">3301</span></a><span class="sd">        Wrapper to _eval_nseries if assumptions allow, else to series.</span>
</span><span id="Expr-3302"><a href="#Expr-3302"><span class="linenos">3302</span></a>
</span><span id="Expr-3303"><a href="#Expr-3303"><span class="linenos">3303</span></a><span class="sd">        If x is given, x0 is 0, dir=&#39;+&#39;, and self has x, then _eval_nseries is</span>
</span><span id="Expr-3304"><a href="#Expr-3304"><span class="linenos">3304</span></a><span class="sd">        called. This calculates &quot;n&quot; terms in the innermost expressions and</span>
</span><span id="Expr-3305"><a href="#Expr-3305"><span class="linenos">3305</span></a><span class="sd">        then builds up the final series just by &quot;cross-multiplying&quot; everything</span>
</span><span id="Expr-3306"><a href="#Expr-3306"><span class="linenos">3306</span></a><span class="sd">        out.</span>
</span><span id="Expr-3307"><a href="#Expr-3307"><span class="linenos">3307</span></a>
</span><span id="Expr-3308"><a href="#Expr-3308"><span class="linenos">3308</span></a><span class="sd">        The optional ``logx`` parameter can be used to replace any log(x) in the</span>
</span><span id="Expr-3309"><a href="#Expr-3309"><span class="linenos">3309</span></a><span class="sd">        returned series with a symbolic value to avoid evaluating log(x) at 0. A</span>
</span><span id="Expr-3310"><a href="#Expr-3310"><span class="linenos">3310</span></a><span class="sd">        symbol to use in place of log(x) should be provided.</span>
</span><span id="Expr-3311"><a href="#Expr-3311"><span class="linenos">3311</span></a>
</span><span id="Expr-3312"><a href="#Expr-3312"><span class="linenos">3312</span></a><span class="sd">        Advantage -- it&#39;s fast, because we do not have to determine how many</span>
</span><span id="Expr-3313"><a href="#Expr-3313"><span class="linenos">3313</span></a><span class="sd">        terms we need to calculate in advance.</span>
</span><span id="Expr-3314"><a href="#Expr-3314"><span class="linenos">3314</span></a>
</span><span id="Expr-3315"><a href="#Expr-3315"><span class="linenos">3315</span></a><span class="sd">        Disadvantage -- you may end up with less terms than you may have</span>
</span><span id="Expr-3316"><a href="#Expr-3316"><span class="linenos">3316</span></a><span class="sd">        expected, but the O(x**n) term appended will always be correct and</span>
</span><span id="Expr-3317"><a href="#Expr-3317"><span class="linenos">3317</span></a><span class="sd">        so the result, though perhaps shorter, will also be correct.</span>
</span><span id="Expr-3318"><a href="#Expr-3318"><span class="linenos">3318</span></a>
</span><span id="Expr-3319"><a href="#Expr-3319"><span class="linenos">3319</span></a><span class="sd">        If any of those assumptions is not met, this is treated like a</span>
</span><span id="Expr-3320"><a href="#Expr-3320"><span class="linenos">3320</span></a><span class="sd">        wrapper to series which will try harder to return the correct</span>
</span><span id="Expr-3321"><a href="#Expr-3321"><span class="linenos">3321</span></a><span class="sd">        number of terms.</span>
</span><span id="Expr-3322"><a href="#Expr-3322"><span class="linenos">3322</span></a>
</span><span id="Expr-3323"><a href="#Expr-3323"><span class="linenos">3323</span></a><span class="sd">        See also lseries().</span>
</span><span id="Expr-3324"><a href="#Expr-3324"><span class="linenos">3324</span></a>
</span><span id="Expr-3325"><a href="#Expr-3325"><span class="linenos">3325</span></a><span class="sd">        Examples</span>
</span><span id="Expr-3326"><a href="#Expr-3326"><span class="linenos">3326</span></a><span class="sd">        ========</span>
</span><span id="Expr-3327"><a href="#Expr-3327"><span class="linenos">3327</span></a>
</span><span id="Expr-3328"><a href="#Expr-3328"><span class="linenos">3328</span></a><span class="sd">        &gt;&gt;&gt; from sympy import sin, log, Symbol</span>
</span><span id="Expr-3329"><a href="#Expr-3329"><span class="linenos">3329</span></a><span class="sd">        &gt;&gt;&gt; from sympy.abc import x, y</span>
</span><span id="Expr-3330"><a href="#Expr-3330"><span class="linenos">3330</span></a><span class="sd">        &gt;&gt;&gt; sin(x).nseries(x, 0, 6)</span>
</span><span id="Expr-3331"><a href="#Expr-3331"><span class="linenos">3331</span></a><span class="sd">        x - x**3/6 + x**5/120 + O(x**6)</span>
</span><span id="Expr-3332"><a href="#Expr-3332"><span class="linenos">3332</span></a><span class="sd">        &gt;&gt;&gt; log(x+1).nseries(x, 0, 5)</span>
</span><span id="Expr-3333"><a href="#Expr-3333"><span class="linenos">3333</span></a><span class="sd">        x - x**2/2 + x**3/3 - x**4/4 + O(x**5)</span>
</span><span id="Expr-3334"><a href="#Expr-3334"><span class="linenos">3334</span></a>
</span><span id="Expr-3335"><a href="#Expr-3335"><span class="linenos">3335</span></a><span class="sd">        Handling of the ``logx`` parameter --- in the following example the</span>
</span><span id="Expr-3336"><a href="#Expr-3336"><span class="linenos">3336</span></a><span class="sd">        expansion fails since ``sin`` does not have an asymptotic expansion</span>
</span><span id="Expr-3337"><a href="#Expr-3337"><span class="linenos">3337</span></a><span class="sd">        at -oo (the limit of log(x) as x approaches 0):</span>
</span><span id="Expr-3338"><a href="#Expr-3338"><span class="linenos">3338</span></a>
</span><span id="Expr-3339"><a href="#Expr-3339"><span class="linenos">3339</span></a><span class="sd">        &gt;&gt;&gt; e = sin(log(x))</span>
</span><span id="Expr-3340"><a href="#Expr-3340"><span class="linenos">3340</span></a><span class="sd">        &gt;&gt;&gt; e.nseries(x, 0, 6)</span>
</span><span id="Expr-3341"><a href="#Expr-3341"><span class="linenos">3341</span></a><span class="sd">        Traceback (most recent call last):</span>
</span><span id="Expr-3342"><a href="#Expr-3342"><span class="linenos">3342</span></a><span class="sd">        ...</span>
</span><span id="Expr-3343"><a href="#Expr-3343"><span class="linenos">3343</span></a><span class="sd">        PoleError: ...</span>
</span><span id="Expr-3344"><a href="#Expr-3344"><span class="linenos">3344</span></a><span class="sd">        ...</span>
</span><span id="Expr-3345"><a href="#Expr-3345"><span class="linenos">3345</span></a><span class="sd">        &gt;&gt;&gt; logx = Symbol(&#39;logx&#39;)</span>
</span><span id="Expr-3346"><a href="#Expr-3346"><span class="linenos">3346</span></a><span class="sd">        &gt;&gt;&gt; e.nseries(x, 0, 6, logx=logx)</span>
</span><span id="Expr-3347"><a href="#Expr-3347"><span class="linenos">3347</span></a><span class="sd">        sin(logx)</span>
</span><span id="Expr-3348"><a href="#Expr-3348"><span class="linenos">3348</span></a>
</span><span id="Expr-3349"><a href="#Expr-3349"><span class="linenos">3349</span></a><span class="sd">        In the following example, the expansion works but gives only an Order term</span>
</span><span id="Expr-3350"><a href="#Expr-3350"><span class="linenos">3350</span></a><span class="sd">        unless the ``logx`` parameter is used:</span>
</span><span id="Expr-3351"><a href="#Expr-3351"><span class="linenos">3351</span></a>
</span><span id="Expr-3352"><a href="#Expr-3352"><span class="linenos">3352</span></a><span class="sd">        &gt;&gt;&gt; e = x**y</span>
</span><span id="Expr-3353"><a href="#Expr-3353"><span class="linenos">3353</span></a><span class="sd">        &gt;&gt;&gt; e.nseries(x, 0, 2)</span>
</span><span id="Expr-3354"><a href="#Expr-3354"><span class="linenos">3354</span></a><span class="sd">        O(log(x)**2)</span>
</span><span id="Expr-3355"><a href="#Expr-3355"><span class="linenos">3355</span></a><span class="sd">        &gt;&gt;&gt; e.nseries(x, 0, 2, logx=logx)</span>
</span><span id="Expr-3356"><a href="#Expr-3356"><span class="linenos">3356</span></a><span class="sd">        exp(logx*y)</span>
</span><span id="Expr-3357"><a href="#Expr-3357"><span class="linenos">3357</span></a>
</span><span id="Expr-3358"><a href="#Expr-3358"><span class="linenos">3358</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Expr-3359"><a href="#Expr-3359"><span class="linenos">3359</span></a>        <span class="k">if</span> <span class="n">x</span> <span class="ow">and</span> <span class="n">x</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">free_symbols</span><span class="p">:</span>
</span><span id="Expr-3360"><a href="#Expr-3360"><span class="linenos">3360</span></a>            <span class="k">return</span> <span class="bp">self</span>
</span><span id="Expr-3361"><a href="#Expr-3361"><span class="linenos">3361</span></a>        <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">x0</span> <span class="ow">or</span> <span class="nb">dir</span> <span class="o">!=</span> <span class="s1">&#39;+&#39;</span><span class="p">:</span>  <span class="c1"># {see XPOS above} or (x.is_positive == x.is_negative == None):</span>
</span><span id="Expr-3362"><a href="#Expr-3362"><span class="linenos">3362</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">series</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="nb">dir</span><span class="p">,</span> <span class="n">cdir</span><span class="o">=</span><span class="n">cdir</span><span class="p">)</span>
</span><span id="Expr-3363"><a href="#Expr-3363"><span class="linenos">3363</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Expr-3364"><a href="#Expr-3364"><span class="linenos">3364</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_eval_nseries</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">logx</span><span class="o">=</span><span class="n">logx</span><span class="p">,</span> <span class="n">cdir</span><span class="o">=</span><span class="n">cdir</span><span class="p">)</span>
</span><span id="Expr-3365"><a href="#Expr-3365"><span class="linenos">3365</span></a>
</span><span id="Expr-3366"><a href="#Expr-3366"><span class="linenos">3366</span></a>    <span class="k">def</span> <span class="nf">_eval_nseries</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">logx</span><span class="p">,</span> <span class="n">cdir</span><span class="p">):</span>
</span><span id="Expr-3367"><a href="#Expr-3367"><span class="linenos">3367</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Expr-3368"><a href="#Expr-3368"><span class="linenos">3368</span></a><span class="sd">        Return terms of series for self up to O(x**n) at x=0</span>
</span><span id="Expr-3369"><a href="#Expr-3369"><span class="linenos">3369</span></a><span class="sd">        from the positive direction.</span>
</span><span id="Expr-3370"><a href="#Expr-3370"><span class="linenos">3370</span></a>
</span><span id="Expr-3371"><a href="#Expr-3371"><span class="linenos">3371</span></a><span class="sd">        This is a method that should be overridden in subclasses. Users should</span>
</span><span id="Expr-3372"><a href="#Expr-3372"><span class="linenos">3372</span></a><span class="sd">        never call this method directly (use .nseries() instead), so you do not</span>
</span><span id="Expr-3373"><a href="#Expr-3373"><span class="linenos">3373</span></a><span class="sd">        have to write docstrings for _eval_nseries().</span>
</span><span id="Expr-3374"><a href="#Expr-3374"><span class="linenos">3374</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Expr-3375"><a href="#Expr-3375"><span class="linenos">3375</span></a>        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="n">filldedent</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
</span><span id="Expr-3376"><a href="#Expr-3376"><span class="linenos">3376</span></a><span class="s2">                     The _eval_nseries method should be added to</span>
</span><span id="Expr-3377"><a href="#Expr-3377"><span class="linenos">3377</span></a><span class="s2">                     </span><span class="si">%s</span><span class="s2"> to give terms up to O(x**n) at x=0</span>
</span><span id="Expr-3378"><a href="#Expr-3378"><span class="linenos">3378</span></a><span class="s2">                     from the positive direction so it is available when</span>
</span><span id="Expr-3379"><a href="#Expr-3379"><span class="linenos">3379</span></a><span class="s2">                     nseries calls it.&quot;&quot;&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">func</span><span class="p">)</span>
</span><span id="Expr-3380"><a href="#Expr-3380"><span class="linenos">3380</span></a>                     <span class="p">)</span>
</span><span id="Expr-3381"><a href="#Expr-3381"><span class="linenos">3381</span></a>
</span><span id="Expr-3382"><a href="#Expr-3382"><span class="linenos">3382</span></a>    <span class="k">def</span> <span class="nf">limit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">xlim</span><span class="p">,</span> <span class="nb">dir</span><span class="o">=</span><span class="s1">&#39;+&#39;</span><span class="p">):</span>
</span><span id="Expr-3383"><a href="#Expr-3383"><span class="linenos">3383</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; Compute limit x-&gt;xlim.</span>
</span><span id="Expr-3384"><a href="#Expr-3384"><span class="linenos">3384</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Expr-3385"><a href="#Expr-3385"><span class="linenos">3385</span></a>        <span class="kn">from</span> <span class="nn">sympy.series.limits</span> <span class="kn">import</span> <span class="n">limit</span>
</span><span id="Expr-3386"><a href="#Expr-3386"><span class="linenos">3386</span></a>        <span class="k">return</span> <span class="n">limit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">xlim</span><span class="p">,</span> <span class="nb">dir</span><span class="p">)</span>
</span><span id="Expr-3387"><a href="#Expr-3387"><span class="linenos">3387</span></a>
</span><span id="Expr-3388"><a href="#Expr-3388"><span class="linenos">3388</span></a>    <span class="k">def</span> <span class="nf">compute_leading_term</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">logx</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="Expr-3389"><a href="#Expr-3389"><span class="linenos">3389</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Expr-3390"><a href="#Expr-3390"><span class="linenos">3390</span></a><span class="sd">        as_leading_term is only allowed for results of .series()</span>
</span><span id="Expr-3391"><a href="#Expr-3391"><span class="linenos">3391</span></a><span class="sd">        This is a wrapper to compute a series first.</span>
</span><span id="Expr-3392"><a href="#Expr-3392"><span class="linenos">3392</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Expr-3393"><a href="#Expr-3393"><span class="linenos">3393</span></a>
</span><span id="Expr-3394"><a href="#Expr-3394"><span class="linenos">3394</span></a>        <span class="kn">from</span> <span class="nn">sympy.functions.elementary.piecewise</span> <span class="kn">import</span> <span class="n">Piecewise</span><span class="p">,</span> <span class="n">piecewise_fold</span>
</span><span id="Expr-3395"><a href="#Expr-3395"><span class="linenos">3395</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">has</span><span class="p">(</span><span class="n">Piecewise</span><span class="p">):</span>
</span><span id="Expr-3396"><a href="#Expr-3396"><span class="linenos">3396</span></a>            <span class="n">expr</span> <span class="o">=</span> <span class="n">piecewise_fold</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="Expr-3397"><a href="#Expr-3397"><span class="linenos">3397</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Expr-3398"><a href="#Expr-3398"><span class="linenos">3398</span></a>            <span class="n">expr</span> <span class="o">=</span> <span class="bp">self</span>
</span><span id="Expr-3399"><a href="#Expr-3399"><span class="linenos">3399</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">removeO</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Expr-3400"><a href="#Expr-3400"><span class="linenos">3400</span></a>            <span class="k">return</span> <span class="bp">self</span>
</span><span id="Expr-3401"><a href="#Expr-3401"><span class="linenos">3401</span></a>
</span><span id="Expr-3402"><a href="#Expr-3402"><span class="linenos">3402</span></a>        <span class="kn">from</span> <span class="nn">sympy.series.gruntz</span> <span class="kn">import</span> <span class="n">calculate_series</span>
</span><span id="Expr-3403"><a href="#Expr-3403"><span class="linenos">3403</span></a>
</span><span id="Expr-3404"><a href="#Expr-3404"><span class="linenos">3404</span></a>        <span class="k">if</span> <span class="n">logx</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Expr-3405"><a href="#Expr-3405"><span class="linenos">3405</span></a>            <span class="kn">from</span> <span class="nn">.symbol</span> <span class="kn">import</span> <span class="n">Dummy</span>
</span><span id="Expr-3406"><a href="#Expr-3406"><span class="linenos">3406</span></a>            <span class="kn">from</span> <span class="nn">sympy.functions.elementary.exponential</span> <span class="kn">import</span> <span class="n">log</span>
</span><span id="Expr-3407"><a href="#Expr-3407"><span class="linenos">3407</span></a>            <span class="n">d</span> <span class="o">=</span> <span class="n">Dummy</span><span class="p">(</span><span class="s1">&#39;logx&#39;</span><span class="p">)</span>
</span><span id="Expr-3408"><a href="#Expr-3408"><span class="linenos">3408</span></a>            <span class="n">s</span> <span class="o">=</span> <span class="n">calculate_series</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</span><span id="Expr-3409"><a href="#Expr-3409"><span class="linenos">3409</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Expr-3410"><a href="#Expr-3410"><span class="linenos">3410</span></a>            <span class="n">s</span> <span class="o">=</span> <span class="n">calculate_series</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">logx</span><span class="p">)</span>
</span><span id="Expr-3411"><a href="#Expr-3411"><span class="linenos">3411</span></a>
</span><span id="Expr-3412"><a href="#Expr-3412"><span class="linenos">3412</span></a>        <span class="k">return</span> <span class="n">s</span><span class="o">.</span><span class="n">as_leading_term</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span><span id="Expr-3413"><a href="#Expr-3413"><span class="linenos">3413</span></a>
</span><span id="Expr-3414"><a href="#Expr-3414"><span class="linenos">3414</span></a>    <span class="nd">@cacheit</span>
</span><span id="Expr-3415"><a href="#Expr-3415"><span class="linenos">3415</span></a>    <span class="k">def</span> <span class="nf">as_leading_term</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">symbols</span><span class="p">,</span> <span class="n">logx</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cdir</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
</span><span id="Expr-3416"><a href="#Expr-3416"><span class="linenos">3416</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Expr-3417"><a href="#Expr-3417"><span class="linenos">3417</span></a><span class="sd">        Returns the leading (nonzero) term of the series expansion of self.</span>
</span><span id="Expr-3418"><a href="#Expr-3418"><span class="linenos">3418</span></a>
</span><span id="Expr-3419"><a href="#Expr-3419"><span class="linenos">3419</span></a><span class="sd">        The _eval_as_leading_term routines are used to do this, and they must</span>
</span><span id="Expr-3420"><a href="#Expr-3420"><span class="linenos">3420</span></a><span class="sd">        always return a non-zero value.</span>
</span><span id="Expr-3421"><a href="#Expr-3421"><span class="linenos">3421</span></a>
</span><span id="Expr-3422"><a href="#Expr-3422"><span class="linenos">3422</span></a><span class="sd">        Examples</span>
</span><span id="Expr-3423"><a href="#Expr-3423"><span class="linenos">3423</span></a><span class="sd">        ========</span>
</span><span id="Expr-3424"><a href="#Expr-3424"><span class="linenos">3424</span></a>
</span><span id="Expr-3425"><a href="#Expr-3425"><span class="linenos">3425</span></a><span class="sd">        &gt;&gt;&gt; from sympy.abc import x</span>
</span><span id="Expr-3426"><a href="#Expr-3426"><span class="linenos">3426</span></a><span class="sd">        &gt;&gt;&gt; (1 + x + x**2).as_leading_term(x)</span>
</span><span id="Expr-3427"><a href="#Expr-3427"><span class="linenos">3427</span></a><span class="sd">        1</span>
</span><span id="Expr-3428"><a href="#Expr-3428"><span class="linenos">3428</span></a><span class="sd">        &gt;&gt;&gt; (1/x**2 + x + x**2).as_leading_term(x)</span>
</span><span id="Expr-3429"><a href="#Expr-3429"><span class="linenos">3429</span></a><span class="sd">        x**(-2)</span>
</span><span id="Expr-3430"><a href="#Expr-3430"><span class="linenos">3430</span></a>
</span><span id="Expr-3431"><a href="#Expr-3431"><span class="linenos">3431</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Expr-3432"><a href="#Expr-3432"><span class="linenos">3432</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">symbols</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Expr-3433"><a href="#Expr-3433"><span class="linenos">3433</span></a>            <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span>
</span><span id="Expr-3434"><a href="#Expr-3434"><span class="linenos">3434</span></a>            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">symbols</span><span class="p">:</span>
</span><span id="Expr-3435"><a href="#Expr-3435"><span class="linenos">3435</span></a>                <span class="n">c</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">as_leading_term</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">logx</span><span class="o">=</span><span class="n">logx</span><span class="p">,</span> <span class="n">cdir</span><span class="o">=</span><span class="n">cdir</span><span class="p">)</span>
</span><span id="Expr-3436"><a href="#Expr-3436"><span class="linenos">3436</span></a>            <span class="k">return</span> <span class="n">c</span>
</span><span id="Expr-3437"><a href="#Expr-3437"><span class="linenos">3437</span></a>        <span class="k">elif</span> <span class="ow">not</span> <span class="n">symbols</span><span class="p">:</span>
</span><span id="Expr-3438"><a href="#Expr-3438"><span class="linenos">3438</span></a>            <span class="k">return</span> <span class="bp">self</span>
</span><span id="Expr-3439"><a href="#Expr-3439"><span class="linenos">3439</span></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">sympify</span><span class="p">(</span><span class="n">symbols</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="Expr-3440"><a href="#Expr-3440"><span class="linenos">3440</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">x</span><span class="o">.</span><span class="n">is_symbol</span><span class="p">:</span>
</span><span id="Expr-3441"><a href="#Expr-3441"><span class="linenos">3441</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;expecting a Symbol but got </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">x</span><span class="p">)</span>
</span><span id="Expr-3442"><a href="#Expr-3442"><span class="linenos">3442</span></a>        <span class="k">if</span> <span class="n">x</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">free_symbols</span><span class="p">:</span>
</span><span id="Expr-3443"><a href="#Expr-3443"><span class="linenos">3443</span></a>            <span class="k">return</span> <span class="bp">self</span>
</span><span id="Expr-3444"><a href="#Expr-3444"><span class="linenos">3444</span></a>        <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_eval_as_leading_term</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">logx</span><span class="o">=</span><span class="n">logx</span><span class="p">,</span> <span class="n">cdir</span><span class="o">=</span><span class="n">cdir</span><span class="p">)</span>
</span><span id="Expr-3445"><a href="#Expr-3445"><span class="linenos">3445</span></a>        <span class="k">if</span> <span class="n">obj</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Expr-3446"><a href="#Expr-3446"><span class="linenos">3446</span></a>            <span class="kn">from</span> <span class="nn">sympy.simplify.powsimp</span> <span class="kn">import</span> <span class="n">powsimp</span>
</span><span id="Expr-3447"><a href="#Expr-3447"><span class="linenos">3447</span></a>            <span class="k">return</span> <span class="n">powsimp</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">combine</span><span class="o">=</span><span class="s1">&#39;exp&#39;</span><span class="p">)</span>
</span><span id="Expr-3448"><a href="#Expr-3448"><span class="linenos">3448</span></a>        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;as_leading_term(</span><span class="si">%s</span><span class="s1">, </span><span class="si">%s</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">))</span>
</span><span id="Expr-3449"><a href="#Expr-3449"><span class="linenos">3449</span></a>
</span><span id="Expr-3450"><a href="#Expr-3450"><span class="linenos">3450</span></a>    <span class="k">def</span> <span class="nf">_eval_as_leading_term</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">logx</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cdir</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
</span><span id="Expr-3451"><a href="#Expr-3451"><span class="linenos">3451</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span><span id="Expr-3452"><a href="#Expr-3452"><span class="linenos">3452</span></a>
</span><span id="Expr-3453"><a href="#Expr-3453"><span class="linenos">3453</span></a>    <span class="k">def</span> <span class="nf">as_coeff_exponent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
</span><span id="Expr-3454"><a href="#Expr-3454"><span class="linenos">3454</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; ``c*x**e -&gt; c,e`` where x can be any symbolic expression.</span>
</span><span id="Expr-3455"><a href="#Expr-3455"><span class="linenos">3455</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Expr-3456"><a href="#Expr-3456"><span class="linenos">3456</span></a>        <span class="kn">from</span> <span class="nn">sympy.simplify.radsimp</span> <span class="kn">import</span> <span class="n">collect</span>
</span><span id="Expr-3457"><a href="#Expr-3457"><span class="linenos">3457</span></a>        <span class="n">s</span> <span class="o">=</span> <span class="n">collect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</span><span id="Expr-3458"><a href="#Expr-3458"><span class="linenos">3458</span></a>        <span class="n">c</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">as_coeff_mul</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span><span id="Expr-3459"><a href="#Expr-3459"><span class="linenos">3459</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Expr-3460"><a href="#Expr-3460"><span class="linenos">3460</span></a>            <span class="n">b</span><span class="p">,</span> <span class="n">e</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">as_base_exp</span><span class="p">()</span>
</span><span id="Expr-3461"><a href="#Expr-3461"><span class="linenos">3461</span></a>            <span class="k">if</span> <span class="n">b</span> <span class="o">==</span> <span class="n">x</span><span class="p">:</span>
</span><span id="Expr-3462"><a href="#Expr-3462"><span class="linenos">3462</span></a>                <span class="k">return</span> <span class="n">c</span><span class="p">,</span> <span class="n">e</span>
</span><span id="Expr-3463"><a href="#Expr-3463"><span class="linenos">3463</span></a>        <span class="k">return</span> <span class="n">s</span><span class="p">,</span> <span class="n">S</span><span class="o">.</span><span class="n">Zero</span>
</span><span id="Expr-3464"><a href="#Expr-3464"><span class="linenos">3464</span></a>
</span><span id="Expr-3465"><a href="#Expr-3465"><span class="linenos">3465</span></a>    <span class="k">def</span> <span class="nf">leadterm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">logx</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cdir</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
</span><span id="Expr-3466"><a href="#Expr-3466"><span class="linenos">3466</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Expr-3467"><a href="#Expr-3467"><span class="linenos">3467</span></a><span class="sd">        Returns the leading term a*x**b as a tuple (a, b).</span>
</span><span id="Expr-3468"><a href="#Expr-3468"><span class="linenos">3468</span></a>
</span><span id="Expr-3469"><a href="#Expr-3469"><span class="linenos">3469</span></a><span class="sd">        Examples</span>
</span><span id="Expr-3470"><a href="#Expr-3470"><span class="linenos">3470</span></a><span class="sd">        ========</span>
</span><span id="Expr-3471"><a href="#Expr-3471"><span class="linenos">3471</span></a>
</span><span id="Expr-3472"><a href="#Expr-3472"><span class="linenos">3472</span></a><span class="sd">        &gt;&gt;&gt; from sympy.abc import x</span>
</span><span id="Expr-3473"><a href="#Expr-3473"><span class="linenos">3473</span></a><span class="sd">        &gt;&gt;&gt; (1+x+x**2).leadterm(x)</span>
</span><span id="Expr-3474"><a href="#Expr-3474"><span class="linenos">3474</span></a><span class="sd">        (1, 0)</span>
</span><span id="Expr-3475"><a href="#Expr-3475"><span class="linenos">3475</span></a><span class="sd">        &gt;&gt;&gt; (1/x**2+x+x**2).leadterm(x)</span>
</span><span id="Expr-3476"><a href="#Expr-3476"><span class="linenos">3476</span></a><span class="sd">        (1, -2)</span>
</span><span id="Expr-3477"><a href="#Expr-3477"><span class="linenos">3477</span></a>
</span><span id="Expr-3478"><a href="#Expr-3478"><span class="linenos">3478</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Expr-3479"><a href="#Expr-3479"><span class="linenos">3479</span></a>        <span class="kn">from</span> <span class="nn">.symbol</span> <span class="kn">import</span> <span class="n">Dummy</span>
</span><span id="Expr-3480"><a href="#Expr-3480"><span class="linenos">3480</span></a>        <span class="kn">from</span> <span class="nn">sympy.functions.elementary.exponential</span> <span class="kn">import</span> <span class="n">log</span>
</span><span id="Expr-3481"><a href="#Expr-3481"><span class="linenos">3481</span></a>        <span class="n">l</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">as_leading_term</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">logx</span><span class="o">=</span><span class="n">logx</span><span class="p">,</span> <span class="n">cdir</span><span class="o">=</span><span class="n">cdir</span><span class="p">)</span>
</span><span id="Expr-3482"><a href="#Expr-3482"><span class="linenos">3482</span></a>        <span class="n">d</span> <span class="o">=</span> <span class="n">Dummy</span><span class="p">(</span><span class="s1">&#39;logx&#39;</span><span class="p">)</span>
</span><span id="Expr-3483"><a href="#Expr-3483"><span class="linenos">3483</span></a>        <span class="k">if</span> <span class="n">l</span><span class="o">.</span><span class="n">has</span><span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)):</span>
</span><span id="Expr-3484"><a href="#Expr-3484"><span class="linenos">3484</span></a>            <span class="n">l</span> <span class="o">=</span> <span class="n">l</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">d</span><span class="p">)</span>
</span><span id="Expr-3485"><a href="#Expr-3485"><span class="linenos">3485</span></a>        <span class="n">c</span><span class="p">,</span> <span class="n">e</span> <span class="o">=</span> <span class="n">l</span><span class="o">.</span><span class="n">as_coeff_exponent</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span><span id="Expr-3486"><a href="#Expr-3486"><span class="linenos">3486</span></a>        <span class="k">if</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">c</span><span class="o">.</span><span class="n">free_symbols</span><span class="p">:</span>
</span><span id="Expr-3487"><a href="#Expr-3487"><span class="linenos">3487</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">filldedent</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
</span><span id="Expr-3488"><a href="#Expr-3488"><span class="linenos">3488</span></a><span class="s2">                cannot compute leadterm(</span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">). The coefficient</span>
</span><span id="Expr-3489"><a href="#Expr-3489"><span class="linenos">3489</span></a><span class="s2">                should have been free of </span><span class="si">%s</span><span class="s2"> but got </span><span class="si">%s</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="p">)))</span>
</span><span id="Expr-3490"><a href="#Expr-3490"><span class="linenos">3490</span></a>        <span class="n">c</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</span><span id="Expr-3491"><a href="#Expr-3491"><span class="linenos">3491</span></a>        <span class="k">return</span> <span class="n">c</span><span class="p">,</span> <span class="n">e</span>
</span><span id="Expr-3492"><a href="#Expr-3492"><span class="linenos">3492</span></a>
</span><span id="Expr-3493"><a href="#Expr-3493"><span class="linenos">3493</span></a>    <span class="k">def</span> <span class="nf">as_coeff_Mul</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rational</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="Expr-3494"><a href="#Expr-3494"><span class="linenos">3494</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Efficiently extract the coefficient of a product. &quot;&quot;&quot;</span>
</span><span id="Expr-3495"><a href="#Expr-3495"><span class="linenos">3495</span></a>        <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">One</span><span class="p">,</span> <span class="bp">self</span>
</span><span id="Expr-3496"><a href="#Expr-3496"><span class="linenos">3496</span></a>
</span><span id="Expr-3497"><a href="#Expr-3497"><span class="linenos">3497</span></a>    <span class="k">def</span> <span class="nf">as_coeff_Add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rational</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="Expr-3498"><a href="#Expr-3498"><span class="linenos">3498</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Efficiently extract the coefficient of a summation. &quot;&quot;&quot;</span>
</span><span id="Expr-3499"><a href="#Expr-3499"><span class="linenos">3499</span></a>        <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">Zero</span><span class="p">,</span> <span class="bp">self</span>
</span><span id="Expr-3500"><a href="#Expr-3500"><span class="linenos">3500</span></a>
</span><span id="Expr-3501"><a href="#Expr-3501"><span class="linenos">3501</span></a>    <span class="k">def</span> <span class="nf">fps</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">dir</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">hyper</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">rational</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="Expr-3502"><a href="#Expr-3502"><span class="linenos">3502</span></a>            <span class="n">full</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="Expr-3503"><a href="#Expr-3503"><span class="linenos">3503</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Expr-3504"><a href="#Expr-3504"><span class="linenos">3504</span></a><span class="sd">        Compute formal power power series of self.</span>
</span><span id="Expr-3505"><a href="#Expr-3505"><span class="linenos">3505</span></a>
</span><span id="Expr-3506"><a href="#Expr-3506"><span class="linenos">3506</span></a><span class="sd">        See the docstring of the :func:`fps` function in sympy.series.formal for</span>
</span><span id="Expr-3507"><a href="#Expr-3507"><span class="linenos">3507</span></a><span class="sd">        more information.</span>
</span><span id="Expr-3508"><a href="#Expr-3508"><span class="linenos">3508</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Expr-3509"><a href="#Expr-3509"><span class="linenos">3509</span></a>        <span class="kn">from</span> <span class="nn">sympy.series.formal</span> <span class="kn">import</span> <span class="n">fps</span>
</span><span id="Expr-3510"><a href="#Expr-3510"><span class="linenos">3510</span></a>
</span><span id="Expr-3511"><a href="#Expr-3511"><span class="linenos">3511</span></a>        <span class="k">return</span> <span class="n">fps</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="nb">dir</span><span class="p">,</span> <span class="n">hyper</span><span class="p">,</span> <span class="n">order</span><span class="p">,</span> <span class="n">rational</span><span class="p">,</span> <span class="n">full</span><span class="p">)</span>
</span><span id="Expr-3512"><a href="#Expr-3512"><span class="linenos">3512</span></a>
</span><span id="Expr-3513"><a href="#Expr-3513"><span class="linenos">3513</span></a>    <span class="k">def</span> <span class="nf">fourier_series</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">limits</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="Expr-3514"><a href="#Expr-3514"><span class="linenos">3514</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute fourier sine/cosine series of self.</span>
</span><span id="Expr-3515"><a href="#Expr-3515"><span class="linenos">3515</span></a>
</span><span id="Expr-3516"><a href="#Expr-3516"><span class="linenos">3516</span></a><span class="sd">        See the docstring of the :func:`fourier_series` in sympy.series.fourier</span>
</span><span id="Expr-3517"><a href="#Expr-3517"><span class="linenos">3517</span></a><span class="sd">        for more information.</span>
</span><span id="Expr-3518"><a href="#Expr-3518"><span class="linenos">3518</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Expr-3519"><a href="#Expr-3519"><span class="linenos">3519</span></a>        <span class="kn">from</span> <span class="nn">sympy.series.fourier</span> <span class="kn">import</span> <span class="n">fourier_series</span>
</span><span id="Expr-3520"><a href="#Expr-3520"><span class="linenos">3520</span></a>
</span><span id="Expr-3521"><a href="#Expr-3521"><span class="linenos">3521</span></a>        <span class="k">return</span> <span class="n">fourier_series</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">limits</span><span class="p">)</span>
</span><span id="Expr-3522"><a href="#Expr-3522"><span class="linenos">3522</span></a>
</span><span id="Expr-3523"><a href="#Expr-3523"><span class="linenos">3523</span></a>    <span class="c1">###################################################################################</span>
</span><span id="Expr-3524"><a href="#Expr-3524"><span class="linenos">3524</span></a>    <span class="c1">##################### DERIVATIVE, INTEGRAL, FUNCTIONAL METHODS ####################</span>
</span><span id="Expr-3525"><a href="#Expr-3525"><span class="linenos">3525</span></a>    <span class="c1">###################################################################################</span>
</span><span id="Expr-3526"><a href="#Expr-3526"><span class="linenos">3526</span></a>
</span><span id="Expr-3527"><a href="#Expr-3527"><span class="linenos">3527</span></a>    <span class="k">def</span> <span class="nf">diff</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">symbols</span><span class="p">,</span> <span class="o">**</span><span class="n">assumptions</span><span class="p">):</span>
</span><span id="Expr-3528"><a href="#Expr-3528"><span class="linenos">3528</span></a>        <span class="n">assumptions</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s2">&quot;evaluate&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
</span><span id="Expr-3529"><a href="#Expr-3529"><span class="linenos">3529</span></a>        <span class="k">return</span> <span class="n">_derivative_dispatch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">symbols</span><span class="p">,</span> <span class="o">**</span><span class="n">assumptions</span><span class="p">)</span>
</span><span id="Expr-3530"><a href="#Expr-3530"><span class="linenos">3530</span></a>
</span><span id="Expr-3531"><a href="#Expr-3531"><span class="linenos">3531</span></a>    <span class="c1">###########################################################################</span>
</span><span id="Expr-3532"><a href="#Expr-3532"><span class="linenos">3532</span></a>    <span class="c1">###################### EXPRESSION EXPANSION METHODS #######################</span>
</span><span id="Expr-3533"><a href="#Expr-3533"><span class="linenos">3533</span></a>    <span class="c1">###########################################################################</span>
</span><span id="Expr-3534"><a href="#Expr-3534"><span class="linenos">3534</span></a>
</span><span id="Expr-3535"><a href="#Expr-3535"><span class="linenos">3535</span></a>    <span class="c1"># Relevant subclasses should override _eval_expand_hint() methods.  See</span>
</span><span id="Expr-3536"><a href="#Expr-3536"><span class="linenos">3536</span></a>    <span class="c1"># the docstring of expand() for more info.</span>
</span><span id="Expr-3537"><a href="#Expr-3537"><span class="linenos">3537</span></a>
</span><span id="Expr-3538"><a href="#Expr-3538"><span class="linenos">3538</span></a>    <span class="k">def</span> <span class="nf">_eval_expand_complex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">hints</span><span class="p">):</span>
</span><span id="Expr-3539"><a href="#Expr-3539"><span class="linenos">3539</span></a>        <span class="n">real</span><span class="p">,</span> <span class="n">imag</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">as_real_imag</span><span class="p">(</span><span class="o">**</span><span class="n">hints</span><span class="p">)</span>
</span><span id="Expr-3540"><a href="#Expr-3540"><span class="linenos">3540</span></a>        <span class="k">return</span> <span class="n">real</span> <span class="o">+</span> <span class="n">S</span><span class="o">.</span><span class="n">ImaginaryUnit</span><span class="o">*</span><span class="n">imag</span>
</span><span id="Expr-3541"><a href="#Expr-3541"><span class="linenos">3541</span></a>
</span><span id="Expr-3542"><a href="#Expr-3542"><span class="linenos">3542</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Expr-3543"><a href="#Expr-3543"><span class="linenos">3543</span></a>    <span class="k">def</span> <span class="nf">_expand_hint</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">hint</span><span class="p">,</span> <span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">hints</span><span class="p">):</span>
</span><span id="Expr-3544"><a href="#Expr-3544"><span class="linenos">3544</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Expr-3545"><a href="#Expr-3545"><span class="linenos">3545</span></a><span class="sd">        Helper for ``expand()``.  Recursively calls ``expr._eval_expand_hint()``.</span>
</span><span id="Expr-3546"><a href="#Expr-3546"><span class="linenos">3546</span></a>
</span><span id="Expr-3547"><a href="#Expr-3547"><span class="linenos">3547</span></a><span class="sd">        Returns ``(expr, hit)``, where expr is the (possibly) expanded</span>
</span><span id="Expr-3548"><a href="#Expr-3548"><span class="linenos">3548</span></a><span class="sd">        ``expr`` and ``hit`` is ``True`` if ``expr`` was truly expanded and</span>
</span><span id="Expr-3549"><a href="#Expr-3549"><span class="linenos">3549</span></a><span class="sd">        ``False`` otherwise.</span>
</span><span id="Expr-3550"><a href="#Expr-3550"><span class="linenos">3550</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Expr-3551"><a href="#Expr-3551"><span class="linenos">3551</span></a>        <span class="n">hit</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="Expr-3552"><a href="#Expr-3552"><span class="linenos">3552</span></a>        <span class="c1"># XXX: Hack to support non-Basic args</span>
</span><span id="Expr-3553"><a href="#Expr-3553"><span class="linenos">3553</span></a>        <span class="c1">#              |</span>
</span><span id="Expr-3554"><a href="#Expr-3554"><span class="linenos">3554</span></a>        <span class="c1">#              V</span>
</span><span id="Expr-3555"><a href="#Expr-3555"><span class="linenos">3555</span></a>        <span class="k">if</span> <span class="n">deep</span> <span class="ow">and</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="s1">&#39;args&#39;</span><span class="p">,</span> <span class="p">())</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">expr</span><span class="o">.</span><span class="n">is_Atom</span><span class="p">:</span>
</span><span id="Expr-3556"><a href="#Expr-3556"><span class="linenos">3556</span></a>            <span class="n">sargs</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Expr-3557"><a href="#Expr-3557"><span class="linenos">3557</span></a>            <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">expr</span><span class="o">.</span><span class="n">args</span><span class="p">:</span>
</span><span id="Expr-3558"><a href="#Expr-3558"><span class="linenos">3558</span></a>                <span class="n">arg</span><span class="p">,</span> <span class="n">arghit</span> <span class="o">=</span> <span class="n">Expr</span><span class="o">.</span><span class="n">_expand_hint</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="n">hint</span><span class="p">,</span> <span class="o">**</span><span class="n">hints</span><span class="p">)</span>
</span><span id="Expr-3559"><a href="#Expr-3559"><span class="linenos">3559</span></a>                <span class="n">hit</span> <span class="o">|=</span> <span class="n">arghit</span>
</span><span id="Expr-3560"><a href="#Expr-3560"><span class="linenos">3560</span></a>                <span class="n">sargs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>
</span><span id="Expr-3561"><a href="#Expr-3561"><span class="linenos">3561</span></a>
</span><span id="Expr-3562"><a href="#Expr-3562"><span class="linenos">3562</span></a>            <span class="k">if</span> <span class="n">hit</span><span class="p">:</span>
</span><span id="Expr-3563"><a href="#Expr-3563"><span class="linenos">3563</span></a>                <span class="n">expr</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">sargs</span><span class="p">)</span>
</span><span id="Expr-3564"><a href="#Expr-3564"><span class="linenos">3564</span></a>
</span><span id="Expr-3565"><a href="#Expr-3565"><span class="linenos">3565</span></a>        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">hint</span><span class="p">):</span>
</span><span id="Expr-3566"><a href="#Expr-3566"><span class="linenos">3566</span></a>            <span class="n">newexpr</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">hint</span><span class="p">)(</span><span class="o">**</span><span class="n">hints</span><span class="p">)</span>
</span><span id="Expr-3567"><a href="#Expr-3567"><span class="linenos">3567</span></a>            <span class="k">if</span> <span class="n">newexpr</span> <span class="o">!=</span> <span class="n">expr</span><span class="p">:</span>
</span><span id="Expr-3568"><a href="#Expr-3568"><span class="linenos">3568</span></a>                <span class="k">return</span> <span class="p">(</span><span class="n">newexpr</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
</span><span id="Expr-3569"><a href="#Expr-3569"><span class="linenos">3569</span></a>
</span><span id="Expr-3570"><a href="#Expr-3570"><span class="linenos">3570</span></a>        <span class="k">return</span> <span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">hit</span><span class="p">)</span>
</span><span id="Expr-3571"><a href="#Expr-3571"><span class="linenos">3571</span></a>
</span><span id="Expr-3572"><a href="#Expr-3572"><span class="linenos">3572</span></a>    <span class="nd">@cacheit</span>
</span><span id="Expr-3573"><a href="#Expr-3573"><span class="linenos">3573</span></a>    <span class="k">def</span> <span class="nf">expand</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">modulus</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">power_base</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">power_exp</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="Expr-3574"><a href="#Expr-3574"><span class="linenos">3574</span></a>            <span class="n">mul</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">multinomial</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">basic</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">hints</span><span class="p">):</span>
</span><span id="Expr-3575"><a href="#Expr-3575"><span class="linenos">3575</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Expr-3576"><a href="#Expr-3576"><span class="linenos">3576</span></a><span class="sd">        Expand an expression using hints.</span>
</span><span id="Expr-3577"><a href="#Expr-3577"><span class="linenos">3577</span></a>
</span><span id="Expr-3578"><a href="#Expr-3578"><span class="linenos">3578</span></a><span class="sd">        See the docstring of the expand() function in sympy.core.function for</span>
</span><span id="Expr-3579"><a href="#Expr-3579"><span class="linenos">3579</span></a><span class="sd">        more information.</span>
</span><span id="Expr-3580"><a href="#Expr-3580"><span class="linenos">3580</span></a>
</span><span id="Expr-3581"><a href="#Expr-3581"><span class="linenos">3581</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Expr-3582"><a href="#Expr-3582"><span class="linenos">3582</span></a>        <span class="kn">from</span> <span class="nn">sympy.simplify.radsimp</span> <span class="kn">import</span> <span class="n">fraction</span>
</span><span id="Expr-3583"><a href="#Expr-3583"><span class="linenos">3583</span></a>
</span><span id="Expr-3584"><a href="#Expr-3584"><span class="linenos">3584</span></a>        <span class="n">hints</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">power_base</span><span class="o">=</span><span class="n">power_base</span><span class="p">,</span> <span class="n">power_exp</span><span class="o">=</span><span class="n">power_exp</span><span class="p">,</span> <span class="n">mul</span><span class="o">=</span><span class="n">mul</span><span class="p">,</span>
</span><span id="Expr-3585"><a href="#Expr-3585"><span class="linenos">3585</span></a>           <span class="n">log</span><span class="o">=</span><span class="n">log</span><span class="p">,</span> <span class="n">multinomial</span><span class="o">=</span><span class="n">multinomial</span><span class="p">,</span> <span class="n">basic</span><span class="o">=</span><span class="n">basic</span><span class="p">)</span>
</span><span id="Expr-3586"><a href="#Expr-3586"><span class="linenos">3586</span></a>
</span><span id="Expr-3587"><a href="#Expr-3587"><span class="linenos">3587</span></a>        <span class="n">expr</span> <span class="o">=</span> <span class="bp">self</span>
</span><span id="Expr-3588"><a href="#Expr-3588"><span class="linenos">3588</span></a>        <span class="k">if</span> <span class="n">hints</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;frac&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
</span><span id="Expr-3589"><a href="#Expr-3589"><span class="linenos">3589</span></a>            <span class="n">n</span><span class="p">,</span> <span class="n">d</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="n">deep</span><span class="p">,</span> <span class="n">modulus</span><span class="o">=</span><span class="n">modulus</span><span class="p">,</span> <span class="o">**</span><span class="n">hints</span><span class="p">)</span>
</span><span id="Expr-3590"><a href="#Expr-3590"><span class="linenos">3590</span></a>                    <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">fraction</span><span class="p">(</span><span class="bp">self</span><span class="p">)]</span>
</span><span id="Expr-3591"><a href="#Expr-3591"><span class="linenos">3591</span></a>            <span class="k">return</span> <span class="n">n</span><span class="o">/</span><span class="n">d</span>
</span><span id="Expr-3592"><a href="#Expr-3592"><span class="linenos">3592</span></a>        <span class="k">elif</span> <span class="n">hints</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;denom&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
</span><span id="Expr-3593"><a href="#Expr-3593"><span class="linenos">3593</span></a>            <span class="n">n</span><span class="p">,</span> <span class="n">d</span> <span class="o">=</span> <span class="n">fraction</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="Expr-3594"><a href="#Expr-3594"><span class="linenos">3594</span></a>            <span class="k">return</span> <span class="n">n</span><span class="o">/</span><span class="n">d</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="n">deep</span><span class="p">,</span> <span class="n">modulus</span><span class="o">=</span><span class="n">modulus</span><span class="p">,</span> <span class="o">**</span><span class="n">hints</span><span class="p">)</span>
</span><span id="Expr-3595"><a href="#Expr-3595"><span class="linenos">3595</span></a>        <span class="k">elif</span> <span class="n">hints</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;numer&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
</span><span id="Expr-3596"><a href="#Expr-3596"><span class="linenos">3596</span></a>            <span class="n">n</span><span class="p">,</span> <span class="n">d</span> <span class="o">=</span> <span class="n">fraction</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="Expr-3597"><a href="#Expr-3597"><span class="linenos">3597</span></a>            <span class="k">return</span> <span class="n">n</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="n">deep</span><span class="p">,</span> <span class="n">modulus</span><span class="o">=</span><span class="n">modulus</span><span class="p">,</span> <span class="o">**</span><span class="n">hints</span><span class="p">)</span><span class="o">/</span><span class="n">d</span>
</span><span id="Expr-3598"><a href="#Expr-3598"><span class="linenos">3598</span></a>
</span><span id="Expr-3599"><a href="#Expr-3599"><span class="linenos">3599</span></a>        <span class="c1"># Although the hints are sorted here, an earlier hint may get applied</span>
</span><span id="Expr-3600"><a href="#Expr-3600"><span class="linenos">3600</span></a>        <span class="c1"># at a given node in the expression tree before another because of how</span>
</span><span id="Expr-3601"><a href="#Expr-3601"><span class="linenos">3601</span></a>        <span class="c1"># the hints are applied.  e.g. expand(log(x*(y + z))) -&gt; log(x*y +</span>
</span><span id="Expr-3602"><a href="#Expr-3602"><span class="linenos">3602</span></a>        <span class="c1"># x*z) because while applying log at the top level, log and mul are</span>
</span><span id="Expr-3603"><a href="#Expr-3603"><span class="linenos">3603</span></a>        <span class="c1"># applied at the deeper level in the tree so that when the log at the</span>
</span><span id="Expr-3604"><a href="#Expr-3604"><span class="linenos">3604</span></a>        <span class="c1"># upper level gets applied, the mul has already been applied at the</span>
</span><span id="Expr-3605"><a href="#Expr-3605"><span class="linenos">3605</span></a>        <span class="c1"># lower level.</span>
</span><span id="Expr-3606"><a href="#Expr-3606"><span class="linenos">3606</span></a>
</span><span id="Expr-3607"><a href="#Expr-3607"><span class="linenos">3607</span></a>        <span class="c1"># Additionally, because hints are only applied once, the expression</span>
</span><span id="Expr-3608"><a href="#Expr-3608"><span class="linenos">3608</span></a>        <span class="c1"># may not be expanded all the way.   For example, if mul is applied</span>
</span><span id="Expr-3609"><a href="#Expr-3609"><span class="linenos">3609</span></a>        <span class="c1"># before multinomial, x*(x + 1)**2 won&#39;t be expanded all the way.  For</span>
</span><span id="Expr-3610"><a href="#Expr-3610"><span class="linenos">3610</span></a>        <span class="c1"># now, we just use a special case to make multinomial run before mul,</span>
</span><span id="Expr-3611"><a href="#Expr-3611"><span class="linenos">3611</span></a>        <span class="c1"># so that at least polynomials will be expanded all the way.  In the</span>
</span><span id="Expr-3612"><a href="#Expr-3612"><span class="linenos">3612</span></a>        <span class="c1"># future, smarter heuristics should be applied.</span>
</span><span id="Expr-3613"><a href="#Expr-3613"><span class="linenos">3613</span></a>        <span class="c1"># TODO: Smarter heuristics</span>
</span><span id="Expr-3614"><a href="#Expr-3614"><span class="linenos">3614</span></a>
</span><span id="Expr-3615"><a href="#Expr-3615"><span class="linenos">3615</span></a>        <span class="k">def</span> <span class="nf">_expand_hint_key</span><span class="p">(</span><span class="n">hint</span><span class="p">):</span>
</span><span id="Expr-3616"><a href="#Expr-3616"><span class="linenos">3616</span></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;Make multinomial come before mul&quot;&quot;&quot;</span>
</span><span id="Expr-3617"><a href="#Expr-3617"><span class="linenos">3617</span></a>            <span class="k">if</span> <span class="n">hint</span> <span class="o">==</span> <span class="s1">&#39;mul&#39;</span><span class="p">:</span>
</span><span id="Expr-3618"><a href="#Expr-3618"><span class="linenos">3618</span></a>                <span class="k">return</span> <span class="s1">&#39;mulz&#39;</span>
</span><span id="Expr-3619"><a href="#Expr-3619"><span class="linenos">3619</span></a>            <span class="k">return</span> <span class="n">hint</span>
</span><span id="Expr-3620"><a href="#Expr-3620"><span class="linenos">3620</span></a>
</span><span id="Expr-3621"><a href="#Expr-3621"><span class="linenos">3621</span></a>        <span class="k">for</span> <span class="n">hint</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">hints</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="n">key</span><span class="o">=</span><span class="n">_expand_hint_key</span><span class="p">):</span>
</span><span id="Expr-3622"><a href="#Expr-3622"><span class="linenos">3622</span></a>            <span class="n">use_hint</span> <span class="o">=</span> <span class="n">hints</span><span class="p">[</span><span class="n">hint</span><span class="p">]</span>
</span><span id="Expr-3623"><a href="#Expr-3623"><span class="linenos">3623</span></a>            <span class="k">if</span> <span class="n">use_hint</span><span class="p">:</span>
</span><span id="Expr-3624"><a href="#Expr-3624"><span class="linenos">3624</span></a>                <span class="n">hint</span> <span class="o">=</span> <span class="s1">&#39;_eval_expand_&#39;</span> <span class="o">+</span> <span class="n">hint</span>
</span><span id="Expr-3625"><a href="#Expr-3625"><span class="linenos">3625</span></a>                <span class="n">expr</span><span class="p">,</span> <span class="n">hit</span> <span class="o">=</span> <span class="n">Expr</span><span class="o">.</span><span class="n">_expand_hint</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">hint</span><span class="p">,</span> <span class="n">deep</span><span class="o">=</span><span class="n">deep</span><span class="p">,</span> <span class="o">**</span><span class="n">hints</span><span class="p">)</span>
</span><span id="Expr-3626"><a href="#Expr-3626"><span class="linenos">3626</span></a>
</span><span id="Expr-3627"><a href="#Expr-3627"><span class="linenos">3627</span></a>        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="Expr-3628"><a href="#Expr-3628"><span class="linenos">3628</span></a>            <span class="n">was</span> <span class="o">=</span> <span class="n">expr</span>
</span><span id="Expr-3629"><a href="#Expr-3629"><span class="linenos">3629</span></a>            <span class="k">if</span> <span class="n">hints</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;multinomial&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
</span><span id="Expr-3630"><a href="#Expr-3630"><span class="linenos">3630</span></a>                <span class="n">expr</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">Expr</span><span class="o">.</span><span class="n">_expand_hint</span><span class="p">(</span>
</span><span id="Expr-3631"><a href="#Expr-3631"><span class="linenos">3631</span></a>                    <span class="n">expr</span><span class="p">,</span> <span class="s1">&#39;_eval_expand_multinomial&#39;</span><span class="p">,</span> <span class="n">deep</span><span class="o">=</span><span class="n">deep</span><span class="p">,</span> <span class="o">**</span><span class="n">hints</span><span class="p">)</span>
</span><span id="Expr-3632"><a href="#Expr-3632"><span class="linenos">3632</span></a>            <span class="k">if</span> <span class="n">hints</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;mul&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
</span><span id="Expr-3633"><a href="#Expr-3633"><span class="linenos">3633</span></a>                <span class="n">expr</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">Expr</span><span class="o">.</span><span class="n">_expand_hint</span><span class="p">(</span>
</span><span id="Expr-3634"><a href="#Expr-3634"><span class="linenos">3634</span></a>                    <span class="n">expr</span><span class="p">,</span> <span class="s1">&#39;_eval_expand_mul&#39;</span><span class="p">,</span> <span class="n">deep</span><span class="o">=</span><span class="n">deep</span><span class="p">,</span> <span class="o">**</span><span class="n">hints</span><span class="p">)</span>
</span><span id="Expr-3635"><a href="#Expr-3635"><span class="linenos">3635</span></a>            <span class="k">if</span> <span class="n">hints</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
</span><span id="Expr-3636"><a href="#Expr-3636"><span class="linenos">3636</span></a>                <span class="n">expr</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">Expr</span><span class="o">.</span><span class="n">_expand_hint</span><span class="p">(</span>
</span><span id="Expr-3637"><a href="#Expr-3637"><span class="linenos">3637</span></a>                    <span class="n">expr</span><span class="p">,</span> <span class="s1">&#39;_eval_expand_log&#39;</span><span class="p">,</span> <span class="n">deep</span><span class="o">=</span><span class="n">deep</span><span class="p">,</span> <span class="o">**</span><span class="n">hints</span><span class="p">)</span>
</span><span id="Expr-3638"><a href="#Expr-3638"><span class="linenos">3638</span></a>            <span class="k">if</span> <span class="n">expr</span> <span class="o">==</span> <span class="n">was</span><span class="p">:</span>
</span><span id="Expr-3639"><a href="#Expr-3639"><span class="linenos">3639</span></a>                <span class="k">break</span>
</span><span id="Expr-3640"><a href="#Expr-3640"><span class="linenos">3640</span></a>
</span><span id="Expr-3641"><a href="#Expr-3641"><span class="linenos">3641</span></a>        <span class="k">if</span> <span class="n">modulus</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Expr-3642"><a href="#Expr-3642"><span class="linenos">3642</span></a>            <span class="n">modulus</span> <span class="o">=</span> <span class="n">sympify</span><span class="p">(</span><span class="n">modulus</span><span class="p">)</span>
</span><span id="Expr-3643"><a href="#Expr-3643"><span class="linenos">3643</span></a>
</span><span id="Expr-3644"><a href="#Expr-3644"><span class="linenos">3644</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">modulus</span><span class="o">.</span><span class="n">is_Integer</span> <span class="ow">or</span> <span class="n">modulus</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Expr-3645"><a href="#Expr-3645"><span class="linenos">3645</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="Expr-3646"><a href="#Expr-3646"><span class="linenos">3646</span></a>                    <span class="s2">&quot;modulus must be a positive integer, got </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">modulus</span><span class="p">)</span>
</span><span id="Expr-3647"><a href="#Expr-3647"><span class="linenos">3647</span></a>
</span><span id="Expr-3648"><a href="#Expr-3648"><span class="linenos">3648</span></a>            <span class="n">terms</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Expr-3649"><a href="#Expr-3649"><span class="linenos">3649</span></a>
</span><span id="Expr-3650"><a href="#Expr-3650"><span class="linenos">3650</span></a>            <span class="k">for</span> <span class="n">term</span> <span class="ow">in</span> <span class="n">Add</span><span class="o">.</span><span class="n">make_args</span><span class="p">(</span><span class="n">expr</span><span class="p">):</span>
</span><span id="Expr-3651"><a href="#Expr-3651"><span class="linenos">3651</span></a>                <span class="n">coeff</span><span class="p">,</span> <span class="n">tail</span> <span class="o">=</span> <span class="n">term</span><span class="o">.</span><span class="n">as_coeff_Mul</span><span class="p">(</span><span class="n">rational</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="Expr-3652"><a href="#Expr-3652"><span class="linenos">3652</span></a>
</span><span id="Expr-3653"><a href="#Expr-3653"><span class="linenos">3653</span></a>                <span class="n">coeff</span> <span class="o">%=</span> <span class="n">modulus</span>
</span><span id="Expr-3654"><a href="#Expr-3654"><span class="linenos">3654</span></a>
</span><span id="Expr-3655"><a href="#Expr-3655"><span class="linenos">3655</span></a>                <span class="k">if</span> <span class="n">coeff</span><span class="p">:</span>
</span><span id="Expr-3656"><a href="#Expr-3656"><span class="linenos">3656</span></a>                    <span class="n">terms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">coeff</span><span class="o">*</span><span class="n">tail</span><span class="p">)</span>
</span><span id="Expr-3657"><a href="#Expr-3657"><span class="linenos">3657</span></a>
</span><span id="Expr-3658"><a href="#Expr-3658"><span class="linenos">3658</span></a>            <span class="n">expr</span> <span class="o">=</span> <span class="n">Add</span><span class="p">(</span><span class="o">*</span><span class="n">terms</span><span class="p">)</span>
</span><span id="Expr-3659"><a href="#Expr-3659"><span class="linenos">3659</span></a>
</span><span id="Expr-3660"><a href="#Expr-3660"><span class="linenos">3660</span></a>        <span class="k">return</span> <span class="n">expr</span>
</span><span id="Expr-3661"><a href="#Expr-3661"><span class="linenos">3661</span></a>
</span><span id="Expr-3662"><a href="#Expr-3662"><span class="linenos">3662</span></a>    <span class="c1">###########################################################################</span>
</span><span id="Expr-3663"><a href="#Expr-3663"><span class="linenos">3663</span></a>    <span class="c1">################### GLOBAL ACTION VERB WRAPPER METHODS ####################</span>
</span><span id="Expr-3664"><a href="#Expr-3664"><span class="linenos">3664</span></a>    <span class="c1">###########################################################################</span>
</span><span id="Expr-3665"><a href="#Expr-3665"><span class="linenos">3665</span></a>
</span><span id="Expr-3666"><a href="#Expr-3666"><span class="linenos">3666</span></a>    <span class="k">def</span> <span class="nf">integrate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Expr-3667"><a href="#Expr-3667"><span class="linenos">3667</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;See the integrate function in sympy.integrals&quot;&quot;&quot;</span>
</span><span id="Expr-3668"><a href="#Expr-3668"><span class="linenos">3668</span></a>        <span class="kn">from</span> <span class="nn">sympy.integrals.integrals</span> <span class="kn">import</span> <span class="n">integrate</span>
</span><span id="Expr-3669"><a href="#Expr-3669"><span class="linenos">3669</span></a>        <span class="k">return</span> <span class="n">integrate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Expr-3670"><a href="#Expr-3670"><span class="linenos">3670</span></a>
</span><span id="Expr-3671"><a href="#Expr-3671"><span class="linenos">3671</span></a>    <span class="k">def</span> <span class="nf">nsimplify</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">constants</span><span class="o">=</span><span class="p">(),</span> <span class="n">tolerance</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">full</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="Expr-3672"><a href="#Expr-3672"><span class="linenos">3672</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;See the nsimplify function in sympy.simplify&quot;&quot;&quot;</span>
</span><span id="Expr-3673"><a href="#Expr-3673"><span class="linenos">3673</span></a>        <span class="kn">from</span> <span class="nn">sympy.simplify.simplify</span> <span class="kn">import</span> <span class="n">nsimplify</span>
</span><span id="Expr-3674"><a href="#Expr-3674"><span class="linenos">3674</span></a>        <span class="k">return</span> <span class="n">nsimplify</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">constants</span><span class="p">,</span> <span class="n">tolerance</span><span class="p">,</span> <span class="n">full</span><span class="p">)</span>
</span><span id="Expr-3675"><a href="#Expr-3675"><span class="linenos">3675</span></a>
</span><span id="Expr-3676"><a href="#Expr-3676"><span class="linenos">3676</span></a>    <span class="k">def</span> <span class="nf">separate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">deep</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="Expr-3677"><a href="#Expr-3677"><span class="linenos">3677</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;See the separate function in sympy.simplify&quot;&quot;&quot;</span>
</span><span id="Expr-3678"><a href="#Expr-3678"><span class="linenos">3678</span></a>        <span class="kn">from</span> <span class="nn">.function</span> <span class="kn">import</span> <span class="n">expand_power_base</span>
</span><span id="Expr-3679"><a href="#Expr-3679"><span class="linenos">3679</span></a>        <span class="k">return</span> <span class="n">expand_power_base</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">deep</span><span class="o">=</span><span class="n">deep</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="n">force</span><span class="p">)</span>
</span><span id="Expr-3680"><a href="#Expr-3680"><span class="linenos">3680</span></a>
</span><span id="Expr-3681"><a href="#Expr-3681"><span class="linenos">3681</span></a>    <span class="k">def</span> <span class="nf">collect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">syms</span><span class="p">,</span> <span class="n">func</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">evaluate</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exact</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">distribute_order_term</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="Expr-3682"><a href="#Expr-3682"><span class="linenos">3682</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;See the collect function in sympy.simplify&quot;&quot;&quot;</span>
</span><span id="Expr-3683"><a href="#Expr-3683"><span class="linenos">3683</span></a>        <span class="kn">from</span> <span class="nn">sympy.simplify.radsimp</span> <span class="kn">import</span> <span class="n">collect</span>
</span><span id="Expr-3684"><a href="#Expr-3684"><span class="linenos">3684</span></a>        <span class="k">return</span> <span class="n">collect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">syms</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="n">evaluate</span><span class="p">,</span> <span class="n">exact</span><span class="p">,</span> <span class="n">distribute_order_term</span><span class="p">)</span>
</span><span id="Expr-3685"><a href="#Expr-3685"><span class="linenos">3685</span></a>
</span><span id="Expr-3686"><a href="#Expr-3686"><span class="linenos">3686</span></a>    <span class="k">def</span> <span class="nf">together</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Expr-3687"><a href="#Expr-3687"><span class="linenos">3687</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;See the together function in sympy.polys&quot;&quot;&quot;</span>
</span><span id="Expr-3688"><a href="#Expr-3688"><span class="linenos">3688</span></a>        <span class="kn">from</span> <span class="nn">sympy.polys.rationaltools</span> <span class="kn">import</span> <span class="n">together</span>
</span><span id="Expr-3689"><a href="#Expr-3689"><span class="linenos">3689</span></a>        <span class="k">return</span> <span class="n">together</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Expr-3690"><a href="#Expr-3690"><span class="linenos">3690</span></a>
</span><span id="Expr-3691"><a href="#Expr-3691"><span class="linenos">3691</span></a>    <span class="k">def</span> <span class="nf">apart</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">):</span>
</span><span id="Expr-3692"><a href="#Expr-3692"><span class="linenos">3692</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;See the apart function in sympy.polys&quot;&quot;&quot;</span>
</span><span id="Expr-3693"><a href="#Expr-3693"><span class="linenos">3693</span></a>        <span class="kn">from</span> <span class="nn">sympy.polys.partfrac</span> <span class="kn">import</span> <span class="n">apart</span>
</span><span id="Expr-3694"><a href="#Expr-3694"><span class="linenos">3694</span></a>        <span class="k">return</span> <span class="n">apart</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">)</span>
</span><span id="Expr-3695"><a href="#Expr-3695"><span class="linenos">3695</span></a>
</span><span id="Expr-3696"><a href="#Expr-3696"><span class="linenos">3696</span></a>    <span class="k">def</span> <span class="nf">ratsimp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Expr-3697"><a href="#Expr-3697"><span class="linenos">3697</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;See the ratsimp function in sympy.simplify&quot;&quot;&quot;</span>
</span><span id="Expr-3698"><a href="#Expr-3698"><span class="linenos">3698</span></a>        <span class="kn">from</span> <span class="nn">sympy.simplify.ratsimp</span> <span class="kn">import</span> <span class="n">ratsimp</span>
</span><span id="Expr-3699"><a href="#Expr-3699"><span class="linenos">3699</span></a>        <span class="k">return</span> <span class="n">ratsimp</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="Expr-3700"><a href="#Expr-3700"><span class="linenos">3700</span></a>
</span><span id="Expr-3701"><a href="#Expr-3701"><span class="linenos">3701</span></a>    <span class="k">def</span> <span class="nf">trigsimp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">):</span>
</span><span id="Expr-3702"><a href="#Expr-3702"><span class="linenos">3702</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;See the trigsimp function in sympy.simplify&quot;&quot;&quot;</span>
</span><span id="Expr-3703"><a href="#Expr-3703"><span class="linenos">3703</span></a>        <span class="kn">from</span> <span class="nn">sympy.simplify.trigsimp</span> <span class="kn">import</span> <span class="n">trigsimp</span>
</span><span id="Expr-3704"><a href="#Expr-3704"><span class="linenos">3704</span></a>        <span class="k">return</span> <span class="n">trigsimp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">)</span>
</span><span id="Expr-3705"><a href="#Expr-3705"><span class="linenos">3705</span></a>
</span><span id="Expr-3706"><a href="#Expr-3706"><span class="linenos">3706</span></a>    <span class="k">def</span> <span class="nf">radsimp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Expr-3707"><a href="#Expr-3707"><span class="linenos">3707</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;See the radsimp function in sympy.simplify&quot;&quot;&quot;</span>
</span><span id="Expr-3708"><a href="#Expr-3708"><span class="linenos">3708</span></a>        <span class="kn">from</span> <span class="nn">sympy.simplify.radsimp</span> <span class="kn">import</span> <span class="n">radsimp</span>
</span><span id="Expr-3709"><a href="#Expr-3709"><span class="linenos">3709</span></a>        <span class="k">return</span> <span class="n">radsimp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Expr-3710"><a href="#Expr-3710"><span class="linenos">3710</span></a>
</span><span id="Expr-3711"><a href="#Expr-3711"><span class="linenos">3711</span></a>    <span class="k">def</span> <span class="nf">powsimp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Expr-3712"><a href="#Expr-3712"><span class="linenos">3712</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;See the powsimp function in sympy.simplify&quot;&quot;&quot;</span>
</span><span id="Expr-3713"><a href="#Expr-3713"><span class="linenos">3713</span></a>        <span class="kn">from</span> <span class="nn">sympy.simplify.powsimp</span> <span class="kn">import</span> <span class="n">powsimp</span>
</span><span id="Expr-3714"><a href="#Expr-3714"><span class="linenos">3714</span></a>        <span class="k">return</span> <span class="n">powsimp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Expr-3715"><a href="#Expr-3715"><span class="linenos">3715</span></a>
</span><span id="Expr-3716"><a href="#Expr-3716"><span class="linenos">3716</span></a>    <span class="k">def</span> <span class="nf">combsimp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Expr-3717"><a href="#Expr-3717"><span class="linenos">3717</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;See the combsimp function in sympy.simplify&quot;&quot;&quot;</span>
</span><span id="Expr-3718"><a href="#Expr-3718"><span class="linenos">3718</span></a>        <span class="kn">from</span> <span class="nn">sympy.simplify.combsimp</span> <span class="kn">import</span> <span class="n">combsimp</span>
</span><span id="Expr-3719"><a href="#Expr-3719"><span class="linenos">3719</span></a>        <span class="k">return</span> <span class="n">combsimp</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="Expr-3720"><a href="#Expr-3720"><span class="linenos">3720</span></a>
</span><span id="Expr-3721"><a href="#Expr-3721"><span class="linenos">3721</span></a>    <span class="k">def</span> <span class="nf">gammasimp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Expr-3722"><a href="#Expr-3722"><span class="linenos">3722</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;See the gammasimp function in sympy.simplify&quot;&quot;&quot;</span>
</span><span id="Expr-3723"><a href="#Expr-3723"><span class="linenos">3723</span></a>        <span class="kn">from</span> <span class="nn">sympy.simplify.gammasimp</span> <span class="kn">import</span> <span class="n">gammasimp</span>
</span><span id="Expr-3724"><a href="#Expr-3724"><span class="linenos">3724</span></a>        <span class="k">return</span> <span class="n">gammasimp</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="Expr-3725"><a href="#Expr-3725"><span class="linenos">3725</span></a>
</span><span id="Expr-3726"><a href="#Expr-3726"><span class="linenos">3726</span></a>    <span class="k">def</span> <span class="nf">factor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">):</span>
</span><span id="Expr-3727"><a href="#Expr-3727"><span class="linenos">3727</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;See the factor() function in sympy.polys.polytools&quot;&quot;&quot;</span>
</span><span id="Expr-3728"><a href="#Expr-3728"><span class="linenos">3728</span></a>        <span class="kn">from</span> <span class="nn">sympy.polys.polytools</span> <span class="kn">import</span> <span class="n">factor</span>
</span><span id="Expr-3729"><a href="#Expr-3729"><span class="linenos">3729</span></a>        <span class="k">return</span> <span class="n">factor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">)</span>
</span><span id="Expr-3730"><a href="#Expr-3730"><span class="linenos">3730</span></a>
</span><span id="Expr-3731"><a href="#Expr-3731"><span class="linenos">3731</span></a>    <span class="k">def</span> <span class="nf">cancel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">):</span>
</span><span id="Expr-3732"><a href="#Expr-3732"><span class="linenos">3732</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;See the cancel function in sympy.polys&quot;&quot;&quot;</span>
</span><span id="Expr-3733"><a href="#Expr-3733"><span class="linenos">3733</span></a>        <span class="kn">from</span> <span class="nn">sympy.polys.polytools</span> <span class="kn">import</span> <span class="n">cancel</span>
</span><span id="Expr-3734"><a href="#Expr-3734"><span class="linenos">3734</span></a>        <span class="k">return</span> <span class="n">cancel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">)</span>
</span><span id="Expr-3735"><a href="#Expr-3735"><span class="linenos">3735</span></a>
</span><span id="Expr-3736"><a href="#Expr-3736"><span class="linenos">3736</span></a>    <span class="k">def</span> <span class="nf">invert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">):</span>
</span><span id="Expr-3737"><a href="#Expr-3737"><span class="linenos">3737</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the multiplicative inverse of ``self`` mod ``g``</span>
</span><span id="Expr-3738"><a href="#Expr-3738"><span class="linenos">3738</span></a><span class="sd">        where ``self`` (and ``g``) may be symbolic expressions).</span>
</span><span id="Expr-3739"><a href="#Expr-3739"><span class="linenos">3739</span></a>
</span><span id="Expr-3740"><a href="#Expr-3740"><span class="linenos">3740</span></a><span class="sd">        See Also</span>
</span><span id="Expr-3741"><a href="#Expr-3741"><span class="linenos">3741</span></a><span class="sd">        ========</span>
</span><span id="Expr-3742"><a href="#Expr-3742"><span class="linenos">3742</span></a><span class="sd">        sympy.core.numbers.mod_inverse, sympy.polys.polytools.invert</span>
</span><span id="Expr-3743"><a href="#Expr-3743"><span class="linenos">3743</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Expr-3744"><a href="#Expr-3744"><span class="linenos">3744</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_number</span> <span class="ow">and</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="s1">&#39;is_number&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">):</span>
</span><span id="Expr-3745"><a href="#Expr-3745"><span class="linenos">3745</span></a>            <span class="kn">from</span> <span class="nn">.numbers</span> <span class="kn">import</span> <span class="n">mod_inverse</span>
</span><span id="Expr-3746"><a href="#Expr-3746"><span class="linenos">3746</span></a>            <span class="k">return</span> <span class="n">mod_inverse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">g</span><span class="p">)</span>
</span><span id="Expr-3747"><a href="#Expr-3747"><span class="linenos">3747</span></a>        <span class="kn">from</span> <span class="nn">sympy.polys.polytools</span> <span class="kn">import</span> <span class="n">invert</span>
</span><span id="Expr-3748"><a href="#Expr-3748"><span class="linenos">3748</span></a>        <span class="k">return</span> <span class="n">invert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">)</span>
</span><span id="Expr-3749"><a href="#Expr-3749"><span class="linenos">3749</span></a>
</span><span id="Expr-3750"><a href="#Expr-3750"><span class="linenos">3750</span></a>    <span class="k">def</span> <span class="nf">round</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="Expr-3751"><a href="#Expr-3751"><span class="linenos">3751</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return x rounded to the given decimal place.</span>
</span><span id="Expr-3752"><a href="#Expr-3752"><span class="linenos">3752</span></a>
</span><span id="Expr-3753"><a href="#Expr-3753"><span class="linenos">3753</span></a><span class="sd">        If a complex number would results, apply round to the real</span>
</span><span id="Expr-3754"><a href="#Expr-3754"><span class="linenos">3754</span></a><span class="sd">        and imaginary components of the number.</span>
</span><span id="Expr-3755"><a href="#Expr-3755"><span class="linenos">3755</span></a>
</span><span id="Expr-3756"><a href="#Expr-3756"><span class="linenos">3756</span></a><span class="sd">        Examples</span>
</span><span id="Expr-3757"><a href="#Expr-3757"><span class="linenos">3757</span></a><span class="sd">        ========</span>
</span><span id="Expr-3758"><a href="#Expr-3758"><span class="linenos">3758</span></a>
</span><span id="Expr-3759"><a href="#Expr-3759"><span class="linenos">3759</span></a><span class="sd">        &gt;&gt;&gt; from sympy import pi, E, I, S, Number</span>
</span><span id="Expr-3760"><a href="#Expr-3760"><span class="linenos">3760</span></a><span class="sd">        &gt;&gt;&gt; pi.round()</span>
</span><span id="Expr-3761"><a href="#Expr-3761"><span class="linenos">3761</span></a><span class="sd">        3</span>
</span><span id="Expr-3762"><a href="#Expr-3762"><span class="linenos">3762</span></a><span class="sd">        &gt;&gt;&gt; pi.round(2)</span>
</span><span id="Expr-3763"><a href="#Expr-3763"><span class="linenos">3763</span></a><span class="sd">        3.14</span>
</span><span id="Expr-3764"><a href="#Expr-3764"><span class="linenos">3764</span></a><span class="sd">        &gt;&gt;&gt; (2*pi + E*I).round()</span>
</span><span id="Expr-3765"><a href="#Expr-3765"><span class="linenos">3765</span></a><span class="sd">        6 + 3*I</span>
</span><span id="Expr-3766"><a href="#Expr-3766"><span class="linenos">3766</span></a>
</span><span id="Expr-3767"><a href="#Expr-3767"><span class="linenos">3767</span></a><span class="sd">        The round method has a chopping effect:</span>
</span><span id="Expr-3768"><a href="#Expr-3768"><span class="linenos">3768</span></a>
</span><span id="Expr-3769"><a href="#Expr-3769"><span class="linenos">3769</span></a><span class="sd">        &gt;&gt;&gt; (2*pi + I/10).round()</span>
</span><span id="Expr-3770"><a href="#Expr-3770"><span class="linenos">3770</span></a><span class="sd">        6</span>
</span><span id="Expr-3771"><a href="#Expr-3771"><span class="linenos">3771</span></a><span class="sd">        &gt;&gt;&gt; (pi/10 + 2*I).round()</span>
</span><span id="Expr-3772"><a href="#Expr-3772"><span class="linenos">3772</span></a><span class="sd">        2*I</span>
</span><span id="Expr-3773"><a href="#Expr-3773"><span class="linenos">3773</span></a><span class="sd">        &gt;&gt;&gt; (pi/10 + E*I).round(2)</span>
</span><span id="Expr-3774"><a href="#Expr-3774"><span class="linenos">3774</span></a><span class="sd">        0.31 + 2.72*I</span>
</span><span id="Expr-3775"><a href="#Expr-3775"><span class="linenos">3775</span></a>
</span><span id="Expr-3776"><a href="#Expr-3776"><span class="linenos">3776</span></a><span class="sd">        Notes</span>
</span><span id="Expr-3777"><a href="#Expr-3777"><span class="linenos">3777</span></a><span class="sd">        =====</span>
</span><span id="Expr-3778"><a href="#Expr-3778"><span class="linenos">3778</span></a>
</span><span id="Expr-3779"><a href="#Expr-3779"><span class="linenos">3779</span></a><span class="sd">        The Python ``round`` function uses the SymPy ``round`` method so it</span>
</span><span id="Expr-3780"><a href="#Expr-3780"><span class="linenos">3780</span></a><span class="sd">        will always return a SymPy number (not a Python float or int):</span>
</span><span id="Expr-3781"><a href="#Expr-3781"><span class="linenos">3781</span></a>
</span><span id="Expr-3782"><a href="#Expr-3782"><span class="linenos">3782</span></a><span class="sd">        &gt;&gt;&gt; isinstance(round(S(123), -2), Number)</span>
</span><span id="Expr-3783"><a href="#Expr-3783"><span class="linenos">3783</span></a><span class="sd">        True</span>
</span><span id="Expr-3784"><a href="#Expr-3784"><span class="linenos">3784</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Expr-3785"><a href="#Expr-3785"><span class="linenos">3785</span></a>        <span class="kn">from</span> <span class="nn">sympy.core.numbers</span> <span class="kn">import</span> <span class="n">Float</span>
</span><span id="Expr-3786"><a href="#Expr-3786"><span class="linenos">3786</span></a>
</span><span id="Expr-3787"><a href="#Expr-3787"><span class="linenos">3787</span></a>        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span>
</span><span id="Expr-3788"><a href="#Expr-3788"><span class="linenos">3788</span></a>
</span><span id="Expr-3789"><a href="#Expr-3789"><span class="linenos">3789</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">x</span><span class="o">.</span><span class="n">is_number</span><span class="p">:</span>
</span><span id="Expr-3790"><a href="#Expr-3790"><span class="linenos">3790</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Cannot round symbolic expression&quot;</span><span class="p">)</span>
</span><span id="Expr-3791"><a href="#Expr-3791"><span class="linenos">3791</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">x</span><span class="o">.</span><span class="n">is_Atom</span><span class="p">:</span>
</span><span id="Expr-3792"><a href="#Expr-3792"><span class="linenos">3792</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">pure_complex</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">n</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">or_real</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="Expr-3793"><a href="#Expr-3793"><span class="linenos">3793</span></a>                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
</span><span id="Expr-3794"><a href="#Expr-3794"><span class="linenos">3794</span></a>                    <span class="s1">&#39;Expected a number but got </span><span class="si">%s</span><span class="s1">:&#39;</span> <span class="o">%</span> <span class="n">func_name</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</span><span id="Expr-3795"><a href="#Expr-3795"><span class="linenos">3795</span></a>        <span class="k">elif</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">NaN</span><span class="p">,</span> <span class="n">S</span><span class="o">.</span><span class="n">Infinity</span><span class="p">,</span> <span class="n">S</span><span class="o">.</span><span class="n">NegativeInfinity</span><span class="p">,</span> <span class="n">S</span><span class="o">.</span><span class="n">ComplexInfinity</span><span class="p">):</span>
</span><span id="Expr-3796"><a href="#Expr-3796"><span class="linenos">3796</span></a>            <span class="k">return</span> <span class="n">x</span>
</span><span id="Expr-3797"><a href="#Expr-3797"><span class="linenos">3797</span></a>        <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">is_extended_real</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
</span><span id="Expr-3798"><a href="#Expr-3798"><span class="linenos">3798</span></a>            <span class="n">r</span><span class="p">,</span> <span class="n">i</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">as_real_imag</span><span class="p">()</span>
</span><span id="Expr-3799"><a href="#Expr-3799"><span class="linenos">3799</span></a>            <span class="k">return</span> <span class="n">r</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">+</span> <span class="n">S</span><span class="o">.</span><span class="n">ImaginaryUnit</span><span class="o">*</span><span class="n">i</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
</span><span id="Expr-3800"><a href="#Expr-3800"><span class="linenos">3800</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">x</span><span class="p">:</span>
</span><span id="Expr-3801"><a href="#Expr-3801"><span class="linenos">3801</span></a>            <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">Zero</span> <span class="k">if</span> <span class="n">n</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">x</span>
</span><span id="Expr-3802"><a href="#Expr-3802"><span class="linenos">3802</span></a>
</span><span id="Expr-3803"><a href="#Expr-3803"><span class="linenos">3803</span></a>        <span class="n">p</span> <span class="o">=</span> <span class="n">as_int</span><span class="p">(</span><span class="n">n</span> <span class="ow">or</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="Expr-3804"><a href="#Expr-3804"><span class="linenos">3804</span></a>
</span><span id="Expr-3805"><a href="#Expr-3805"><span class="linenos">3805</span></a>        <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">is_Integer</span><span class="p">:</span>
</span><span id="Expr-3806"><a href="#Expr-3806"><span class="linenos">3806</span></a>            <span class="k">return</span> <span class="n">Integer</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">p</span><span class="p">))</span>
</span><span id="Expr-3807"><a href="#Expr-3807"><span class="linenos">3807</span></a>
</span><span id="Expr-3808"><a href="#Expr-3808"><span class="linenos">3808</span></a>        <span class="n">digits_to_decimal</span> <span class="o">=</span> <span class="n">_mag</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>  <span class="c1"># _mag(12) = 2, _mag(.012) = -1</span>
</span><span id="Expr-3809"><a href="#Expr-3809"><span class="linenos">3809</span></a>        <span class="n">allow</span> <span class="o">=</span> <span class="n">digits_to_decimal</span> <span class="o">+</span> <span class="n">p</span>
</span><span id="Expr-3810"><a href="#Expr-3810"><span class="linenos">3810</span></a>        <span class="n">precs</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span><span class="o">.</span><span class="n">_prec</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">x</span><span class="o">.</span><span class="n">atoms</span><span class="p">(</span><span class="n">Float</span><span class="p">)]</span>
</span><span id="Expr-3811"><a href="#Expr-3811"><span class="linenos">3811</span></a>        <span class="n">dps</span> <span class="o">=</span> <span class="n">prec_to_dps</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">precs</span><span class="p">))</span> <span class="k">if</span> <span class="n">precs</span> <span class="k">else</span> <span class="kc">None</span>
</span><span id="Expr-3812"><a href="#Expr-3812"><span class="linenos">3812</span></a>        <span class="k">if</span> <span class="n">dps</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Expr-3813"><a href="#Expr-3813"><span class="linenos">3813</span></a>            <span class="c1"># assume everything is exact so use the Python</span>
</span><span id="Expr-3814"><a href="#Expr-3814"><span class="linenos">3814</span></a>            <span class="c1"># float default or whatever was requested</span>
</span><span id="Expr-3815"><a href="#Expr-3815"><span class="linenos">3815</span></a>            <span class="n">dps</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="n">allow</span><span class="p">)</span>
</span><span id="Expr-3816"><a href="#Expr-3816"><span class="linenos">3816</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Expr-3817"><a href="#Expr-3817"><span class="linenos">3817</span></a>            <span class="n">allow</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">allow</span><span class="p">,</span> <span class="n">dps</span><span class="p">)</span>
</span><span id="Expr-3818"><a href="#Expr-3818"><span class="linenos">3818</span></a>        <span class="c1"># this will shift all digits to right of decimal</span>
</span><span id="Expr-3819"><a href="#Expr-3819"><span class="linenos">3819</span></a>        <span class="c1"># and give us dps to work with as an int</span>
</span><span id="Expr-3820"><a href="#Expr-3820"><span class="linenos">3820</span></a>        <span class="n">shift</span> <span class="o">=</span> <span class="o">-</span><span class="n">digits_to_decimal</span> <span class="o">+</span> <span class="n">dps</span>
</span><span id="Expr-3821"><a href="#Expr-3821"><span class="linenos">3821</span></a>        <span class="n">extra</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># how far we look past known digits</span>
</span><span id="Expr-3822"><a href="#Expr-3822"><span class="linenos">3822</span></a>        <span class="c1"># NOTE</span>
</span><span id="Expr-3823"><a href="#Expr-3823"><span class="linenos">3823</span></a>        <span class="c1"># mpmath will calculate the binary representation to</span>
</span><span id="Expr-3824"><a href="#Expr-3824"><span class="linenos">3824</span></a>        <span class="c1"># an arbitrary number of digits but we must base our</span>
</span><span id="Expr-3825"><a href="#Expr-3825"><span class="linenos">3825</span></a>        <span class="c1"># answer on a finite number of those digits, e.g.</span>
</span><span id="Expr-3826"><a href="#Expr-3826"><span class="linenos">3826</span></a>        <span class="c1"># .575 2589569785738035/2**52 in binary.</span>
</span><span id="Expr-3827"><a href="#Expr-3827"><span class="linenos">3827</span></a>        <span class="c1"># mpmath shows us that the first 18 digits are</span>
</span><span id="Expr-3828"><a href="#Expr-3828"><span class="linenos">3828</span></a>        <span class="c1">#     &gt;&gt;&gt; Float(.575).n(18)</span>
</span><span id="Expr-3829"><a href="#Expr-3829"><span class="linenos">3829</span></a>        <span class="c1">#     0.574999999999999956</span>
</span><span id="Expr-3830"><a href="#Expr-3830"><span class="linenos">3830</span></a>        <span class="c1"># The default precision is 15 digits and if we ask</span>
</span><span id="Expr-3831"><a href="#Expr-3831"><span class="linenos">3831</span></a>        <span class="c1"># for 15 we get</span>
</span><span id="Expr-3832"><a href="#Expr-3832"><span class="linenos">3832</span></a>        <span class="c1">#     &gt;&gt;&gt; Float(.575).n(15)</span>
</span><span id="Expr-3833"><a href="#Expr-3833"><span class="linenos">3833</span></a>        <span class="c1">#     0.575000000000000</span>
</span><span id="Expr-3834"><a href="#Expr-3834"><span class="linenos">3834</span></a>        <span class="c1"># mpmath handles rounding at the 15th digit. But we</span>
</span><span id="Expr-3835"><a href="#Expr-3835"><span class="linenos">3835</span></a>        <span class="c1"># need to be careful since the user might be asking</span>
</span><span id="Expr-3836"><a href="#Expr-3836"><span class="linenos">3836</span></a>        <span class="c1"># for rounding at the last digit and our semantics</span>
</span><span id="Expr-3837"><a href="#Expr-3837"><span class="linenos">3837</span></a>        <span class="c1"># are to round toward the even final digit when there</span>
</span><span id="Expr-3838"><a href="#Expr-3838"><span class="linenos">3838</span></a>        <span class="c1"># is a tie. So the extra digit will be used to make</span>
</span><span id="Expr-3839"><a href="#Expr-3839"><span class="linenos">3839</span></a>        <span class="c1"># that decision. In this case, the value is the same</span>
</span><span id="Expr-3840"><a href="#Expr-3840"><span class="linenos">3840</span></a>        <span class="c1"># to 15 digits:</span>
</span><span id="Expr-3841"><a href="#Expr-3841"><span class="linenos">3841</span></a>        <span class="c1">#     &gt;&gt;&gt; Float(.575).n(16)</span>
</span><span id="Expr-3842"><a href="#Expr-3842"><span class="linenos">3842</span></a>        <span class="c1">#     0.5750000000000000</span>
</span><span id="Expr-3843"><a href="#Expr-3843"><span class="linenos">3843</span></a>        <span class="c1"># Now converting this to the 15 known digits gives</span>
</span><span id="Expr-3844"><a href="#Expr-3844"><span class="linenos">3844</span></a>        <span class="c1">#     575000000000000.0</span>
</span><span id="Expr-3845"><a href="#Expr-3845"><span class="linenos">3845</span></a>        <span class="c1"># which rounds to integer</span>
</span><span id="Expr-3846"><a href="#Expr-3846"><span class="linenos">3846</span></a>        <span class="c1">#    5750000000000000</span>
</span><span id="Expr-3847"><a href="#Expr-3847"><span class="linenos">3847</span></a>        <span class="c1"># And now we can round to the desired digt, e.g. at</span>
</span><span id="Expr-3848"><a href="#Expr-3848"><span class="linenos">3848</span></a>        <span class="c1"># the second from the left and we get</span>
</span><span id="Expr-3849"><a href="#Expr-3849"><span class="linenos">3849</span></a>        <span class="c1">#    5800000000000000</span>
</span><span id="Expr-3850"><a href="#Expr-3850"><span class="linenos">3850</span></a>        <span class="c1"># and rescaling that gives</span>
</span><span id="Expr-3851"><a href="#Expr-3851"><span class="linenos">3851</span></a>        <span class="c1">#    0.58</span>
</span><span id="Expr-3852"><a href="#Expr-3852"><span class="linenos">3852</span></a>        <span class="c1"># as the final result.</span>
</span><span id="Expr-3853"><a href="#Expr-3853"><span class="linenos">3853</span></a>        <span class="c1"># If the value is made slightly less than 0.575 we might</span>
</span><span id="Expr-3854"><a href="#Expr-3854"><span class="linenos">3854</span></a>        <span class="c1"># still obtain the same value:</span>
</span><span id="Expr-3855"><a href="#Expr-3855"><span class="linenos">3855</span></a>        <span class="c1">#    &gt;&gt;&gt; Float(.575-1e-16).n(16)*10**15</span>
</span><span id="Expr-3856"><a href="#Expr-3856"><span class="linenos">3856</span></a>        <span class="c1">#    574999999999999.8</span>
</span><span id="Expr-3857"><a href="#Expr-3857"><span class="linenos">3857</span></a>        <span class="c1"># What 15 digits best represents the known digits (which are</span>
</span><span id="Expr-3858"><a href="#Expr-3858"><span class="linenos">3858</span></a>        <span class="c1"># to the left of the decimal? 5750000000000000, the same as</span>
</span><span id="Expr-3859"><a href="#Expr-3859"><span class="linenos">3859</span></a>        <span class="c1"># before. The only way we will round down (in this case) is</span>
</span><span id="Expr-3860"><a href="#Expr-3860"><span class="linenos">3860</span></a>        <span class="c1"># if we declared that we had more than 15 digits of precision.</span>
</span><span id="Expr-3861"><a href="#Expr-3861"><span class="linenos">3861</span></a>        <span class="c1"># For example, if we use 16 digits of precision, the integer</span>
</span><span id="Expr-3862"><a href="#Expr-3862"><span class="linenos">3862</span></a>        <span class="c1"># we deal with is</span>
</span><span id="Expr-3863"><a href="#Expr-3863"><span class="linenos">3863</span></a>        <span class="c1">#    &gt;&gt;&gt; Float(.575-1e-16).n(17)*10**16</span>
</span><span id="Expr-3864"><a href="#Expr-3864"><span class="linenos">3864</span></a>        <span class="c1">#    5749999999999998.4</span>
</span><span id="Expr-3865"><a href="#Expr-3865"><span class="linenos">3865</span></a>        <span class="c1"># and this now rounds to 5749999999999998 and (if we round to</span>
</span><span id="Expr-3866"><a href="#Expr-3866"><span class="linenos">3866</span></a>        <span class="c1"># the 2nd digit from the left) we get 5700000000000000.</span>
</span><span id="Expr-3867"><a href="#Expr-3867"><span class="linenos">3867</span></a>        <span class="c1">#</span>
</span><span id="Expr-3868"><a href="#Expr-3868"><span class="linenos">3868</span></a>        <span class="n">xf</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">n</span><span class="p">(</span><span class="n">dps</span> <span class="o">+</span> <span class="n">extra</span><span class="p">)</span><span class="o">*</span><span class="n">Pow</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">shift</span><span class="p">)</span>
</span><span id="Expr-3869"><a href="#Expr-3869"><span class="linenos">3869</span></a>        <span class="n">xi</span> <span class="o">=</span> <span class="n">Integer</span><span class="p">(</span><span class="n">xf</span><span class="p">)</span>
</span><span id="Expr-3870"><a href="#Expr-3870"><span class="linenos">3870</span></a>        <span class="c1"># use the last digit to select the value of xi</span>
</span><span id="Expr-3871"><a href="#Expr-3871"><span class="linenos">3871</span></a>        <span class="c1"># nearest to x before rounding at the desired digit</span>
</span><span id="Expr-3872"><a href="#Expr-3872"><span class="linenos">3872</span></a>        <span class="n">sign</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="o">-</span><span class="mi">1</span>
</span><span id="Expr-3873"><a href="#Expr-3873"><span class="linenos">3873</span></a>        <span class="n">dif2</span> <span class="o">=</span> <span class="n">sign</span><span class="o">*</span><span class="p">(</span><span class="n">xf</span> <span class="o">-</span> <span class="n">xi</span><span class="p">)</span><span class="o">.</span><span class="n">n</span><span class="p">(</span><span class="n">extra</span><span class="p">)</span>
</span><span id="Expr-3874"><a href="#Expr-3874"><span class="linenos">3874</span></a>        <span class="k">if</span> <span class="n">dif2</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Expr-3875"><a href="#Expr-3875"><span class="linenos">3875</span></a>            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
</span><span id="Expr-3876"><a href="#Expr-3876"><span class="linenos">3876</span></a>                <span class="s1">&#39;not expecting int(x) to round away from 0&#39;</span><span class="p">)</span>
</span><span id="Expr-3877"><a href="#Expr-3877"><span class="linenos">3877</span></a>        <span class="k">if</span> <span class="n">dif2</span> <span class="o">&gt;</span> <span class="mf">.5</span><span class="p">:</span>
</span><span id="Expr-3878"><a href="#Expr-3878"><span class="linenos">3878</span></a>            <span class="n">xi</span> <span class="o">+=</span> <span class="n">sign</span>  <span class="c1"># round away from 0</span>
</span><span id="Expr-3879"><a href="#Expr-3879"><span class="linenos">3879</span></a>        <span class="k">elif</span> <span class="n">dif2</span> <span class="o">==</span> <span class="mf">.5</span><span class="p">:</span>
</span><span id="Expr-3880"><a href="#Expr-3880"><span class="linenos">3880</span></a>            <span class="n">xi</span> <span class="o">+=</span> <span class="n">sign</span> <span class="k">if</span> <span class="n">xi</span><span class="o">%</span><span class="mi">2</span> <span class="k">else</span> <span class="o">-</span><span class="n">sign</span>  <span class="c1"># round toward even</span>
</span><span id="Expr-3881"><a href="#Expr-3881"><span class="linenos">3881</span></a>        <span class="c1"># shift p to the new position</span>
</span><span id="Expr-3882"><a href="#Expr-3882"><span class="linenos">3882</span></a>        <span class="n">ip</span> <span class="o">=</span> <span class="n">p</span> <span class="o">-</span> <span class="n">shift</span>
</span><span id="Expr-3883"><a href="#Expr-3883"><span class="linenos">3883</span></a>        <span class="c1"># let Python handle the int rounding then rescale</span>
</span><span id="Expr-3884"><a href="#Expr-3884"><span class="linenos">3884</span></a>        <span class="n">xr</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">xi</span><span class="o">.</span><span class="n">p</span><span class="p">,</span> <span class="n">ip</span><span class="p">)</span>
</span><span id="Expr-3885"><a href="#Expr-3885"><span class="linenos">3885</span></a>        <span class="c1"># restore scale</span>
</span><span id="Expr-3886"><a href="#Expr-3886"><span class="linenos">3886</span></a>        <span class="n">rv</span> <span class="o">=</span> <span class="n">Rational</span><span class="p">(</span><span class="n">xr</span><span class="p">,</span> <span class="n">Pow</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">shift</span><span class="p">))</span>
</span><span id="Expr-3887"><a href="#Expr-3887"><span class="linenos">3887</span></a>        <span class="c1"># return Float or Integer</span>
</span><span id="Expr-3888"><a href="#Expr-3888"><span class="linenos">3888</span></a>        <span class="k">if</span> <span class="n">rv</span><span class="o">.</span><span class="n">is_Integer</span><span class="p">:</span>
</span><span id="Expr-3889"><a href="#Expr-3889"><span class="linenos">3889</span></a>            <span class="k">if</span> <span class="n">n</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># the single-arg case</span>
</span><span id="Expr-3890"><a href="#Expr-3890"><span class="linenos">3890</span></a>                <span class="k">return</span> <span class="n">rv</span>
</span><span id="Expr-3891"><a href="#Expr-3891"><span class="linenos">3891</span></a>            <span class="c1"># use str or else it won&#39;t be a float</span>
</span><span id="Expr-3892"><a href="#Expr-3892"><span class="linenos">3892</span></a>            <span class="k">return</span> <span class="n">Float</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">rv</span><span class="p">),</span> <span class="n">dps</span><span class="p">)</span>  <span class="c1"># keep same precision</span>
</span><span id="Expr-3893"><a href="#Expr-3893"><span class="linenos">3893</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Expr-3894"><a href="#Expr-3894"><span class="linenos">3894</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">allow</span> <span class="ow">and</span> <span class="n">rv</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="p">:</span>
</span><span id="Expr-3895"><a href="#Expr-3895"><span class="linenos">3895</span></a>                <span class="n">allow</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="Expr-3896"><a href="#Expr-3896"><span class="linenos">3896</span></a>            <span class="k">return</span> <span class="n">Float</span><span class="p">(</span><span class="n">rv</span><span class="p">,</span> <span class="n">allow</span><span class="p">)</span>
</span><span id="Expr-3897"><a href="#Expr-3897"><span class="linenos">3897</span></a>
</span><span id="Expr-3898"><a href="#Expr-3898"><span class="linenos">3898</span></a>    <span class="fm">__round__</span> <span class="o">=</span> <span class="nb">round</span>
</span><span id="Expr-3899"><a href="#Expr-3899"><span class="linenos">3899</span></a>
</span><span id="Expr-3900"><a href="#Expr-3900"><span class="linenos">3900</span></a>    <span class="k">def</span> <span class="nf">_eval_derivative_matrix_lines</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
</span><span id="Expr-3901"><a href="#Expr-3901"><span class="linenos">3901</span></a>        <span class="kn">from</span> <span class="nn">sympy.matrices.expressions.matexpr</span> <span class="kn">import</span> <span class="n">_LeftRightArgs</span>
</span><span id="Expr-3902"><a href="#Expr-3902"><span class="linenos">3902</span></a>        <span class="k">return</span> <span class="p">[</span><span class="n">_LeftRightArgs</span><span class="p">([</span><span class="n">S</span><span class="o">.</span><span class="n">One</span><span class="p">,</span> <span class="n">S</span><span class="o">.</span><span class="n">One</span><span class="p">],</span> <span class="n">higher</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_eval_derivative</span><span class="p">(</span><span class="n">x</span><span class="p">))]</span>
</span></pre></div>


            <div class="docstring"><p>Base class for algebraic expressions.</p>

<h1 id="explanation">Explanation</h1>

<p>Everything that requires arithmetic operations to be defined
should subclass this class, instead of Basic (which should be
used only for argument storage and expression manipulation, i.e.
pattern matching, substitutions, etc).</p>

<p>If you want to override the comparisons of expressions:
Should use _eval_is_ge for inequality, or _eval_is_eq, with multiple dispatch.
_eval_is_ge return true if x &gt;= y, false if x &lt; y, and None if the two types
are not comparable or the comparison is indeterminate</p>

<h1 id="see-also">See Also</h1>

<p>sympy.core.basic.Basic</p>
</div>


                            <div id="Expr.sort_key" class="classattr">
                                        <input id="Expr.sort_key-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@cacheit</div>

        <span class="def">def</span>
        <span class="name">sort_key</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">order</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Expr.sort_key-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Expr.sort_key"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Expr.sort_key-108"><a href="#Expr.sort_key-108"><span class="linenos">108</span></a>    <span class="nd">@cacheit</span>
</span><span id="Expr.sort_key-109"><a href="#Expr.sort_key-109"><span class="linenos">109</span></a>    <span class="k">def</span> <span class="nf">sort_key</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="Expr.sort_key-110"><a href="#Expr.sort_key-110"><span class="linenos">110</span></a>
</span><span id="Expr.sort_key-111"><a href="#Expr.sort_key-111"><span class="linenos">111</span></a>        <span class="n">coeff</span><span class="p">,</span> <span class="n">expr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">as_coeff_Mul</span><span class="p">()</span>
</span><span id="Expr.sort_key-112"><a href="#Expr.sort_key-112"><span class="linenos">112</span></a>
</span><span id="Expr.sort_key-113"><a href="#Expr.sort_key-113"><span class="linenos">113</span></a>        <span class="k">if</span> <span class="n">expr</span><span class="o">.</span><span class="n">is_Pow</span><span class="p">:</span>
</span><span id="Expr.sort_key-114"><a href="#Expr.sort_key-114"><span class="linenos">114</span></a>            <span class="k">if</span> <span class="n">expr</span><span class="o">.</span><span class="n">base</span> <span class="ow">is</span> <span class="n">S</span><span class="o">.</span><span class="n">Exp1</span><span class="p">:</span>
</span><span id="Expr.sort_key-115"><a href="#Expr.sort_key-115"><span class="linenos">115</span></a>                <span class="c1"># If we remove this, many doctests will go crazy:</span>
</span><span id="Expr.sort_key-116"><a href="#Expr.sort_key-116"><span class="linenos">116</span></a>                <span class="c1"># (keeps E**x sorted like the exp(x) function,</span>
</span><span id="Expr.sort_key-117"><a href="#Expr.sort_key-117"><span class="linenos">117</span></a>                <span class="c1">#  part of exp(x) to E**x transition)</span>
</span><span id="Expr.sort_key-118"><a href="#Expr.sort_key-118"><span class="linenos">118</span></a>                <span class="n">expr</span><span class="p">,</span> <span class="n">exp</span> <span class="o">=</span> <span class="n">Function</span><span class="p">(</span><span class="s2">&quot;exp&quot;</span><span class="p">)(</span><span class="n">expr</span><span class="o">.</span><span class="n">exp</span><span class="p">),</span> <span class="n">S</span><span class="o">.</span><span class="n">One</span>
</span><span id="Expr.sort_key-119"><a href="#Expr.sort_key-119"><span class="linenos">119</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Expr.sort_key-120"><a href="#Expr.sort_key-120"><span class="linenos">120</span></a>                <span class="n">expr</span><span class="p">,</span> <span class="n">exp</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">args</span>
</span><span id="Expr.sort_key-121"><a href="#Expr.sort_key-121"><span class="linenos">121</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Expr.sort_key-122"><a href="#Expr.sort_key-122"><span class="linenos">122</span></a>            <span class="n">exp</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">One</span>
</span><span id="Expr.sort_key-123"><a href="#Expr.sort_key-123"><span class="linenos">123</span></a>
</span><span id="Expr.sort_key-124"><a href="#Expr.sort_key-124"><span class="linenos">124</span></a>        <span class="k">if</span> <span class="n">expr</span><span class="o">.</span><span class="n">is_Dummy</span><span class="p">:</span>
</span><span id="Expr.sort_key-125"><a href="#Expr.sort_key-125"><span class="linenos">125</span></a>            <span class="n">args</span> <span class="o">=</span> <span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">sort_key</span><span class="p">(),)</span>
</span><span id="Expr.sort_key-126"><a href="#Expr.sort_key-126"><span class="linenos">126</span></a>        <span class="k">elif</span> <span class="n">expr</span><span class="o">.</span><span class="n">is_Atom</span><span class="p">:</span>
</span><span id="Expr.sort_key-127"><a href="#Expr.sort_key-127"><span class="linenos">127</span></a>            <span class="n">args</span> <span class="o">=</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">expr</span><span class="p">),)</span>
</span><span id="Expr.sort_key-128"><a href="#Expr.sort_key-128"><span class="linenos">128</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Expr.sort_key-129"><a href="#Expr.sort_key-129"><span class="linenos">129</span></a>            <span class="k">if</span> <span class="n">expr</span><span class="o">.</span><span class="n">is_Add</span><span class="p">:</span>
</span><span id="Expr.sort_key-130"><a href="#Expr.sort_key-130"><span class="linenos">130</span></a>                <span class="n">args</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">as_ordered_terms</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="n">order</span><span class="p">)</span>
</span><span id="Expr.sort_key-131"><a href="#Expr.sort_key-131"><span class="linenos">131</span></a>            <span class="k">elif</span> <span class="n">expr</span><span class="o">.</span><span class="n">is_Mul</span><span class="p">:</span>
</span><span id="Expr.sort_key-132"><a href="#Expr.sort_key-132"><span class="linenos">132</span></a>                <span class="n">args</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">as_ordered_factors</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="n">order</span><span class="p">)</span>
</span><span id="Expr.sort_key-133"><a href="#Expr.sort_key-133"><span class="linenos">133</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Expr.sort_key-134"><a href="#Expr.sort_key-134"><span class="linenos">134</span></a>                <span class="n">args</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">args</span>
</span><span id="Expr.sort_key-135"><a href="#Expr.sort_key-135"><span class="linenos">135</span></a>
</span><span id="Expr.sort_key-136"><a href="#Expr.sort_key-136"><span class="linenos">136</span></a>            <span class="n">args</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span>
</span><span id="Expr.sort_key-137"><a href="#Expr.sort_key-137"><span class="linenos">137</span></a>                <span class="p">[</span> <span class="n">default_sort_key</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="n">order</span><span class="p">)</span> <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">args</span> <span class="p">])</span>
</span><span id="Expr.sort_key-138"><a href="#Expr.sort_key-138"><span class="linenos">138</span></a>
</span><span id="Expr.sort_key-139"><a href="#Expr.sort_key-139"><span class="linenos">139</span></a>        <span class="n">args</span> <span class="o">=</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">),</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">args</span><span class="p">))</span>
</span><span id="Expr.sort_key-140"><a href="#Expr.sort_key-140"><span class="linenos">140</span></a>        <span class="n">exp</span> <span class="o">=</span> <span class="n">exp</span><span class="o">.</span><span class="n">sort_key</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="n">order</span><span class="p">)</span>
</span><span id="Expr.sort_key-141"><a href="#Expr.sort_key-141"><span class="linenos">141</span></a>
</span><span id="Expr.sort_key-142"><a href="#Expr.sort_key-142"><span class="linenos">142</span></a>        <span class="k">return</span> <span class="n">expr</span><span class="o">.</span><span class="n">class_key</span><span class="p">(),</span> <span class="n">args</span><span class="p">,</span> <span class="n">exp</span><span class="p">,</span> <span class="n">coeff</span>
</span></pre></div>


            <div class="docstring"><p>Return a sort key.</p>

<h1 id="examples">Examples</h1>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">S</span><span class="p">,</span> <span class="n">I</span>
</code></pre>
</div>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="nb">sorted</span><span class="p">([</span><span class="n">S</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">I</span><span class="p">,</span> <span class="o">-</span><span class="n">I</span><span class="p">],</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">sort_key</span><span class="p">())</span>
<span class="go">[1/2, -I, I]</span>
</code></pre>
</div>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">S</span><span class="p">(</span><span class="s2">&quot;[x, 1/x, 1/x**2, x**2, x**(1/2), x**(1/4), x**(3/2)]&quot;</span><span class="p">)</span>
<span class="go">[x, 1/x, x**(-2), x**2, sqrt(x), x**(1/4), x**(3/2)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">sorted</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">sort_key</span><span class="p">())</span>
<span class="go">[x**(-2), 1/x, x**(1/4), sqrt(x), x, x**(3/2), x**2]</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="Expr.is_number" class="classattr">
                                <div class="attr variable">
            <span class="name">is_number</span>

        
    </div>
    <a class="headerlink" href="#Expr.is_number"></a>
    
            <div class="docstring"><p>Returns True if <code>self</code> has no free symbols and no
undefined functions (AppliedUndef, to be precise). It will be
faster than <code>if not self.free_symbols</code>, however, since
<code><a href="#Expr.is_number">is_number</a></code> will fail as soon as it hits a free symbol
or undefined function.</p>

<h1 id="examples">Examples</h1>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">Function</span><span class="p">,</span> <span class="n">Integral</span><span class="p">,</span> <span class="n">cos</span><span class="p">,</span> <span class="n">sin</span><span class="p">,</span> <span class="n">pi</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.abc</span> <span class="kn">import</span> <span class="n">x</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">Function</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">)</span>
</code></pre>
</div>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="o">.</span><span class="n">is_number</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">is_number</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">is_number</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="mi">2</span> <span class="o">+</span> <span class="n">Integral</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">x</span><span class="p">))</span><span class="o">.</span><span class="n">is_number</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="mi">2</span> <span class="o">+</span> <span class="n">Integral</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)))</span><span class="o">.</span><span class="n">is_number</span>
<span class="go">True</span>
</code></pre>
</div>

<p>Not all numbers are Numbers in the SymPy sense:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">pi</span><span class="o">.</span><span class="n">is_number</span><span class="p">,</span> <span class="n">pi</span><span class="o">.</span><span class="n">is_Number</span>
<span class="go">(True, False)</span>
</code></pre>
</div>

<p>If something is a number it should evaluate to a number with
real and imaginary parts that are Numbers; the result may not
be comparable, however, since the real and/or imaginary part
of the result may not have precision.</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">cos</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">is_number</span> <span class="ow">and</span> <span class="n">cos</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">is_comparable</span>
<span class="go">True</span>
</code></pre>
</div>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">z</span> <span class="o">=</span> <span class="n">cos</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">sin</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">z</span><span class="o">.</span><span class="n">is_number</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">z</span><span class="o">.</span><span class="n">is_comparable</span>
<span class="go">False</span>
</code></pre>
</div>

<h1 id="see-also">See Also</h1>

<p>sympy.core.basic.Basic.is_comparable</p>
</div>


                            </div>
                            <div id="Expr.is_constant" class="classattr">
                                        <input id="Expr.is_constant-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">is_constant</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="o">*</span><span class="n">wrt</span>, </span><span class="param"><span class="o">**</span><span class="n">flags</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Expr.is_constant-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Expr.is_constant"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Expr.is_constant-522"><a href="#Expr.is_constant-522"><span class="linenos">522</span></a>    <span class="k">def</span> <span class="nf">is_constant</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">wrt</span><span class="p">,</span> <span class="o">**</span><span class="n">flags</span><span class="p">):</span>
</span><span id="Expr.is_constant-523"><a href="#Expr.is_constant-523"><span class="linenos">523</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return True if self is constant, False if not, or None if</span>
</span><span id="Expr.is_constant-524"><a href="#Expr.is_constant-524"><span class="linenos">524</span></a><span class="sd">        the constancy could not be determined conclusively.</span>
</span><span id="Expr.is_constant-525"><a href="#Expr.is_constant-525"><span class="linenos">525</span></a>
</span><span id="Expr.is_constant-526"><a href="#Expr.is_constant-526"><span class="linenos">526</span></a><span class="sd">        Explanation</span>
</span><span id="Expr.is_constant-527"><a href="#Expr.is_constant-527"><span class="linenos">527</span></a><span class="sd">        ===========</span>
</span><span id="Expr.is_constant-528"><a href="#Expr.is_constant-528"><span class="linenos">528</span></a>
</span><span id="Expr.is_constant-529"><a href="#Expr.is_constant-529"><span class="linenos">529</span></a><span class="sd">        If an expression has no free symbols then it is a constant. If</span>
</span><span id="Expr.is_constant-530"><a href="#Expr.is_constant-530"><span class="linenos">530</span></a><span class="sd">        there are free symbols it is possible that the expression is a</span>
</span><span id="Expr.is_constant-531"><a href="#Expr.is_constant-531"><span class="linenos">531</span></a><span class="sd">        constant, perhaps (but not necessarily) zero. To test such</span>
</span><span id="Expr.is_constant-532"><a href="#Expr.is_constant-532"><span class="linenos">532</span></a><span class="sd">        expressions, a few strategies are tried:</span>
</span><span id="Expr.is_constant-533"><a href="#Expr.is_constant-533"><span class="linenos">533</span></a>
</span><span id="Expr.is_constant-534"><a href="#Expr.is_constant-534"><span class="linenos">534</span></a><span class="sd">        1) numerical evaluation at two random points. If two such evaluations</span>
</span><span id="Expr.is_constant-535"><a href="#Expr.is_constant-535"><span class="linenos">535</span></a><span class="sd">        give two different values and the values have a precision greater than</span>
</span><span id="Expr.is_constant-536"><a href="#Expr.is_constant-536"><span class="linenos">536</span></a><span class="sd">        1 then self is not constant. If the evaluations agree or could not be</span>
</span><span id="Expr.is_constant-537"><a href="#Expr.is_constant-537"><span class="linenos">537</span></a><span class="sd">        obtained with any precision, no decision is made. The numerical testing</span>
</span><span id="Expr.is_constant-538"><a href="#Expr.is_constant-538"><span class="linenos">538</span></a><span class="sd">        is done only if ``wrt`` is different than the free symbols.</span>
</span><span id="Expr.is_constant-539"><a href="#Expr.is_constant-539"><span class="linenos">539</span></a>
</span><span id="Expr.is_constant-540"><a href="#Expr.is_constant-540"><span class="linenos">540</span></a><span class="sd">        2) differentiation with respect to variables in &#39;wrt&#39; (or all free</span>
</span><span id="Expr.is_constant-541"><a href="#Expr.is_constant-541"><span class="linenos">541</span></a><span class="sd">        symbols if omitted) to see if the expression is constant or not. This</span>
</span><span id="Expr.is_constant-542"><a href="#Expr.is_constant-542"><span class="linenos">542</span></a><span class="sd">        will not always lead to an expression that is zero even though an</span>
</span><span id="Expr.is_constant-543"><a href="#Expr.is_constant-543"><span class="linenos">543</span></a><span class="sd">        expression is constant (see added test in test_expr.py). If</span>
</span><span id="Expr.is_constant-544"><a href="#Expr.is_constant-544"><span class="linenos">544</span></a><span class="sd">        all derivatives are zero then self is constant with respect to the</span>
</span><span id="Expr.is_constant-545"><a href="#Expr.is_constant-545"><span class="linenos">545</span></a><span class="sd">        given symbols.</span>
</span><span id="Expr.is_constant-546"><a href="#Expr.is_constant-546"><span class="linenos">546</span></a>
</span><span id="Expr.is_constant-547"><a href="#Expr.is_constant-547"><span class="linenos">547</span></a><span class="sd">        3) finding out zeros of denominator expression with free_symbols.</span>
</span><span id="Expr.is_constant-548"><a href="#Expr.is_constant-548"><span class="linenos">548</span></a><span class="sd">        It will not be constant if there are zeros. It gives more negative</span>
</span><span id="Expr.is_constant-549"><a href="#Expr.is_constant-549"><span class="linenos">549</span></a><span class="sd">        answers for expression that are not constant.</span>
</span><span id="Expr.is_constant-550"><a href="#Expr.is_constant-550"><span class="linenos">550</span></a>
</span><span id="Expr.is_constant-551"><a href="#Expr.is_constant-551"><span class="linenos">551</span></a><span class="sd">        If neither evaluation nor differentiation can prove the expression is</span>
</span><span id="Expr.is_constant-552"><a href="#Expr.is_constant-552"><span class="linenos">552</span></a><span class="sd">        constant, None is returned unless two numerical values happened to be</span>
</span><span id="Expr.is_constant-553"><a href="#Expr.is_constant-553"><span class="linenos">553</span></a><span class="sd">        the same and the flag ``failing_number`` is True -- in that case the</span>
</span><span id="Expr.is_constant-554"><a href="#Expr.is_constant-554"><span class="linenos">554</span></a><span class="sd">        numerical value will be returned.</span>
</span><span id="Expr.is_constant-555"><a href="#Expr.is_constant-555"><span class="linenos">555</span></a>
</span><span id="Expr.is_constant-556"><a href="#Expr.is_constant-556"><span class="linenos">556</span></a><span class="sd">        If flag simplify=False is passed, self will not be simplified;</span>
</span><span id="Expr.is_constant-557"><a href="#Expr.is_constant-557"><span class="linenos">557</span></a><span class="sd">        the default is True since self should be simplified before testing.</span>
</span><span id="Expr.is_constant-558"><a href="#Expr.is_constant-558"><span class="linenos">558</span></a>
</span><span id="Expr.is_constant-559"><a href="#Expr.is_constant-559"><span class="linenos">559</span></a><span class="sd">        Examples</span>
</span><span id="Expr.is_constant-560"><a href="#Expr.is_constant-560"><span class="linenos">560</span></a><span class="sd">        ========</span>
</span><span id="Expr.is_constant-561"><a href="#Expr.is_constant-561"><span class="linenos">561</span></a>
</span><span id="Expr.is_constant-562"><a href="#Expr.is_constant-562"><span class="linenos">562</span></a><span class="sd">        &gt;&gt;&gt; from sympy import cos, sin, Sum, S, pi</span>
</span><span id="Expr.is_constant-563"><a href="#Expr.is_constant-563"><span class="linenos">563</span></a><span class="sd">        &gt;&gt;&gt; from sympy.abc import a, n, x, y</span>
</span><span id="Expr.is_constant-564"><a href="#Expr.is_constant-564"><span class="linenos">564</span></a><span class="sd">        &gt;&gt;&gt; x.is_constant()</span>
</span><span id="Expr.is_constant-565"><a href="#Expr.is_constant-565"><span class="linenos">565</span></a><span class="sd">        False</span>
</span><span id="Expr.is_constant-566"><a href="#Expr.is_constant-566"><span class="linenos">566</span></a><span class="sd">        &gt;&gt;&gt; S(2).is_constant()</span>
</span><span id="Expr.is_constant-567"><a href="#Expr.is_constant-567"><span class="linenos">567</span></a><span class="sd">        True</span>
</span><span id="Expr.is_constant-568"><a href="#Expr.is_constant-568"><span class="linenos">568</span></a><span class="sd">        &gt;&gt;&gt; Sum(x, (x, 1, 10)).is_constant()</span>
</span><span id="Expr.is_constant-569"><a href="#Expr.is_constant-569"><span class="linenos">569</span></a><span class="sd">        True</span>
</span><span id="Expr.is_constant-570"><a href="#Expr.is_constant-570"><span class="linenos">570</span></a><span class="sd">        &gt;&gt;&gt; Sum(x, (x, 1, n)).is_constant()</span>
</span><span id="Expr.is_constant-571"><a href="#Expr.is_constant-571"><span class="linenos">571</span></a><span class="sd">        False</span>
</span><span id="Expr.is_constant-572"><a href="#Expr.is_constant-572"><span class="linenos">572</span></a><span class="sd">        &gt;&gt;&gt; Sum(x, (x, 1, n)).is_constant(y)</span>
</span><span id="Expr.is_constant-573"><a href="#Expr.is_constant-573"><span class="linenos">573</span></a><span class="sd">        True</span>
</span><span id="Expr.is_constant-574"><a href="#Expr.is_constant-574"><span class="linenos">574</span></a><span class="sd">        &gt;&gt;&gt; Sum(x, (x, 1, n)).is_constant(n)</span>
</span><span id="Expr.is_constant-575"><a href="#Expr.is_constant-575"><span class="linenos">575</span></a><span class="sd">        False</span>
</span><span id="Expr.is_constant-576"><a href="#Expr.is_constant-576"><span class="linenos">576</span></a><span class="sd">        &gt;&gt;&gt; Sum(x, (x, 1, n)).is_constant(x)</span>
</span><span id="Expr.is_constant-577"><a href="#Expr.is_constant-577"><span class="linenos">577</span></a><span class="sd">        True</span>
</span><span id="Expr.is_constant-578"><a href="#Expr.is_constant-578"><span class="linenos">578</span></a><span class="sd">        &gt;&gt;&gt; eq = a*cos(x)**2 + a*sin(x)**2 - a</span>
</span><span id="Expr.is_constant-579"><a href="#Expr.is_constant-579"><span class="linenos">579</span></a><span class="sd">        &gt;&gt;&gt; eq.is_constant()</span>
</span><span id="Expr.is_constant-580"><a href="#Expr.is_constant-580"><span class="linenos">580</span></a><span class="sd">        True</span>
</span><span id="Expr.is_constant-581"><a href="#Expr.is_constant-581"><span class="linenos">581</span></a><span class="sd">        &gt;&gt;&gt; eq.subs({x: pi, a: 2}) == eq.subs({x: pi, a: 3}) == 0</span>
</span><span id="Expr.is_constant-582"><a href="#Expr.is_constant-582"><span class="linenos">582</span></a><span class="sd">        True</span>
</span><span id="Expr.is_constant-583"><a href="#Expr.is_constant-583"><span class="linenos">583</span></a>
</span><span id="Expr.is_constant-584"><a href="#Expr.is_constant-584"><span class="linenos">584</span></a><span class="sd">        &gt;&gt;&gt; (0**x).is_constant()</span>
</span><span id="Expr.is_constant-585"><a href="#Expr.is_constant-585"><span class="linenos">585</span></a><span class="sd">        False</span>
</span><span id="Expr.is_constant-586"><a href="#Expr.is_constant-586"><span class="linenos">586</span></a><span class="sd">        &gt;&gt;&gt; x.is_constant()</span>
</span><span id="Expr.is_constant-587"><a href="#Expr.is_constant-587"><span class="linenos">587</span></a><span class="sd">        False</span>
</span><span id="Expr.is_constant-588"><a href="#Expr.is_constant-588"><span class="linenos">588</span></a><span class="sd">        &gt;&gt;&gt; (x**x).is_constant()</span>
</span><span id="Expr.is_constant-589"><a href="#Expr.is_constant-589"><span class="linenos">589</span></a><span class="sd">        False</span>
</span><span id="Expr.is_constant-590"><a href="#Expr.is_constant-590"><span class="linenos">590</span></a><span class="sd">        &gt;&gt;&gt; one = cos(x)**2 + sin(x)**2</span>
</span><span id="Expr.is_constant-591"><a href="#Expr.is_constant-591"><span class="linenos">591</span></a><span class="sd">        &gt;&gt;&gt; one.is_constant()</span>
</span><span id="Expr.is_constant-592"><a href="#Expr.is_constant-592"><span class="linenos">592</span></a><span class="sd">        True</span>
</span><span id="Expr.is_constant-593"><a href="#Expr.is_constant-593"><span class="linenos">593</span></a><span class="sd">        &gt;&gt;&gt; ((one - 1)**(x + 1)).is_constant() in (True, False) # could be 0 or 1</span>
</span><span id="Expr.is_constant-594"><a href="#Expr.is_constant-594"><span class="linenos">594</span></a><span class="sd">        True</span>
</span><span id="Expr.is_constant-595"><a href="#Expr.is_constant-595"><span class="linenos">595</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Expr.is_constant-596"><a href="#Expr.is_constant-596"><span class="linenos">596</span></a>
</span><span id="Expr.is_constant-597"><a href="#Expr.is_constant-597"><span class="linenos">597</span></a>        <span class="k">def</span> <span class="nf">check_denominator_zeros</span><span class="p">(</span><span class="n">expression</span><span class="p">):</span>
</span><span id="Expr.is_constant-598"><a href="#Expr.is_constant-598"><span class="linenos">598</span></a>            <span class="kn">from</span> <span class="nn">sympy.solvers.solvers</span> <span class="kn">import</span> <span class="n">denoms</span>
</span><span id="Expr.is_constant-599"><a href="#Expr.is_constant-599"><span class="linenos">599</span></a>
</span><span id="Expr.is_constant-600"><a href="#Expr.is_constant-600"><span class="linenos">600</span></a>            <span class="n">retNone</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="Expr.is_constant-601"><a href="#Expr.is_constant-601"><span class="linenos">601</span></a>            <span class="k">for</span> <span class="n">den</span> <span class="ow">in</span> <span class="n">denoms</span><span class="p">(</span><span class="n">expression</span><span class="p">):</span>
</span><span id="Expr.is_constant-602"><a href="#Expr.is_constant-602"><span class="linenos">602</span></a>                <span class="n">z</span> <span class="o">=</span> <span class="n">den</span><span class="o">.</span><span class="n">is_zero</span>
</span><span id="Expr.is_constant-603"><a href="#Expr.is_constant-603"><span class="linenos">603</span></a>                <span class="k">if</span> <span class="n">z</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="Expr.is_constant-604"><a href="#Expr.is_constant-604"><span class="linenos">604</span></a>                    <span class="k">return</span> <span class="kc">True</span>
</span><span id="Expr.is_constant-605"><a href="#Expr.is_constant-605"><span class="linenos">605</span></a>                <span class="k">if</span> <span class="n">z</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Expr.is_constant-606"><a href="#Expr.is_constant-606"><span class="linenos">606</span></a>                    <span class="n">retNone</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="Expr.is_constant-607"><a href="#Expr.is_constant-607"><span class="linenos">607</span></a>            <span class="k">if</span> <span class="n">retNone</span><span class="p">:</span>
</span><span id="Expr.is_constant-608"><a href="#Expr.is_constant-608"><span class="linenos">608</span></a>                <span class="k">return</span> <span class="kc">None</span>
</span><span id="Expr.is_constant-609"><a href="#Expr.is_constant-609"><span class="linenos">609</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="Expr.is_constant-610"><a href="#Expr.is_constant-610"><span class="linenos">610</span></a>
</span><span id="Expr.is_constant-611"><a href="#Expr.is_constant-611"><span class="linenos">611</span></a>        <span class="n">simplify</span> <span class="o">=</span> <span class="n">flags</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;simplify&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
</span><span id="Expr.is_constant-612"><a href="#Expr.is_constant-612"><span class="linenos">612</span></a>
</span><span id="Expr.is_constant-613"><a href="#Expr.is_constant-613"><span class="linenos">613</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_number</span><span class="p">:</span>
</span><span id="Expr.is_constant-614"><a href="#Expr.is_constant-614"><span class="linenos">614</span></a>            <span class="k">return</span> <span class="kc">True</span>
</span><span id="Expr.is_constant-615"><a href="#Expr.is_constant-615"><span class="linenos">615</span></a>        <span class="n">free</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">free_symbols</span>
</span><span id="Expr.is_constant-616"><a href="#Expr.is_constant-616"><span class="linenos">616</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">free</span><span class="p">:</span>
</span><span id="Expr.is_constant-617"><a href="#Expr.is_constant-617"><span class="linenos">617</span></a>            <span class="k">return</span> <span class="kc">True</span>  <span class="c1"># assume f(1) is some constant</span>
</span><span id="Expr.is_constant-618"><a href="#Expr.is_constant-618"><span class="linenos">618</span></a>
</span><span id="Expr.is_constant-619"><a href="#Expr.is_constant-619"><span class="linenos">619</span></a>        <span class="c1"># if we are only interested in some symbols and they are not in the</span>
</span><span id="Expr.is_constant-620"><a href="#Expr.is_constant-620"><span class="linenos">620</span></a>        <span class="c1"># free symbols then this expression is constant wrt those symbols</span>
</span><span id="Expr.is_constant-621"><a href="#Expr.is_constant-621"><span class="linenos">621</span></a>        <span class="n">wrt</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">wrt</span><span class="p">)</span>
</span><span id="Expr.is_constant-622"><a href="#Expr.is_constant-622"><span class="linenos">622</span></a>        <span class="k">if</span> <span class="n">wrt</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">wrt</span> <span class="o">&amp;</span> <span class="n">free</span><span class="p">:</span>
</span><span id="Expr.is_constant-623"><a href="#Expr.is_constant-623"><span class="linenos">623</span></a>            <span class="k">return</span> <span class="kc">True</span>
</span><span id="Expr.is_constant-624"><a href="#Expr.is_constant-624"><span class="linenos">624</span></a>        <span class="n">wrt</span> <span class="o">=</span> <span class="n">wrt</span> <span class="ow">or</span> <span class="n">free</span>
</span><span id="Expr.is_constant-625"><a href="#Expr.is_constant-625"><span class="linenos">625</span></a>
</span><span id="Expr.is_constant-626"><a href="#Expr.is_constant-626"><span class="linenos">626</span></a>        <span class="c1"># simplify unless this has already been done</span>
</span><span id="Expr.is_constant-627"><a href="#Expr.is_constant-627"><span class="linenos">627</span></a>        <span class="n">expr</span> <span class="o">=</span> <span class="bp">self</span>
</span><span id="Expr.is_constant-628"><a href="#Expr.is_constant-628"><span class="linenos">628</span></a>        <span class="k">if</span> <span class="n">simplify</span><span class="p">:</span>
</span><span id="Expr.is_constant-629"><a href="#Expr.is_constant-629"><span class="linenos">629</span></a>            <span class="n">expr</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">simplify</span><span class="p">()</span>
</span><span id="Expr.is_constant-630"><a href="#Expr.is_constant-630"><span class="linenos">630</span></a>
</span><span id="Expr.is_constant-631"><a href="#Expr.is_constant-631"><span class="linenos">631</span></a>        <span class="c1"># is_zero should be a quick assumptions check; it can be wrong for</span>
</span><span id="Expr.is_constant-632"><a href="#Expr.is_constant-632"><span class="linenos">632</span></a>        <span class="c1"># numbers (see test_is_not_constant test), giving False when it</span>
</span><span id="Expr.is_constant-633"><a href="#Expr.is_constant-633"><span class="linenos">633</span></a>        <span class="c1"># shouldn&#39;t, but hopefully it will never give True unless it is sure.</span>
</span><span id="Expr.is_constant-634"><a href="#Expr.is_constant-634"><span class="linenos">634</span></a>        <span class="k">if</span> <span class="n">expr</span><span class="o">.</span><span class="n">is_zero</span><span class="p">:</span>
</span><span id="Expr.is_constant-635"><a href="#Expr.is_constant-635"><span class="linenos">635</span></a>            <span class="k">return</span> <span class="kc">True</span>
</span><span id="Expr.is_constant-636"><a href="#Expr.is_constant-636"><span class="linenos">636</span></a>
</span><span id="Expr.is_constant-637"><a href="#Expr.is_constant-637"><span class="linenos">637</span></a>        <span class="c1"># Don&#39;t attempt substitution or differentiation with non-number symbols</span>
</span><span id="Expr.is_constant-638"><a href="#Expr.is_constant-638"><span class="linenos">638</span></a>        <span class="n">wrt_number</span> <span class="o">=</span> <span class="p">{</span><span class="n">sym</span> <span class="k">for</span> <span class="n">sym</span> <span class="ow">in</span> <span class="n">wrt</span> <span class="k">if</span> <span class="n">sym</span><span class="o">.</span><span class="n">kind</span> <span class="ow">is</span> <span class="n">NumberKind</span><span class="p">}</span>
</span><span id="Expr.is_constant-639"><a href="#Expr.is_constant-639"><span class="linenos">639</span></a>
</span><span id="Expr.is_constant-640"><a href="#Expr.is_constant-640"><span class="linenos">640</span></a>        <span class="c1"># try numerical evaluation to see if we get two different values</span>
</span><span id="Expr.is_constant-641"><a href="#Expr.is_constant-641"><span class="linenos">641</span></a>        <span class="n">failing_number</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Expr.is_constant-642"><a href="#Expr.is_constant-642"><span class="linenos">642</span></a>        <span class="k">if</span> <span class="n">wrt_number</span> <span class="o">==</span> <span class="n">free</span><span class="p">:</span>
</span><span id="Expr.is_constant-643"><a href="#Expr.is_constant-643"><span class="linenos">643</span></a>            <span class="c1"># try 0 (for a) and 1 (for b)</span>
</span><span id="Expr.is_constant-644"><a href="#Expr.is_constant-644"><span class="linenos">644</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="Expr.is_constant-645"><a href="#Expr.is_constant-645"><span class="linenos">645</span></a>                <span class="n">a</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">free</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">free</span><span class="p">))),</span>
</span><span id="Expr.is_constant-646"><a href="#Expr.is_constant-646"><span class="linenos">646</span></a>                    <span class="n">simultaneous</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="Expr.is_constant-647"><a href="#Expr.is_constant-647"><span class="linenos">647</span></a>                <span class="k">if</span> <span class="n">a</span> <span class="ow">is</span> <span class="n">S</span><span class="o">.</span><span class="n">NaN</span><span class="p">:</span>
</span><span id="Expr.is_constant-648"><a href="#Expr.is_constant-648"><span class="linenos">648</span></a>                    <span class="c1"># evaluation may succeed when substitution fails</span>
</span><span id="Expr.is_constant-649"><a href="#Expr.is_constant-649"><span class="linenos">649</span></a>                    <span class="n">a</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">_random</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="Expr.is_constant-650"><a href="#Expr.is_constant-650"><span class="linenos">650</span></a>            <span class="k">except</span> <span class="ne">ZeroDivisionError</span><span class="p">:</span>
</span><span id="Expr.is_constant-651"><a href="#Expr.is_constant-651"><span class="linenos">651</span></a>                <span class="n">a</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Expr.is_constant-652"><a href="#Expr.is_constant-652"><span class="linenos">652</span></a>            <span class="k">if</span> <span class="n">a</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">a</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">S</span><span class="o">.</span><span class="n">NaN</span><span class="p">:</span>
</span><span id="Expr.is_constant-653"><a href="#Expr.is_constant-653"><span class="linenos">653</span></a>                <span class="k">try</span><span class="p">:</span>
</span><span id="Expr.is_constant-654"><a href="#Expr.is_constant-654"><span class="linenos">654</span></a>                    <span class="n">b</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">free</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">free</span><span class="p">))),</span>
</span><span id="Expr.is_constant-655"><a href="#Expr.is_constant-655"><span class="linenos">655</span></a>                        <span class="n">simultaneous</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="Expr.is_constant-656"><a href="#Expr.is_constant-656"><span class="linenos">656</span></a>                    <span class="k">if</span> <span class="n">b</span> <span class="ow">is</span> <span class="n">S</span><span class="o">.</span><span class="n">NaN</span><span class="p">:</span>
</span><span id="Expr.is_constant-657"><a href="#Expr.is_constant-657"><span class="linenos">657</span></a>                        <span class="c1"># evaluation may succeed when substitution fails</span>
</span><span id="Expr.is_constant-658"><a href="#Expr.is_constant-658"><span class="linenos">658</span></a>                        <span class="n">b</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">_random</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="Expr.is_constant-659"><a href="#Expr.is_constant-659"><span class="linenos">659</span></a>                <span class="k">except</span> <span class="ne">ZeroDivisionError</span><span class="p">:</span>
</span><span id="Expr.is_constant-660"><a href="#Expr.is_constant-660"><span class="linenos">660</span></a>                    <span class="n">b</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Expr.is_constant-661"><a href="#Expr.is_constant-661"><span class="linenos">661</span></a>                <span class="k">if</span> <span class="n">b</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">b</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">S</span><span class="o">.</span><span class="n">NaN</span> <span class="ow">and</span> <span class="n">b</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
</span><span id="Expr.is_constant-662"><a href="#Expr.is_constant-662"><span class="linenos">662</span></a>                    <span class="k">return</span> <span class="kc">False</span>
</span><span id="Expr.is_constant-663"><a href="#Expr.is_constant-663"><span class="linenos">663</span></a>                <span class="c1"># try random real</span>
</span><span id="Expr.is_constant-664"><a href="#Expr.is_constant-664"><span class="linenos">664</span></a>                <span class="n">b</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">_random</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="Expr.is_constant-665"><a href="#Expr.is_constant-665"><span class="linenos">665</span></a>                <span class="k">if</span> <span class="n">b</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">b</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">S</span><span class="o">.</span><span class="n">NaN</span> <span class="ow">and</span> <span class="n">b</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
</span><span id="Expr.is_constant-666"><a href="#Expr.is_constant-666"><span class="linenos">666</span></a>                    <span class="k">return</span> <span class="kc">False</span>
</span><span id="Expr.is_constant-667"><a href="#Expr.is_constant-667"><span class="linenos">667</span></a>                <span class="c1"># try random complex</span>
</span><span id="Expr.is_constant-668"><a href="#Expr.is_constant-668"><span class="linenos">668</span></a>                <span class="n">b</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">_random</span><span class="p">()</span>
</span><span id="Expr.is_constant-669"><a href="#Expr.is_constant-669"><span class="linenos">669</span></a>                <span class="k">if</span> <span class="n">b</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">b</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">S</span><span class="o">.</span><span class="n">NaN</span><span class="p">:</span>
</span><span id="Expr.is_constant-670"><a href="#Expr.is_constant-670"><span class="linenos">670</span></a>                    <span class="k">if</span> <span class="n">b</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
</span><span id="Expr.is_constant-671"><a href="#Expr.is_constant-671"><span class="linenos">671</span></a>                        <span class="k">return</span> <span class="kc">False</span>
</span><span id="Expr.is_constant-672"><a href="#Expr.is_constant-672"><span class="linenos">672</span></a>                    <span class="n">failing_number</span> <span class="o">=</span> <span class="n">a</span> <span class="k">if</span> <span class="n">a</span><span class="o">.</span><span class="n">is_number</span> <span class="k">else</span> <span class="n">b</span>
</span><span id="Expr.is_constant-673"><a href="#Expr.is_constant-673"><span class="linenos">673</span></a>
</span><span id="Expr.is_constant-674"><a href="#Expr.is_constant-674"><span class="linenos">674</span></a>        <span class="c1"># now we will test each wrt symbol (or all free symbols) to see if the</span>
</span><span id="Expr.is_constant-675"><a href="#Expr.is_constant-675"><span class="linenos">675</span></a>        <span class="c1"># expression depends on them or not using differentiation. This is</span>
</span><span id="Expr.is_constant-676"><a href="#Expr.is_constant-676"><span class="linenos">676</span></a>        <span class="c1"># not sufficient for all expressions, however, so we don&#39;t return</span>
</span><span id="Expr.is_constant-677"><a href="#Expr.is_constant-677"><span class="linenos">677</span></a>        <span class="c1"># False if we get a derivative other than 0 with free symbols.</span>
</span><span id="Expr.is_constant-678"><a href="#Expr.is_constant-678"><span class="linenos">678</span></a>        <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">wrt_number</span><span class="p">:</span>
</span><span id="Expr.is_constant-679"><a href="#Expr.is_constant-679"><span class="linenos">679</span></a>            <span class="n">deriv</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
</span><span id="Expr.is_constant-680"><a href="#Expr.is_constant-680"><span class="linenos">680</span></a>            <span class="k">if</span> <span class="n">simplify</span><span class="p">:</span>
</span><span id="Expr.is_constant-681"><a href="#Expr.is_constant-681"><span class="linenos">681</span></a>                <span class="n">deriv</span> <span class="o">=</span> <span class="n">deriv</span><span class="o">.</span><span class="n">simplify</span><span class="p">()</span>
</span><span id="Expr.is_constant-682"><a href="#Expr.is_constant-682"><span class="linenos">682</span></a>            <span class="k">if</span> <span class="n">deriv</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Expr.is_constant-683"><a href="#Expr.is_constant-683"><span class="linenos">683</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">pure_complex</span><span class="p">(</span><span class="n">deriv</span><span class="p">,</span> <span class="n">or_real</span><span class="o">=</span><span class="kc">True</span><span class="p">)):</span>
</span><span id="Expr.is_constant-684"><a href="#Expr.is_constant-684"><span class="linenos">684</span></a>                    <span class="k">if</span> <span class="n">flags</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;failing_number&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
</span><span id="Expr.is_constant-685"><a href="#Expr.is_constant-685"><span class="linenos">685</span></a>                        <span class="k">return</span> <span class="n">failing_number</span>
</span><span id="Expr.is_constant-686"><a href="#Expr.is_constant-686"><span class="linenos">686</span></a>                <span class="k">return</span> <span class="kc">False</span>
</span><span id="Expr.is_constant-687"><a href="#Expr.is_constant-687"><span class="linenos">687</span></a>        <span class="n">cd</span> <span class="o">=</span> <span class="n">check_denominator_zeros</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="Expr.is_constant-688"><a href="#Expr.is_constant-688"><span class="linenos">688</span></a>        <span class="k">if</span> <span class="n">cd</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="Expr.is_constant-689"><a href="#Expr.is_constant-689"><span class="linenos">689</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="Expr.is_constant-690"><a href="#Expr.is_constant-690"><span class="linenos">690</span></a>        <span class="k">elif</span> <span class="n">cd</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Expr.is_constant-691"><a href="#Expr.is_constant-691"><span class="linenos">691</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="Expr.is_constant-692"><a href="#Expr.is_constant-692"><span class="linenos">692</span></a>        <span class="k">return</span> <span class="kc">True</span>
</span></pre></div>


            <div class="docstring"><p>Return True if self is constant, False if not, or None if
the constancy could not be determined conclusively.</p>

<h1 id="explanation">Explanation</h1>

<p>If an expression has no free symbols then it is a constant. If
there are free symbols it is possible that the expression is a
constant, perhaps (but not necessarily) zero. To test such
expressions, a few strategies are tried:</p>

<p>1) numerical evaluation at two random points. If two such evaluations
give two different values and the values have a precision greater than
1 then self is not constant. If the evaluations agree or could not be
obtained with any precision, no decision is made. The numerical testing
is done only if <code>wrt</code> is different than the free symbols.</p>

<p>2) differentiation with respect to variables in 'wrt' (or all free
symbols if omitted) to see if the expression is constant or not. This
will not always lead to an expression that is zero even though an
expression is constant (see added test in test_expr.py). If
all derivatives are zero then self is constant with respect to the
given symbols.</p>

<p>3) finding out zeros of denominator expression with free_symbols.
It will not be constant if there are zeros. It gives more negative
answers for expression that are not constant.</p>

<p>If neither evaluation nor differentiation can prove the expression is
constant, None is returned unless two numerical values happened to be
the same and the flag <code>failing_number</code> is True -- in that case the
numerical value will be returned.</p>

<p>If flag simplify=False is passed, self will not be simplified;
the default is True since self should be simplified before testing.</p>

<h1 id="examples">Examples</h1>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">cos</span><span class="p">,</span> <span class="n">sin</span><span class="p">,</span> <span class="n">Sum</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">pi</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.abc</span> <span class="kn">import</span> <span class="n">a</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="o">.</span><span class="n">is_constant</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">S</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">is_constant</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Sum</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span><span class="o">.</span><span class="n">is_constant</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Sum</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span><span class="o">.</span><span class="n">is_constant</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Sum</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span><span class="o">.</span><span class="n">is_constant</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Sum</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span><span class="o">.</span><span class="n">is_constant</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Sum</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span><span class="o">.</span><span class="n">is_constant</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eq</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">a</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">a</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eq</span><span class="o">.</span><span class="n">is_constant</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eq</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">x</span><span class="p">:</span> <span class="n">pi</span><span class="p">,</span> <span class="n">a</span><span class="p">:</span> <span class="mi">2</span><span class="p">})</span> <span class="o">==</span> <span class="n">eq</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">x</span><span class="p">:</span> <span class="n">pi</span><span class="p">,</span> <span class="n">a</span><span class="p">:</span> <span class="mi">3</span><span class="p">})</span> <span class="o">==</span> <span class="mi">0</span>
<span class="go">True</span>
</code></pre>
</div>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="mi">0</span><span class="o">**</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">is_constant</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="o">.</span><span class="n">is_constant</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">is_constant</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">one</span> <span class="o">=</span> <span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">one</span><span class="o">.</span><span class="n">is_constant</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">((</span><span class="n">one</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">is_constant</span><span class="p">()</span> <span class="ow">in</span> <span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span> <span class="c1"># could be 0 or 1</span>
<span class="go">True</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="Expr.equals" class="classattr">
                                        <input id="Expr.equals-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">equals</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">other</span>, </span><span class="param"><span class="n">failing_expression</span><span class="o">=</span><span class="kc">False</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Expr.equals-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Expr.equals"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Expr.equals-694"><a href="#Expr.equals-694"><span class="linenos">694</span></a>    <span class="k">def</span> <span class="nf">equals</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">failing_expression</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="Expr.equals-695"><a href="#Expr.equals-695"><span class="linenos">695</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return True if self == other, False if it doesn&#39;t, or None. If</span>
</span><span id="Expr.equals-696"><a href="#Expr.equals-696"><span class="linenos">696</span></a><span class="sd">        failing_expression is True then the expression which did not simplify</span>
</span><span id="Expr.equals-697"><a href="#Expr.equals-697"><span class="linenos">697</span></a><span class="sd">        to a 0 will be returned instead of None.</span>
</span><span id="Expr.equals-698"><a href="#Expr.equals-698"><span class="linenos">698</span></a>
</span><span id="Expr.equals-699"><a href="#Expr.equals-699"><span class="linenos">699</span></a><span class="sd">        Explanation</span>
</span><span id="Expr.equals-700"><a href="#Expr.equals-700"><span class="linenos">700</span></a><span class="sd">        ===========</span>
</span><span id="Expr.equals-701"><a href="#Expr.equals-701"><span class="linenos">701</span></a>
</span><span id="Expr.equals-702"><a href="#Expr.equals-702"><span class="linenos">702</span></a><span class="sd">        If ``self`` is a Number (or complex number) that is not zero, then</span>
</span><span id="Expr.equals-703"><a href="#Expr.equals-703"><span class="linenos">703</span></a><span class="sd">        the result is False.</span>
</span><span id="Expr.equals-704"><a href="#Expr.equals-704"><span class="linenos">704</span></a>
</span><span id="Expr.equals-705"><a href="#Expr.equals-705"><span class="linenos">705</span></a><span class="sd">        If ``self`` is a number and has not evaluated to zero, evalf will be</span>
</span><span id="Expr.equals-706"><a href="#Expr.equals-706"><span class="linenos">706</span></a><span class="sd">        used to test whether the expression evaluates to zero. If it does so</span>
</span><span id="Expr.equals-707"><a href="#Expr.equals-707"><span class="linenos">707</span></a><span class="sd">        and the result has significance (i.e. the precision is either -1, for</span>
</span><span id="Expr.equals-708"><a href="#Expr.equals-708"><span class="linenos">708</span></a><span class="sd">        a Rational result, or is greater than 1) then the evalf value will be</span>
</span><span id="Expr.equals-709"><a href="#Expr.equals-709"><span class="linenos">709</span></a><span class="sd">        used to return True or False.</span>
</span><span id="Expr.equals-710"><a href="#Expr.equals-710"><span class="linenos">710</span></a>
</span><span id="Expr.equals-711"><a href="#Expr.equals-711"><span class="linenos">711</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Expr.equals-712"><a href="#Expr.equals-712"><span class="linenos">712</span></a>        <span class="kn">from</span> <span class="nn">sympy.simplify.simplify</span> <span class="kn">import</span> <span class="n">nsimplify</span><span class="p">,</span> <span class="n">simplify</span>
</span><span id="Expr.equals-713"><a href="#Expr.equals-713"><span class="linenos">713</span></a>        <span class="kn">from</span> <span class="nn">sympy.solvers.solvers</span> <span class="kn">import</span> <span class="n">solve</span>
</span><span id="Expr.equals-714"><a href="#Expr.equals-714"><span class="linenos">714</span></a>        <span class="kn">from</span> <span class="nn">sympy.polys.polyerrors</span> <span class="kn">import</span> <span class="n">NotAlgebraic</span>
</span><span id="Expr.equals-715"><a href="#Expr.equals-715"><span class="linenos">715</span></a>        <span class="kn">from</span> <span class="nn">sympy.polys.numberfields</span> <span class="kn">import</span> <span class="n">minimal_polynomial</span>
</span><span id="Expr.equals-716"><a href="#Expr.equals-716"><span class="linenos">716</span></a>
</span><span id="Expr.equals-717"><a href="#Expr.equals-717"><span class="linenos">717</span></a>        <span class="n">other</span> <span class="o">=</span> <span class="n">sympify</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
</span><span id="Expr.equals-718"><a href="#Expr.equals-718"><span class="linenos">718</span></a>        <span class="k">if</span> <span class="bp">self</span> <span class="o">==</span> <span class="n">other</span><span class="p">:</span>
</span><span id="Expr.equals-719"><a href="#Expr.equals-719"><span class="linenos">719</span></a>            <span class="k">return</span> <span class="kc">True</span>
</span><span id="Expr.equals-720"><a href="#Expr.equals-720"><span class="linenos">720</span></a>
</span><span id="Expr.equals-721"><a href="#Expr.equals-721"><span class="linenos">721</span></a>        <span class="c1"># they aren&#39;t the same so see if we can make the difference 0;</span>
</span><span id="Expr.equals-722"><a href="#Expr.equals-722"><span class="linenos">722</span></a>        <span class="c1"># don&#39;t worry about doing simplification steps one at a time</span>
</span><span id="Expr.equals-723"><a href="#Expr.equals-723"><span class="linenos">723</span></a>        <span class="c1"># because if the expression ever goes to 0 then the subsequent</span>
</span><span id="Expr.equals-724"><a href="#Expr.equals-724"><span class="linenos">724</span></a>        <span class="c1"># simplification steps that are done will be very fast.</span>
</span><span id="Expr.equals-725"><a href="#Expr.equals-725"><span class="linenos">725</span></a>        <span class="n">diff</span> <span class="o">=</span> <span class="n">factor_terms</span><span class="p">(</span><span class="n">simplify</span><span class="p">(</span><span class="bp">self</span> <span class="o">-</span> <span class="n">other</span><span class="p">),</span> <span class="n">radical</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="Expr.equals-726"><a href="#Expr.equals-726"><span class="linenos">726</span></a>
</span><span id="Expr.equals-727"><a href="#Expr.equals-727"><span class="linenos">727</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">diff</span><span class="p">:</span>
</span><span id="Expr.equals-728"><a href="#Expr.equals-728"><span class="linenos">728</span></a>            <span class="k">return</span> <span class="kc">True</span>
</span><span id="Expr.equals-729"><a href="#Expr.equals-729"><span class="linenos">729</span></a>
</span><span id="Expr.equals-730"><a href="#Expr.equals-730"><span class="linenos">730</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">diff</span><span class="o">.</span><span class="n">has</span><span class="p">(</span><span class="n">Add</span><span class="p">,</span> <span class="n">Mod</span><span class="p">):</span>
</span><span id="Expr.equals-731"><a href="#Expr.equals-731"><span class="linenos">731</span></a>            <span class="c1"># if there is no expanding to be done after simplifying</span>
</span><span id="Expr.equals-732"><a href="#Expr.equals-732"><span class="linenos">732</span></a>            <span class="c1"># then this can&#39;t be a zero</span>
</span><span id="Expr.equals-733"><a href="#Expr.equals-733"><span class="linenos">733</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="Expr.equals-734"><a href="#Expr.equals-734"><span class="linenos">734</span></a>
</span><span id="Expr.equals-735"><a href="#Expr.equals-735"><span class="linenos">735</span></a>        <span class="n">factors</span> <span class="o">=</span> <span class="n">diff</span><span class="o">.</span><span class="n">as_coeff_mul</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Expr.equals-736"><a href="#Expr.equals-736"><span class="linenos">736</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">factors</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># avoid infinity recursion</span>
</span><span id="Expr.equals-737"><a href="#Expr.equals-737"><span class="linenos">737</span></a>            <span class="n">fac_zero</span> <span class="o">=</span> <span class="p">[</span><span class="n">fac</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="k">for</span> <span class="n">fac</span> <span class="ow">in</span> <span class="n">factors</span><span class="p">]</span>
</span><span id="Expr.equals-738"><a href="#Expr.equals-738"><span class="linenos">738</span></a>            <span class="k">if</span> <span class="kc">None</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">fac_zero</span><span class="p">:</span>  <span class="c1"># every part can be decided</span>
</span><span id="Expr.equals-739"><a href="#Expr.equals-739"><span class="linenos">739</span></a>                <span class="k">return</span> <span class="nb">any</span><span class="p">(</span><span class="n">fac_zero</span><span class="p">)</span>
</span><span id="Expr.equals-740"><a href="#Expr.equals-740"><span class="linenos">740</span></a>
</span><span id="Expr.equals-741"><a href="#Expr.equals-741"><span class="linenos">741</span></a>        <span class="n">constant</span> <span class="o">=</span> <span class="n">diff</span><span class="o">.</span><span class="n">is_constant</span><span class="p">(</span><span class="n">simplify</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">failing_number</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="Expr.equals-742"><a href="#Expr.equals-742"><span class="linenos">742</span></a>
</span><span id="Expr.equals-743"><a href="#Expr.equals-743"><span class="linenos">743</span></a>        <span class="k">if</span> <span class="n">constant</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
</span><span id="Expr.equals-744"><a href="#Expr.equals-744"><span class="linenos">744</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="Expr.equals-745"><a href="#Expr.equals-745"><span class="linenos">745</span></a>
</span><span id="Expr.equals-746"><a href="#Expr.equals-746"><span class="linenos">746</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">diff</span><span class="o">.</span><span class="n">is_number</span><span class="p">:</span>
</span><span id="Expr.equals-747"><a href="#Expr.equals-747"><span class="linenos">747</span></a>            <span class="k">if</span> <span class="n">constant</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Expr.equals-748"><a href="#Expr.equals-748"><span class="linenos">748</span></a>                <span class="c1"># e.g. unless the right simplification is done, a symbolic</span>
</span><span id="Expr.equals-749"><a href="#Expr.equals-749"><span class="linenos">749</span></a>                <span class="c1"># zero is possible (see expression of issue 6829: without</span>
</span><span id="Expr.equals-750"><a href="#Expr.equals-750"><span class="linenos">750</span></a>                <span class="c1"># simplification constant will be None).</span>
</span><span id="Expr.equals-751"><a href="#Expr.equals-751"><span class="linenos">751</span></a>                <span class="k">return</span>
</span><span id="Expr.equals-752"><a href="#Expr.equals-752"><span class="linenos">752</span></a>
</span><span id="Expr.equals-753"><a href="#Expr.equals-753"><span class="linenos">753</span></a>        <span class="k">if</span> <span class="n">constant</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="Expr.equals-754"><a href="#Expr.equals-754"><span class="linenos">754</span></a>            <span class="c1"># this gives a number whether there are free symbols or not</span>
</span><span id="Expr.equals-755"><a href="#Expr.equals-755"><span class="linenos">755</span></a>            <span class="n">ndiff</span> <span class="o">=</span> <span class="n">diff</span><span class="o">.</span><span class="n">_random</span><span class="p">()</span>
</span><span id="Expr.equals-756"><a href="#Expr.equals-756"><span class="linenos">756</span></a>            <span class="c1"># is_comparable will work whether the result is real</span>
</span><span id="Expr.equals-757"><a href="#Expr.equals-757"><span class="linenos">757</span></a>            <span class="c1"># or complex; it could be None, however.</span>
</span><span id="Expr.equals-758"><a href="#Expr.equals-758"><span class="linenos">758</span></a>            <span class="k">if</span> <span class="n">ndiff</span> <span class="ow">and</span> <span class="n">ndiff</span><span class="o">.</span><span class="n">is_comparable</span><span class="p">:</span>
</span><span id="Expr.equals-759"><a href="#Expr.equals-759"><span class="linenos">759</span></a>                <span class="k">return</span> <span class="kc">False</span>
</span><span id="Expr.equals-760"><a href="#Expr.equals-760"><span class="linenos">760</span></a>
</span><span id="Expr.equals-761"><a href="#Expr.equals-761"><span class="linenos">761</span></a>        <span class="c1"># sometimes we can use a simplified result to give a clue as to</span>
</span><span id="Expr.equals-762"><a href="#Expr.equals-762"><span class="linenos">762</span></a>        <span class="c1"># what the expression should be; if the expression is *not* zero</span>
</span><span id="Expr.equals-763"><a href="#Expr.equals-763"><span class="linenos">763</span></a>        <span class="c1"># then we should have been able to compute that and so now</span>
</span><span id="Expr.equals-764"><a href="#Expr.equals-764"><span class="linenos">764</span></a>        <span class="c1"># we can just consider the cases where the approximation appears</span>
</span><span id="Expr.equals-765"><a href="#Expr.equals-765"><span class="linenos">765</span></a>        <span class="c1"># to be zero -- we try to prove it via minimal_polynomial.</span>
</span><span id="Expr.equals-766"><a href="#Expr.equals-766"><span class="linenos">766</span></a>        <span class="c1">#</span>
</span><span id="Expr.equals-767"><a href="#Expr.equals-767"><span class="linenos">767</span></a>        <span class="c1"># removed</span>
</span><span id="Expr.equals-768"><a href="#Expr.equals-768"><span class="linenos">768</span></a>        <span class="c1"># ns = nsimplify(diff)</span>
</span><span id="Expr.equals-769"><a href="#Expr.equals-769"><span class="linenos">769</span></a>        <span class="c1"># if diff.is_number and (not ns or ns == diff):</span>
</span><span id="Expr.equals-770"><a href="#Expr.equals-770"><span class="linenos">770</span></a>        <span class="c1">#</span>
</span><span id="Expr.equals-771"><a href="#Expr.equals-771"><span class="linenos">771</span></a>        <span class="c1"># The thought was that if it nsimplifies to 0 that&#39;s a sure sign</span>
</span><span id="Expr.equals-772"><a href="#Expr.equals-772"><span class="linenos">772</span></a>        <span class="c1"># to try the following to prove it; or if it changed but wasn&#39;t</span>
</span><span id="Expr.equals-773"><a href="#Expr.equals-773"><span class="linenos">773</span></a>        <span class="c1"># zero that might be a sign that it&#39;s not going to be easy to</span>
</span><span id="Expr.equals-774"><a href="#Expr.equals-774"><span class="linenos">774</span></a>        <span class="c1"># prove. But tests seem to be working without that logic.</span>
</span><span id="Expr.equals-775"><a href="#Expr.equals-775"><span class="linenos">775</span></a>        <span class="c1">#</span>
</span><span id="Expr.equals-776"><a href="#Expr.equals-776"><span class="linenos">776</span></a>        <span class="k">if</span> <span class="n">diff</span><span class="o">.</span><span class="n">is_number</span><span class="p">:</span>
</span><span id="Expr.equals-777"><a href="#Expr.equals-777"><span class="linenos">777</span></a>            <span class="c1"># try to prove via self-consistency</span>
</span><span id="Expr.equals-778"><a href="#Expr.equals-778"><span class="linenos">778</span></a>            <span class="n">surds</span> <span class="o">=</span> <span class="p">[</span><span class="n">s</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">diff</span><span class="o">.</span><span class="n">atoms</span><span class="p">(</span><span class="n">Pow</span><span class="p">)</span> <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">is_Integer</span><span class="p">]</span>
</span><span id="Expr.equals-779"><a href="#Expr.equals-779"><span class="linenos">779</span></a>            <span class="c1"># it seems to work better to try big ones first</span>
</span><span id="Expr.equals-780"><a href="#Expr.equals-780"><span class="linenos">780</span></a>            <span class="n">surds</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="o">-</span><span class="n">x</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="Expr.equals-781"><a href="#Expr.equals-781"><span class="linenos">781</span></a>            <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">surds</span><span class="p">:</span>
</span><span id="Expr.equals-782"><a href="#Expr.equals-782"><span class="linenos">782</span></a>                <span class="k">try</span><span class="p">:</span>
</span><span id="Expr.equals-783"><a href="#Expr.equals-783"><span class="linenos">783</span></a>                    <span class="c1"># simplify is False here -- this expression has already</span>
</span><span id="Expr.equals-784"><a href="#Expr.equals-784"><span class="linenos">784</span></a>                    <span class="c1"># been identified as being hard to identify as zero;</span>
</span><span id="Expr.equals-785"><a href="#Expr.equals-785"><span class="linenos">785</span></a>                    <span class="c1"># we will handle the checking ourselves using nsimplify</span>
</span><span id="Expr.equals-786"><a href="#Expr.equals-786"><span class="linenos">786</span></a>                    <span class="c1"># to see if we are in the right ballpark or not and if so</span>
</span><span id="Expr.equals-787"><a href="#Expr.equals-787"><span class="linenos">787</span></a>                    <span class="c1"># *then* the simplification will be attempted.</span>
</span><span id="Expr.equals-788"><a href="#Expr.equals-788"><span class="linenos">788</span></a>                    <span class="n">sol</span> <span class="o">=</span> <span class="n">solve</span><span class="p">(</span><span class="n">diff</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">simplify</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="Expr.equals-789"><a href="#Expr.equals-789"><span class="linenos">789</span></a>                    <span class="k">if</span> <span class="n">sol</span><span class="p">:</span>
</span><span id="Expr.equals-790"><a href="#Expr.equals-790"><span class="linenos">790</span></a>                        <span class="k">if</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">sol</span><span class="p">:</span>
</span><span id="Expr.equals-791"><a href="#Expr.equals-791"><span class="linenos">791</span></a>                            <span class="c1"># the self-consistent result is present</span>
</span><span id="Expr.equals-792"><a href="#Expr.equals-792"><span class="linenos">792</span></a>                            <span class="k">return</span> <span class="kc">True</span>
</span><span id="Expr.equals-793"><a href="#Expr.equals-793"><span class="linenos">793</span></a>                        <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="n">si</span><span class="o">.</span><span class="n">is_Integer</span> <span class="k">for</span> <span class="n">si</span> <span class="ow">in</span> <span class="n">sol</span><span class="p">):</span>
</span><span id="Expr.equals-794"><a href="#Expr.equals-794"><span class="linenos">794</span></a>                            <span class="c1"># perfect powers are removed at instantiation</span>
</span><span id="Expr.equals-795"><a href="#Expr.equals-795"><span class="linenos">795</span></a>                            <span class="c1"># so surd s cannot be an integer</span>
</span><span id="Expr.equals-796"><a href="#Expr.equals-796"><span class="linenos">796</span></a>                            <span class="k">return</span> <span class="kc">False</span>
</span><span id="Expr.equals-797"><a href="#Expr.equals-797"><span class="linenos">797</span></a>                        <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">is_algebraic</span> <span class="ow">is</span> <span class="kc">False</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">sol</span><span class="p">):</span>
</span><span id="Expr.equals-798"><a href="#Expr.equals-798"><span class="linenos">798</span></a>                            <span class="c1"># a surd is algebraic</span>
</span><span id="Expr.equals-799"><a href="#Expr.equals-799"><span class="linenos">799</span></a>                            <span class="k">return</span> <span class="kc">False</span>
</span><span id="Expr.equals-800"><a href="#Expr.equals-800"><span class="linenos">800</span></a>                        <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">si</span> <span class="ow">in</span> <span class="n">surds</span> <span class="k">for</span> <span class="n">si</span> <span class="ow">in</span> <span class="n">sol</span><span class="p">):</span>
</span><span id="Expr.equals-801"><a href="#Expr.equals-801"><span class="linenos">801</span></a>                            <span class="c1"># it wasn&#39;t equal to s but it is in surds</span>
</span><span id="Expr.equals-802"><a href="#Expr.equals-802"><span class="linenos">802</span></a>                            <span class="c1"># and different surds are not equal</span>
</span><span id="Expr.equals-803"><a href="#Expr.equals-803"><span class="linenos">803</span></a>                            <span class="k">return</span> <span class="kc">False</span>
</span><span id="Expr.equals-804"><a href="#Expr.equals-804"><span class="linenos">804</span></a>                        <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">nsimplify</span><span class="p">(</span><span class="n">s</span> <span class="o">-</span> <span class="n">si</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span>
</span><span id="Expr.equals-805"><a href="#Expr.equals-805"><span class="linenos">805</span></a>                                <span class="n">simplify</span><span class="p">(</span><span class="n">s</span> <span class="o">-</span> <span class="n">si</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">si</span> <span class="ow">in</span> <span class="n">sol</span><span class="p">):</span>
</span><span id="Expr.equals-806"><a href="#Expr.equals-806"><span class="linenos">806</span></a>                            <span class="k">return</span> <span class="kc">True</span>
</span><span id="Expr.equals-807"><a href="#Expr.equals-807"><span class="linenos">807</span></a>                        <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">is_real</span><span class="p">:</span>
</span><span id="Expr.equals-808"><a href="#Expr.equals-808"><span class="linenos">808</span></a>                            <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">nsimplify</span><span class="p">(</span><span class="n">si</span><span class="p">,</span> <span class="p">[</span><span class="n">s</span><span class="p">])</span> <span class="o">==</span> <span class="n">s</span> <span class="ow">and</span> <span class="n">simplify</span><span class="p">(</span><span class="n">si</span><span class="p">)</span> <span class="o">==</span> <span class="n">s</span>
</span><span id="Expr.equals-809"><a href="#Expr.equals-809"><span class="linenos">809</span></a>                                    <span class="k">for</span> <span class="n">si</span> <span class="ow">in</span> <span class="n">sol</span><span class="p">):</span>
</span><span id="Expr.equals-810"><a href="#Expr.equals-810"><span class="linenos">810</span></a>                                <span class="k">return</span> <span class="kc">True</span>
</span><span id="Expr.equals-811"><a href="#Expr.equals-811"><span class="linenos">811</span></a>                <span class="k">except</span> <span class="ne">NotImplementedError</span><span class="p">:</span>
</span><span id="Expr.equals-812"><a href="#Expr.equals-812"><span class="linenos">812</span></a>                    <span class="k">pass</span>
</span><span id="Expr.equals-813"><a href="#Expr.equals-813"><span class="linenos">813</span></a>
</span><span id="Expr.equals-814"><a href="#Expr.equals-814"><span class="linenos">814</span></a>            <span class="c1"># try to prove with minimal_polynomial but know when</span>
</span><span id="Expr.equals-815"><a href="#Expr.equals-815"><span class="linenos">815</span></a>            <span class="c1"># *not* to use this or else it can take a long time. e.g. issue 8354</span>
</span><span id="Expr.equals-816"><a href="#Expr.equals-816"><span class="linenos">816</span></a>            <span class="k">if</span> <span class="kc">True</span><span class="p">:</span>  <span class="c1"># change True to condition that assures non-hang</span>
</span><span id="Expr.equals-817"><a href="#Expr.equals-817"><span class="linenos">817</span></a>                <span class="k">try</span><span class="p">:</span>
</span><span id="Expr.equals-818"><a href="#Expr.equals-818"><span class="linenos">818</span></a>                    <span class="n">mp</span> <span class="o">=</span> <span class="n">minimal_polynomial</span><span class="p">(</span><span class="n">diff</span><span class="p">)</span>
</span><span id="Expr.equals-819"><a href="#Expr.equals-819"><span class="linenos">819</span></a>                    <span class="k">if</span> <span class="n">mp</span><span class="o">.</span><span class="n">is_Symbol</span><span class="p">:</span>
</span><span id="Expr.equals-820"><a href="#Expr.equals-820"><span class="linenos">820</span></a>                        <span class="k">return</span> <span class="kc">True</span>
</span><span id="Expr.equals-821"><a href="#Expr.equals-821"><span class="linenos">821</span></a>                    <span class="k">return</span> <span class="kc">False</span>
</span><span id="Expr.equals-822"><a href="#Expr.equals-822"><span class="linenos">822</span></a>                <span class="k">except</span> <span class="p">(</span><span class="n">NotAlgebraic</span><span class="p">,</span> <span class="ne">NotImplementedError</span><span class="p">):</span>
</span><span id="Expr.equals-823"><a href="#Expr.equals-823"><span class="linenos">823</span></a>                    <span class="k">pass</span>
</span><span id="Expr.equals-824"><a href="#Expr.equals-824"><span class="linenos">824</span></a>
</span><span id="Expr.equals-825"><a href="#Expr.equals-825"><span class="linenos">825</span></a>        <span class="c1"># diff has not simplified to zero; constant is either None, True</span>
</span><span id="Expr.equals-826"><a href="#Expr.equals-826"><span class="linenos">826</span></a>        <span class="c1"># or the number with significance (is_comparable) that was randomly</span>
</span><span id="Expr.equals-827"><a href="#Expr.equals-827"><span class="linenos">827</span></a>        <span class="c1"># calculated twice as the same value.</span>
</span><span id="Expr.equals-828"><a href="#Expr.equals-828"><span class="linenos">828</span></a>        <span class="k">if</span> <span class="n">constant</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="n">constant</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Expr.equals-829"><a href="#Expr.equals-829"><span class="linenos">829</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="Expr.equals-830"><a href="#Expr.equals-830"><span class="linenos">830</span></a>
</span><span id="Expr.equals-831"><a href="#Expr.equals-831"><span class="linenos">831</span></a>        <span class="k">if</span> <span class="n">failing_expression</span><span class="p">:</span>
</span><span id="Expr.equals-832"><a href="#Expr.equals-832"><span class="linenos">832</span></a>            <span class="k">return</span> <span class="n">diff</span>
</span><span id="Expr.equals-833"><a href="#Expr.equals-833"><span class="linenos">833</span></a>        <span class="k">return</span> <span class="kc">None</span>
</span></pre></div>


            <div class="docstring"><p>Return True if self == other, False if it doesn't, or None. If
failing_expression is True then the expression which did not simplify
to a 0 will be returned instead of None.</p>

<h1 id="explanation">Explanation</h1>

<p>If <code>self</code> is a Number (or complex number) that is not zero, then
the result is False.</p>

<p>If <code>self</code> is a number and has not evaluated to zero, evalf will be
used to test whether the expression evaluates to zero. If it does so
and the result has significance (i.e. the precision is either -1, for
a Rational result, or is greater than 1) then the evalf value will be
used to return True or False.</p>
</div>


                            </div>
                            <div id="Expr.conjugate" class="classattr">
                                        <input id="Expr.conjugate-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">conjugate</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Expr.conjugate-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Expr.conjugate"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Expr.conjugate-995"><a href="#Expr.conjugate-995"><span class="linenos">995</span></a>    <span class="k">def</span> <span class="nf">conjugate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Expr.conjugate-996"><a href="#Expr.conjugate-996"><span class="linenos">996</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the complex conjugate of &#39;self&#39;.&quot;&quot;&quot;</span>
</span><span id="Expr.conjugate-997"><a href="#Expr.conjugate-997"><span class="linenos">997</span></a>        <span class="kn">from</span> <span class="nn">sympy.functions.elementary.complexes</span> <span class="kn">import</span> <span class="n">conjugate</span> <span class="k">as</span> <span class="n">c</span>
</span><span id="Expr.conjugate-998"><a href="#Expr.conjugate-998"><span class="linenos">998</span></a>        <span class="k">return</span> <span class="n">c</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Returns the complex conjugate of 'self'.</p>
</div>


                            </div>
                            <div id="Expr.dir" class="classattr">
                                        <input id="Expr.dir-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">dir</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">x</span>, </span><span class="param"><span class="n">cdir</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Expr.dir-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Expr.dir"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Expr.dir-1000"><a href="#Expr.dir-1000"><span class="linenos">1000</span></a>    <span class="k">def</span> <span class="nf">dir</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">cdir</span><span class="p">):</span>
</span><span id="Expr.dir-1001"><a href="#Expr.dir-1001"><span class="linenos">1001</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_zero</span><span class="p">:</span>
</span><span id="Expr.dir-1002"><a href="#Expr.dir-1002"><span class="linenos">1002</span></a>            <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">Zero</span>
</span><span id="Expr.dir-1003"><a href="#Expr.dir-1003"><span class="linenos">1003</span></a>        <span class="kn">from</span> <span class="nn">sympy.functions.elementary.exponential</span> <span class="kn">import</span> <span class="n">log</span>
</span><span id="Expr.dir-1004"><a href="#Expr.dir-1004"><span class="linenos">1004</span></a>        <span class="n">minexp</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">Zero</span>
</span><span id="Expr.dir-1005"><a href="#Expr.dir-1005"><span class="linenos">1005</span></a>        <span class="n">arg</span> <span class="o">=</span> <span class="bp">self</span>
</span><span id="Expr.dir-1006"><a href="#Expr.dir-1006"><span class="linenos">1006</span></a>        <span class="k">while</span> <span class="n">arg</span><span class="p">:</span>
</span><span id="Expr.dir-1007"><a href="#Expr.dir-1007"><span class="linenos">1007</span></a>            <span class="n">minexp</span> <span class="o">+=</span> <span class="n">S</span><span class="o">.</span><span class="n">One</span>
</span><span id="Expr.dir-1008"><a href="#Expr.dir-1008"><span class="linenos">1008</span></a>            <span class="n">arg</span> <span class="o">=</span> <span class="n">arg</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span><span id="Expr.dir-1009"><a href="#Expr.dir-1009"><span class="linenos">1009</span></a>            <span class="n">coeff</span> <span class="o">=</span> <span class="n">arg</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="Expr.dir-1010"><a href="#Expr.dir-1010"><span class="linenos">1010</span></a>            <span class="k">if</span> <span class="n">coeff</span> <span class="ow">is</span> <span class="n">S</span><span class="o">.</span><span class="n">NaN</span><span class="p">:</span>
</span><span id="Expr.dir-1011"><a href="#Expr.dir-1011"><span class="linenos">1011</span></a>                <span class="n">coeff</span> <span class="o">=</span> <span class="n">arg</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="Expr.dir-1012"><a href="#Expr.dir-1012"><span class="linenos">1012</span></a>            <span class="k">if</span> <span class="n">coeff</span> <span class="ow">is</span> <span class="n">S</span><span class="o">.</span><span class="n">ComplexInfinity</span><span class="p">:</span>
</span><span id="Expr.dir-1013"><a href="#Expr.dir-1013"><span class="linenos">1013</span></a>                <span class="k">try</span><span class="p">:</span>
</span><span id="Expr.dir-1014"><a href="#Expr.dir-1014"><span class="linenos">1014</span></a>                    <span class="n">coeff</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">arg</span><span class="o">.</span><span class="n">leadterm</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span><span id="Expr.dir-1015"><a href="#Expr.dir-1015"><span class="linenos">1015</span></a>                    <span class="k">if</span> <span class="n">coeff</span><span class="o">.</span><span class="n">has</span><span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)):</span>
</span><span id="Expr.dir-1016"><a href="#Expr.dir-1016"><span class="linenos">1016</span></a>                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">()</span>
</span><span id="Expr.dir-1017"><a href="#Expr.dir-1017"><span class="linenos">1017</span></a>                <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
</span><span id="Expr.dir-1018"><a href="#Expr.dir-1018"><span class="linenos">1018</span></a>                    <span class="n">coeff</span> <span class="o">=</span> <span class="n">arg</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="Expr.dir-1019"><a href="#Expr.dir-1019"><span class="linenos">1019</span></a>            <span class="k">if</span> <span class="n">coeff</span> <span class="o">!=</span> <span class="n">S</span><span class="o">.</span><span class="n">Zero</span><span class="p">:</span>
</span><span id="Expr.dir-1020"><a href="#Expr.dir-1020"><span class="linenos">1020</span></a>                <span class="k">break</span>
</span><span id="Expr.dir-1021"><a href="#Expr.dir-1021"><span class="linenos">1021</span></a>        <span class="k">return</span> <span class="n">coeff</span><span class="o">*</span><span class="n">cdir</span><span class="o">**</span><span class="n">minexp</span>
</span></pre></div>


    

                            </div>
                            <div id="Expr.transpose" class="classattr">
                                        <input id="Expr.transpose-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">transpose</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Expr.transpose-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Expr.transpose"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Expr.transpose-1032"><a href="#Expr.transpose-1032"><span class="linenos">1032</span></a>    <span class="k">def</span> <span class="nf">transpose</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Expr.transpose-1033"><a href="#Expr.transpose-1033"><span class="linenos">1033</span></a>        <span class="kn">from</span> <span class="nn">sympy.functions.elementary.complexes</span> <span class="kn">import</span> <span class="n">transpose</span>
</span><span id="Expr.transpose-1034"><a href="#Expr.transpose-1034"><span class="linenos">1034</span></a>        <span class="k">return</span> <span class="n">transpose</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="Expr.adjoint" class="classattr">
                                        <input id="Expr.adjoint-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">adjoint</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Expr.adjoint-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Expr.adjoint"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Expr.adjoint-1049"><a href="#Expr.adjoint-1049"><span class="linenos">1049</span></a>    <span class="k">def</span> <span class="nf">adjoint</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Expr.adjoint-1050"><a href="#Expr.adjoint-1050"><span class="linenos">1050</span></a>        <span class="kn">from</span> <span class="nn">sympy.functions.elementary.complexes</span> <span class="kn">import</span> <span class="n">adjoint</span>
</span><span id="Expr.adjoint-1051"><a href="#Expr.adjoint-1051"><span class="linenos">1051</span></a>        <span class="k">return</span> <span class="n">adjoint</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="Expr.as_ordered_factors" class="classattr">
                                        <input id="Expr.as_ordered_factors-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">as_ordered_factors</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">order</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Expr.as_ordered_factors-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Expr.as_ordered_factors"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Expr.as_ordered_factors-1090"><a href="#Expr.as_ordered_factors-1090"><span class="linenos">1090</span></a>    <span class="k">def</span> <span class="nf">as_ordered_factors</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="Expr.as_ordered_factors-1091"><a href="#Expr.as_ordered_factors-1091"><span class="linenos">1091</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return list of ordered factors (if Mul) else [self].&quot;&quot;&quot;</span>
</span><span id="Expr.as_ordered_factors-1092"><a href="#Expr.as_ordered_factors-1092"><span class="linenos">1092</span></a>        <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Return list of ordered factors (if Mul) else [self].</p>
</div>


                            </div>
                            <div id="Expr.as_poly" class="classattr">
                                        <input id="Expr.as_poly-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">as_poly</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="o">*</span><span class="n">gens</span>, </span><span class="param"><span class="o">**</span><span class="n">args</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Expr.as_poly-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Expr.as_poly"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Expr.as_poly-1094"><a href="#Expr.as_poly-1094"><span class="linenos">1094</span></a>    <span class="k">def</span> <span class="nf">as_poly</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">):</span>
</span><span id="Expr.as_poly-1095"><a href="#Expr.as_poly-1095"><span class="linenos">1095</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Converts ``self`` to a polynomial or returns ``None``.</span>
</span><span id="Expr.as_poly-1096"><a href="#Expr.as_poly-1096"><span class="linenos">1096</span></a>
</span><span id="Expr.as_poly-1097"><a href="#Expr.as_poly-1097"><span class="linenos">1097</span></a><span class="sd">        Explanation</span>
</span><span id="Expr.as_poly-1098"><a href="#Expr.as_poly-1098"><span class="linenos">1098</span></a><span class="sd">        ===========</span>
</span><span id="Expr.as_poly-1099"><a href="#Expr.as_poly-1099"><span class="linenos">1099</span></a>
</span><span id="Expr.as_poly-1100"><a href="#Expr.as_poly-1100"><span class="linenos">1100</span></a><span class="sd">        &gt;&gt;&gt; from sympy import sin</span>
</span><span id="Expr.as_poly-1101"><a href="#Expr.as_poly-1101"><span class="linenos">1101</span></a><span class="sd">        &gt;&gt;&gt; from sympy.abc import x, y</span>
</span><span id="Expr.as_poly-1102"><a href="#Expr.as_poly-1102"><span class="linenos">1102</span></a>
</span><span id="Expr.as_poly-1103"><a href="#Expr.as_poly-1103"><span class="linenos">1103</span></a><span class="sd">        &gt;&gt;&gt; print((x**2 + x*y).as_poly())</span>
</span><span id="Expr.as_poly-1104"><a href="#Expr.as_poly-1104"><span class="linenos">1104</span></a><span class="sd">        Poly(x**2 + x*y, x, y, domain=&#39;ZZ&#39;)</span>
</span><span id="Expr.as_poly-1105"><a href="#Expr.as_poly-1105"><span class="linenos">1105</span></a>
</span><span id="Expr.as_poly-1106"><a href="#Expr.as_poly-1106"><span class="linenos">1106</span></a><span class="sd">        &gt;&gt;&gt; print((x**2 + x*y).as_poly(x, y))</span>
</span><span id="Expr.as_poly-1107"><a href="#Expr.as_poly-1107"><span class="linenos">1107</span></a><span class="sd">        Poly(x**2 + x*y, x, y, domain=&#39;ZZ&#39;)</span>
</span><span id="Expr.as_poly-1108"><a href="#Expr.as_poly-1108"><span class="linenos">1108</span></a>
</span><span id="Expr.as_poly-1109"><a href="#Expr.as_poly-1109"><span class="linenos">1109</span></a><span class="sd">        &gt;&gt;&gt; print((x**2 + sin(y)).as_poly(x, y))</span>
</span><span id="Expr.as_poly-1110"><a href="#Expr.as_poly-1110"><span class="linenos">1110</span></a><span class="sd">        None</span>
</span><span id="Expr.as_poly-1111"><a href="#Expr.as_poly-1111"><span class="linenos">1111</span></a>
</span><span id="Expr.as_poly-1112"><a href="#Expr.as_poly-1112"><span class="linenos">1112</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Expr.as_poly-1113"><a href="#Expr.as_poly-1113"><span class="linenos">1113</span></a>        <span class="kn">from</span> <span class="nn">sympy.polys.polyerrors</span> <span class="kn">import</span> <span class="n">PolynomialError</span><span class="p">,</span> <span class="n">GeneratorsNeeded</span>
</span><span id="Expr.as_poly-1114"><a href="#Expr.as_poly-1114"><span class="linenos">1114</span></a>        <span class="kn">from</span> <span class="nn">sympy.polys.polytools</span> <span class="kn">import</span> <span class="n">Poly</span>
</span><span id="Expr.as_poly-1115"><a href="#Expr.as_poly-1115"><span class="linenos">1115</span></a>
</span><span id="Expr.as_poly-1116"><a href="#Expr.as_poly-1116"><span class="linenos">1116</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="Expr.as_poly-1117"><a href="#Expr.as_poly-1117"><span class="linenos">1117</span></a>            <span class="n">poly</span> <span class="o">=</span> <span class="n">Poly</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">)</span>
</span><span id="Expr.as_poly-1118"><a href="#Expr.as_poly-1118"><span class="linenos">1118</span></a>
</span><span id="Expr.as_poly-1119"><a href="#Expr.as_poly-1119"><span class="linenos">1119</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">poly</span><span class="o">.</span><span class="n">is_Poly</span><span class="p">:</span>
</span><span id="Expr.as_poly-1120"><a href="#Expr.as_poly-1120"><span class="linenos">1120</span></a>                <span class="k">return</span> <span class="kc">None</span>
</span><span id="Expr.as_poly-1121"><a href="#Expr.as_poly-1121"><span class="linenos">1121</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Expr.as_poly-1122"><a href="#Expr.as_poly-1122"><span class="linenos">1122</span></a>                <span class="k">return</span> <span class="n">poly</span>
</span><span id="Expr.as_poly-1123"><a href="#Expr.as_poly-1123"><span class="linenos">1123</span></a>        <span class="k">except</span> <span class="p">(</span><span class="n">PolynomialError</span><span class="p">,</span> <span class="n">GeneratorsNeeded</span><span class="p">):</span>
</span><span id="Expr.as_poly-1124"><a href="#Expr.as_poly-1124"><span class="linenos">1124</span></a>            <span class="c1"># PolynomialError is caught for e.g. exp(x).as_poly(x)</span>
</span><span id="Expr.as_poly-1125"><a href="#Expr.as_poly-1125"><span class="linenos">1125</span></a>            <span class="c1"># GeneratorsNeeded is caught for e.g. S(2).as_poly()</span>
</span><span id="Expr.as_poly-1126"><a href="#Expr.as_poly-1126"><span class="linenos">1126</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span></pre></div>


            <div class="docstring"><p>Converts <code>self</code> to a polynomial or returns <code>None</code>.</p>

<h1 id="explanation">Explanation</h1>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">sin</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.abc</span> <span class="kn">import</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>
</code></pre>
</div>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">((</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">as_poly</span><span class="p">())</span>
<span class="go">Poly(x**2 + x*y, x, y, domain=&#39;ZZ&#39;)</span>
</code></pre>
</div>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">((</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">as_poly</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
<span class="go">Poly(x**2 + x*y, x, y, domain=&#39;ZZ&#39;)</span>
</code></pre>
</div>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">((</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">sin</span><span class="p">(</span><span class="n">y</span><span class="p">))</span><span class="o">.</span><span class="n">as_poly</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
<span class="go">None</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="Expr.as_ordered_terms" class="classattr">
                                        <input id="Expr.as_ordered_terms-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">as_ordered_terms</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">order</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="n">data</span><span class="o">=</span><span class="kc">False</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Expr.as_ordered_terms-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Expr.as_ordered_terms"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Expr.as_ordered_terms-1128"><a href="#Expr.as_ordered_terms-1128"><span class="linenos">1128</span></a>    <span class="k">def</span> <span class="nf">as_ordered_terms</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="Expr.as_ordered_terms-1129"><a href="#Expr.as_ordered_terms-1129"><span class="linenos">1129</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Expr.as_ordered_terms-1130"><a href="#Expr.as_ordered_terms-1130"><span class="linenos">1130</span></a><span class="sd">        Transform an expression to an ordered list of terms.</span>
</span><span id="Expr.as_ordered_terms-1131"><a href="#Expr.as_ordered_terms-1131"><span class="linenos">1131</span></a>
</span><span id="Expr.as_ordered_terms-1132"><a href="#Expr.as_ordered_terms-1132"><span class="linenos">1132</span></a><span class="sd">        Examples</span>
</span><span id="Expr.as_ordered_terms-1133"><a href="#Expr.as_ordered_terms-1133"><span class="linenos">1133</span></a><span class="sd">        ========</span>
</span><span id="Expr.as_ordered_terms-1134"><a href="#Expr.as_ordered_terms-1134"><span class="linenos">1134</span></a>
</span><span id="Expr.as_ordered_terms-1135"><a href="#Expr.as_ordered_terms-1135"><span class="linenos">1135</span></a><span class="sd">        &gt;&gt;&gt; from sympy import sin, cos</span>
</span><span id="Expr.as_ordered_terms-1136"><a href="#Expr.as_ordered_terms-1136"><span class="linenos">1136</span></a><span class="sd">        &gt;&gt;&gt; from sympy.abc import x</span>
</span><span id="Expr.as_ordered_terms-1137"><a href="#Expr.as_ordered_terms-1137"><span class="linenos">1137</span></a>
</span><span id="Expr.as_ordered_terms-1138"><a href="#Expr.as_ordered_terms-1138"><span class="linenos">1138</span></a><span class="sd">        &gt;&gt;&gt; (sin(x)**2*cos(x) + sin(x)**2 + 1).as_ordered_terms()</span>
</span><span id="Expr.as_ordered_terms-1139"><a href="#Expr.as_ordered_terms-1139"><span class="linenos">1139</span></a><span class="sd">        [sin(x)**2*cos(x), sin(x)**2, 1]</span>
</span><span id="Expr.as_ordered_terms-1140"><a href="#Expr.as_ordered_terms-1140"><span class="linenos">1140</span></a>
</span><span id="Expr.as_ordered_terms-1141"><a href="#Expr.as_ordered_terms-1141"><span class="linenos">1141</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Expr.as_ordered_terms-1142"><a href="#Expr.as_ordered_terms-1142"><span class="linenos">1142</span></a>
</span><span id="Expr.as_ordered_terms-1143"><a href="#Expr.as_ordered_terms-1143"><span class="linenos">1143</span></a>        <span class="kn">from</span> <span class="nn">.numbers</span> <span class="kn">import</span> <span class="n">Number</span><span class="p">,</span> <span class="n">NumberSymbol</span>
</span><span id="Expr.as_ordered_terms-1144"><a href="#Expr.as_ordered_terms-1144"><span class="linenos">1144</span></a>
</span><span id="Expr.as_ordered_terms-1145"><a href="#Expr.as_ordered_terms-1145"><span class="linenos">1145</span></a>        <span class="k">if</span> <span class="n">order</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_Add</span><span class="p">:</span>
</span><span id="Expr.as_ordered_terms-1146"><a href="#Expr.as_ordered_terms-1146"><span class="linenos">1146</span></a>            <span class="c1"># Spot the special case of Add(Number, Mul(Number, expr)) with the</span>
</span><span id="Expr.as_ordered_terms-1147"><a href="#Expr.as_ordered_terms-1147"><span class="linenos">1147</span></a>            <span class="c1"># first number positive and the second number negative</span>
</span><span id="Expr.as_ordered_terms-1148"><a href="#Expr.as_ordered_terms-1148"><span class="linenos">1148</span></a>            <span class="n">key</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="n">Number</span><span class="p">,</span> <span class="n">NumberSymbol</span><span class="p">))</span>
</span><span id="Expr.as_ordered_terms-1149"><a href="#Expr.as_ordered_terms-1149"><span class="linenos">1149</span></a>            <span class="n">add_args</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">Add</span><span class="o">.</span><span class="n">make_args</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span> <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">)</span>
</span><span id="Expr.as_ordered_terms-1150"><a href="#Expr.as_ordered_terms-1150"><span class="linenos">1150</span></a>            <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">add_args</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span>
</span><span id="Expr.as_ordered_terms-1151"><a href="#Expr.as_ordered_terms-1151"><span class="linenos">1151</span></a>                <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">add_args</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">(</span><span class="n">Number</span><span class="p">,</span> <span class="n">NumberSymbol</span><span class="p">))</span>
</span><span id="Expr.as_ordered_terms-1152"><a href="#Expr.as_ordered_terms-1152"><span class="linenos">1152</span></a>                <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">add_args</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">Mul</span><span class="p">)):</span>
</span><span id="Expr.as_ordered_terms-1153"><a href="#Expr.as_ordered_terms-1153"><span class="linenos">1153</span></a>                <span class="n">mul_args</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">Mul</span><span class="o">.</span><span class="n">make_args</span><span class="p">(</span><span class="n">add_args</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">)</span>
</span><span id="Expr.as_ordered_terms-1154"><a href="#Expr.as_ordered_terms-1154"><span class="linenos">1154</span></a>                <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">mul_args</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span>
</span><span id="Expr.as_ordered_terms-1155"><a href="#Expr.as_ordered_terms-1155"><span class="linenos">1155</span></a>                    <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mul_args</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Number</span><span class="p">)</span>
</span><span id="Expr.as_ordered_terms-1156"><a href="#Expr.as_ordered_terms-1156"><span class="linenos">1156</span></a>                    <span class="ow">and</span> <span class="n">add_args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">is_positive</span>
</span><span id="Expr.as_ordered_terms-1157"><a href="#Expr.as_ordered_terms-1157"><span class="linenos">1157</span></a>                    <span class="ow">and</span> <span class="n">mul_args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">is_negative</span><span class="p">):</span>
</span><span id="Expr.as_ordered_terms-1158"><a href="#Expr.as_ordered_terms-1158"><span class="linenos">1158</span></a>                    <span class="k">return</span> <span class="n">add_args</span>
</span><span id="Expr.as_ordered_terms-1159"><a href="#Expr.as_ordered_terms-1159"><span class="linenos">1159</span></a>
</span><span id="Expr.as_ordered_terms-1160"><a href="#Expr.as_ordered_terms-1160"><span class="linenos">1160</span></a>        <span class="n">key</span><span class="p">,</span> <span class="n">reverse</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_order</span><span class="p">(</span><span class="n">order</span><span class="p">)</span>
</span><span id="Expr.as_ordered_terms-1161"><a href="#Expr.as_ordered_terms-1161"><span class="linenos">1161</span></a>        <span class="n">terms</span><span class="p">,</span> <span class="n">gens</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">as_terms</span><span class="p">()</span>
</span><span id="Expr.as_ordered_terms-1162"><a href="#Expr.as_ordered_terms-1162"><span class="linenos">1162</span></a>
</span><span id="Expr.as_ordered_terms-1163"><a href="#Expr.as_ordered_terms-1163"><span class="linenos">1163</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">any</span><span class="p">(</span><span class="n">term</span><span class="o">.</span><span class="n">is_Order</span> <span class="k">for</span> <span class="n">term</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">terms</span><span class="p">):</span>
</span><span id="Expr.as_ordered_terms-1164"><a href="#Expr.as_ordered_terms-1164"><span class="linenos">1164</span></a>            <span class="n">ordered</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">terms</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="n">reverse</span><span class="p">)</span>
</span><span id="Expr.as_ordered_terms-1165"><a href="#Expr.as_ordered_terms-1165"><span class="linenos">1165</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Expr.as_ordered_terms-1166"><a href="#Expr.as_ordered_terms-1166"><span class="linenos">1166</span></a>            <span class="n">_terms</span><span class="p">,</span> <span class="n">_order</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
</span><span id="Expr.as_ordered_terms-1167"><a href="#Expr.as_ordered_terms-1167"><span class="linenos">1167</span></a>
</span><span id="Expr.as_ordered_terms-1168"><a href="#Expr.as_ordered_terms-1168"><span class="linenos">1168</span></a>            <span class="k">for</span> <span class="n">term</span><span class="p">,</span> <span class="nb">repr</span> <span class="ow">in</span> <span class="n">terms</span><span class="p">:</span>
</span><span id="Expr.as_ordered_terms-1169"><a href="#Expr.as_ordered_terms-1169"><span class="linenos">1169</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">term</span><span class="o">.</span><span class="n">is_Order</span><span class="p">:</span>
</span><span id="Expr.as_ordered_terms-1170"><a href="#Expr.as_ordered_terms-1170"><span class="linenos">1170</span></a>                    <span class="n">_terms</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">term</span><span class="p">,</span> <span class="nb">repr</span><span class="p">))</span>
</span><span id="Expr.as_ordered_terms-1171"><a href="#Expr.as_ordered_terms-1171"><span class="linenos">1171</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="Expr.as_ordered_terms-1172"><a href="#Expr.as_ordered_terms-1172"><span class="linenos">1172</span></a>                    <span class="n">_order</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">term</span><span class="p">,</span> <span class="nb">repr</span><span class="p">))</span>
</span><span id="Expr.as_ordered_terms-1173"><a href="#Expr.as_ordered_terms-1173"><span class="linenos">1173</span></a>
</span><span id="Expr.as_ordered_terms-1174"><a href="#Expr.as_ordered_terms-1174"><span class="linenos">1174</span></a>            <span class="n">ordered</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">_terms</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> \
</span><span id="Expr.as_ordered_terms-1175"><a href="#Expr.as_ordered_terms-1175"><span class="linenos">1175</span></a>                <span class="o">+</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">_order</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="Expr.as_ordered_terms-1176"><a href="#Expr.as_ordered_terms-1176"><span class="linenos">1176</span></a>
</span><span id="Expr.as_ordered_terms-1177"><a href="#Expr.as_ordered_terms-1177"><span class="linenos">1177</span></a>        <span class="k">if</span> <span class="n">data</span><span class="p">:</span>
</span><span id="Expr.as_ordered_terms-1178"><a href="#Expr.as_ordered_terms-1178"><span class="linenos">1178</span></a>            <span class="k">return</span> <span class="n">ordered</span><span class="p">,</span> <span class="n">gens</span>
</span><span id="Expr.as_ordered_terms-1179"><a href="#Expr.as_ordered_terms-1179"><span class="linenos">1179</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Expr.as_ordered_terms-1180"><a href="#Expr.as_ordered_terms-1180"><span class="linenos">1180</span></a>            <span class="k">return</span> <span class="p">[</span><span class="n">term</span> <span class="k">for</span> <span class="n">term</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">ordered</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Transform an expression to an ordered list of terms.</p>

<h1 id="examples">Examples</h1>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">sin</span><span class="p">,</span> <span class="n">cos</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.abc</span> <span class="kn">import</span> <span class="n">x</span>
</code></pre>
</div>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">as_ordered_terms</span><span class="p">()</span>
<span class="go">[sin(x)**2*cos(x), sin(x)**2, 1]</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="Expr.as_terms" class="classattr">
                                        <input id="Expr.as_terms-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">as_terms</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Expr.as_terms-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Expr.as_terms"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Expr.as_terms-1182"><a href="#Expr.as_terms-1182"><span class="linenos">1182</span></a>    <span class="k">def</span> <span class="nf">as_terms</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Expr.as_terms-1183"><a href="#Expr.as_terms-1183"><span class="linenos">1183</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Transform an expression to a list of terms. &quot;&quot;&quot;</span>
</span><span id="Expr.as_terms-1184"><a href="#Expr.as_terms-1184"><span class="linenos">1184</span></a>        <span class="kn">from</span> <span class="nn">.exprtools</span> <span class="kn">import</span> <span class="n">decompose_power</span>
</span><span id="Expr.as_terms-1185"><a href="#Expr.as_terms-1185"><span class="linenos">1185</span></a>
</span><span id="Expr.as_terms-1186"><a href="#Expr.as_terms-1186"><span class="linenos">1186</span></a>        <span class="n">gens</span><span class="p">,</span> <span class="n">terms</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(),</span> <span class="p">[]</span>
</span><span id="Expr.as_terms-1187"><a href="#Expr.as_terms-1187"><span class="linenos">1187</span></a>
</span><span id="Expr.as_terms-1188"><a href="#Expr.as_terms-1188"><span class="linenos">1188</span></a>        <span class="k">for</span> <span class="n">term</span> <span class="ow">in</span> <span class="n">Add</span><span class="o">.</span><span class="n">make_args</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Expr.as_terms-1189"><a href="#Expr.as_terms-1189"><span class="linenos">1189</span></a>            <span class="n">coeff</span><span class="p">,</span> <span class="n">_term</span> <span class="o">=</span> <span class="n">term</span><span class="o">.</span><span class="n">as_coeff_Mul</span><span class="p">()</span>
</span><span id="Expr.as_terms-1190"><a href="#Expr.as_terms-1190"><span class="linenos">1190</span></a>
</span><span id="Expr.as_terms-1191"><a href="#Expr.as_terms-1191"><span class="linenos">1191</span></a>            <span class="n">coeff</span> <span class="o">=</span> <span class="nb">complex</span><span class="p">(</span><span class="n">coeff</span><span class="p">)</span>
</span><span id="Expr.as_terms-1192"><a href="#Expr.as_terms-1192"><span class="linenos">1192</span></a>            <span class="n">cpart</span><span class="p">,</span> <span class="n">ncpart</span> <span class="o">=</span> <span class="p">{},</span> <span class="p">[]</span>
</span><span id="Expr.as_terms-1193"><a href="#Expr.as_terms-1193"><span class="linenos">1193</span></a>
</span><span id="Expr.as_terms-1194"><a href="#Expr.as_terms-1194"><span class="linenos">1194</span></a>            <span class="k">if</span> <span class="n">_term</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">S</span><span class="o">.</span><span class="n">One</span><span class="p">:</span>
</span><span id="Expr.as_terms-1195"><a href="#Expr.as_terms-1195"><span class="linenos">1195</span></a>                <span class="k">for</span> <span class="n">factor</span> <span class="ow">in</span> <span class="n">Mul</span><span class="o">.</span><span class="n">make_args</span><span class="p">(</span><span class="n">_term</span><span class="p">):</span>
</span><span id="Expr.as_terms-1196"><a href="#Expr.as_terms-1196"><span class="linenos">1196</span></a>                    <span class="k">if</span> <span class="n">factor</span><span class="o">.</span><span class="n">is_number</span><span class="p">:</span>
</span><span id="Expr.as_terms-1197"><a href="#Expr.as_terms-1197"><span class="linenos">1197</span></a>                        <span class="k">try</span><span class="p">:</span>
</span><span id="Expr.as_terms-1198"><a href="#Expr.as_terms-1198"><span class="linenos">1198</span></a>                            <span class="n">coeff</span> <span class="o">*=</span> <span class="nb">complex</span><span class="p">(</span><span class="n">factor</span><span class="p">)</span>
</span><span id="Expr.as_terms-1199"><a href="#Expr.as_terms-1199"><span class="linenos">1199</span></a>                        <span class="k">except</span> <span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span>
</span><span id="Expr.as_terms-1200"><a href="#Expr.as_terms-1200"><span class="linenos">1200</span></a>                            <span class="k">pass</span>
</span><span id="Expr.as_terms-1201"><a href="#Expr.as_terms-1201"><span class="linenos">1201</span></a>                        <span class="k">else</span><span class="p">:</span>
</span><span id="Expr.as_terms-1202"><a href="#Expr.as_terms-1202"><span class="linenos">1202</span></a>                            <span class="k">continue</span>
</span><span id="Expr.as_terms-1203"><a href="#Expr.as_terms-1203"><span class="linenos">1203</span></a>
</span><span id="Expr.as_terms-1204"><a href="#Expr.as_terms-1204"><span class="linenos">1204</span></a>                    <span class="k">if</span> <span class="n">factor</span><span class="o">.</span><span class="n">is_commutative</span><span class="p">:</span>
</span><span id="Expr.as_terms-1205"><a href="#Expr.as_terms-1205"><span class="linenos">1205</span></a>                        <span class="n">base</span><span class="p">,</span> <span class="n">exp</span> <span class="o">=</span> <span class="n">decompose_power</span><span class="p">(</span><span class="n">factor</span><span class="p">)</span>
</span><span id="Expr.as_terms-1206"><a href="#Expr.as_terms-1206"><span class="linenos">1206</span></a>
</span><span id="Expr.as_terms-1207"><a href="#Expr.as_terms-1207"><span class="linenos">1207</span></a>                        <span class="n">cpart</span><span class="p">[</span><span class="n">base</span><span class="p">]</span> <span class="o">=</span> <span class="n">exp</span>
</span><span id="Expr.as_terms-1208"><a href="#Expr.as_terms-1208"><span class="linenos">1208</span></a>                        <span class="n">gens</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">base</span><span class="p">)</span>
</span><span id="Expr.as_terms-1209"><a href="#Expr.as_terms-1209"><span class="linenos">1209</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="Expr.as_terms-1210"><a href="#Expr.as_terms-1210"><span class="linenos">1210</span></a>                        <span class="n">ncpart</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">factor</span><span class="p">)</span>
</span><span id="Expr.as_terms-1211"><a href="#Expr.as_terms-1211"><span class="linenos">1211</span></a>
</span><span id="Expr.as_terms-1212"><a href="#Expr.as_terms-1212"><span class="linenos">1212</span></a>            <span class="n">coeff</span> <span class="o">=</span> <span class="n">coeff</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="n">coeff</span><span class="o">.</span><span class="n">imag</span>
</span><span id="Expr.as_terms-1213"><a href="#Expr.as_terms-1213"><span class="linenos">1213</span></a>            <span class="n">ncpart</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">ncpart</span><span class="p">)</span>
</span><span id="Expr.as_terms-1214"><a href="#Expr.as_terms-1214"><span class="linenos">1214</span></a>
</span><span id="Expr.as_terms-1215"><a href="#Expr.as_terms-1215"><span class="linenos">1215</span></a>            <span class="n">terms</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">term</span><span class="p">,</span> <span class="p">(</span><span class="n">coeff</span><span class="p">,</span> <span class="n">cpart</span><span class="p">,</span> <span class="n">ncpart</span><span class="p">)))</span>
</span><span id="Expr.as_terms-1216"><a href="#Expr.as_terms-1216"><span class="linenos">1216</span></a>
</span><span id="Expr.as_terms-1217"><a href="#Expr.as_terms-1217"><span class="linenos">1217</span></a>        <span class="n">gens</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">gens</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">default_sort_key</span><span class="p">)</span>
</span><span id="Expr.as_terms-1218"><a href="#Expr.as_terms-1218"><span class="linenos">1218</span></a>
</span><span id="Expr.as_terms-1219"><a href="#Expr.as_terms-1219"><span class="linenos">1219</span></a>        <span class="n">k</span><span class="p">,</span> <span class="n">indices</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">gens</span><span class="p">),</span> <span class="p">{}</span>
</span><span id="Expr.as_terms-1220"><a href="#Expr.as_terms-1220"><span class="linenos">1220</span></a>
</span><span id="Expr.as_terms-1221"><a href="#Expr.as_terms-1221"><span class="linenos">1221</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">g</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">gens</span><span class="p">):</span>
</span><span id="Expr.as_terms-1222"><a href="#Expr.as_terms-1222"><span class="linenos">1222</span></a>            <span class="n">indices</span><span class="p">[</span><span class="n">g</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span>
</span><span id="Expr.as_terms-1223"><a href="#Expr.as_terms-1223"><span class="linenos">1223</span></a>
</span><span id="Expr.as_terms-1224"><a href="#Expr.as_terms-1224"><span class="linenos">1224</span></a>        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Expr.as_terms-1225"><a href="#Expr.as_terms-1225"><span class="linenos">1225</span></a>
</span><span id="Expr.as_terms-1226"><a href="#Expr.as_terms-1226"><span class="linenos">1226</span></a>        <span class="k">for</span> <span class="n">term</span><span class="p">,</span> <span class="p">(</span><span class="n">coeff</span><span class="p">,</span> <span class="n">cpart</span><span class="p">,</span> <span class="n">ncpart</span><span class="p">)</span> <span class="ow">in</span> <span class="n">terms</span><span class="p">:</span>
</span><span id="Expr.as_terms-1227"><a href="#Expr.as_terms-1227"><span class="linenos">1227</span></a>            <span class="n">monom</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">k</span>
</span><span id="Expr.as_terms-1228"><a href="#Expr.as_terms-1228"><span class="linenos">1228</span></a>
</span><span id="Expr.as_terms-1229"><a href="#Expr.as_terms-1229"><span class="linenos">1229</span></a>            <span class="k">for</span> <span class="n">base</span><span class="p">,</span> <span class="n">exp</span> <span class="ow">in</span> <span class="n">cpart</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="Expr.as_terms-1230"><a href="#Expr.as_terms-1230"><span class="linenos">1230</span></a>                <span class="n">monom</span><span class="p">[</span><span class="n">indices</span><span class="p">[</span><span class="n">base</span><span class="p">]]</span> <span class="o">=</span> <span class="n">exp</span>
</span><span id="Expr.as_terms-1231"><a href="#Expr.as_terms-1231"><span class="linenos">1231</span></a>
</span><span id="Expr.as_terms-1232"><a href="#Expr.as_terms-1232"><span class="linenos">1232</span></a>            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">term</span><span class="p">,</span> <span class="p">(</span><span class="n">coeff</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">monom</span><span class="p">),</span> <span class="n">ncpart</span><span class="p">)))</span>
</span><span id="Expr.as_terms-1233"><a href="#Expr.as_terms-1233"><span class="linenos">1233</span></a>
</span><span id="Expr.as_terms-1234"><a href="#Expr.as_terms-1234"><span class="linenos">1234</span></a>        <span class="k">return</span> <span class="n">result</span><span class="p">,</span> <span class="n">gens</span>
</span></pre></div>


            <div class="docstring"><p>Transform an expression to a list of terms.</p>
</div>


                            </div>
                            <div id="Expr.removeO" class="classattr">
                                        <input id="Expr.removeO-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">removeO</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Expr.removeO-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Expr.removeO"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Expr.removeO-1236"><a href="#Expr.removeO-1236"><span class="linenos">1236</span></a>    <span class="k">def</span> <span class="nf">removeO</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Expr.removeO-1237"><a href="#Expr.removeO-1237"><span class="linenos">1237</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Removes the additive O(..) symbol if there is one&quot;&quot;&quot;</span>
</span><span id="Expr.removeO-1238"><a href="#Expr.removeO-1238"><span class="linenos">1238</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span></pre></div>


            <div class="docstring"><p>Removes the additive O(..) symbol if there is one</p>
</div>


                            </div>
                            <div id="Expr.getO" class="classattr">
                                        <input id="Expr.getO-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">getO</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Expr.getO-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Expr.getO"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Expr.getO-1240"><a href="#Expr.getO-1240"><span class="linenos">1240</span></a>    <span class="k">def</span> <span class="nf">getO</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Expr.getO-1241"><a href="#Expr.getO-1241"><span class="linenos">1241</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the additive O(..) symbol if there is one, else None.&quot;&quot;&quot;</span>
</span><span id="Expr.getO-1242"><a href="#Expr.getO-1242"><span class="linenos">1242</span></a>        <span class="k">return</span> <span class="kc">None</span>
</span></pre></div>


            <div class="docstring"><p>Returns the additive O(..) symbol if there is one, else None.</p>
</div>


                            </div>
                            <div id="Expr.getn" class="classattr">
                                        <input id="Expr.getn-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">getn</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Expr.getn-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Expr.getn"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Expr.getn-1244"><a href="#Expr.getn-1244"><span class="linenos">1244</span></a>    <span class="k">def</span> <span class="nf">getn</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Expr.getn-1245"><a href="#Expr.getn-1245"><span class="linenos">1245</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Expr.getn-1246"><a href="#Expr.getn-1246"><span class="linenos">1246</span></a><span class="sd">        Returns the order of the expression.</span>
</span><span id="Expr.getn-1247"><a href="#Expr.getn-1247"><span class="linenos">1247</span></a>
</span><span id="Expr.getn-1248"><a href="#Expr.getn-1248"><span class="linenos">1248</span></a><span class="sd">        Explanation</span>
</span><span id="Expr.getn-1249"><a href="#Expr.getn-1249"><span class="linenos">1249</span></a><span class="sd">        ===========</span>
</span><span id="Expr.getn-1250"><a href="#Expr.getn-1250"><span class="linenos">1250</span></a>
</span><span id="Expr.getn-1251"><a href="#Expr.getn-1251"><span class="linenos">1251</span></a><span class="sd">        The order is determined either from the O(...) term. If there</span>
</span><span id="Expr.getn-1252"><a href="#Expr.getn-1252"><span class="linenos">1252</span></a><span class="sd">        is no O(...) term, it returns None.</span>
</span><span id="Expr.getn-1253"><a href="#Expr.getn-1253"><span class="linenos">1253</span></a>
</span><span id="Expr.getn-1254"><a href="#Expr.getn-1254"><span class="linenos">1254</span></a><span class="sd">        Examples</span>
</span><span id="Expr.getn-1255"><a href="#Expr.getn-1255"><span class="linenos">1255</span></a><span class="sd">        ========</span>
</span><span id="Expr.getn-1256"><a href="#Expr.getn-1256"><span class="linenos">1256</span></a>
</span><span id="Expr.getn-1257"><a href="#Expr.getn-1257"><span class="linenos">1257</span></a><span class="sd">        &gt;&gt;&gt; from sympy import O</span>
</span><span id="Expr.getn-1258"><a href="#Expr.getn-1258"><span class="linenos">1258</span></a><span class="sd">        &gt;&gt;&gt; from sympy.abc import x</span>
</span><span id="Expr.getn-1259"><a href="#Expr.getn-1259"><span class="linenos">1259</span></a><span class="sd">        &gt;&gt;&gt; (1 + x + O(x**2)).getn()</span>
</span><span id="Expr.getn-1260"><a href="#Expr.getn-1260"><span class="linenos">1260</span></a><span class="sd">        2</span>
</span><span id="Expr.getn-1261"><a href="#Expr.getn-1261"><span class="linenos">1261</span></a><span class="sd">        &gt;&gt;&gt; (1 + x).getn()</span>
</span><span id="Expr.getn-1262"><a href="#Expr.getn-1262"><span class="linenos">1262</span></a>
</span><span id="Expr.getn-1263"><a href="#Expr.getn-1263"><span class="linenos">1263</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Expr.getn-1264"><a href="#Expr.getn-1264"><span class="linenos">1264</span></a>        <span class="n">o</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getO</span><span class="p">()</span>
</span><span id="Expr.getn-1265"><a href="#Expr.getn-1265"><span class="linenos">1265</span></a>        <span class="k">if</span> <span class="n">o</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Expr.getn-1266"><a href="#Expr.getn-1266"><span class="linenos">1266</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="Expr.getn-1267"><a href="#Expr.getn-1267"><span class="linenos">1267</span></a>        <span class="k">elif</span> <span class="n">o</span><span class="o">.</span><span class="n">is_Order</span><span class="p">:</span>
</span><span id="Expr.getn-1268"><a href="#Expr.getn-1268"><span class="linenos">1268</span></a>            <span class="n">o</span> <span class="o">=</span> <span class="n">o</span><span class="o">.</span><span class="n">expr</span>
</span><span id="Expr.getn-1269"><a href="#Expr.getn-1269"><span class="linenos">1269</span></a>            <span class="k">if</span> <span class="n">o</span> <span class="ow">is</span> <span class="n">S</span><span class="o">.</span><span class="n">One</span><span class="p">:</span>
</span><span id="Expr.getn-1270"><a href="#Expr.getn-1270"><span class="linenos">1270</span></a>                <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">Zero</span>
</span><span id="Expr.getn-1271"><a href="#Expr.getn-1271"><span class="linenos">1271</span></a>            <span class="k">if</span> <span class="n">o</span><span class="o">.</span><span class="n">is_Symbol</span><span class="p">:</span>
</span><span id="Expr.getn-1272"><a href="#Expr.getn-1272"><span class="linenos">1272</span></a>                <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">One</span>
</span><span id="Expr.getn-1273"><a href="#Expr.getn-1273"><span class="linenos">1273</span></a>            <span class="k">if</span> <span class="n">o</span><span class="o">.</span><span class="n">is_Pow</span><span class="p">:</span>
</span><span id="Expr.getn-1274"><a href="#Expr.getn-1274"><span class="linenos">1274</span></a>                <span class="k">return</span> <span class="n">o</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Expr.getn-1275"><a href="#Expr.getn-1275"><span class="linenos">1275</span></a>            <span class="k">if</span> <span class="n">o</span><span class="o">.</span><span class="n">is_Mul</span><span class="p">:</span>  <span class="c1"># x**n*log(x)**n or x**n/log(x)**n</span>
</span><span id="Expr.getn-1276"><a href="#Expr.getn-1276"><span class="linenos">1276</span></a>                <span class="k">for</span> <span class="n">oi</span> <span class="ow">in</span> <span class="n">o</span><span class="o">.</span><span class="n">args</span><span class="p">:</span>
</span><span id="Expr.getn-1277"><a href="#Expr.getn-1277"><span class="linenos">1277</span></a>                    <span class="k">if</span> <span class="n">oi</span><span class="o">.</span><span class="n">is_Symbol</span><span class="p">:</span>
</span><span id="Expr.getn-1278"><a href="#Expr.getn-1278"><span class="linenos">1278</span></a>                        <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">One</span>
</span><span id="Expr.getn-1279"><a href="#Expr.getn-1279"><span class="linenos">1279</span></a>                    <span class="k">if</span> <span class="n">oi</span><span class="o">.</span><span class="n">is_Pow</span><span class="p">:</span>
</span><span id="Expr.getn-1280"><a href="#Expr.getn-1280"><span class="linenos">1280</span></a>                        <span class="kn">from</span> <span class="nn">.symbol</span> <span class="kn">import</span> <span class="n">Dummy</span><span class="p">,</span> <span class="n">Symbol</span>
</span><span id="Expr.getn-1281"><a href="#Expr.getn-1281"><span class="linenos">1281</span></a>                        <span class="n">syms</span> <span class="o">=</span> <span class="n">oi</span><span class="o">.</span><span class="n">atoms</span><span class="p">(</span><span class="n">Symbol</span><span class="p">)</span>
</span><span id="Expr.getn-1282"><a href="#Expr.getn-1282"><span class="linenos">1282</span></a>                        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">syms</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Expr.getn-1283"><a href="#Expr.getn-1283"><span class="linenos">1283</span></a>                            <span class="n">x</span> <span class="o">=</span> <span class="n">syms</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
</span><span id="Expr.getn-1284"><a href="#Expr.getn-1284"><span class="linenos">1284</span></a>                            <span class="n">oi</span> <span class="o">=</span> <span class="n">oi</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Dummy</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">positive</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</span><span id="Expr.getn-1285"><a href="#Expr.getn-1285"><span class="linenos">1285</span></a>                            <span class="k">if</span> <span class="n">oi</span><span class="o">.</span><span class="n">base</span><span class="o">.</span><span class="n">is_Symbol</span> <span class="ow">and</span> <span class="n">oi</span><span class="o">.</span><span class="n">exp</span><span class="o">.</span><span class="n">is_Rational</span><span class="p">:</span>
</span><span id="Expr.getn-1286"><a href="#Expr.getn-1286"><span class="linenos">1286</span></a>                                <span class="k">return</span> <span class="nb">abs</span><span class="p">(</span><span class="n">oi</span><span class="o">.</span><span class="n">exp</span><span class="p">)</span>
</span><span id="Expr.getn-1287"><a href="#Expr.getn-1287"><span class="linenos">1287</span></a>
</span><span id="Expr.getn-1288"><a href="#Expr.getn-1288"><span class="linenos">1288</span></a>        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;not sure of order of </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">o</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Returns the order of the expression.</p>

<h1 id="explanation">Explanation</h1>

<p>The order is determined either from the O(...) term. If there
is no O(...) term, it returns None.</p>

<h1 id="examples">Examples</h1>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">O</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.abc</span> <span class="kn">import</span> <span class="n">x</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="n">O</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span><span class="o">.</span><span class="n">getn</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">getn</span><span class="p">()</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="Expr.count_ops" class="classattr">
                                        <input id="Expr.count_ops-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">count_ops</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">visual</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Expr.count_ops-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Expr.count_ops"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Expr.count_ops-1290"><a href="#Expr.count_ops-1290"><span class="linenos">1290</span></a>    <span class="k">def</span> <span class="nf">count_ops</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">visual</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="Expr.count_ops-1291"><a href="#Expr.count_ops-1291"><span class="linenos">1291</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;wrapper for count_ops that returns the operation count.&quot;&quot;&quot;</span>
</span><span id="Expr.count_ops-1292"><a href="#Expr.count_ops-1292"><span class="linenos">1292</span></a>        <span class="kn">from</span> <span class="nn">.function</span> <span class="kn">import</span> <span class="n">count_ops</span>
</span><span id="Expr.count_ops-1293"><a href="#Expr.count_ops-1293"><span class="linenos">1293</span></a>        <span class="k">return</span> <span class="n">count_ops</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">visual</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>wrapper for count_ops that returns the operation count.</p>
</div>


                            </div>
                            <div id="Expr.args_cnc" class="classattr">
                                        <input id="Expr.args_cnc-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">args_cnc</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">cset</span><span class="o">=</span><span class="kc">False</span>, </span><span class="param"><span class="n">warn</span><span class="o">=</span><span class="kc">True</span>, </span><span class="param"><span class="n">split_1</span><span class="o">=</span><span class="kc">True</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Expr.args_cnc-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Expr.args_cnc"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Expr.args_cnc-1295"><a href="#Expr.args_cnc-1295"><span class="linenos">1295</span></a>    <span class="k">def</span> <span class="nf">args_cnc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cset</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">warn</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">split_1</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="Expr.args_cnc-1296"><a href="#Expr.args_cnc-1296"><span class="linenos">1296</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return [commutative factors, non-commutative factors] of self.</span>
</span><span id="Expr.args_cnc-1297"><a href="#Expr.args_cnc-1297"><span class="linenos">1297</span></a>
</span><span id="Expr.args_cnc-1298"><a href="#Expr.args_cnc-1298"><span class="linenos">1298</span></a><span class="sd">        Explanation</span>
</span><span id="Expr.args_cnc-1299"><a href="#Expr.args_cnc-1299"><span class="linenos">1299</span></a><span class="sd">        ===========</span>
</span><span id="Expr.args_cnc-1300"><a href="#Expr.args_cnc-1300"><span class="linenos">1300</span></a>
</span><span id="Expr.args_cnc-1301"><a href="#Expr.args_cnc-1301"><span class="linenos">1301</span></a><span class="sd">        self is treated as a Mul and the ordering of the factors is maintained.</span>
</span><span id="Expr.args_cnc-1302"><a href="#Expr.args_cnc-1302"><span class="linenos">1302</span></a><span class="sd">        If ``cset`` is True the commutative factors will be returned in a set.</span>
</span><span id="Expr.args_cnc-1303"><a href="#Expr.args_cnc-1303"><span class="linenos">1303</span></a><span class="sd">        If there were repeated factors (as may happen with an unevaluated Mul)</span>
</span><span id="Expr.args_cnc-1304"><a href="#Expr.args_cnc-1304"><span class="linenos">1304</span></a><span class="sd">        then an error will be raised unless it is explicitly suppressed by</span>
</span><span id="Expr.args_cnc-1305"><a href="#Expr.args_cnc-1305"><span class="linenos">1305</span></a><span class="sd">        setting ``warn`` to False.</span>
</span><span id="Expr.args_cnc-1306"><a href="#Expr.args_cnc-1306"><span class="linenos">1306</span></a>
</span><span id="Expr.args_cnc-1307"><a href="#Expr.args_cnc-1307"><span class="linenos">1307</span></a><span class="sd">        Note: -1 is always separated from a Number unless split_1 is False.</span>
</span><span id="Expr.args_cnc-1308"><a href="#Expr.args_cnc-1308"><span class="linenos">1308</span></a>
</span><span id="Expr.args_cnc-1309"><a href="#Expr.args_cnc-1309"><span class="linenos">1309</span></a><span class="sd">        Examples</span>
</span><span id="Expr.args_cnc-1310"><a href="#Expr.args_cnc-1310"><span class="linenos">1310</span></a><span class="sd">        ========</span>
</span><span id="Expr.args_cnc-1311"><a href="#Expr.args_cnc-1311"><span class="linenos">1311</span></a>
</span><span id="Expr.args_cnc-1312"><a href="#Expr.args_cnc-1312"><span class="linenos">1312</span></a><span class="sd">        &gt;&gt;&gt; from sympy import symbols, oo</span>
</span><span id="Expr.args_cnc-1313"><a href="#Expr.args_cnc-1313"><span class="linenos">1313</span></a><span class="sd">        &gt;&gt;&gt; A, B = symbols(&#39;A B&#39;, commutative=0)</span>
</span><span id="Expr.args_cnc-1314"><a href="#Expr.args_cnc-1314"><span class="linenos">1314</span></a><span class="sd">        &gt;&gt;&gt; x, y = symbols(&#39;x y&#39;)</span>
</span><span id="Expr.args_cnc-1315"><a href="#Expr.args_cnc-1315"><span class="linenos">1315</span></a><span class="sd">        &gt;&gt;&gt; (-2*x*y).args_cnc()</span>
</span><span id="Expr.args_cnc-1316"><a href="#Expr.args_cnc-1316"><span class="linenos">1316</span></a><span class="sd">        [[-1, 2, x, y], []]</span>
</span><span id="Expr.args_cnc-1317"><a href="#Expr.args_cnc-1317"><span class="linenos">1317</span></a><span class="sd">        &gt;&gt;&gt; (-2.5*x).args_cnc()</span>
</span><span id="Expr.args_cnc-1318"><a href="#Expr.args_cnc-1318"><span class="linenos">1318</span></a><span class="sd">        [[-1, 2.5, x], []]</span>
</span><span id="Expr.args_cnc-1319"><a href="#Expr.args_cnc-1319"><span class="linenos">1319</span></a><span class="sd">        &gt;&gt;&gt; (-2*x*A*B*y).args_cnc()</span>
</span><span id="Expr.args_cnc-1320"><a href="#Expr.args_cnc-1320"><span class="linenos">1320</span></a><span class="sd">        [[-1, 2, x, y], [A, B]]</span>
</span><span id="Expr.args_cnc-1321"><a href="#Expr.args_cnc-1321"><span class="linenos">1321</span></a><span class="sd">        &gt;&gt;&gt; (-2*x*A*B*y).args_cnc(split_1=False)</span>
</span><span id="Expr.args_cnc-1322"><a href="#Expr.args_cnc-1322"><span class="linenos">1322</span></a><span class="sd">        [[-2, x, y], [A, B]]</span>
</span><span id="Expr.args_cnc-1323"><a href="#Expr.args_cnc-1323"><span class="linenos">1323</span></a><span class="sd">        &gt;&gt;&gt; (-2*x*y).args_cnc(cset=True)</span>
</span><span id="Expr.args_cnc-1324"><a href="#Expr.args_cnc-1324"><span class="linenos">1324</span></a><span class="sd">        [{-1, 2, x, y}, []]</span>
</span><span id="Expr.args_cnc-1325"><a href="#Expr.args_cnc-1325"><span class="linenos">1325</span></a>
</span><span id="Expr.args_cnc-1326"><a href="#Expr.args_cnc-1326"><span class="linenos">1326</span></a><span class="sd">        The arg is always treated as a Mul:</span>
</span><span id="Expr.args_cnc-1327"><a href="#Expr.args_cnc-1327"><span class="linenos">1327</span></a>
</span><span id="Expr.args_cnc-1328"><a href="#Expr.args_cnc-1328"><span class="linenos">1328</span></a><span class="sd">        &gt;&gt;&gt; (-2 + x + A).args_cnc()</span>
</span><span id="Expr.args_cnc-1329"><a href="#Expr.args_cnc-1329"><span class="linenos">1329</span></a><span class="sd">        [[], [x - 2 + A]]</span>
</span><span id="Expr.args_cnc-1330"><a href="#Expr.args_cnc-1330"><span class="linenos">1330</span></a><span class="sd">        &gt;&gt;&gt; (-oo).args_cnc() # -oo is a singleton</span>
</span><span id="Expr.args_cnc-1331"><a href="#Expr.args_cnc-1331"><span class="linenos">1331</span></a><span class="sd">        [[-1, oo], []]</span>
</span><span id="Expr.args_cnc-1332"><a href="#Expr.args_cnc-1332"><span class="linenos">1332</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Expr.args_cnc-1333"><a href="#Expr.args_cnc-1333"><span class="linenos">1333</span></a>
</span><span id="Expr.args_cnc-1334"><a href="#Expr.args_cnc-1334"><span class="linenos">1334</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_Mul</span><span class="p">:</span>
</span><span id="Expr.args_cnc-1335"><a href="#Expr.args_cnc-1335"><span class="linenos">1335</span></a>            <span class="n">args</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">)</span>
</span><span id="Expr.args_cnc-1336"><a href="#Expr.args_cnc-1336"><span class="linenos">1336</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Expr.args_cnc-1337"><a href="#Expr.args_cnc-1337"><span class="linenos">1337</span></a>            <span class="n">args</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="p">]</span>
</span><span id="Expr.args_cnc-1338"><a href="#Expr.args_cnc-1338"><span class="linenos">1338</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">mi</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">args</span><span class="p">):</span>
</span><span id="Expr.args_cnc-1339"><a href="#Expr.args_cnc-1339"><span class="linenos">1339</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">mi</span><span class="o">.</span><span class="n">is_commutative</span><span class="p">:</span>
</span><span id="Expr.args_cnc-1340"><a href="#Expr.args_cnc-1340"><span class="linenos">1340</span></a>                <span class="n">c</span> <span class="o">=</span> <span class="n">args</span><span class="p">[:</span><span class="n">i</span><span class="p">]</span>
</span><span id="Expr.args_cnc-1341"><a href="#Expr.args_cnc-1341"><span class="linenos">1341</span></a>                <span class="n">nc</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="n">i</span><span class="p">:]</span>
</span><span id="Expr.args_cnc-1342"><a href="#Expr.args_cnc-1342"><span class="linenos">1342</span></a>                <span class="k">break</span>
</span><span id="Expr.args_cnc-1343"><a href="#Expr.args_cnc-1343"><span class="linenos">1343</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Expr.args_cnc-1344"><a href="#Expr.args_cnc-1344"><span class="linenos">1344</span></a>            <span class="n">c</span> <span class="o">=</span> <span class="n">args</span>
</span><span id="Expr.args_cnc-1345"><a href="#Expr.args_cnc-1345"><span class="linenos">1345</span></a>            <span class="n">nc</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Expr.args_cnc-1346"><a href="#Expr.args_cnc-1346"><span class="linenos">1346</span></a>
</span><span id="Expr.args_cnc-1347"><a href="#Expr.args_cnc-1347"><span class="linenos">1347</span></a>        <span class="k">if</span> <span class="n">c</span> <span class="ow">and</span> <span class="n">split_1</span> <span class="ow">and</span> <span class="p">(</span>
</span><span id="Expr.args_cnc-1348"><a href="#Expr.args_cnc-1348"><span class="linenos">1348</span></a>            <span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">is_Number</span> <span class="ow">and</span>
</span><span id="Expr.args_cnc-1349"><a href="#Expr.args_cnc-1349"><span class="linenos">1349</span></a>            <span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">is_extended_negative</span> <span class="ow">and</span>
</span><span id="Expr.args_cnc-1350"><a href="#Expr.args_cnc-1350"><span class="linenos">1350</span></a>                <span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">S</span><span class="o">.</span><span class="n">NegativeOne</span><span class="p">):</span>
</span><span id="Expr.args_cnc-1351"><a href="#Expr.args_cnc-1351"><span class="linenos">1351</span></a>            <span class="n">c</span><span class="p">[:</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">S</span><span class="o">.</span><span class="n">NegativeOne</span><span class="p">,</span> <span class="o">-</span><span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
</span><span id="Expr.args_cnc-1352"><a href="#Expr.args_cnc-1352"><span class="linenos">1352</span></a>
</span><span id="Expr.args_cnc-1353"><a href="#Expr.args_cnc-1353"><span class="linenos">1353</span></a>        <span class="k">if</span> <span class="n">cset</span><span class="p">:</span>
</span><span id="Expr.args_cnc-1354"><a href="#Expr.args_cnc-1354"><span class="linenos">1354</span></a>            <span class="n">clen</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
</span><span id="Expr.args_cnc-1355"><a href="#Expr.args_cnc-1355"><span class="linenos">1355</span></a>            <span class="n">c</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
</span><span id="Expr.args_cnc-1356"><a href="#Expr.args_cnc-1356"><span class="linenos">1356</span></a>            <span class="k">if</span> <span class="n">clen</span> <span class="ow">and</span> <span class="n">warn</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">!=</span> <span class="n">clen</span><span class="p">:</span>
</span><span id="Expr.args_cnc-1357"><a href="#Expr.args_cnc-1357"><span class="linenos">1357</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;repeated commutative arguments: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span>
</span><span id="Expr.args_cnc-1358"><a href="#Expr.args_cnc-1358"><span class="linenos">1358</span></a>                                 <span class="p">[</span><span class="n">ci</span> <span class="k">for</span> <span class="n">ci</span> <span class="ow">in</span> <span class="n">c</span> <span class="k">if</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">ci</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">])</span>
</span><span id="Expr.args_cnc-1359"><a href="#Expr.args_cnc-1359"><span class="linenos">1359</span></a>        <span class="k">return</span> <span class="p">[</span><span class="n">c</span><span class="p">,</span> <span class="n">nc</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Return [commutative factors, non-commutative factors] of self.</p>

<h1 id="explanation">Explanation</h1>

<p>self is treated as a Mul and the ordering of the factors is maintained.
If <code>cset</code> is True the commutative factors will be returned in a set.
If there were repeated factors (as may happen with an unevaluated Mul)
then an error will be raised unless it is explicitly suppressed by
setting <code>warn</code> to False.</p>

<p>Note: -1 is always separated from a Number unless split_1 is False.</p>

<h1 id="examples">Examples</h1>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">symbols</span><span class="p">,</span> <span class="n">oo</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span><span class="p">,</span> <span class="n">B</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;A B&#39;</span><span class="p">,</span> <span class="n">commutative</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x y&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">args_cnc</span><span class="p">()</span>
<span class="go">[[-1, 2, x, y], []]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="o">-</span><span class="mf">2.5</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">args_cnc</span><span class="p">()</span>
<span class="go">[[-1, 2.5, x], []]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">A</span><span class="o">*</span><span class="n">B</span><span class="o">*</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">args_cnc</span><span class="p">()</span>
<span class="go">[[-1, 2, x, y], [A, B]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">A</span><span class="o">*</span><span class="n">B</span><span class="o">*</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">args_cnc</span><span class="p">(</span><span class="n">split_1</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">[[-2, x, y], [A, B]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">args_cnc</span><span class="p">(</span><span class="n">cset</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">[{-1, 2, x, y}, []]</span>
</code></pre>
</div>

<p>The arg is always treated as a Mul:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="o">-</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="n">A</span><span class="p">)</span><span class="o">.</span><span class="n">args_cnc</span><span class="p">()</span>
<span class="go">[[], [x - 2 + A]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="o">-</span><span class="n">oo</span><span class="p">)</span><span class="o">.</span><span class="n">args_cnc</span><span class="p">()</span> <span class="c1"># -oo is a singleton</span>
<span class="go">[[-1, oo], []]</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="Expr.coeff" class="classattr">
                                        <input id="Expr.coeff-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">coeff</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">x</span>, </span><span class="param"><span class="n">n</span><span class="o">=</span><span class="mi">1</span>, </span><span class="param"><span class="n">right</span><span class="o">=</span><span class="kc">False</span>, </span><span class="param"><span class="n">_first</span><span class="o">=</span><span class="kc">True</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Expr.coeff-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Expr.coeff"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Expr.coeff-1361"><a href="#Expr.coeff-1361"><span class="linenos">1361</span></a>    <span class="k">def</span> <span class="nf">coeff</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">_first</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="Expr.coeff-1362"><a href="#Expr.coeff-1362"><span class="linenos">1362</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Expr.coeff-1363"><a href="#Expr.coeff-1363"><span class="linenos">1363</span></a><span class="sd">        Returns the coefficient from the term(s) containing ``x**n``. If ``n``</span>
</span><span id="Expr.coeff-1364"><a href="#Expr.coeff-1364"><span class="linenos">1364</span></a><span class="sd">        is zero then all terms independent of ``x`` will be returned.</span>
</span><span id="Expr.coeff-1365"><a href="#Expr.coeff-1365"><span class="linenos">1365</span></a>
</span><span id="Expr.coeff-1366"><a href="#Expr.coeff-1366"><span class="linenos">1366</span></a><span class="sd">        Explanation</span>
</span><span id="Expr.coeff-1367"><a href="#Expr.coeff-1367"><span class="linenos">1367</span></a><span class="sd">        ===========</span>
</span><span id="Expr.coeff-1368"><a href="#Expr.coeff-1368"><span class="linenos">1368</span></a>
</span><span id="Expr.coeff-1369"><a href="#Expr.coeff-1369"><span class="linenos">1369</span></a><span class="sd">        When ``x`` is noncommutative, the coefficient to the left (default) or</span>
</span><span id="Expr.coeff-1370"><a href="#Expr.coeff-1370"><span class="linenos">1370</span></a><span class="sd">        right of ``x`` can be returned. The keyword &#39;right&#39; is ignored when</span>
</span><span id="Expr.coeff-1371"><a href="#Expr.coeff-1371"><span class="linenos">1371</span></a><span class="sd">        ``x`` is commutative.</span>
</span><span id="Expr.coeff-1372"><a href="#Expr.coeff-1372"><span class="linenos">1372</span></a>
</span><span id="Expr.coeff-1373"><a href="#Expr.coeff-1373"><span class="linenos">1373</span></a><span class="sd">        Examples</span>
</span><span id="Expr.coeff-1374"><a href="#Expr.coeff-1374"><span class="linenos">1374</span></a><span class="sd">        ========</span>
</span><span id="Expr.coeff-1375"><a href="#Expr.coeff-1375"><span class="linenos">1375</span></a>
</span><span id="Expr.coeff-1376"><a href="#Expr.coeff-1376"><span class="linenos">1376</span></a><span class="sd">        &gt;&gt;&gt; from sympy import symbols</span>
</span><span id="Expr.coeff-1377"><a href="#Expr.coeff-1377"><span class="linenos">1377</span></a><span class="sd">        &gt;&gt;&gt; from sympy.abc import x, y, z</span>
</span><span id="Expr.coeff-1378"><a href="#Expr.coeff-1378"><span class="linenos">1378</span></a>
</span><span id="Expr.coeff-1379"><a href="#Expr.coeff-1379"><span class="linenos">1379</span></a><span class="sd">        You can select terms that have an explicit negative in front of them:</span>
</span><span id="Expr.coeff-1380"><a href="#Expr.coeff-1380"><span class="linenos">1380</span></a>
</span><span id="Expr.coeff-1381"><a href="#Expr.coeff-1381"><span class="linenos">1381</span></a><span class="sd">        &gt;&gt;&gt; (-x + 2*y).coeff(-1)</span>
</span><span id="Expr.coeff-1382"><a href="#Expr.coeff-1382"><span class="linenos">1382</span></a><span class="sd">        x</span>
</span><span id="Expr.coeff-1383"><a href="#Expr.coeff-1383"><span class="linenos">1383</span></a><span class="sd">        &gt;&gt;&gt; (x - 2*y).coeff(-1)</span>
</span><span id="Expr.coeff-1384"><a href="#Expr.coeff-1384"><span class="linenos">1384</span></a><span class="sd">        2*y</span>
</span><span id="Expr.coeff-1385"><a href="#Expr.coeff-1385"><span class="linenos">1385</span></a>
</span><span id="Expr.coeff-1386"><a href="#Expr.coeff-1386"><span class="linenos">1386</span></a><span class="sd">        You can select terms with no Rational coefficient:</span>
</span><span id="Expr.coeff-1387"><a href="#Expr.coeff-1387"><span class="linenos">1387</span></a>
</span><span id="Expr.coeff-1388"><a href="#Expr.coeff-1388"><span class="linenos">1388</span></a><span class="sd">        &gt;&gt;&gt; (x + 2*y).coeff(1)</span>
</span><span id="Expr.coeff-1389"><a href="#Expr.coeff-1389"><span class="linenos">1389</span></a><span class="sd">        x</span>
</span><span id="Expr.coeff-1390"><a href="#Expr.coeff-1390"><span class="linenos">1390</span></a><span class="sd">        &gt;&gt;&gt; (3 + 2*x + 4*x**2).coeff(1)</span>
</span><span id="Expr.coeff-1391"><a href="#Expr.coeff-1391"><span class="linenos">1391</span></a><span class="sd">        0</span>
</span><span id="Expr.coeff-1392"><a href="#Expr.coeff-1392"><span class="linenos">1392</span></a>
</span><span id="Expr.coeff-1393"><a href="#Expr.coeff-1393"><span class="linenos">1393</span></a><span class="sd">        You can select terms independent of x by making n=0; in this case</span>
</span><span id="Expr.coeff-1394"><a href="#Expr.coeff-1394"><span class="linenos">1394</span></a><span class="sd">        expr.as_independent(x)[0] is returned (and 0 will be returned instead</span>
</span><span id="Expr.coeff-1395"><a href="#Expr.coeff-1395"><span class="linenos">1395</span></a><span class="sd">        of None):</span>
</span><span id="Expr.coeff-1396"><a href="#Expr.coeff-1396"><span class="linenos">1396</span></a>
</span><span id="Expr.coeff-1397"><a href="#Expr.coeff-1397"><span class="linenos">1397</span></a><span class="sd">        &gt;&gt;&gt; (3 + 2*x + 4*x**2).coeff(x, 0)</span>
</span><span id="Expr.coeff-1398"><a href="#Expr.coeff-1398"><span class="linenos">1398</span></a><span class="sd">        3</span>
</span><span id="Expr.coeff-1399"><a href="#Expr.coeff-1399"><span class="linenos">1399</span></a><span class="sd">        &gt;&gt;&gt; eq = ((x + 1)**3).expand() + 1</span>
</span><span id="Expr.coeff-1400"><a href="#Expr.coeff-1400"><span class="linenos">1400</span></a><span class="sd">        &gt;&gt;&gt; eq</span>
</span><span id="Expr.coeff-1401"><a href="#Expr.coeff-1401"><span class="linenos">1401</span></a><span class="sd">        x**3 + 3*x**2 + 3*x + 2</span>
</span><span id="Expr.coeff-1402"><a href="#Expr.coeff-1402"><span class="linenos">1402</span></a><span class="sd">        &gt;&gt;&gt; [eq.coeff(x, i) for i in reversed(range(4))]</span>
</span><span id="Expr.coeff-1403"><a href="#Expr.coeff-1403"><span class="linenos">1403</span></a><span class="sd">        [1, 3, 3, 2]</span>
</span><span id="Expr.coeff-1404"><a href="#Expr.coeff-1404"><span class="linenos">1404</span></a><span class="sd">        &gt;&gt;&gt; eq -= 2</span>
</span><span id="Expr.coeff-1405"><a href="#Expr.coeff-1405"><span class="linenos">1405</span></a><span class="sd">        &gt;&gt;&gt; [eq.coeff(x, i) for i in reversed(range(4))]</span>
</span><span id="Expr.coeff-1406"><a href="#Expr.coeff-1406"><span class="linenos">1406</span></a><span class="sd">        [1, 3, 3, 0]</span>
</span><span id="Expr.coeff-1407"><a href="#Expr.coeff-1407"><span class="linenos">1407</span></a>
</span><span id="Expr.coeff-1408"><a href="#Expr.coeff-1408"><span class="linenos">1408</span></a><span class="sd">        You can select terms that have a numerical term in front of them:</span>
</span><span id="Expr.coeff-1409"><a href="#Expr.coeff-1409"><span class="linenos">1409</span></a>
</span><span id="Expr.coeff-1410"><a href="#Expr.coeff-1410"><span class="linenos">1410</span></a><span class="sd">        &gt;&gt;&gt; (-x - 2*y).coeff(2)</span>
</span><span id="Expr.coeff-1411"><a href="#Expr.coeff-1411"><span class="linenos">1411</span></a><span class="sd">        -y</span>
</span><span id="Expr.coeff-1412"><a href="#Expr.coeff-1412"><span class="linenos">1412</span></a><span class="sd">        &gt;&gt;&gt; from sympy import sqrt</span>
</span><span id="Expr.coeff-1413"><a href="#Expr.coeff-1413"><span class="linenos">1413</span></a><span class="sd">        &gt;&gt;&gt; (x + sqrt(2)*x).coeff(sqrt(2))</span>
</span><span id="Expr.coeff-1414"><a href="#Expr.coeff-1414"><span class="linenos">1414</span></a><span class="sd">        x</span>
</span><span id="Expr.coeff-1415"><a href="#Expr.coeff-1415"><span class="linenos">1415</span></a>
</span><span id="Expr.coeff-1416"><a href="#Expr.coeff-1416"><span class="linenos">1416</span></a><span class="sd">        The matching is exact:</span>
</span><span id="Expr.coeff-1417"><a href="#Expr.coeff-1417"><span class="linenos">1417</span></a>
</span><span id="Expr.coeff-1418"><a href="#Expr.coeff-1418"><span class="linenos">1418</span></a><span class="sd">        &gt;&gt;&gt; (3 + 2*x + 4*x**2).coeff(x)</span>
</span><span id="Expr.coeff-1419"><a href="#Expr.coeff-1419"><span class="linenos">1419</span></a><span class="sd">        2</span>
</span><span id="Expr.coeff-1420"><a href="#Expr.coeff-1420"><span class="linenos">1420</span></a><span class="sd">        &gt;&gt;&gt; (3 + 2*x + 4*x**2).coeff(x**2)</span>
</span><span id="Expr.coeff-1421"><a href="#Expr.coeff-1421"><span class="linenos">1421</span></a><span class="sd">        4</span>
</span><span id="Expr.coeff-1422"><a href="#Expr.coeff-1422"><span class="linenos">1422</span></a><span class="sd">        &gt;&gt;&gt; (3 + 2*x + 4*x**2).coeff(x**3)</span>
</span><span id="Expr.coeff-1423"><a href="#Expr.coeff-1423"><span class="linenos">1423</span></a><span class="sd">        0</span>
</span><span id="Expr.coeff-1424"><a href="#Expr.coeff-1424"><span class="linenos">1424</span></a><span class="sd">        &gt;&gt;&gt; (z*(x + y)**2).coeff((x + y)**2)</span>
</span><span id="Expr.coeff-1425"><a href="#Expr.coeff-1425"><span class="linenos">1425</span></a><span class="sd">        z</span>
</span><span id="Expr.coeff-1426"><a href="#Expr.coeff-1426"><span class="linenos">1426</span></a><span class="sd">        &gt;&gt;&gt; (z*(x + y)**2).coeff(x + y)</span>
</span><span id="Expr.coeff-1427"><a href="#Expr.coeff-1427"><span class="linenos">1427</span></a><span class="sd">        0</span>
</span><span id="Expr.coeff-1428"><a href="#Expr.coeff-1428"><span class="linenos">1428</span></a>
</span><span id="Expr.coeff-1429"><a href="#Expr.coeff-1429"><span class="linenos">1429</span></a><span class="sd">        In addition, no factoring is done, so 1 + z*(1 + y) is not obtained</span>
</span><span id="Expr.coeff-1430"><a href="#Expr.coeff-1430"><span class="linenos">1430</span></a><span class="sd">        from the following:</span>
</span><span id="Expr.coeff-1431"><a href="#Expr.coeff-1431"><span class="linenos">1431</span></a>
</span><span id="Expr.coeff-1432"><a href="#Expr.coeff-1432"><span class="linenos">1432</span></a><span class="sd">        &gt;&gt;&gt; (x + z*(x + x*y)).coeff(x)</span>
</span><span id="Expr.coeff-1433"><a href="#Expr.coeff-1433"><span class="linenos">1433</span></a><span class="sd">        1</span>
</span><span id="Expr.coeff-1434"><a href="#Expr.coeff-1434"><span class="linenos">1434</span></a>
</span><span id="Expr.coeff-1435"><a href="#Expr.coeff-1435"><span class="linenos">1435</span></a><span class="sd">        If such factoring is desired, factor_terms can be used first:</span>
</span><span id="Expr.coeff-1436"><a href="#Expr.coeff-1436"><span class="linenos">1436</span></a>
</span><span id="Expr.coeff-1437"><a href="#Expr.coeff-1437"><span class="linenos">1437</span></a><span class="sd">        &gt;&gt;&gt; from sympy import factor_terms</span>
</span><span id="Expr.coeff-1438"><a href="#Expr.coeff-1438"><span class="linenos">1438</span></a><span class="sd">        &gt;&gt;&gt; factor_terms(x + z*(x + x*y)).coeff(x)</span>
</span><span id="Expr.coeff-1439"><a href="#Expr.coeff-1439"><span class="linenos">1439</span></a><span class="sd">        z*(y + 1) + 1</span>
</span><span id="Expr.coeff-1440"><a href="#Expr.coeff-1440"><span class="linenos">1440</span></a>
</span><span id="Expr.coeff-1441"><a href="#Expr.coeff-1441"><span class="linenos">1441</span></a><span class="sd">        &gt;&gt;&gt; n, m, o = symbols(&#39;n m o&#39;, commutative=False)</span>
</span><span id="Expr.coeff-1442"><a href="#Expr.coeff-1442"><span class="linenos">1442</span></a><span class="sd">        &gt;&gt;&gt; n.coeff(n)</span>
</span><span id="Expr.coeff-1443"><a href="#Expr.coeff-1443"><span class="linenos">1443</span></a><span class="sd">        1</span>
</span><span id="Expr.coeff-1444"><a href="#Expr.coeff-1444"><span class="linenos">1444</span></a><span class="sd">        &gt;&gt;&gt; (3*n).coeff(n)</span>
</span><span id="Expr.coeff-1445"><a href="#Expr.coeff-1445"><span class="linenos">1445</span></a><span class="sd">        3</span>
</span><span id="Expr.coeff-1446"><a href="#Expr.coeff-1446"><span class="linenos">1446</span></a><span class="sd">        &gt;&gt;&gt; (n*m + m*n*m).coeff(n) # = (1 + m)*n*m</span>
</span><span id="Expr.coeff-1447"><a href="#Expr.coeff-1447"><span class="linenos">1447</span></a><span class="sd">        1 + m</span>
</span><span id="Expr.coeff-1448"><a href="#Expr.coeff-1448"><span class="linenos">1448</span></a><span class="sd">        &gt;&gt;&gt; (n*m + m*n*m).coeff(n, right=True) # = (1 + m)*n*m</span>
</span><span id="Expr.coeff-1449"><a href="#Expr.coeff-1449"><span class="linenos">1449</span></a><span class="sd">        m</span>
</span><span id="Expr.coeff-1450"><a href="#Expr.coeff-1450"><span class="linenos">1450</span></a>
</span><span id="Expr.coeff-1451"><a href="#Expr.coeff-1451"><span class="linenos">1451</span></a><span class="sd">        If there is more than one possible coefficient 0 is returned:</span>
</span><span id="Expr.coeff-1452"><a href="#Expr.coeff-1452"><span class="linenos">1452</span></a>
</span><span id="Expr.coeff-1453"><a href="#Expr.coeff-1453"><span class="linenos">1453</span></a><span class="sd">        &gt;&gt;&gt; (n*m + m*n).coeff(n)</span>
</span><span id="Expr.coeff-1454"><a href="#Expr.coeff-1454"><span class="linenos">1454</span></a><span class="sd">        0</span>
</span><span id="Expr.coeff-1455"><a href="#Expr.coeff-1455"><span class="linenos">1455</span></a>
</span><span id="Expr.coeff-1456"><a href="#Expr.coeff-1456"><span class="linenos">1456</span></a><span class="sd">        If there is only one possible coefficient, it is returned:</span>
</span><span id="Expr.coeff-1457"><a href="#Expr.coeff-1457"><span class="linenos">1457</span></a>
</span><span id="Expr.coeff-1458"><a href="#Expr.coeff-1458"><span class="linenos">1458</span></a><span class="sd">        &gt;&gt;&gt; (n*m + x*m*n).coeff(m*n)</span>
</span><span id="Expr.coeff-1459"><a href="#Expr.coeff-1459"><span class="linenos">1459</span></a><span class="sd">        x</span>
</span><span id="Expr.coeff-1460"><a href="#Expr.coeff-1460"><span class="linenos">1460</span></a><span class="sd">        &gt;&gt;&gt; (n*m + x*m*n).coeff(m*n, right=1)</span>
</span><span id="Expr.coeff-1461"><a href="#Expr.coeff-1461"><span class="linenos">1461</span></a><span class="sd">        1</span>
</span><span id="Expr.coeff-1462"><a href="#Expr.coeff-1462"><span class="linenos">1462</span></a>
</span><span id="Expr.coeff-1463"><a href="#Expr.coeff-1463"><span class="linenos">1463</span></a><span class="sd">        See Also</span>
</span><span id="Expr.coeff-1464"><a href="#Expr.coeff-1464"><span class="linenos">1464</span></a><span class="sd">        ========</span>
</span><span id="Expr.coeff-1465"><a href="#Expr.coeff-1465"><span class="linenos">1465</span></a>
</span><span id="Expr.coeff-1466"><a href="#Expr.coeff-1466"><span class="linenos">1466</span></a><span class="sd">        as_coefficient: separate the expression into a coefficient and factor</span>
</span><span id="Expr.coeff-1467"><a href="#Expr.coeff-1467"><span class="linenos">1467</span></a><span class="sd">        as_coeff_Add: separate the additive constant from an expression</span>
</span><span id="Expr.coeff-1468"><a href="#Expr.coeff-1468"><span class="linenos">1468</span></a><span class="sd">        as_coeff_Mul: separate the multiplicative constant from an expression</span>
</span><span id="Expr.coeff-1469"><a href="#Expr.coeff-1469"><span class="linenos">1469</span></a><span class="sd">        as_independent: separate x-dependent terms/factors from others</span>
</span><span id="Expr.coeff-1470"><a href="#Expr.coeff-1470"><span class="linenos">1470</span></a><span class="sd">        sympy.polys.polytools.Poly.coeff_monomial: efficiently find the single coefficient of a monomial in Poly</span>
</span><span id="Expr.coeff-1471"><a href="#Expr.coeff-1471"><span class="linenos">1471</span></a><span class="sd">        sympy.polys.polytools.Poly.nth: like coeff_monomial but powers of monomial terms are used</span>
</span><span id="Expr.coeff-1472"><a href="#Expr.coeff-1472"><span class="linenos">1472</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Expr.coeff-1473"><a href="#Expr.coeff-1473"><span class="linenos">1473</span></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">sympify</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span><span id="Expr.coeff-1474"><a href="#Expr.coeff-1474"><span class="linenos">1474</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Basic</span><span class="p">):</span>
</span><span id="Expr.coeff-1475"><a href="#Expr.coeff-1475"><span class="linenos">1475</span></a>            <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">Zero</span>
</span><span id="Expr.coeff-1476"><a href="#Expr.coeff-1476"><span class="linenos">1476</span></a>
</span><span id="Expr.coeff-1477"><a href="#Expr.coeff-1477"><span class="linenos">1477</span></a>        <span class="n">n</span> <span class="o">=</span> <span class="n">as_int</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
</span><span id="Expr.coeff-1478"><a href="#Expr.coeff-1478"><span class="linenos">1478</span></a>
</span><span id="Expr.coeff-1479"><a href="#Expr.coeff-1479"><span class="linenos">1479</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">x</span><span class="p">:</span>
</span><span id="Expr.coeff-1480"><a href="#Expr.coeff-1480"><span class="linenos">1480</span></a>            <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">Zero</span>
</span><span id="Expr.coeff-1481"><a href="#Expr.coeff-1481"><span class="linenos">1481</span></a>
</span><span id="Expr.coeff-1482"><a href="#Expr.coeff-1482"><span class="linenos">1482</span></a>        <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="bp">self</span><span class="p">:</span>
</span><span id="Expr.coeff-1483"><a href="#Expr.coeff-1483"><span class="linenos">1483</span></a>            <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Expr.coeff-1484"><a href="#Expr.coeff-1484"><span class="linenos">1484</span></a>                <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">One</span>
</span><span id="Expr.coeff-1485"><a href="#Expr.coeff-1485"><span class="linenos">1485</span></a>            <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">Zero</span>
</span><span id="Expr.coeff-1486"><a href="#Expr.coeff-1486"><span class="linenos">1486</span></a>
</span><span id="Expr.coeff-1487"><a href="#Expr.coeff-1487"><span class="linenos">1487</span></a>        <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="n">S</span><span class="o">.</span><span class="n">One</span><span class="p">:</span>
</span><span id="Expr.coeff-1488"><a href="#Expr.coeff-1488"><span class="linenos">1488</span></a>            <span class="n">co</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">Add</span><span class="o">.</span><span class="n">make_args</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="Expr.coeff-1489"><a href="#Expr.coeff-1489"><span class="linenos">1489</span></a>                  <span class="k">if</span> <span class="n">a</span><span class="o">.</span><span class="n">as_coeff_Mul</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">is</span> <span class="n">S</span><span class="o">.</span><span class="n">One</span><span class="p">]</span>
</span><span id="Expr.coeff-1490"><a href="#Expr.coeff-1490"><span class="linenos">1490</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">co</span><span class="p">:</span>
</span><span id="Expr.coeff-1491"><a href="#Expr.coeff-1491"><span class="linenos">1491</span></a>                <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">Zero</span>
</span><span id="Expr.coeff-1492"><a href="#Expr.coeff-1492"><span class="linenos">1492</span></a>            <span class="k">return</span> <span class="n">Add</span><span class="p">(</span><span class="o">*</span><span class="n">co</span><span class="p">)</span>
</span><span id="Expr.coeff-1493"><a href="#Expr.coeff-1493"><span class="linenos">1493</span></a>
</span><span id="Expr.coeff-1494"><a href="#Expr.coeff-1494"><span class="linenos">1494</span></a>        <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Expr.coeff-1495"><a href="#Expr.coeff-1495"><span class="linenos">1495</span></a>            <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">is_Add</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_Add</span><span class="p">:</span>
</span><span id="Expr.coeff-1496"><a href="#Expr.coeff-1496"><span class="linenos">1496</span></a>                <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coeff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="n">right</span><span class="p">)</span>
</span><span id="Expr.coeff-1497"><a href="#Expr.coeff-1497"><span class="linenos">1497</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">c</span><span class="p">:</span>
</span><span id="Expr.coeff-1498"><a href="#Expr.coeff-1498"><span class="linenos">1498</span></a>                    <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">Zero</span>
</span><span id="Expr.coeff-1499"><a href="#Expr.coeff-1499"><span class="linenos">1499</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">right</span><span class="p">:</span>
</span><span id="Expr.coeff-1500"><a href="#Expr.coeff-1500"><span class="linenos">1500</span></a>                    <span class="k">return</span> <span class="bp">self</span> <span class="o">-</span> <span class="n">Add</span><span class="p">(</span><span class="o">*</span><span class="p">[</span><span class="n">a</span><span class="o">*</span><span class="n">x</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">Add</span><span class="o">.</span><span class="n">make_args</span><span class="p">(</span><span class="n">c</span><span class="p">)])</span>
</span><span id="Expr.coeff-1501"><a href="#Expr.coeff-1501"><span class="linenos">1501</span></a>                <span class="k">return</span> <span class="bp">self</span> <span class="o">-</span> <span class="n">Add</span><span class="p">(</span><span class="o">*</span><span class="p">[</span><span class="n">x</span><span class="o">*</span><span class="n">a</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">Add</span><span class="o">.</span><span class="n">make_args</span><span class="p">(</span><span class="n">c</span><span class="p">)])</span>
</span><span id="Expr.coeff-1502"><a href="#Expr.coeff-1502"><span class="linenos">1502</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">as_independent</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">as_Add</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Expr.coeff-1503"><a href="#Expr.coeff-1503"><span class="linenos">1503</span></a>
</span><span id="Expr.coeff-1504"><a href="#Expr.coeff-1504"><span class="linenos">1504</span></a>        <span class="c1"># continue with the full method, looking for this power of x:</span>
</span><span id="Expr.coeff-1505"><a href="#Expr.coeff-1505"><span class="linenos">1505</span></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">**</span><span class="n">n</span>
</span><span id="Expr.coeff-1506"><a href="#Expr.coeff-1506"><span class="linenos">1506</span></a>
</span><span id="Expr.coeff-1507"><a href="#Expr.coeff-1507"><span class="linenos">1507</span></a>        <span class="k">def</span> <span class="nf">incommon</span><span class="p">(</span><span class="n">l1</span><span class="p">,</span> <span class="n">l2</span><span class="p">):</span>
</span><span id="Expr.coeff-1508"><a href="#Expr.coeff-1508"><span class="linenos">1508</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">l1</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">l2</span><span class="p">:</span>
</span><span id="Expr.coeff-1509"><a href="#Expr.coeff-1509"><span class="linenos">1509</span></a>                <span class="k">return</span> <span class="p">[]</span>
</span><span id="Expr.coeff-1510"><a href="#Expr.coeff-1510"><span class="linenos">1510</span></a>            <span class="n">n</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">l1</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">l2</span><span class="p">))</span>
</span><span id="Expr.coeff-1511"><a href="#Expr.coeff-1511"><span class="linenos">1511</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
</span><span id="Expr.coeff-1512"><a href="#Expr.coeff-1512"><span class="linenos">1512</span></a>                <span class="k">if</span> <span class="n">l1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="n">l2</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
</span><span id="Expr.coeff-1513"><a href="#Expr.coeff-1513"><span class="linenos">1513</span></a>                    <span class="k">return</span> <span class="n">l1</span><span class="p">[:</span><span class="n">i</span><span class="p">]</span>
</span><span id="Expr.coeff-1514"><a href="#Expr.coeff-1514"><span class="linenos">1514</span></a>            <span class="k">return</span> <span class="n">l1</span><span class="p">[:]</span>
</span><span id="Expr.coeff-1515"><a href="#Expr.coeff-1515"><span class="linenos">1515</span></a>
</span><span id="Expr.coeff-1516"><a href="#Expr.coeff-1516"><span class="linenos">1516</span></a>        <span class="k">def</span> <span class="nf">find</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">sub</span><span class="p">,</span> <span class="n">first</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="Expr.coeff-1517"><a href="#Expr.coeff-1517"><span class="linenos">1517</span></a><span class="w">            </span><span class="sd">&quot;&quot;&quot; Find where list sub appears in list l. When ``first`` is True</span>
</span><span id="Expr.coeff-1518"><a href="#Expr.coeff-1518"><span class="linenos">1518</span></a><span class="sd">            the first occurrence from the left is returned, else the last</span>
</span><span id="Expr.coeff-1519"><a href="#Expr.coeff-1519"><span class="linenos">1519</span></a><span class="sd">            occurrence is returned. Return None if sub is not in l.</span>
</span><span id="Expr.coeff-1520"><a href="#Expr.coeff-1520"><span class="linenos">1520</span></a>
</span><span id="Expr.coeff-1521"><a href="#Expr.coeff-1521"><span class="linenos">1521</span></a><span class="sd">            Examples</span>
</span><span id="Expr.coeff-1522"><a href="#Expr.coeff-1522"><span class="linenos">1522</span></a><span class="sd">            ========</span>
</span><span id="Expr.coeff-1523"><a href="#Expr.coeff-1523"><span class="linenos">1523</span></a>
</span><span id="Expr.coeff-1524"><a href="#Expr.coeff-1524"><span class="linenos">1524</span></a><span class="sd">            &gt;&gt; l = range(5)*2</span>
</span><span id="Expr.coeff-1525"><a href="#Expr.coeff-1525"><span class="linenos">1525</span></a><span class="sd">            &gt;&gt; find(l, [2, 3])</span>
</span><span id="Expr.coeff-1526"><a href="#Expr.coeff-1526"><span class="linenos">1526</span></a><span class="sd">            2</span>
</span><span id="Expr.coeff-1527"><a href="#Expr.coeff-1527"><span class="linenos">1527</span></a><span class="sd">            &gt;&gt; find(l, [2, 3], first=0)</span>
</span><span id="Expr.coeff-1528"><a href="#Expr.coeff-1528"><span class="linenos">1528</span></a><span class="sd">            7</span>
</span><span id="Expr.coeff-1529"><a href="#Expr.coeff-1529"><span class="linenos">1529</span></a><span class="sd">            &gt;&gt; find(l, [2, 4])</span>
</span><span id="Expr.coeff-1530"><a href="#Expr.coeff-1530"><span class="linenos">1530</span></a><span class="sd">            None</span>
</span><span id="Expr.coeff-1531"><a href="#Expr.coeff-1531"><span class="linenos">1531</span></a>
</span><span id="Expr.coeff-1532"><a href="#Expr.coeff-1532"><span class="linenos">1532</span></a><span class="sd">            &quot;&quot;&quot;</span>
</span><span id="Expr.coeff-1533"><a href="#Expr.coeff-1533"><span class="linenos">1533</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">sub</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">l</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">sub</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">):</span>
</span><span id="Expr.coeff-1534"><a href="#Expr.coeff-1534"><span class="linenos">1534</span></a>                <span class="k">return</span> <span class="kc">None</span>
</span><span id="Expr.coeff-1535"><a href="#Expr.coeff-1535"><span class="linenos">1535</span></a>            <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sub</span><span class="p">)</span>
</span><span id="Expr.coeff-1536"><a href="#Expr.coeff-1536"><span class="linenos">1536</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">first</span><span class="p">:</span>
</span><span id="Expr.coeff-1537"><a href="#Expr.coeff-1537"><span class="linenos">1537</span></a>                <span class="n">l</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
</span><span id="Expr.coeff-1538"><a href="#Expr.coeff-1538"><span class="linenos">1538</span></a>                <span class="n">sub</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
</span><span id="Expr.coeff-1539"><a href="#Expr.coeff-1539"><span class="linenos">1539</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="o">-</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
</span><span id="Expr.coeff-1540"><a href="#Expr.coeff-1540"><span class="linenos">1540</span></a>                <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="n">sub</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)):</span>
</span><span id="Expr.coeff-1541"><a href="#Expr.coeff-1541"><span class="linenos">1541</span></a>                    <span class="k">break</span>
</span><span id="Expr.coeff-1542"><a href="#Expr.coeff-1542"><span class="linenos">1542</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Expr.coeff-1543"><a href="#Expr.coeff-1543"><span class="linenos">1543</span></a>                <span class="n">i</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Expr.coeff-1544"><a href="#Expr.coeff-1544"><span class="linenos">1544</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">first</span><span class="p">:</span>
</span><span id="Expr.coeff-1545"><a href="#Expr.coeff-1545"><span class="linenos">1545</span></a>                <span class="n">l</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
</span><span id="Expr.coeff-1546"><a href="#Expr.coeff-1546"><span class="linenos">1546</span></a>                <span class="n">sub</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
</span><span id="Expr.coeff-1547"><a href="#Expr.coeff-1547"><span class="linenos">1547</span></a>            <span class="k">if</span> <span class="n">i</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">first</span><span class="p">:</span>
</span><span id="Expr.coeff-1548"><a href="#Expr.coeff-1548"><span class="linenos">1548</span></a>                <span class="n">i</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="n">n</span><span class="p">)</span>
</span><span id="Expr.coeff-1549"><a href="#Expr.coeff-1549"><span class="linenos">1549</span></a>            <span class="k">return</span> <span class="n">i</span>
</span><span id="Expr.coeff-1550"><a href="#Expr.coeff-1550"><span class="linenos">1550</span></a>
</span><span id="Expr.coeff-1551"><a href="#Expr.coeff-1551"><span class="linenos">1551</span></a>        <span class="n">co</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Expr.coeff-1552"><a href="#Expr.coeff-1552"><span class="linenos">1552</span></a>        <span class="n">args</span> <span class="o">=</span> <span class="n">Add</span><span class="o">.</span><span class="n">make_args</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="Expr.coeff-1553"><a href="#Expr.coeff-1553"><span class="linenos">1553</span></a>        <span class="n">self_c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_commutative</span>
</span><span id="Expr.coeff-1554"><a href="#Expr.coeff-1554"><span class="linenos">1554</span></a>        <span class="n">x_c</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">is_commutative</span>
</span><span id="Expr.coeff-1555"><a href="#Expr.coeff-1555"><span class="linenos">1555</span></a>        <span class="k">if</span> <span class="n">self_c</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">x_c</span><span class="p">:</span>
</span><span id="Expr.coeff-1556"><a href="#Expr.coeff-1556"><span class="linenos">1556</span></a>            <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">Zero</span>
</span><span id="Expr.coeff-1557"><a href="#Expr.coeff-1557"><span class="linenos">1557</span></a>        <span class="k">if</span> <span class="n">_first</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_Add</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">self_c</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">x_c</span><span class="p">:</span>
</span><span id="Expr.coeff-1558"><a href="#Expr.coeff-1558"><span class="linenos">1558</span></a>            <span class="c1"># get the part that depends on x exactly</span>
</span><span id="Expr.coeff-1559"><a href="#Expr.coeff-1559"><span class="linenos">1559</span></a>            <span class="n">xargs</span> <span class="o">=</span> <span class="n">Mul</span><span class="o">.</span><span class="n">make_args</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span><span id="Expr.coeff-1560"><a href="#Expr.coeff-1560"><span class="linenos">1560</span></a>            <span class="n">d</span> <span class="o">=</span> <span class="n">Add</span><span class="p">(</span><span class="o">*</span><span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">Add</span><span class="o">.</span><span class="n">make_args</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">as_independent</span><span class="p">(</span><span class="n">x</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="Expr.coeff-1561"><a href="#Expr.coeff-1561"><span class="linenos">1561</span></a>                <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="n">xi</span> <span class="ow">in</span> <span class="n">Mul</span><span class="o">.</span><span class="n">make_args</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">xi</span> <span class="ow">in</span> <span class="n">xargs</span><span class="p">)])</span>
</span><span id="Expr.coeff-1562"><a href="#Expr.coeff-1562"><span class="linenos">1562</span></a>            <span class="n">rv</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">coeff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="n">right</span><span class="p">,</span> <span class="n">_first</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="Expr.coeff-1563"><a href="#Expr.coeff-1563"><span class="linenos">1563</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">rv</span><span class="o">.</span><span class="n">is_Add</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">right</span><span class="p">:</span>
</span><span id="Expr.coeff-1564"><a href="#Expr.coeff-1564"><span class="linenos">1564</span></a>                <span class="k">return</span> <span class="n">rv</span>
</span><span id="Expr.coeff-1565"><a href="#Expr.coeff-1565"><span class="linenos">1565</span></a>            <span class="n">c_part</span><span class="p">,</span> <span class="n">nc_part</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">args_cnc</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">rv</span><span class="o">.</span><span class="n">args</span><span class="p">])</span>
</span><span id="Expr.coeff-1566"><a href="#Expr.coeff-1566"><span class="linenos">1566</span></a>            <span class="k">if</span> <span class="n">has_variety</span><span class="p">(</span><span class="n">c_part</span><span class="p">):</span>
</span><span id="Expr.coeff-1567"><a href="#Expr.coeff-1567"><span class="linenos">1567</span></a>                <span class="k">return</span> <span class="n">rv</span>
</span><span id="Expr.coeff-1568"><a href="#Expr.coeff-1568"><span class="linenos">1568</span></a>            <span class="k">return</span> <span class="n">Add</span><span class="p">(</span><span class="o">*</span><span class="p">[</span><span class="n">Mul</span><span class="o">.</span><span class="n">_from_args</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">nc_part</span><span class="p">])</span>
</span><span id="Expr.coeff-1569"><a href="#Expr.coeff-1569"><span class="linenos">1569</span></a>
</span><span id="Expr.coeff-1570"><a href="#Expr.coeff-1570"><span class="linenos">1570</span></a>        <span class="n">one_c</span> <span class="o">=</span> <span class="n">self_c</span> <span class="ow">or</span> <span class="n">x_c</span>
</span><span id="Expr.coeff-1571"><a href="#Expr.coeff-1571"><span class="linenos">1571</span></a>        <span class="n">xargs</span><span class="p">,</span> <span class="n">nx</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">args_cnc</span><span class="p">(</span><span class="n">cset</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">warn</span><span class="o">=</span><span class="nb">bool</span><span class="p">(</span><span class="ow">not</span> <span class="n">x_c</span><span class="p">))</span>
</span><span id="Expr.coeff-1572"><a href="#Expr.coeff-1572"><span class="linenos">1572</span></a>        <span class="c1"># find the parts that pass the commutative terms</span>
</span><span id="Expr.coeff-1573"><a href="#Expr.coeff-1573"><span class="linenos">1573</span></a>        <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">args</span><span class="p">:</span>
</span><span id="Expr.coeff-1574"><a href="#Expr.coeff-1574"><span class="linenos">1574</span></a>            <span class="n">margs</span><span class="p">,</span> <span class="n">nc</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">args_cnc</span><span class="p">(</span><span class="n">cset</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">warn</span><span class="o">=</span><span class="nb">bool</span><span class="p">(</span><span class="ow">not</span> <span class="n">self_c</span><span class="p">))</span>
</span><span id="Expr.coeff-1575"><a href="#Expr.coeff-1575"><span class="linenos">1575</span></a>            <span class="k">if</span> <span class="n">nc</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Expr.coeff-1576"><a href="#Expr.coeff-1576"><span class="linenos">1576</span></a>                <span class="n">nc</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Expr.coeff-1577"><a href="#Expr.coeff-1577"><span class="linenos">1577</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">xargs</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">margs</span><span class="p">):</span>
</span><span id="Expr.coeff-1578"><a href="#Expr.coeff-1578"><span class="linenos">1578</span></a>                <span class="k">continue</span>
</span><span id="Expr.coeff-1579"><a href="#Expr.coeff-1579"><span class="linenos">1579</span></a>            <span class="n">resid</span> <span class="o">=</span> <span class="n">margs</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="n">xargs</span><span class="p">)</span>
</span><span id="Expr.coeff-1580"><a href="#Expr.coeff-1580"><span class="linenos">1580</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">resid</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">xargs</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">margs</span><span class="p">):</span>
</span><span id="Expr.coeff-1581"><a href="#Expr.coeff-1581"><span class="linenos">1581</span></a>                <span class="k">if</span> <span class="n">one_c</span><span class="p">:</span>
</span><span id="Expr.coeff-1582"><a href="#Expr.coeff-1582"><span class="linenos">1582</span></a>                    <span class="n">co</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Mul</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">resid</span><span class="p">)</span> <span class="o">+</span> <span class="n">nc</span><span class="p">)))</span>
</span><span id="Expr.coeff-1583"><a href="#Expr.coeff-1583"><span class="linenos">1583</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="Expr.coeff-1584"><a href="#Expr.coeff-1584"><span class="linenos">1584</span></a>                    <span class="n">co</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">resid</span><span class="p">,</span> <span class="n">nc</span><span class="p">))</span>
</span><span id="Expr.coeff-1585"><a href="#Expr.coeff-1585"><span class="linenos">1585</span></a>        <span class="k">if</span> <span class="n">one_c</span><span class="p">:</span>
</span><span id="Expr.coeff-1586"><a href="#Expr.coeff-1586"><span class="linenos">1586</span></a>            <span class="k">if</span> <span class="n">co</span> <span class="o">==</span> <span class="p">[]:</span>
</span><span id="Expr.coeff-1587"><a href="#Expr.coeff-1587"><span class="linenos">1587</span></a>                <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">Zero</span>
</span><span id="Expr.coeff-1588"><a href="#Expr.coeff-1588"><span class="linenos">1588</span></a>            <span class="k">elif</span> <span class="n">co</span><span class="p">:</span>
</span><span id="Expr.coeff-1589"><a href="#Expr.coeff-1589"><span class="linenos">1589</span></a>                <span class="k">return</span> <span class="n">Add</span><span class="p">(</span><span class="o">*</span><span class="n">co</span><span class="p">)</span>
</span><span id="Expr.coeff-1590"><a href="#Expr.coeff-1590"><span class="linenos">1590</span></a>        <span class="k">else</span><span class="p">:</span>  <span class="c1"># both nc</span>
</span><span id="Expr.coeff-1591"><a href="#Expr.coeff-1591"><span class="linenos">1591</span></a>            <span class="c1"># now check the non-comm parts</span>
</span><span id="Expr.coeff-1592"><a href="#Expr.coeff-1592"><span class="linenos">1592</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">co</span><span class="p">:</span>
</span><span id="Expr.coeff-1593"><a href="#Expr.coeff-1593"><span class="linenos">1593</span></a>                <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">Zero</span>
</span><span id="Expr.coeff-1594"><a href="#Expr.coeff-1594"><span class="linenos">1594</span></a>            <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="n">n</span> <span class="o">==</span> <span class="n">co</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">r</span><span class="p">,</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">co</span><span class="p">):</span>
</span><span id="Expr.coeff-1595"><a href="#Expr.coeff-1595"><span class="linenos">1595</span></a>                <span class="n">ii</span> <span class="o">=</span> <span class="n">find</span><span class="p">(</span><span class="n">co</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">nx</span><span class="p">,</span> <span class="n">right</span><span class="p">)</span>
</span><span id="Expr.coeff-1596"><a href="#Expr.coeff-1596"><span class="linenos">1596</span></a>                <span class="k">if</span> <span class="n">ii</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Expr.coeff-1597"><a href="#Expr.coeff-1597"><span class="linenos">1597</span></a>                    <span class="k">if</span> <span class="ow">not</span> <span class="n">right</span><span class="p">:</span>
</span><span id="Expr.coeff-1598"><a href="#Expr.coeff-1598"><span class="linenos">1598</span></a>                        <span class="k">return</span> <span class="n">Mul</span><span class="p">(</span><span class="n">Add</span><span class="p">(</span><span class="o">*</span><span class="p">[</span><span class="n">Mul</span><span class="p">(</span><span class="o">*</span><span class="n">r</span><span class="p">)</span> <span class="k">for</span> <span class="n">r</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">co</span><span class="p">]),</span> <span class="n">Mul</span><span class="p">(</span><span class="o">*</span><span class="n">co</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">][:</span><span class="n">ii</span><span class="p">]))</span>
</span><span id="Expr.coeff-1599"><a href="#Expr.coeff-1599"><span class="linenos">1599</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="Expr.coeff-1600"><a href="#Expr.coeff-1600"><span class="linenos">1600</span></a>                        <span class="k">return</span> <span class="n">Mul</span><span class="p">(</span><span class="o">*</span><span class="n">co</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="n">ii</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">nx</span><span class="p">):])</span>
</span><span id="Expr.coeff-1601"><a href="#Expr.coeff-1601"><span class="linenos">1601</span></a>            <span class="n">beg</span> <span class="o">=</span> <span class="n">reduce</span><span class="p">(</span><span class="n">incommon</span><span class="p">,</span> <span class="p">(</span><span class="n">n</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">co</span><span class="p">))</span>
</span><span id="Expr.coeff-1602"><a href="#Expr.coeff-1602"><span class="linenos">1602</span></a>            <span class="k">if</span> <span class="n">beg</span><span class="p">:</span>
</span><span id="Expr.coeff-1603"><a href="#Expr.coeff-1603"><span class="linenos">1603</span></a>                <span class="n">ii</span> <span class="o">=</span> <span class="n">find</span><span class="p">(</span><span class="n">beg</span><span class="p">,</span> <span class="n">nx</span><span class="p">,</span> <span class="n">right</span><span class="p">)</span>
</span><span id="Expr.coeff-1604"><a href="#Expr.coeff-1604"><span class="linenos">1604</span></a>                <span class="k">if</span> <span class="n">ii</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Expr.coeff-1605"><a href="#Expr.coeff-1605"><span class="linenos">1605</span></a>                    <span class="k">if</span> <span class="ow">not</span> <span class="n">right</span><span class="p">:</span>
</span><span id="Expr.coeff-1606"><a href="#Expr.coeff-1606"><span class="linenos">1606</span></a>                        <span class="n">gcdc</span> <span class="o">=</span> <span class="n">co</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Expr.coeff-1607"><a href="#Expr.coeff-1607"><span class="linenos">1607</span></a>                        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">co</span><span class="p">)):</span>
</span><span id="Expr.coeff-1608"><a href="#Expr.coeff-1608"><span class="linenos">1608</span></a>                            <span class="n">gcdc</span> <span class="o">=</span> <span class="n">gcdc</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">co</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
</span><span id="Expr.coeff-1609"><a href="#Expr.coeff-1609"><span class="linenos">1609</span></a>                            <span class="k">if</span> <span class="ow">not</span> <span class="n">gcdc</span><span class="p">:</span>
</span><span id="Expr.coeff-1610"><a href="#Expr.coeff-1610"><span class="linenos">1610</span></a>                                <span class="k">break</span>
</span><span id="Expr.coeff-1611"><a href="#Expr.coeff-1611"><span class="linenos">1611</span></a>                        <span class="k">return</span> <span class="n">Mul</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">gcdc</span><span class="p">)</span> <span class="o">+</span> <span class="n">beg</span><span class="p">[:</span><span class="n">ii</span><span class="p">]))</span>
</span><span id="Expr.coeff-1612"><a href="#Expr.coeff-1612"><span class="linenos">1612</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="Expr.coeff-1613"><a href="#Expr.coeff-1613"><span class="linenos">1613</span></a>                        <span class="n">m</span> <span class="o">=</span> <span class="n">ii</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">nx</span><span class="p">)</span>
</span><span id="Expr.coeff-1614"><a href="#Expr.coeff-1614"><span class="linenos">1614</span></a>                        <span class="k">return</span> <span class="n">Add</span><span class="p">(</span><span class="o">*</span><span class="p">[</span><span class="n">Mul</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="o">+</span> <span class="n">n</span><span class="p">[</span><span class="n">m</span><span class="p">:]))</span> <span class="k">for</span> <span class="n">r</span><span class="p">,</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">co</span><span class="p">])</span>
</span><span id="Expr.coeff-1615"><a href="#Expr.coeff-1615"><span class="linenos">1615</span></a>            <span class="n">end</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span>
</span><span id="Expr.coeff-1616"><a href="#Expr.coeff-1616"><span class="linenos">1616</span></a>                <span class="n">reduce</span><span class="p">(</span><span class="n">incommon</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="n">n</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">co</span><span class="p">))))</span>
</span><span id="Expr.coeff-1617"><a href="#Expr.coeff-1617"><span class="linenos">1617</span></a>            <span class="k">if</span> <span class="n">end</span><span class="p">:</span>
</span><span id="Expr.coeff-1618"><a href="#Expr.coeff-1618"><span class="linenos">1618</span></a>                <span class="n">ii</span> <span class="o">=</span> <span class="n">find</span><span class="p">(</span><span class="n">end</span><span class="p">,</span> <span class="n">nx</span><span class="p">,</span> <span class="n">right</span><span class="p">)</span>
</span><span id="Expr.coeff-1619"><a href="#Expr.coeff-1619"><span class="linenos">1619</span></a>                <span class="k">if</span> <span class="n">ii</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Expr.coeff-1620"><a href="#Expr.coeff-1620"><span class="linenos">1620</span></a>                    <span class="k">if</span> <span class="ow">not</span> <span class="n">right</span><span class="p">:</span>
</span><span id="Expr.coeff-1621"><a href="#Expr.coeff-1621"><span class="linenos">1621</span></a>                        <span class="k">return</span> <span class="n">Add</span><span class="p">(</span><span class="o">*</span><span class="p">[</span><span class="n">Mul</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="o">+</span> <span class="n">n</span><span class="p">[:</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">end</span><span class="p">)</span> <span class="o">+</span> <span class="n">ii</span><span class="p">]))</span> <span class="k">for</span> <span class="n">r</span><span class="p">,</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">co</span><span class="p">])</span>
</span><span id="Expr.coeff-1622"><a href="#Expr.coeff-1622"><span class="linenos">1622</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="Expr.coeff-1623"><a href="#Expr.coeff-1623"><span class="linenos">1623</span></a>                        <span class="k">return</span> <span class="n">Mul</span><span class="p">(</span><span class="o">*</span><span class="n">end</span><span class="p">[</span><span class="n">ii</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">nx</span><span class="p">):])</span>
</span><span id="Expr.coeff-1624"><a href="#Expr.coeff-1624"><span class="linenos">1624</span></a>            <span class="c1"># look for single match</span>
</span><span id="Expr.coeff-1625"><a href="#Expr.coeff-1625"><span class="linenos">1625</span></a>            <span class="n">hit</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Expr.coeff-1626"><a href="#Expr.coeff-1626"><span class="linenos">1626</span></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">co</span><span class="p">):</span>
</span><span id="Expr.coeff-1627"><a href="#Expr.coeff-1627"><span class="linenos">1627</span></a>                <span class="n">ii</span> <span class="o">=</span> <span class="n">find</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">nx</span><span class="p">,</span> <span class="n">right</span><span class="p">)</span>
</span><span id="Expr.coeff-1628"><a href="#Expr.coeff-1628"><span class="linenos">1628</span></a>                <span class="k">if</span> <span class="n">ii</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Expr.coeff-1629"><a href="#Expr.coeff-1629"><span class="linenos">1629</span></a>                    <span class="k">if</span> <span class="ow">not</span> <span class="n">hit</span><span class="p">:</span>
</span><span id="Expr.coeff-1630"><a href="#Expr.coeff-1630"><span class="linenos">1630</span></a>                        <span class="n">hit</span> <span class="o">=</span> <span class="n">ii</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">n</span>
</span><span id="Expr.coeff-1631"><a href="#Expr.coeff-1631"><span class="linenos">1631</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="Expr.coeff-1632"><a href="#Expr.coeff-1632"><span class="linenos">1632</span></a>                        <span class="k">break</span>
</span><span id="Expr.coeff-1633"><a href="#Expr.coeff-1633"><span class="linenos">1633</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Expr.coeff-1634"><a href="#Expr.coeff-1634"><span class="linenos">1634</span></a>                <span class="k">if</span> <span class="n">hit</span><span class="p">:</span>
</span><span id="Expr.coeff-1635"><a href="#Expr.coeff-1635"><span class="linenos">1635</span></a>                    <span class="n">ii</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="n">hit</span>
</span><span id="Expr.coeff-1636"><a href="#Expr.coeff-1636"><span class="linenos">1636</span></a>                    <span class="k">if</span> <span class="ow">not</span> <span class="n">right</span><span class="p">:</span>
</span><span id="Expr.coeff-1637"><a href="#Expr.coeff-1637"><span class="linenos">1637</span></a>                        <span class="k">return</span> <span class="n">Mul</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="o">+</span> <span class="n">n</span><span class="p">[:</span><span class="n">ii</span><span class="p">]))</span>
</span><span id="Expr.coeff-1638"><a href="#Expr.coeff-1638"><span class="linenos">1638</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="Expr.coeff-1639"><a href="#Expr.coeff-1639"><span class="linenos">1639</span></a>                        <span class="k">return</span> <span class="n">Mul</span><span class="p">(</span><span class="o">*</span><span class="n">n</span><span class="p">[</span><span class="n">ii</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">nx</span><span class="p">):])</span>
</span><span id="Expr.coeff-1640"><a href="#Expr.coeff-1640"><span class="linenos">1640</span></a>
</span><span id="Expr.coeff-1641"><a href="#Expr.coeff-1641"><span class="linenos">1641</span></a>            <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">Zero</span>
</span></pre></div>


            <div class="docstring"><p>Returns the coefficient from the term(s) containing <code>x**n</code>. If <code><a href="#Expr.n">n</a></code>
is zero then all terms independent of <code>x</code> will be returned.</p>

<h1 id="explanation">Explanation</h1>

<p>When <code>x</code> is noncommutative, the coefficient to the left (default) or
right of <code>x</code> can be returned. The keyword 'right' is ignored when
<code>x</code> is commutative.</p>

<h1 id="examples">Examples</h1>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">symbols</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.abc</span> <span class="kn">import</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span>
</code></pre>
</div>

<p>You can select terms that have an explicit negative in front of them:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="o">-</span><span class="n">x</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">coeff</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">x</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">coeff</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">2*y</span>
</code></pre>
</div>

<p>You can select terms with no Rational coefficient:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">coeff</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">x</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">coeff</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">0</span>
</code></pre>
</div>

<p>You can select terms independent of x by making n=0; in this case
expr.as_independent(x)[0] is returned (and 0 will be returned instead
of None):</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">coeff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="go">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eq</span> <span class="o">=</span> <span class="p">((</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span> <span class="o">+</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eq</span>
<span class="go">x**3 + 3*x**2 + 3*x + 2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="n">eq</span><span class="o">.</span><span class="n">coeff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">))]</span>
<span class="go">[1, 3, 3, 2]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eq</span> <span class="o">-=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="n">eq</span><span class="o">.</span><span class="n">coeff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">))]</span>
<span class="go">[1, 3, 3, 0]</span>
</code></pre>
</div>

<p>You can select terms that have a numerical term in front of them:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="o">-</span><span class="n">x</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">coeff</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">-y</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">sqrt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">coeff</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="go">x</span>
</code></pre>
</div>

<p>The matching is exact:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">coeff</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">coeff</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="go">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">coeff</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">z</span><span class="o">*</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">coeff</span><span class="p">((</span><span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="go">z</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">z</span><span class="o">*</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">coeff</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="p">)</span>
<span class="go">0</span>
</code></pre>
</div>

<p>In addition, no factoring is done, so 1 + z*(1 + y) is not obtained
from the following:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">z</span><span class="o">*</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="p">))</span><span class="o">.</span><span class="n">coeff</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">1</span>
</code></pre>
</div>

<p>If such factoring is desired, factor_terms can be used first:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">factor_terms</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">factor_terms</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">z</span><span class="o">*</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="p">))</span><span class="o">.</span><span class="n">coeff</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">z*(y + 1) + 1</span>
</code></pre>
</div>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">o</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;n m o&#39;</span><span class="p">,</span> <span class="n">commutative</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n</span><span class="o">.</span><span class="n">coeff</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">n</span><span class="p">)</span><span class="o">.</span><span class="n">coeff</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="go">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">n</span><span class="o">*</span><span class="n">m</span> <span class="o">+</span> <span class="n">m</span><span class="o">*</span><span class="n">n</span><span class="o">*</span><span class="n">m</span><span class="p">)</span><span class="o">.</span><span class="n">coeff</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="c1"># = (1 + m)*n*m</span>
<span class="go">1 + m</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">n</span><span class="o">*</span><span class="n">m</span> <span class="o">+</span> <span class="n">m</span><span class="o">*</span><span class="n">n</span><span class="o">*</span><span class="n">m</span><span class="p">)</span><span class="o">.</span><span class="n">coeff</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># = (1 + m)*n*m</span>
<span class="go">m</span>
</code></pre>
</div>

<p>If there is more than one possible coefficient 0 is returned:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">n</span><span class="o">*</span><span class="n">m</span> <span class="o">+</span> <span class="n">m</span><span class="o">*</span><span class="n">n</span><span class="p">)</span><span class="o">.</span><span class="n">coeff</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="go">0</span>
</code></pre>
</div>

<p>If there is only one possible coefficient, it is returned:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">n</span><span class="o">*</span><span class="n">m</span> <span class="o">+</span> <span class="n">x</span><span class="o">*</span><span class="n">m</span><span class="o">*</span><span class="n">n</span><span class="p">)</span><span class="o">.</span><span class="n">coeff</span><span class="p">(</span><span class="n">m</span><span class="o">*</span><span class="n">n</span><span class="p">)</span>
<span class="go">x</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">n</span><span class="o">*</span><span class="n">m</span> <span class="o">+</span> <span class="n">x</span><span class="o">*</span><span class="n">m</span><span class="o">*</span><span class="n">n</span><span class="p">)</span><span class="o">.</span><span class="n">coeff</span><span class="p">(</span><span class="n">m</span><span class="o">*</span><span class="n">n</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">1</span>
</code></pre>
</div>

<h1 id="see-also">See Also</h1>

<p>as_coefficient: separate the expression into a coefficient and factor
as_coeff_Add: separate the additive constant from an expression
as_coeff_Mul: separate the multiplicative constant from an expression
as_independent: separate x-dependent terms/factors from others
sympy.polys.polytools.Poly.coeff_monomial: efficiently find the single coefficient of a monomial in Poly
sympy.polys.polytools.Poly.nth: like coeff_monomial but powers of monomial terms are used</p>
</div>


                            </div>
                            <div id="Expr.as_expr" class="classattr">
                                        <input id="Expr.as_expr-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">as_expr</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="o">*</span><span class="n">gens</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Expr.as_expr-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Expr.as_expr"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Expr.as_expr-1643"><a href="#Expr.as_expr-1643"><span class="linenos">1643</span></a>    <span class="k">def</span> <span class="nf">as_expr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">gens</span><span class="p">):</span>
</span><span id="Expr.as_expr-1644"><a href="#Expr.as_expr-1644"><span class="linenos">1644</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Expr.as_expr-1645"><a href="#Expr.as_expr-1645"><span class="linenos">1645</span></a><span class="sd">        Convert a polynomial to a SymPy expression.</span>
</span><span id="Expr.as_expr-1646"><a href="#Expr.as_expr-1646"><span class="linenos">1646</span></a>
</span><span id="Expr.as_expr-1647"><a href="#Expr.as_expr-1647"><span class="linenos">1647</span></a><span class="sd">        Examples</span>
</span><span id="Expr.as_expr-1648"><a href="#Expr.as_expr-1648"><span class="linenos">1648</span></a><span class="sd">        ========</span>
</span><span id="Expr.as_expr-1649"><a href="#Expr.as_expr-1649"><span class="linenos">1649</span></a>
</span><span id="Expr.as_expr-1650"><a href="#Expr.as_expr-1650"><span class="linenos">1650</span></a><span class="sd">        &gt;&gt;&gt; from sympy import sin</span>
</span><span id="Expr.as_expr-1651"><a href="#Expr.as_expr-1651"><span class="linenos">1651</span></a><span class="sd">        &gt;&gt;&gt; from sympy.abc import x, y</span>
</span><span id="Expr.as_expr-1652"><a href="#Expr.as_expr-1652"><span class="linenos">1652</span></a>
</span><span id="Expr.as_expr-1653"><a href="#Expr.as_expr-1653"><span class="linenos">1653</span></a><span class="sd">        &gt;&gt;&gt; f = (x**2 + x*y).as_poly(x, y)</span>
</span><span id="Expr.as_expr-1654"><a href="#Expr.as_expr-1654"><span class="linenos">1654</span></a><span class="sd">        &gt;&gt;&gt; f.as_expr()</span>
</span><span id="Expr.as_expr-1655"><a href="#Expr.as_expr-1655"><span class="linenos">1655</span></a><span class="sd">        x**2 + x*y</span>
</span><span id="Expr.as_expr-1656"><a href="#Expr.as_expr-1656"><span class="linenos">1656</span></a>
</span><span id="Expr.as_expr-1657"><a href="#Expr.as_expr-1657"><span class="linenos">1657</span></a><span class="sd">        &gt;&gt;&gt; sin(x).as_expr()</span>
</span><span id="Expr.as_expr-1658"><a href="#Expr.as_expr-1658"><span class="linenos">1658</span></a><span class="sd">        sin(x)</span>
</span><span id="Expr.as_expr-1659"><a href="#Expr.as_expr-1659"><span class="linenos">1659</span></a>
</span><span id="Expr.as_expr-1660"><a href="#Expr.as_expr-1660"><span class="linenos">1660</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Expr.as_expr-1661"><a href="#Expr.as_expr-1661"><span class="linenos">1661</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span></pre></div>


            <div class="docstring"><p>Convert a polynomial to a SymPy expression.</p>

<h1 id="examples">Examples</h1>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">sin</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.abc</span> <span class="kn">import</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>
</code></pre>
</div>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">as_poly</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">as_expr</span><span class="p">()</span>
<span class="go">x**2 + x*y</span>
</code></pre>
</div>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">as_expr</span><span class="p">()</span>
<span class="go">sin(x)</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="Expr.as_coefficient" class="classattr">
                                        <input id="Expr.as_coefficient-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">as_coefficient</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">expr</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Expr.as_coefficient-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Expr.as_coefficient"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Expr.as_coefficient-1663"><a href="#Expr.as_coefficient-1663"><span class="linenos">1663</span></a>    <span class="k">def</span> <span class="nf">as_coefficient</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
</span><span id="Expr.as_coefficient-1664"><a href="#Expr.as_coefficient-1664"><span class="linenos">1664</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Expr.as_coefficient-1665"><a href="#Expr.as_coefficient-1665"><span class="linenos">1665</span></a><span class="sd">        Extracts symbolic coefficient at the given expression. In</span>
</span><span id="Expr.as_coefficient-1666"><a href="#Expr.as_coefficient-1666"><span class="linenos">1666</span></a><span class="sd">        other words, this functions separates &#39;self&#39; into the product</span>
</span><span id="Expr.as_coefficient-1667"><a href="#Expr.as_coefficient-1667"><span class="linenos">1667</span></a><span class="sd">        of &#39;expr&#39; and &#39;expr&#39;-free coefficient. If such separation</span>
</span><span id="Expr.as_coefficient-1668"><a href="#Expr.as_coefficient-1668"><span class="linenos">1668</span></a><span class="sd">        is not possible it will return None.</span>
</span><span id="Expr.as_coefficient-1669"><a href="#Expr.as_coefficient-1669"><span class="linenos">1669</span></a>
</span><span id="Expr.as_coefficient-1670"><a href="#Expr.as_coefficient-1670"><span class="linenos">1670</span></a><span class="sd">        Examples</span>
</span><span id="Expr.as_coefficient-1671"><a href="#Expr.as_coefficient-1671"><span class="linenos">1671</span></a><span class="sd">        ========</span>
</span><span id="Expr.as_coefficient-1672"><a href="#Expr.as_coefficient-1672"><span class="linenos">1672</span></a>
</span><span id="Expr.as_coefficient-1673"><a href="#Expr.as_coefficient-1673"><span class="linenos">1673</span></a><span class="sd">        &gt;&gt;&gt; from sympy import E, pi, sin, I, Poly</span>
</span><span id="Expr.as_coefficient-1674"><a href="#Expr.as_coefficient-1674"><span class="linenos">1674</span></a><span class="sd">        &gt;&gt;&gt; from sympy.abc import x</span>
</span><span id="Expr.as_coefficient-1675"><a href="#Expr.as_coefficient-1675"><span class="linenos">1675</span></a>
</span><span id="Expr.as_coefficient-1676"><a href="#Expr.as_coefficient-1676"><span class="linenos">1676</span></a><span class="sd">        &gt;&gt;&gt; E.as_coefficient(E)</span>
</span><span id="Expr.as_coefficient-1677"><a href="#Expr.as_coefficient-1677"><span class="linenos">1677</span></a><span class="sd">        1</span>
</span><span id="Expr.as_coefficient-1678"><a href="#Expr.as_coefficient-1678"><span class="linenos">1678</span></a><span class="sd">        &gt;&gt;&gt; (2*E).as_coefficient(E)</span>
</span><span id="Expr.as_coefficient-1679"><a href="#Expr.as_coefficient-1679"><span class="linenos">1679</span></a><span class="sd">        2</span>
</span><span id="Expr.as_coefficient-1680"><a href="#Expr.as_coefficient-1680"><span class="linenos">1680</span></a><span class="sd">        &gt;&gt;&gt; (2*sin(E)*E).as_coefficient(E)</span>
</span><span id="Expr.as_coefficient-1681"><a href="#Expr.as_coefficient-1681"><span class="linenos">1681</span></a>
</span><span id="Expr.as_coefficient-1682"><a href="#Expr.as_coefficient-1682"><span class="linenos">1682</span></a><span class="sd">        Two terms have E in them so a sum is returned. (If one were</span>
</span><span id="Expr.as_coefficient-1683"><a href="#Expr.as_coefficient-1683"><span class="linenos">1683</span></a><span class="sd">        desiring the coefficient of the term exactly matching E then</span>
</span><span id="Expr.as_coefficient-1684"><a href="#Expr.as_coefficient-1684"><span class="linenos">1684</span></a><span class="sd">        the constant from the returned expression could be selected.</span>
</span><span id="Expr.as_coefficient-1685"><a href="#Expr.as_coefficient-1685"><span class="linenos">1685</span></a><span class="sd">        Or, for greater precision, a method of Poly can be used to</span>
</span><span id="Expr.as_coefficient-1686"><a href="#Expr.as_coefficient-1686"><span class="linenos">1686</span></a><span class="sd">        indicate the desired term from which the coefficient is</span>
</span><span id="Expr.as_coefficient-1687"><a href="#Expr.as_coefficient-1687"><span class="linenos">1687</span></a><span class="sd">        desired.)</span>
</span><span id="Expr.as_coefficient-1688"><a href="#Expr.as_coefficient-1688"><span class="linenos">1688</span></a>
</span><span id="Expr.as_coefficient-1689"><a href="#Expr.as_coefficient-1689"><span class="linenos">1689</span></a><span class="sd">        &gt;&gt;&gt; (2*E + x*E).as_coefficient(E)</span>
</span><span id="Expr.as_coefficient-1690"><a href="#Expr.as_coefficient-1690"><span class="linenos">1690</span></a><span class="sd">        x + 2</span>
</span><span id="Expr.as_coefficient-1691"><a href="#Expr.as_coefficient-1691"><span class="linenos">1691</span></a><span class="sd">        &gt;&gt;&gt; _.args[0]  # just want the exact match</span>
</span><span id="Expr.as_coefficient-1692"><a href="#Expr.as_coefficient-1692"><span class="linenos">1692</span></a><span class="sd">        2</span>
</span><span id="Expr.as_coefficient-1693"><a href="#Expr.as_coefficient-1693"><span class="linenos">1693</span></a><span class="sd">        &gt;&gt;&gt; p = Poly(2*E + x*E); p</span>
</span><span id="Expr.as_coefficient-1694"><a href="#Expr.as_coefficient-1694"><span class="linenos">1694</span></a><span class="sd">        Poly(x*E + 2*E, x, E, domain=&#39;ZZ&#39;)</span>
</span><span id="Expr.as_coefficient-1695"><a href="#Expr.as_coefficient-1695"><span class="linenos">1695</span></a><span class="sd">        &gt;&gt;&gt; p.coeff_monomial(E)</span>
</span><span id="Expr.as_coefficient-1696"><a href="#Expr.as_coefficient-1696"><span class="linenos">1696</span></a><span class="sd">        2</span>
</span><span id="Expr.as_coefficient-1697"><a href="#Expr.as_coefficient-1697"><span class="linenos">1697</span></a><span class="sd">        &gt;&gt;&gt; p.nth(0, 1)</span>
</span><span id="Expr.as_coefficient-1698"><a href="#Expr.as_coefficient-1698"><span class="linenos">1698</span></a><span class="sd">        2</span>
</span><span id="Expr.as_coefficient-1699"><a href="#Expr.as_coefficient-1699"><span class="linenos">1699</span></a>
</span><span id="Expr.as_coefficient-1700"><a href="#Expr.as_coefficient-1700"><span class="linenos">1700</span></a><span class="sd">        Since the following cannot be written as a product containing</span>
</span><span id="Expr.as_coefficient-1701"><a href="#Expr.as_coefficient-1701"><span class="linenos">1701</span></a><span class="sd">        E as a factor, None is returned. (If the coefficient ``2*x`` is</span>
</span><span id="Expr.as_coefficient-1702"><a href="#Expr.as_coefficient-1702"><span class="linenos">1702</span></a><span class="sd">        desired then the ``coeff`` method should be used.)</span>
</span><span id="Expr.as_coefficient-1703"><a href="#Expr.as_coefficient-1703"><span class="linenos">1703</span></a>
</span><span id="Expr.as_coefficient-1704"><a href="#Expr.as_coefficient-1704"><span class="linenos">1704</span></a><span class="sd">        &gt;&gt;&gt; (2*E*x + x).as_coefficient(E)</span>
</span><span id="Expr.as_coefficient-1705"><a href="#Expr.as_coefficient-1705"><span class="linenos">1705</span></a><span class="sd">        &gt;&gt;&gt; (2*E*x + x).coeff(E)</span>
</span><span id="Expr.as_coefficient-1706"><a href="#Expr.as_coefficient-1706"><span class="linenos">1706</span></a><span class="sd">        2*x</span>
</span><span id="Expr.as_coefficient-1707"><a href="#Expr.as_coefficient-1707"><span class="linenos">1707</span></a>
</span><span id="Expr.as_coefficient-1708"><a href="#Expr.as_coefficient-1708"><span class="linenos">1708</span></a><span class="sd">        &gt;&gt;&gt; (E*(x + 1) + x).as_coefficient(E)</span>
</span><span id="Expr.as_coefficient-1709"><a href="#Expr.as_coefficient-1709"><span class="linenos">1709</span></a>
</span><span id="Expr.as_coefficient-1710"><a href="#Expr.as_coefficient-1710"><span class="linenos">1710</span></a><span class="sd">        &gt;&gt;&gt; (2*pi*I).as_coefficient(pi*I)</span>
</span><span id="Expr.as_coefficient-1711"><a href="#Expr.as_coefficient-1711"><span class="linenos">1711</span></a><span class="sd">        2</span>
</span><span id="Expr.as_coefficient-1712"><a href="#Expr.as_coefficient-1712"><span class="linenos">1712</span></a><span class="sd">        &gt;&gt;&gt; (2*I).as_coefficient(pi*I)</span>
</span><span id="Expr.as_coefficient-1713"><a href="#Expr.as_coefficient-1713"><span class="linenos">1713</span></a>
</span><span id="Expr.as_coefficient-1714"><a href="#Expr.as_coefficient-1714"><span class="linenos">1714</span></a><span class="sd">        See Also</span>
</span><span id="Expr.as_coefficient-1715"><a href="#Expr.as_coefficient-1715"><span class="linenos">1715</span></a><span class="sd">        ========</span>
</span><span id="Expr.as_coefficient-1716"><a href="#Expr.as_coefficient-1716"><span class="linenos">1716</span></a>
</span><span id="Expr.as_coefficient-1717"><a href="#Expr.as_coefficient-1717"><span class="linenos">1717</span></a><span class="sd">        coeff: return sum of terms have a given factor</span>
</span><span id="Expr.as_coefficient-1718"><a href="#Expr.as_coefficient-1718"><span class="linenos">1718</span></a><span class="sd">        as_coeff_Add: separate the additive constant from an expression</span>
</span><span id="Expr.as_coefficient-1719"><a href="#Expr.as_coefficient-1719"><span class="linenos">1719</span></a><span class="sd">        as_coeff_Mul: separate the multiplicative constant from an expression</span>
</span><span id="Expr.as_coefficient-1720"><a href="#Expr.as_coefficient-1720"><span class="linenos">1720</span></a><span class="sd">        as_independent: separate x-dependent terms/factors from others</span>
</span><span id="Expr.as_coefficient-1721"><a href="#Expr.as_coefficient-1721"><span class="linenos">1721</span></a><span class="sd">        sympy.polys.polytools.Poly.coeff_monomial: efficiently find the single coefficient of a monomial in Poly</span>
</span><span id="Expr.as_coefficient-1722"><a href="#Expr.as_coefficient-1722"><span class="linenos">1722</span></a><span class="sd">        sympy.polys.polytools.Poly.nth: like coeff_monomial but powers of monomial terms are used</span>
</span><span id="Expr.as_coefficient-1723"><a href="#Expr.as_coefficient-1723"><span class="linenos">1723</span></a>
</span><span id="Expr.as_coefficient-1724"><a href="#Expr.as_coefficient-1724"><span class="linenos">1724</span></a>
</span><span id="Expr.as_coefficient-1725"><a href="#Expr.as_coefficient-1725"><span class="linenos">1725</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Expr.as_coefficient-1726"><a href="#Expr.as_coefficient-1726"><span class="linenos">1726</span></a>
</span><span id="Expr.as_coefficient-1727"><a href="#Expr.as_coefficient-1727"><span class="linenos">1727</span></a>        <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">extract_multiplicatively</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span>
</span><span id="Expr.as_coefficient-1728"><a href="#Expr.as_coefficient-1728"><span class="linenos">1728</span></a>        <span class="k">if</span> <span class="n">r</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">r</span><span class="o">.</span><span class="n">has</span><span class="p">(</span><span class="n">expr</span><span class="p">):</span>
</span><span id="Expr.as_coefficient-1729"><a href="#Expr.as_coefficient-1729"><span class="linenos">1729</span></a>            <span class="k">return</span> <span class="n">r</span>
</span></pre></div>


            <div class="docstring"><p>Extracts symbolic coefficient at the given expression. In
other words, this functions separates 'self' into the product
of 'expr' and 'expr'-free coefficient. If such separation
is not possible it will return None.</p>

<h1 id="examples">Examples</h1>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">E</span><span class="p">,</span> <span class="n">pi</span><span class="p">,</span> <span class="n">sin</span><span class="p">,</span> <span class="n">I</span><span class="p">,</span> <span class="n">Poly</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.abc</span> <span class="kn">import</span> <span class="n">x</span>
</code></pre>
</div>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">E</span><span class="o">.</span><span class="n">as_coefficient</span><span class="p">(</span><span class="n">E</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">E</span><span class="p">)</span><span class="o">.</span><span class="n">as_coefficient</span><span class="p">(</span><span class="n">E</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">E</span><span class="p">)</span><span class="o">*</span><span class="n">E</span><span class="p">)</span><span class="o">.</span><span class="n">as_coefficient</span><span class="p">(</span><span class="n">E</span><span class="p">)</span>
</code></pre>
</div>

<p>Two terms have E in them so a sum is returned. (If one were
desiring the coefficient of the term exactly matching E then
the constant from the returned expression could be selected.
Or, for greater precision, a method of Poly can be used to
indicate the desired term from which the coefficient is
desired.)</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">E</span> <span class="o">+</span> <span class="n">x</span><span class="o">*</span><span class="n">E</span><span class="p">)</span><span class="o">.</span><span class="n">as_coefficient</span><span class="p">(</span><span class="n">E</span><span class="p">)</span>
<span class="go">x + 2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># just want the exact match</span>
<span class="go">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">Poly</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">E</span> <span class="o">+</span> <span class="n">x</span><span class="o">*</span><span class="n">E</span><span class="p">);</span> <span class="n">p</span>
<span class="go">Poly(x*E + 2*E, x, E, domain=&#39;ZZ&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">coeff_monomial</span><span class="p">(</span><span class="n">E</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">nth</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">2</span>
</code></pre>
</div>

<p>Since the following cannot be written as a product containing
E as a factor, None is returned. (If the coefficient <code>2*x</code> is
desired then the <code><a href="#Expr.coeff">coeff</a></code> method should be used.)</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">E</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">as_coefficient</span><span class="p">(</span><span class="n">E</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">E</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">coeff</span><span class="p">(</span><span class="n">E</span><span class="p">)</span>
<span class="go">2*x</span>
</code></pre>
</div>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">E</span><span class="o">*</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">as_coefficient</span><span class="p">(</span><span class="n">E</span><span class="p">)</span>
</code></pre>
</div>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">I</span><span class="p">)</span><span class="o">.</span><span class="n">as_coefficient</span><span class="p">(</span><span class="n">pi</span><span class="o">*</span><span class="n">I</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">I</span><span class="p">)</span><span class="o">.</span><span class="n">as_coefficient</span><span class="p">(</span><span class="n">pi</span><span class="o">*</span><span class="n">I</span><span class="p">)</span>
</code></pre>
</div>

<h1 id="see-also">See Also</h1>

<p>coeff: return sum of terms have a given factor
as_coeff_Add: separate the additive constant from an expression
as_coeff_Mul: separate the multiplicative constant from an expression
as_independent: separate x-dependent terms/factors from others
sympy.polys.polytools.Poly.coeff_monomial: efficiently find the single coefficient of a monomial in Poly
sympy.polys.polytools.Poly.nth: like coeff_monomial but powers of monomial terms are used</p>
</div>


                            </div>
                            <div id="Expr.as_independent" class="classattr">
                                        <input id="Expr.as_independent-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">as_independent</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="o">*</span><span class="n">deps</span>, </span><span class="param"><span class="o">**</span><span class="n">hint</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Expr.as_independent-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Expr.as_independent"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Expr.as_independent-1731"><a href="#Expr.as_independent-1731"><span class="linenos">1731</span></a>    <span class="k">def</span> <span class="nf">as_independent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">deps</span><span class="p">,</span> <span class="o">**</span><span class="n">hint</span><span class="p">):</span>
</span><span id="Expr.as_independent-1732"><a href="#Expr.as_independent-1732"><span class="linenos">1732</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Expr.as_independent-1733"><a href="#Expr.as_independent-1733"><span class="linenos">1733</span></a><span class="sd">        A mostly naive separation of a Mul or Add into arguments that are not</span>
</span><span id="Expr.as_independent-1734"><a href="#Expr.as_independent-1734"><span class="linenos">1734</span></a><span class="sd">        are dependent on deps. To obtain as complete a separation of variables</span>
</span><span id="Expr.as_independent-1735"><a href="#Expr.as_independent-1735"><span class="linenos">1735</span></a><span class="sd">        as possible, use a separation method first, e.g.:</span>
</span><span id="Expr.as_independent-1736"><a href="#Expr.as_independent-1736"><span class="linenos">1736</span></a>
</span><span id="Expr.as_independent-1737"><a href="#Expr.as_independent-1737"><span class="linenos">1737</span></a><span class="sd">        * separatevars() to change Mul, Add and Pow (including exp) into Mul</span>
</span><span id="Expr.as_independent-1738"><a href="#Expr.as_independent-1738"><span class="linenos">1738</span></a><span class="sd">        * .expand(mul=True) to change Add or Mul into Add</span>
</span><span id="Expr.as_independent-1739"><a href="#Expr.as_independent-1739"><span class="linenos">1739</span></a><span class="sd">        * .expand(log=True) to change log expr into an Add</span>
</span><span id="Expr.as_independent-1740"><a href="#Expr.as_independent-1740"><span class="linenos">1740</span></a>
</span><span id="Expr.as_independent-1741"><a href="#Expr.as_independent-1741"><span class="linenos">1741</span></a><span class="sd">        The only non-naive thing that is done here is to respect noncommutative</span>
</span><span id="Expr.as_independent-1742"><a href="#Expr.as_independent-1742"><span class="linenos">1742</span></a><span class="sd">        ordering of variables and to always return (0, 0) for `self` of zero</span>
</span><span id="Expr.as_independent-1743"><a href="#Expr.as_independent-1743"><span class="linenos">1743</span></a><span class="sd">        regardless of hints.</span>
</span><span id="Expr.as_independent-1744"><a href="#Expr.as_independent-1744"><span class="linenos">1744</span></a>
</span><span id="Expr.as_independent-1745"><a href="#Expr.as_independent-1745"><span class="linenos">1745</span></a><span class="sd">        For nonzero `self`, the returned tuple (i, d) has the</span>
</span><span id="Expr.as_independent-1746"><a href="#Expr.as_independent-1746"><span class="linenos">1746</span></a><span class="sd">        following interpretation:</span>
</span><span id="Expr.as_independent-1747"><a href="#Expr.as_independent-1747"><span class="linenos">1747</span></a>
</span><span id="Expr.as_independent-1748"><a href="#Expr.as_independent-1748"><span class="linenos">1748</span></a><span class="sd">        * i will has no variable that appears in deps</span>
</span><span id="Expr.as_independent-1749"><a href="#Expr.as_independent-1749"><span class="linenos">1749</span></a><span class="sd">        * d will either have terms that contain variables that are in deps, or</span>
</span><span id="Expr.as_independent-1750"><a href="#Expr.as_independent-1750"><span class="linenos">1750</span></a><span class="sd">          be equal to 0 (when self is an Add) or 1 (when self is a Mul)</span>
</span><span id="Expr.as_independent-1751"><a href="#Expr.as_independent-1751"><span class="linenos">1751</span></a><span class="sd">        * if self is an Add then self = i + d</span>
</span><span id="Expr.as_independent-1752"><a href="#Expr.as_independent-1752"><span class="linenos">1752</span></a><span class="sd">        * if self is a Mul then self = i*d</span>
</span><span id="Expr.as_independent-1753"><a href="#Expr.as_independent-1753"><span class="linenos">1753</span></a><span class="sd">        * otherwise (self, S.One) or (S.One, self) is returned.</span>
</span><span id="Expr.as_independent-1754"><a href="#Expr.as_independent-1754"><span class="linenos">1754</span></a>
</span><span id="Expr.as_independent-1755"><a href="#Expr.as_independent-1755"><span class="linenos">1755</span></a><span class="sd">        To force the expression to be treated as an Add, use the hint as_Add=True</span>
</span><span id="Expr.as_independent-1756"><a href="#Expr.as_independent-1756"><span class="linenos">1756</span></a>
</span><span id="Expr.as_independent-1757"><a href="#Expr.as_independent-1757"><span class="linenos">1757</span></a><span class="sd">        Examples</span>
</span><span id="Expr.as_independent-1758"><a href="#Expr.as_independent-1758"><span class="linenos">1758</span></a><span class="sd">        ========</span>
</span><span id="Expr.as_independent-1759"><a href="#Expr.as_independent-1759"><span class="linenos">1759</span></a>
</span><span id="Expr.as_independent-1760"><a href="#Expr.as_independent-1760"><span class="linenos">1760</span></a><span class="sd">        -- self is an Add</span>
</span><span id="Expr.as_independent-1761"><a href="#Expr.as_independent-1761"><span class="linenos">1761</span></a>
</span><span id="Expr.as_independent-1762"><a href="#Expr.as_independent-1762"><span class="linenos">1762</span></a><span class="sd">        &gt;&gt;&gt; from sympy import sin, cos, exp</span>
</span><span id="Expr.as_independent-1763"><a href="#Expr.as_independent-1763"><span class="linenos">1763</span></a><span class="sd">        &gt;&gt;&gt; from sympy.abc import x, y, z</span>
</span><span id="Expr.as_independent-1764"><a href="#Expr.as_independent-1764"><span class="linenos">1764</span></a>
</span><span id="Expr.as_independent-1765"><a href="#Expr.as_independent-1765"><span class="linenos">1765</span></a><span class="sd">        &gt;&gt;&gt; (x + x*y).as_independent(x)</span>
</span><span id="Expr.as_independent-1766"><a href="#Expr.as_independent-1766"><span class="linenos">1766</span></a><span class="sd">        (0, x*y + x)</span>
</span><span id="Expr.as_independent-1767"><a href="#Expr.as_independent-1767"><span class="linenos">1767</span></a><span class="sd">        &gt;&gt;&gt; (x + x*y).as_independent(y)</span>
</span><span id="Expr.as_independent-1768"><a href="#Expr.as_independent-1768"><span class="linenos">1768</span></a><span class="sd">        (x, x*y)</span>
</span><span id="Expr.as_independent-1769"><a href="#Expr.as_independent-1769"><span class="linenos">1769</span></a><span class="sd">        &gt;&gt;&gt; (2*x*sin(x) + y + x + z).as_independent(x)</span>
</span><span id="Expr.as_independent-1770"><a href="#Expr.as_independent-1770"><span class="linenos">1770</span></a><span class="sd">        (y + z, 2*x*sin(x) + x)</span>
</span><span id="Expr.as_independent-1771"><a href="#Expr.as_independent-1771"><span class="linenos">1771</span></a><span class="sd">        &gt;&gt;&gt; (2*x*sin(x) + y + x + z).as_independent(x, y)</span>
</span><span id="Expr.as_independent-1772"><a href="#Expr.as_independent-1772"><span class="linenos">1772</span></a><span class="sd">        (z, 2*x*sin(x) + x + y)</span>
</span><span id="Expr.as_independent-1773"><a href="#Expr.as_independent-1773"><span class="linenos">1773</span></a>
</span><span id="Expr.as_independent-1774"><a href="#Expr.as_independent-1774"><span class="linenos">1774</span></a><span class="sd">        -- self is a Mul</span>
</span><span id="Expr.as_independent-1775"><a href="#Expr.as_independent-1775"><span class="linenos">1775</span></a>
</span><span id="Expr.as_independent-1776"><a href="#Expr.as_independent-1776"><span class="linenos">1776</span></a><span class="sd">        &gt;&gt;&gt; (x*sin(x)*cos(y)).as_independent(x)</span>
</span><span id="Expr.as_independent-1777"><a href="#Expr.as_independent-1777"><span class="linenos">1777</span></a><span class="sd">        (cos(y), x*sin(x))</span>
</span><span id="Expr.as_independent-1778"><a href="#Expr.as_independent-1778"><span class="linenos">1778</span></a>
</span><span id="Expr.as_independent-1779"><a href="#Expr.as_independent-1779"><span class="linenos">1779</span></a><span class="sd">        non-commutative terms cannot always be separated out when self is a Mul</span>
</span><span id="Expr.as_independent-1780"><a href="#Expr.as_independent-1780"><span class="linenos">1780</span></a>
</span><span id="Expr.as_independent-1781"><a href="#Expr.as_independent-1781"><span class="linenos">1781</span></a><span class="sd">        &gt;&gt;&gt; from sympy import symbols</span>
</span><span id="Expr.as_independent-1782"><a href="#Expr.as_independent-1782"><span class="linenos">1782</span></a><span class="sd">        &gt;&gt;&gt; n1, n2, n3 = symbols(&#39;n1 n2 n3&#39;, commutative=False)</span>
</span><span id="Expr.as_independent-1783"><a href="#Expr.as_independent-1783"><span class="linenos">1783</span></a><span class="sd">        &gt;&gt;&gt; (n1 + n1*n2).as_independent(n2)</span>
</span><span id="Expr.as_independent-1784"><a href="#Expr.as_independent-1784"><span class="linenos">1784</span></a><span class="sd">        (n1, n1*n2)</span>
</span><span id="Expr.as_independent-1785"><a href="#Expr.as_independent-1785"><span class="linenos">1785</span></a><span class="sd">        &gt;&gt;&gt; (n2*n1 + n1*n2).as_independent(n2)</span>
</span><span id="Expr.as_independent-1786"><a href="#Expr.as_independent-1786"><span class="linenos">1786</span></a><span class="sd">        (0, n1*n2 + n2*n1)</span>
</span><span id="Expr.as_independent-1787"><a href="#Expr.as_independent-1787"><span class="linenos">1787</span></a><span class="sd">        &gt;&gt;&gt; (n1*n2*n3).as_independent(n1)</span>
</span><span id="Expr.as_independent-1788"><a href="#Expr.as_independent-1788"><span class="linenos">1788</span></a><span class="sd">        (1, n1*n2*n3)</span>
</span><span id="Expr.as_independent-1789"><a href="#Expr.as_independent-1789"><span class="linenos">1789</span></a><span class="sd">        &gt;&gt;&gt; (n1*n2*n3).as_independent(n2)</span>
</span><span id="Expr.as_independent-1790"><a href="#Expr.as_independent-1790"><span class="linenos">1790</span></a><span class="sd">        (n1, n2*n3)</span>
</span><span id="Expr.as_independent-1791"><a href="#Expr.as_independent-1791"><span class="linenos">1791</span></a><span class="sd">        &gt;&gt;&gt; ((x-n1)*(x-y)).as_independent(x)</span>
</span><span id="Expr.as_independent-1792"><a href="#Expr.as_independent-1792"><span class="linenos">1792</span></a><span class="sd">        (1, (x - y)*(x - n1))</span>
</span><span id="Expr.as_independent-1793"><a href="#Expr.as_independent-1793"><span class="linenos">1793</span></a>
</span><span id="Expr.as_independent-1794"><a href="#Expr.as_independent-1794"><span class="linenos">1794</span></a><span class="sd">        -- self is anything else:</span>
</span><span id="Expr.as_independent-1795"><a href="#Expr.as_independent-1795"><span class="linenos">1795</span></a>
</span><span id="Expr.as_independent-1796"><a href="#Expr.as_independent-1796"><span class="linenos">1796</span></a><span class="sd">        &gt;&gt;&gt; (sin(x)).as_independent(x)</span>
</span><span id="Expr.as_independent-1797"><a href="#Expr.as_independent-1797"><span class="linenos">1797</span></a><span class="sd">        (1, sin(x))</span>
</span><span id="Expr.as_independent-1798"><a href="#Expr.as_independent-1798"><span class="linenos">1798</span></a><span class="sd">        &gt;&gt;&gt; (sin(x)).as_independent(y)</span>
</span><span id="Expr.as_independent-1799"><a href="#Expr.as_independent-1799"><span class="linenos">1799</span></a><span class="sd">        (sin(x), 1)</span>
</span><span id="Expr.as_independent-1800"><a href="#Expr.as_independent-1800"><span class="linenos">1800</span></a><span class="sd">        &gt;&gt;&gt; exp(x+y).as_independent(x)</span>
</span><span id="Expr.as_independent-1801"><a href="#Expr.as_independent-1801"><span class="linenos">1801</span></a><span class="sd">        (1, exp(x + y))</span>
</span><span id="Expr.as_independent-1802"><a href="#Expr.as_independent-1802"><span class="linenos">1802</span></a>
</span><span id="Expr.as_independent-1803"><a href="#Expr.as_independent-1803"><span class="linenos">1803</span></a><span class="sd">        -- force self to be treated as an Add:</span>
</span><span id="Expr.as_independent-1804"><a href="#Expr.as_independent-1804"><span class="linenos">1804</span></a>
</span><span id="Expr.as_independent-1805"><a href="#Expr.as_independent-1805"><span class="linenos">1805</span></a><span class="sd">        &gt;&gt;&gt; (3*x).as_independent(x, as_Add=True)</span>
</span><span id="Expr.as_independent-1806"><a href="#Expr.as_independent-1806"><span class="linenos">1806</span></a><span class="sd">        (0, 3*x)</span>
</span><span id="Expr.as_independent-1807"><a href="#Expr.as_independent-1807"><span class="linenos">1807</span></a>
</span><span id="Expr.as_independent-1808"><a href="#Expr.as_independent-1808"><span class="linenos">1808</span></a><span class="sd">        -- force self to be treated as a Mul:</span>
</span><span id="Expr.as_independent-1809"><a href="#Expr.as_independent-1809"><span class="linenos">1809</span></a>
</span><span id="Expr.as_independent-1810"><a href="#Expr.as_independent-1810"><span class="linenos">1810</span></a><span class="sd">        &gt;&gt;&gt; (3+x).as_independent(x, as_Add=False)</span>
</span><span id="Expr.as_independent-1811"><a href="#Expr.as_independent-1811"><span class="linenos">1811</span></a><span class="sd">        (1, x + 3)</span>
</span><span id="Expr.as_independent-1812"><a href="#Expr.as_independent-1812"><span class="linenos">1812</span></a><span class="sd">        &gt;&gt;&gt; (-3+x).as_independent(x, as_Add=False)</span>
</span><span id="Expr.as_independent-1813"><a href="#Expr.as_independent-1813"><span class="linenos">1813</span></a><span class="sd">        (1, x - 3)</span>
</span><span id="Expr.as_independent-1814"><a href="#Expr.as_independent-1814"><span class="linenos">1814</span></a>
</span><span id="Expr.as_independent-1815"><a href="#Expr.as_independent-1815"><span class="linenos">1815</span></a><span class="sd">        Note how the below differs from the above in making the</span>
</span><span id="Expr.as_independent-1816"><a href="#Expr.as_independent-1816"><span class="linenos">1816</span></a><span class="sd">        constant on the dep term positive.</span>
</span><span id="Expr.as_independent-1817"><a href="#Expr.as_independent-1817"><span class="linenos">1817</span></a>
</span><span id="Expr.as_independent-1818"><a href="#Expr.as_independent-1818"><span class="linenos">1818</span></a><span class="sd">        &gt;&gt;&gt; (y*(-3+x)).as_independent(x)</span>
</span><span id="Expr.as_independent-1819"><a href="#Expr.as_independent-1819"><span class="linenos">1819</span></a><span class="sd">        (y, x - 3)</span>
</span><span id="Expr.as_independent-1820"><a href="#Expr.as_independent-1820"><span class="linenos">1820</span></a>
</span><span id="Expr.as_independent-1821"><a href="#Expr.as_independent-1821"><span class="linenos">1821</span></a><span class="sd">        -- use .as_independent() for true independence testing instead</span>
</span><span id="Expr.as_independent-1822"><a href="#Expr.as_independent-1822"><span class="linenos">1822</span></a><span class="sd">           of .has(). The former considers only symbols in the free</span>
</span><span id="Expr.as_independent-1823"><a href="#Expr.as_independent-1823"><span class="linenos">1823</span></a><span class="sd">           symbols while the latter considers all symbols</span>
</span><span id="Expr.as_independent-1824"><a href="#Expr.as_independent-1824"><span class="linenos">1824</span></a>
</span><span id="Expr.as_independent-1825"><a href="#Expr.as_independent-1825"><span class="linenos">1825</span></a><span class="sd">        &gt;&gt;&gt; from sympy import Integral</span>
</span><span id="Expr.as_independent-1826"><a href="#Expr.as_independent-1826"><span class="linenos">1826</span></a><span class="sd">        &gt;&gt;&gt; I = Integral(x, (x, 1, 2))</span>
</span><span id="Expr.as_independent-1827"><a href="#Expr.as_independent-1827"><span class="linenos">1827</span></a><span class="sd">        &gt;&gt;&gt; I.has(x)</span>
</span><span id="Expr.as_independent-1828"><a href="#Expr.as_independent-1828"><span class="linenos">1828</span></a><span class="sd">        True</span>
</span><span id="Expr.as_independent-1829"><a href="#Expr.as_independent-1829"><span class="linenos">1829</span></a><span class="sd">        &gt;&gt;&gt; x in I.free_symbols</span>
</span><span id="Expr.as_independent-1830"><a href="#Expr.as_independent-1830"><span class="linenos">1830</span></a><span class="sd">        False</span>
</span><span id="Expr.as_independent-1831"><a href="#Expr.as_independent-1831"><span class="linenos">1831</span></a><span class="sd">        &gt;&gt;&gt; I.as_independent(x) == (I, 1)</span>
</span><span id="Expr.as_independent-1832"><a href="#Expr.as_independent-1832"><span class="linenos">1832</span></a><span class="sd">        True</span>
</span><span id="Expr.as_independent-1833"><a href="#Expr.as_independent-1833"><span class="linenos">1833</span></a><span class="sd">        &gt;&gt;&gt; (I + x).as_independent(x) == (I, x)</span>
</span><span id="Expr.as_independent-1834"><a href="#Expr.as_independent-1834"><span class="linenos">1834</span></a><span class="sd">        True</span>
</span><span id="Expr.as_independent-1835"><a href="#Expr.as_independent-1835"><span class="linenos">1835</span></a>
</span><span id="Expr.as_independent-1836"><a href="#Expr.as_independent-1836"><span class="linenos">1836</span></a><span class="sd">        Note: when trying to get independent terms, a separation method</span>
</span><span id="Expr.as_independent-1837"><a href="#Expr.as_independent-1837"><span class="linenos">1837</span></a><span class="sd">        might need to be used first. In this case, it is important to keep</span>
</span><span id="Expr.as_independent-1838"><a href="#Expr.as_independent-1838"><span class="linenos">1838</span></a><span class="sd">        track of what you send to this routine so you know how to interpret</span>
</span><span id="Expr.as_independent-1839"><a href="#Expr.as_independent-1839"><span class="linenos">1839</span></a><span class="sd">        the returned values</span>
</span><span id="Expr.as_independent-1840"><a href="#Expr.as_independent-1840"><span class="linenos">1840</span></a>
</span><span id="Expr.as_independent-1841"><a href="#Expr.as_independent-1841"><span class="linenos">1841</span></a><span class="sd">        &gt;&gt;&gt; from sympy import separatevars, log</span>
</span><span id="Expr.as_independent-1842"><a href="#Expr.as_independent-1842"><span class="linenos">1842</span></a><span class="sd">        &gt;&gt;&gt; separatevars(exp(x+y)).as_independent(x)</span>
</span><span id="Expr.as_independent-1843"><a href="#Expr.as_independent-1843"><span class="linenos">1843</span></a><span class="sd">        (exp(y), exp(x))</span>
</span><span id="Expr.as_independent-1844"><a href="#Expr.as_independent-1844"><span class="linenos">1844</span></a><span class="sd">        &gt;&gt;&gt; (x + x*y).as_independent(y)</span>
</span><span id="Expr.as_independent-1845"><a href="#Expr.as_independent-1845"><span class="linenos">1845</span></a><span class="sd">        (x, x*y)</span>
</span><span id="Expr.as_independent-1846"><a href="#Expr.as_independent-1846"><span class="linenos">1846</span></a><span class="sd">        &gt;&gt;&gt; separatevars(x + x*y).as_independent(y)</span>
</span><span id="Expr.as_independent-1847"><a href="#Expr.as_independent-1847"><span class="linenos">1847</span></a><span class="sd">        (x, y + 1)</span>
</span><span id="Expr.as_independent-1848"><a href="#Expr.as_independent-1848"><span class="linenos">1848</span></a><span class="sd">        &gt;&gt;&gt; (x*(1 + y)).as_independent(y)</span>
</span><span id="Expr.as_independent-1849"><a href="#Expr.as_independent-1849"><span class="linenos">1849</span></a><span class="sd">        (x, y + 1)</span>
</span><span id="Expr.as_independent-1850"><a href="#Expr.as_independent-1850"><span class="linenos">1850</span></a><span class="sd">        &gt;&gt;&gt; (x*(1 + y)).expand(mul=True).as_independent(y)</span>
</span><span id="Expr.as_independent-1851"><a href="#Expr.as_independent-1851"><span class="linenos">1851</span></a><span class="sd">        (x, x*y)</span>
</span><span id="Expr.as_independent-1852"><a href="#Expr.as_independent-1852"><span class="linenos">1852</span></a><span class="sd">        &gt;&gt;&gt; a, b=symbols(&#39;a b&#39;, positive=True)</span>
</span><span id="Expr.as_independent-1853"><a href="#Expr.as_independent-1853"><span class="linenos">1853</span></a><span class="sd">        &gt;&gt;&gt; (log(a*b).expand(log=True)).as_independent(b)</span>
</span><span id="Expr.as_independent-1854"><a href="#Expr.as_independent-1854"><span class="linenos">1854</span></a><span class="sd">        (log(a), log(b))</span>
</span><span id="Expr.as_independent-1855"><a href="#Expr.as_independent-1855"><span class="linenos">1855</span></a>
</span><span id="Expr.as_independent-1856"><a href="#Expr.as_independent-1856"><span class="linenos">1856</span></a><span class="sd">        See Also</span>
</span><span id="Expr.as_independent-1857"><a href="#Expr.as_independent-1857"><span class="linenos">1857</span></a><span class="sd">        ========</span>
</span><span id="Expr.as_independent-1858"><a href="#Expr.as_independent-1858"><span class="linenos">1858</span></a><span class="sd">        .separatevars(), .expand(log=True), sympy.core.add.Add.as_two_terms(),</span>
</span><span id="Expr.as_independent-1859"><a href="#Expr.as_independent-1859"><span class="linenos">1859</span></a><span class="sd">        sympy.core.mul.Mul.as_two_terms(), .as_coeff_add(), .as_coeff_mul()</span>
</span><span id="Expr.as_independent-1860"><a href="#Expr.as_independent-1860"><span class="linenos">1860</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Expr.as_independent-1861"><a href="#Expr.as_independent-1861"><span class="linenos">1861</span></a>        <span class="kn">from</span> <span class="nn">.symbol</span> <span class="kn">import</span> <span class="n">Symbol</span>
</span><span id="Expr.as_independent-1862"><a href="#Expr.as_independent-1862"><span class="linenos">1862</span></a>        <span class="kn">from</span> <span class="nn">.add</span> <span class="kn">import</span> <span class="n">_unevaluated_Add</span>
</span><span id="Expr.as_independent-1863"><a href="#Expr.as_independent-1863"><span class="linenos">1863</span></a>        <span class="kn">from</span> <span class="nn">.mul</span> <span class="kn">import</span> <span class="n">_unevaluated_Mul</span>
</span><span id="Expr.as_independent-1864"><a href="#Expr.as_independent-1864"><span class="linenos">1864</span></a>
</span><span id="Expr.as_independent-1865"><a href="#Expr.as_independent-1865"><span class="linenos">1865</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_zero</span><span class="p">:</span>
</span><span id="Expr.as_independent-1866"><a href="#Expr.as_independent-1866"><span class="linenos">1866</span></a>            <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">Zero</span><span class="p">,</span> <span class="n">S</span><span class="o">.</span><span class="n">Zero</span>
</span><span id="Expr.as_independent-1867"><a href="#Expr.as_independent-1867"><span class="linenos">1867</span></a>
</span><span id="Expr.as_independent-1868"><a href="#Expr.as_independent-1868"><span class="linenos">1868</span></a>        <span class="n">func</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">func</span>
</span><span id="Expr.as_independent-1869"><a href="#Expr.as_independent-1869"><span class="linenos">1869</span></a>        <span class="k">if</span> <span class="n">hint</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;as_Add&#39;</span><span class="p">,</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Add</span><span class="p">)</span> <span class="p">):</span>
</span><span id="Expr.as_independent-1870"><a href="#Expr.as_independent-1870"><span class="linenos">1870</span></a>            <span class="n">want</span> <span class="o">=</span> <span class="n">Add</span>
</span><span id="Expr.as_independent-1871"><a href="#Expr.as_independent-1871"><span class="linenos">1871</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Expr.as_independent-1872"><a href="#Expr.as_independent-1872"><span class="linenos">1872</span></a>            <span class="n">want</span> <span class="o">=</span> <span class="n">Mul</span>
</span><span id="Expr.as_independent-1873"><a href="#Expr.as_independent-1873"><span class="linenos">1873</span></a>
</span><span id="Expr.as_independent-1874"><a href="#Expr.as_independent-1874"><span class="linenos">1874</span></a>        <span class="c1"># sift out deps into symbolic and other and ignore</span>
</span><span id="Expr.as_independent-1875"><a href="#Expr.as_independent-1875"><span class="linenos">1875</span></a>        <span class="c1"># all symbols but those that are in the free symbols</span>
</span><span id="Expr.as_independent-1876"><a href="#Expr.as_independent-1876"><span class="linenos">1876</span></a>        <span class="n">sym</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
</span><span id="Expr.as_independent-1877"><a href="#Expr.as_independent-1877"><span class="linenos">1877</span></a>        <span class="n">other</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Expr.as_independent-1878"><a href="#Expr.as_independent-1878"><span class="linenos">1878</span></a>        <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">deps</span><span class="p">:</span>
</span><span id="Expr.as_independent-1879"><a href="#Expr.as_independent-1879"><span class="linenos">1879</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">Symbol</span><span class="p">):</span>  <span class="c1"># Symbol.is_Symbol is True</span>
</span><span id="Expr.as_independent-1880"><a href="#Expr.as_independent-1880"><span class="linenos">1880</span></a>                <span class="n">sym</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
</span><span id="Expr.as_independent-1881"><a href="#Expr.as_independent-1881"><span class="linenos">1881</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Expr.as_independent-1882"><a href="#Expr.as_independent-1882"><span class="linenos">1882</span></a>                <span class="n">other</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
</span><span id="Expr.as_independent-1883"><a href="#Expr.as_independent-1883"><span class="linenos">1883</span></a>
</span><span id="Expr.as_independent-1884"><a href="#Expr.as_independent-1884"><span class="linenos">1884</span></a>        <span class="k">def</span> <span class="nf">has</span><span class="p">(</span><span class="n">e</span><span class="p">):</span>
</span><span id="Expr.as_independent-1885"><a href="#Expr.as_independent-1885"><span class="linenos">1885</span></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;return the standard has() if there are no literal symbols, else</span>
</span><span id="Expr.as_independent-1886"><a href="#Expr.as_independent-1886"><span class="linenos">1886</span></a><span class="sd">            check to see that symbol-deps are in the free symbols.&quot;&quot;&quot;</span>
</span><span id="Expr.as_independent-1887"><a href="#Expr.as_independent-1887"><span class="linenos">1887</span></a>            <span class="n">has_other</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">has</span><span class="p">(</span><span class="o">*</span><span class="n">other</span><span class="p">)</span>
</span><span id="Expr.as_independent-1888"><a href="#Expr.as_independent-1888"><span class="linenos">1888</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">sym</span><span class="p">:</span>
</span><span id="Expr.as_independent-1889"><a href="#Expr.as_independent-1889"><span class="linenos">1889</span></a>                <span class="k">return</span> <span class="n">has_other</span>
</span><span id="Expr.as_independent-1890"><a href="#Expr.as_independent-1890"><span class="linenos">1890</span></a>            <span class="k">return</span> <span class="n">has_other</span> <span class="ow">or</span> <span class="n">e</span><span class="o">.</span><span class="n">has</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">free_symbols</span> <span class="o">&amp;</span> <span class="n">sym</span><span class="p">))</span>
</span><span id="Expr.as_independent-1891"><a href="#Expr.as_independent-1891"><span class="linenos">1891</span></a>
</span><span id="Expr.as_independent-1892"><a href="#Expr.as_independent-1892"><span class="linenos">1892</span></a>        <span class="k">if</span> <span class="p">(</span><span class="n">want</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">func</span> <span class="ow">or</span>
</span><span id="Expr.as_independent-1893"><a href="#Expr.as_independent-1893"><span class="linenos">1893</span></a>                <span class="n">func</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">Add</span> <span class="ow">and</span> <span class="n">func</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">Mul</span><span class="p">):</span>
</span><span id="Expr.as_independent-1894"><a href="#Expr.as_independent-1894"><span class="linenos">1894</span></a>            <span class="k">if</span> <span class="n">has</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Expr.as_independent-1895"><a href="#Expr.as_independent-1895"><span class="linenos">1895</span></a>                <span class="k">return</span> <span class="p">(</span><span class="n">want</span><span class="o">.</span><span class="n">identity</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
</span><span id="Expr.as_independent-1896"><a href="#Expr.as_independent-1896"><span class="linenos">1896</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Expr.as_independent-1897"><a href="#Expr.as_independent-1897"><span class="linenos">1897</span></a>                <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">want</span><span class="o">.</span><span class="n">identity</span><span class="p">)</span>
</span><span id="Expr.as_independent-1898"><a href="#Expr.as_independent-1898"><span class="linenos">1898</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Expr.as_independent-1899"><a href="#Expr.as_independent-1899"><span class="linenos">1899</span></a>            <span class="k">if</span> <span class="n">func</span> <span class="ow">is</span> <span class="n">Add</span><span class="p">:</span>
</span><span id="Expr.as_independent-1900"><a href="#Expr.as_independent-1900"><span class="linenos">1900</span></a>                <span class="n">args</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">)</span>
</span><span id="Expr.as_independent-1901"><a href="#Expr.as_independent-1901"><span class="linenos">1901</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Expr.as_independent-1902"><a href="#Expr.as_independent-1902"><span class="linenos">1902</span></a>                <span class="n">args</span><span class="p">,</span> <span class="n">nc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">args_cnc</span><span class="p">()</span>
</span><span id="Expr.as_independent-1903"><a href="#Expr.as_independent-1903"><span class="linenos">1903</span></a>
</span><span id="Expr.as_independent-1904"><a href="#Expr.as_independent-1904"><span class="linenos">1904</span></a>        <span class="n">d</span> <span class="o">=</span> <span class="n">sift</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">has</span><span class="p">)</span>
</span><span id="Expr.as_independent-1905"><a href="#Expr.as_independent-1905"><span class="linenos">1905</span></a>        <span class="n">depend</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="kc">True</span><span class="p">]</span>
</span><span id="Expr.as_independent-1906"><a href="#Expr.as_independent-1906"><span class="linenos">1906</span></a>        <span class="n">indep</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="kc">False</span><span class="p">]</span>
</span><span id="Expr.as_independent-1907"><a href="#Expr.as_independent-1907"><span class="linenos">1907</span></a>        <span class="k">if</span> <span class="n">func</span> <span class="ow">is</span> <span class="n">Add</span><span class="p">:</span>  <span class="c1"># all terms were treated as commutative</span>
</span><span id="Expr.as_independent-1908"><a href="#Expr.as_independent-1908"><span class="linenos">1908</span></a>            <span class="k">return</span> <span class="p">(</span><span class="n">Add</span><span class="p">(</span><span class="o">*</span><span class="n">indep</span><span class="p">),</span> <span class="n">_unevaluated_Add</span><span class="p">(</span><span class="o">*</span><span class="n">depend</span><span class="p">))</span>
</span><span id="Expr.as_independent-1909"><a href="#Expr.as_independent-1909"><span class="linenos">1909</span></a>        <span class="k">else</span><span class="p">:</span>  <span class="c1"># handle noncommutative by stopping at first dependent term</span>
</span><span id="Expr.as_independent-1910"><a href="#Expr.as_independent-1910"><span class="linenos">1910</span></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">nc</span><span class="p">):</span>
</span><span id="Expr.as_independent-1911"><a href="#Expr.as_independent-1911"><span class="linenos">1911</span></a>                <span class="k">if</span> <span class="n">has</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
</span><span id="Expr.as_independent-1912"><a href="#Expr.as_independent-1912"><span class="linenos">1912</span></a>                    <span class="n">depend</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">nc</span><span class="p">[</span><span class="n">i</span><span class="p">:])</span>
</span><span id="Expr.as_independent-1913"><a href="#Expr.as_independent-1913"><span class="linenos">1913</span></a>                    <span class="k">break</span>
</span><span id="Expr.as_independent-1914"><a href="#Expr.as_independent-1914"><span class="linenos">1914</span></a>                <span class="n">indep</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
</span><span id="Expr.as_independent-1915"><a href="#Expr.as_independent-1915"><span class="linenos">1915</span></a>            <span class="k">return</span> <span class="n">Mul</span><span class="p">(</span><span class="o">*</span><span class="n">indep</span><span class="p">),</span> <span class="p">(</span>
</span><span id="Expr.as_independent-1916"><a href="#Expr.as_independent-1916"><span class="linenos">1916</span></a>                <span class="n">Mul</span><span class="p">(</span><span class="o">*</span><span class="n">depend</span><span class="p">,</span> <span class="n">evaluate</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="k">if</span> <span class="n">nc</span> <span class="k">else</span>
</span><span id="Expr.as_independent-1917"><a href="#Expr.as_independent-1917"><span class="linenos">1917</span></a>                <span class="n">_unevaluated_Mul</span><span class="p">(</span><span class="o">*</span><span class="n">depend</span><span class="p">))</span>
</span></pre></div>


            <div class="docstring"><p>A mostly naive separation of a Mul or Add into arguments that are not
are dependent on deps. To obtain as complete a separation of variables
as possible, use a separation method first, e.g.:</p>

<ul>
<li>separatevars() to change Mul, Add and Pow (including exp) into Mul</li>
<li>.expand(mul=True) to change Add or Mul into Add</li>
<li>.expand(log=True) to change log expr into an Add</li>
</ul>

<p>The only non-naive thing that is done here is to respect noncommutative
ordering of variables and to always return (0, 0) for <code>self</code> of zero
regardless of hints.</p>

<p>For nonzero <code>self</code>, the returned tuple (i, d) has the
following interpretation:</p>

<ul>
<li>i will has no variable that appears in deps</li>
<li>d will either have terms that contain variables that are in deps, or
be equal to 0 (when self is an Add) or 1 (when self is a Mul)</li>
<li>if self is an Add then self = i + d</li>
<li>if self is a Mul then self = i*d</li>
<li>otherwise (self, S.One) or (S.One, self) is returned.</li>
</ul>

<p>To force the expression to be treated as an Add, use the hint as_Add=True</p>

<h1 id="examples">Examples</h1>

<p>-- self is an Add</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">sin</span><span class="p">,</span> <span class="n">cos</span><span class="p">,</span> <span class="n">exp</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.abc</span> <span class="kn">import</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span>
</code></pre>
</div>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">as_independent</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">(0, x*y + x)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">as_independent</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="go">(x, x*y)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">y</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="n">z</span><span class="p">)</span><span class="o">.</span><span class="n">as_independent</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">(y + z, 2*x*sin(x) + x)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">y</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="n">z</span><span class="p">)</span><span class="o">.</span><span class="n">as_independent</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="go">(z, 2*x*sin(x) + x + y)</span>
</code></pre>
</div>

<p>-- self is a Mul</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">y</span><span class="p">))</span><span class="o">.</span><span class="n">as_independent</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">(cos(y), x*sin(x))</span>
</code></pre>
</div>

<p>non-commutative terms cannot always be separated out when self is a Mul</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">symbols</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n1</span><span class="p">,</span> <span class="n">n2</span><span class="p">,</span> <span class="n">n3</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;n1 n2 n3&#39;</span><span class="p">,</span> <span class="n">commutative</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">n1</span> <span class="o">+</span> <span class="n">n1</span><span class="o">*</span><span class="n">n2</span><span class="p">)</span><span class="o">.</span><span class="n">as_independent</span><span class="p">(</span><span class="n">n2</span><span class="p">)</span>
<span class="go">(n1, n1*n2)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">n2</span><span class="o">*</span><span class="n">n1</span> <span class="o">+</span> <span class="n">n1</span><span class="o">*</span><span class="n">n2</span><span class="p">)</span><span class="o">.</span><span class="n">as_independent</span><span class="p">(</span><span class="n">n2</span><span class="p">)</span>
<span class="go">(0, n1*n2 + n2*n1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">n1</span><span class="o">*</span><span class="n">n2</span><span class="o">*</span><span class="n">n3</span><span class="p">)</span><span class="o">.</span><span class="n">as_independent</span><span class="p">(</span><span class="n">n1</span><span class="p">)</span>
<span class="go">(1, n1*n2*n3)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">n1</span><span class="o">*</span><span class="n">n2</span><span class="o">*</span><span class="n">n3</span><span class="p">)</span><span class="o">.</span><span class="n">as_independent</span><span class="p">(</span><span class="n">n2</span><span class="p">)</span>
<span class="go">(n1, n2*n3)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">((</span><span class="n">x</span><span class="o">-</span><span class="n">n1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">y</span><span class="p">))</span><span class="o">.</span><span class="n">as_independent</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">(1, (x - y)*(x - n1))</span>
</code></pre>
</div>

<p>-- self is anything else:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">.</span><span class="n">as_independent</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">(1, sin(x))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">.</span><span class="n">as_independent</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="go">(sin(x), 1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">as_independent</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">(1, exp(x + y))</span>
</code></pre>
</div>

<p>-- force self to be treated as an Add:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">as_independent</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">as_Add</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">(0, 3*x)</span>
</code></pre>
</div>

<p>-- force self to be treated as a Mul:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="mi">3</span><span class="o">+</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">as_independent</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">as_Add</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">(1, x + 3)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="o">+</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">as_independent</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">as_Add</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">(1, x - 3)</span>
</code></pre>
</div>

<p>Note how the below differs from the above in making the
constant on the dep term positive.</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">y</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="o">+</span><span class="n">x</span><span class="p">))</span><span class="o">.</span><span class="n">as_independent</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">(y, x - 3)</span>
</code></pre>
</div>

<p>-- use .as_independent() for true independence testing instead
   of .has(). The former considers only symbols in the free
   symbols while the latter considers all symbols</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">Integral</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">I</span> <span class="o">=</span> <span class="n">Integral</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">I</span><span class="o">.</span><span class="n">has</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="ow">in</span> <span class="n">I</span><span class="o">.</span><span class="n">free_symbols</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">I</span><span class="o">.</span><span class="n">as_independent</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="n">I</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">I</span> <span class="o">+</span> <span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">as_independent</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="n">I</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="go">True</span>
</code></pre>
</div>

<p>Note: when trying to get independent terms, a separation method
might need to be used first. In this case, it is important to keep
track of what you send to this routine so you know how to interpret
the returned values</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">separatevars</span><span class="p">,</span> <span class="n">log</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">separatevars</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="p">))</span><span class="o">.</span><span class="n">as_independent</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">(exp(y), exp(x))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">as_independent</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="go">(x, x*y)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">separatevars</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">as_independent</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="go">(x, y + 1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">y</span><span class="p">))</span><span class="o">.</span><span class="n">as_independent</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="go">(x, y + 1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">y</span><span class="p">))</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="n">mul</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">as_independent</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="go">(x, x*y)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;a b&#39;</span><span class="p">,</span> <span class="n">positive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="n">log</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span><span class="o">.</span><span class="n">as_independent</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="go">(log(a), log(b))</span>
</code></pre>
</div>

<h1 id="see-also">See Also</h1>

<p>.separatevars(), .expand(log=True), sympy.core.add.Add.as_two_terms(),
sympy.core.mul.Mul.as_two_terms(), .as_coeff_add(), .as_coeff_mul()</p>
</div>


                            </div>
                            <div id="Expr.as_real_imag" class="classattr">
                                        <input id="Expr.as_real_imag-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">as_real_imag</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">deep</span><span class="o">=</span><span class="kc">True</span>, </span><span class="param"><span class="o">**</span><span class="n">hints</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Expr.as_real_imag-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Expr.as_real_imag"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Expr.as_real_imag-1919"><a href="#Expr.as_real_imag-1919"><span class="linenos">1919</span></a>    <span class="k">def</span> <span class="nf">as_real_imag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">hints</span><span class="p">):</span>
</span><span id="Expr.as_real_imag-1920"><a href="#Expr.as_real_imag-1920"><span class="linenos">1920</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Performs complex expansion on &#39;self&#39; and returns a tuple</span>
</span><span id="Expr.as_real_imag-1921"><a href="#Expr.as_real_imag-1921"><span class="linenos">1921</span></a><span class="sd">           containing collected both real and imaginary parts. This</span>
</span><span id="Expr.as_real_imag-1922"><a href="#Expr.as_real_imag-1922"><span class="linenos">1922</span></a><span class="sd">           method cannot be confused with re() and im() functions,</span>
</span><span id="Expr.as_real_imag-1923"><a href="#Expr.as_real_imag-1923"><span class="linenos">1923</span></a><span class="sd">           which does not perform complex expansion at evaluation.</span>
</span><span id="Expr.as_real_imag-1924"><a href="#Expr.as_real_imag-1924"><span class="linenos">1924</span></a>
</span><span id="Expr.as_real_imag-1925"><a href="#Expr.as_real_imag-1925"><span class="linenos">1925</span></a><span class="sd">           However it is possible to expand both re() and im()</span>
</span><span id="Expr.as_real_imag-1926"><a href="#Expr.as_real_imag-1926"><span class="linenos">1926</span></a><span class="sd">           functions and get exactly the same results as with</span>
</span><span id="Expr.as_real_imag-1927"><a href="#Expr.as_real_imag-1927"><span class="linenos">1927</span></a><span class="sd">           a single call to this function.</span>
</span><span id="Expr.as_real_imag-1928"><a href="#Expr.as_real_imag-1928"><span class="linenos">1928</span></a>
</span><span id="Expr.as_real_imag-1929"><a href="#Expr.as_real_imag-1929"><span class="linenos">1929</span></a><span class="sd">           &gt;&gt;&gt; from sympy import symbols, I</span>
</span><span id="Expr.as_real_imag-1930"><a href="#Expr.as_real_imag-1930"><span class="linenos">1930</span></a>
</span><span id="Expr.as_real_imag-1931"><a href="#Expr.as_real_imag-1931"><span class="linenos">1931</span></a><span class="sd">           &gt;&gt;&gt; x, y = symbols(&#39;x,y&#39;, real=True)</span>
</span><span id="Expr.as_real_imag-1932"><a href="#Expr.as_real_imag-1932"><span class="linenos">1932</span></a>
</span><span id="Expr.as_real_imag-1933"><a href="#Expr.as_real_imag-1933"><span class="linenos">1933</span></a><span class="sd">           &gt;&gt;&gt; (x + y*I).as_real_imag()</span>
</span><span id="Expr.as_real_imag-1934"><a href="#Expr.as_real_imag-1934"><span class="linenos">1934</span></a><span class="sd">           (x, y)</span>
</span><span id="Expr.as_real_imag-1935"><a href="#Expr.as_real_imag-1935"><span class="linenos">1935</span></a>
</span><span id="Expr.as_real_imag-1936"><a href="#Expr.as_real_imag-1936"><span class="linenos">1936</span></a><span class="sd">           &gt;&gt;&gt; from sympy.abc import z, w</span>
</span><span id="Expr.as_real_imag-1937"><a href="#Expr.as_real_imag-1937"><span class="linenos">1937</span></a>
</span><span id="Expr.as_real_imag-1938"><a href="#Expr.as_real_imag-1938"><span class="linenos">1938</span></a><span class="sd">           &gt;&gt;&gt; (z + w*I).as_real_imag()</span>
</span><span id="Expr.as_real_imag-1939"><a href="#Expr.as_real_imag-1939"><span class="linenos">1939</span></a><span class="sd">           (re(z) - im(w), re(w) + im(z))</span>
</span><span id="Expr.as_real_imag-1940"><a href="#Expr.as_real_imag-1940"><span class="linenos">1940</span></a>
</span><span id="Expr.as_real_imag-1941"><a href="#Expr.as_real_imag-1941"><span class="linenos">1941</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Expr.as_real_imag-1942"><a href="#Expr.as_real_imag-1942"><span class="linenos">1942</span></a>        <span class="k">if</span> <span class="n">hints</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="p">:</span>
</span><span id="Expr.as_real_imag-1943"><a href="#Expr.as_real_imag-1943"><span class="linenos">1943</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="Expr.as_real_imag-1944"><a href="#Expr.as_real_imag-1944"><span class="linenos">1944</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Expr.as_real_imag-1945"><a href="#Expr.as_real_imag-1945"><span class="linenos">1945</span></a>            <span class="kn">from</span> <span class="nn">sympy.functions.elementary.complexes</span> <span class="kn">import</span> <span class="n">im</span><span class="p">,</span> <span class="n">re</span>
</span><span id="Expr.as_real_imag-1946"><a href="#Expr.as_real_imag-1946"><span class="linenos">1946</span></a>            <span class="k">return</span> <span class="p">(</span><span class="n">re</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span> <span class="n">im</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>
</span></pre></div>


            <div class="docstring"><p>Performs complex expansion on 'self' and returns a tuple
containing collected both real and imaginary parts. This
method cannot be confused with re() and im() functions,
which does not perform complex expansion at evaluation.</p>

<p>However it is possible to expand both re() and im()
functions and get exactly the same results as with
a single call to this function.</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">symbols</span><span class="p">,</span> <span class="n">I</span>
</code></pre>
</div>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x,y&#39;</span><span class="p">,</span> <span class="n">real</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre>
</div>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="o">*</span><span class="n">I</span><span class="p">)</span><span class="o">.</span><span class="n">as_real_imag</span><span class="p">()</span>
<span class="go">(x, y)</span>
</code></pre>
</div>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.abc</span> <span class="kn">import</span> <span class="n">z</span><span class="p">,</span> <span class="n">w</span>
</code></pre>
</div>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">z</span> <span class="o">+</span> <span class="n">w</span><span class="o">*</span><span class="n">I</span><span class="p">)</span><span class="o">.</span><span class="n">as_real_imag</span><span class="p">()</span>
<span class="go">(re(z) - im(w), re(w) + im(z))</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="Expr.as_powers_dict" class="classattr">
                                        <input id="Expr.as_powers_dict-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">as_powers_dict</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Expr.as_powers_dict-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Expr.as_powers_dict"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Expr.as_powers_dict-1948"><a href="#Expr.as_powers_dict-1948"><span class="linenos">1948</span></a>    <span class="k">def</span> <span class="nf">as_powers_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Expr.as_powers_dict-1949"><a href="#Expr.as_powers_dict-1949"><span class="linenos">1949</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return self as a dictionary of factors with each factor being</span>
</span><span id="Expr.as_powers_dict-1950"><a href="#Expr.as_powers_dict-1950"><span class="linenos">1950</span></a><span class="sd">        treated as a power. The keys are the bases of the factors and the</span>
</span><span id="Expr.as_powers_dict-1951"><a href="#Expr.as_powers_dict-1951"><span class="linenos">1951</span></a><span class="sd">        values, the corresponding exponents. The resulting dictionary should</span>
</span><span id="Expr.as_powers_dict-1952"><a href="#Expr.as_powers_dict-1952"><span class="linenos">1952</span></a><span class="sd">        be used with caution if the expression is a Mul and contains non-</span>
</span><span id="Expr.as_powers_dict-1953"><a href="#Expr.as_powers_dict-1953"><span class="linenos">1953</span></a><span class="sd">        commutative factors since the order that they appeared will be lost in</span>
</span><span id="Expr.as_powers_dict-1954"><a href="#Expr.as_powers_dict-1954"><span class="linenos">1954</span></a><span class="sd">        the dictionary.</span>
</span><span id="Expr.as_powers_dict-1955"><a href="#Expr.as_powers_dict-1955"><span class="linenos">1955</span></a>
</span><span id="Expr.as_powers_dict-1956"><a href="#Expr.as_powers_dict-1956"><span class="linenos">1956</span></a><span class="sd">        See Also</span>
</span><span id="Expr.as_powers_dict-1957"><a href="#Expr.as_powers_dict-1957"><span class="linenos">1957</span></a><span class="sd">        ========</span>
</span><span id="Expr.as_powers_dict-1958"><a href="#Expr.as_powers_dict-1958"><span class="linenos">1958</span></a><span class="sd">        as_ordered_factors: An alternative for noncommutative applications,</span>
</span><span id="Expr.as_powers_dict-1959"><a href="#Expr.as_powers_dict-1959"><span class="linenos">1959</span></a><span class="sd">                            returning an ordered list of factors.</span>
</span><span id="Expr.as_powers_dict-1960"><a href="#Expr.as_powers_dict-1960"><span class="linenos">1960</span></a><span class="sd">        args_cnc: Similar to as_ordered_factors, but guarantees separation</span>
</span><span id="Expr.as_powers_dict-1961"><a href="#Expr.as_powers_dict-1961"><span class="linenos">1961</span></a><span class="sd">                  of commutative and noncommutative factors.</span>
</span><span id="Expr.as_powers_dict-1962"><a href="#Expr.as_powers_dict-1962"><span class="linenos">1962</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Expr.as_powers_dict-1963"><a href="#Expr.as_powers_dict-1963"><span class="linenos">1963</span></a>        <span class="n">d</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</span><span id="Expr.as_powers_dict-1964"><a href="#Expr.as_powers_dict-1964"><span class="linenos">1964</span></a>        <span class="n">d</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="nb">dict</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">as_base_exp</span><span class="p">()]))</span>
</span><span id="Expr.as_powers_dict-1965"><a href="#Expr.as_powers_dict-1965"><span class="linenos">1965</span></a>        <span class="k">return</span> <span class="n">d</span>
</span></pre></div>


            <div class="docstring"><p>Return self as a dictionary of factors with each factor being
treated as a power. The keys are the bases of the factors and the
values, the corresponding exponents. The resulting dictionary should
be used with caution if the expression is a Mul and contains non-
commutative factors since the order that they appeared will be lost in
the dictionary.</p>

<h1 id="see-also">See Also</h1>

<p>as_ordered_factors: An alternative for noncommutative applications,
                    returning an ordered list of factors.
args_cnc: Similar to as_ordered_factors, but guarantees separation
          of commutative and noncommutative factors.</p>
</div>


                            </div>
                            <div id="Expr.as_coefficients_dict" class="classattr">
                                        <input id="Expr.as_coefficients_dict-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">as_coefficients_dict</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Expr.as_coefficients_dict-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Expr.as_coefficients_dict"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Expr.as_coefficients_dict-1967"><a href="#Expr.as_coefficients_dict-1967"><span class="linenos">1967</span></a>    <span class="k">def</span> <span class="nf">as_coefficients_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Expr.as_coefficients_dict-1968"><a href="#Expr.as_coefficients_dict-1968"><span class="linenos">1968</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a dictionary mapping terms to their Rational coefficient.</span>
</span><span id="Expr.as_coefficients_dict-1969"><a href="#Expr.as_coefficients_dict-1969"><span class="linenos">1969</span></a><span class="sd">        Since the dictionary is a defaultdict, inquiries about terms which</span>
</span><span id="Expr.as_coefficients_dict-1970"><a href="#Expr.as_coefficients_dict-1970"><span class="linenos">1970</span></a><span class="sd">        were not present will return a coefficient of 0. If an expression is</span>
</span><span id="Expr.as_coefficients_dict-1971"><a href="#Expr.as_coefficients_dict-1971"><span class="linenos">1971</span></a><span class="sd">        not an Add it is considered to have a single term.</span>
</span><span id="Expr.as_coefficients_dict-1972"><a href="#Expr.as_coefficients_dict-1972"><span class="linenos">1972</span></a>
</span><span id="Expr.as_coefficients_dict-1973"><a href="#Expr.as_coefficients_dict-1973"><span class="linenos">1973</span></a><span class="sd">        Examples</span>
</span><span id="Expr.as_coefficients_dict-1974"><a href="#Expr.as_coefficients_dict-1974"><span class="linenos">1974</span></a><span class="sd">        ========</span>
</span><span id="Expr.as_coefficients_dict-1975"><a href="#Expr.as_coefficients_dict-1975"><span class="linenos">1975</span></a>
</span><span id="Expr.as_coefficients_dict-1976"><a href="#Expr.as_coefficients_dict-1976"><span class="linenos">1976</span></a><span class="sd">        &gt;&gt;&gt; from sympy.abc import a, x</span>
</span><span id="Expr.as_coefficients_dict-1977"><a href="#Expr.as_coefficients_dict-1977"><span class="linenos">1977</span></a><span class="sd">        &gt;&gt;&gt; (3*x + a*x + 4).as_coefficients_dict()</span>
</span><span id="Expr.as_coefficients_dict-1978"><a href="#Expr.as_coefficients_dict-1978"><span class="linenos">1978</span></a><span class="sd">        {1: 4, x: 3, a*x: 1}</span>
</span><span id="Expr.as_coefficients_dict-1979"><a href="#Expr.as_coefficients_dict-1979"><span class="linenos">1979</span></a><span class="sd">        &gt;&gt;&gt; _[a]</span>
</span><span id="Expr.as_coefficients_dict-1980"><a href="#Expr.as_coefficients_dict-1980"><span class="linenos">1980</span></a><span class="sd">        0</span>
</span><span id="Expr.as_coefficients_dict-1981"><a href="#Expr.as_coefficients_dict-1981"><span class="linenos">1981</span></a><span class="sd">        &gt;&gt;&gt; (3*a*x).as_coefficients_dict()</span>
</span><span id="Expr.as_coefficients_dict-1982"><a href="#Expr.as_coefficients_dict-1982"><span class="linenos">1982</span></a><span class="sd">        {a*x: 3}</span>
</span><span id="Expr.as_coefficients_dict-1983"><a href="#Expr.as_coefficients_dict-1983"><span class="linenos">1983</span></a>
</span><span id="Expr.as_coefficients_dict-1984"><a href="#Expr.as_coefficients_dict-1984"><span class="linenos">1984</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Expr.as_coefficients_dict-1985"><a href="#Expr.as_coefficients_dict-1985"><span class="linenos">1985</span></a>        <span class="n">c</span><span class="p">,</span> <span class="n">m</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">as_coeff_Mul</span><span class="p">()</span>
</span><span id="Expr.as_coefficients_dict-1986"><a href="#Expr.as_coefficients_dict-1986"><span class="linenos">1986</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">c</span><span class="o">.</span><span class="n">is_Rational</span><span class="p">:</span>
</span><span id="Expr.as_coefficients_dict-1987"><a href="#Expr.as_coefficients_dict-1987"><span class="linenos">1987</span></a>            <span class="n">c</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">One</span>
</span><span id="Expr.as_coefficients_dict-1988"><a href="#Expr.as_coefficients_dict-1988"><span class="linenos">1988</span></a>            <span class="n">m</span> <span class="o">=</span> <span class="bp">self</span>
</span><span id="Expr.as_coefficients_dict-1989"><a href="#Expr.as_coefficients_dict-1989"><span class="linenos">1989</span></a>        <span class="n">d</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</span><span id="Expr.as_coefficients_dict-1990"><a href="#Expr.as_coefficients_dict-1990"><span class="linenos">1990</span></a>        <span class="n">d</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">m</span><span class="p">:</span> <span class="n">c</span><span class="p">})</span>
</span><span id="Expr.as_coefficients_dict-1991"><a href="#Expr.as_coefficients_dict-1991"><span class="linenos">1991</span></a>        <span class="k">return</span> <span class="n">d</span>
</span></pre></div>


            <div class="docstring"><p>Return a dictionary mapping terms to their Rational coefficient.
Since the dictionary is a defaultdict, inquiries about terms which
were not present will return a coefficient of 0. If an expression is
not an Add it is considered to have a single term.</p>

<h1 id="examples">Examples</h1>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.abc</span> <span class="kn">import</span> <span class="n">a</span><span class="p">,</span> <span class="n">x</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">a</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">as_coefficients_dict</span><span class="p">()</span>
<span class="go">{1: 4, x: 3, a*x: 1}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span><span class="p">[</span><span class="n">a</span><span class="p">]</span>
<span class="go">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">a</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">as_coefficients_dict</span><span class="p">()</span>
<span class="go">{a*x: 3}</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="Expr.as_base_exp" class="classattr">
                                        <input id="Expr.as_base_exp-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">as_base_exp</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Expr.as_base_exp-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Expr.as_base_exp"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Expr.as_base_exp-1993"><a href="#Expr.as_base_exp-1993"><span class="linenos">1993</span></a>    <span class="k">def</span> <span class="nf">as_base_exp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Expr.as_base_exp-1994"><a href="#Expr.as_base_exp-1994"><span class="linenos">1994</span></a>        <span class="c1"># a -&gt; b ** e</span>
</span><span id="Expr.as_base_exp-1995"><a href="#Expr.as_base_exp-1995"><span class="linenos">1995</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="p">,</span> <span class="n">S</span><span class="o">.</span><span class="n">One</span>
</span></pre></div>


    

                            </div>
                            <div id="Expr.as_coeff_mul" class="classattr">
                                        <input id="Expr.as_coeff_mul-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">as_coeff_mul</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="o">*</span><span class="n">deps</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Expr.as_coeff_mul-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Expr.as_coeff_mul"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Expr.as_coeff_mul-1997"><a href="#Expr.as_coeff_mul-1997"><span class="linenos">1997</span></a>    <span class="k">def</span> <span class="nf">as_coeff_mul</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">deps</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Expr.as_coeff_mul-1998"><a href="#Expr.as_coeff_mul-1998"><span class="linenos">1998</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the tuple (c, args) where self is written as a Mul, ``m``.</span>
</span><span id="Expr.as_coeff_mul-1999"><a href="#Expr.as_coeff_mul-1999"><span class="linenos">1999</span></a>
</span><span id="Expr.as_coeff_mul-2000"><a href="#Expr.as_coeff_mul-2000"><span class="linenos">2000</span></a><span class="sd">        c should be a Rational multiplied by any factors of the Mul that are</span>
</span><span id="Expr.as_coeff_mul-2001"><a href="#Expr.as_coeff_mul-2001"><span class="linenos">2001</span></a><span class="sd">        independent of deps.</span>
</span><span id="Expr.as_coeff_mul-2002"><a href="#Expr.as_coeff_mul-2002"><span class="linenos">2002</span></a>
</span><span id="Expr.as_coeff_mul-2003"><a href="#Expr.as_coeff_mul-2003"><span class="linenos">2003</span></a><span class="sd">        args should be a tuple of all other factors of m; args is empty</span>
</span><span id="Expr.as_coeff_mul-2004"><a href="#Expr.as_coeff_mul-2004"><span class="linenos">2004</span></a><span class="sd">        if self is a Number or if self is independent of deps (when given).</span>
</span><span id="Expr.as_coeff_mul-2005"><a href="#Expr.as_coeff_mul-2005"><span class="linenos">2005</span></a>
</span><span id="Expr.as_coeff_mul-2006"><a href="#Expr.as_coeff_mul-2006"><span class="linenos">2006</span></a><span class="sd">        This should be used when you do not know if self is a Mul or not but</span>
</span><span id="Expr.as_coeff_mul-2007"><a href="#Expr.as_coeff_mul-2007"><span class="linenos">2007</span></a><span class="sd">        you want to treat self as a Mul or if you want to process the</span>
</span><span id="Expr.as_coeff_mul-2008"><a href="#Expr.as_coeff_mul-2008"><span class="linenos">2008</span></a><span class="sd">        individual arguments of the tail of self as a Mul.</span>
</span><span id="Expr.as_coeff_mul-2009"><a href="#Expr.as_coeff_mul-2009"><span class="linenos">2009</span></a>
</span><span id="Expr.as_coeff_mul-2010"><a href="#Expr.as_coeff_mul-2010"><span class="linenos">2010</span></a><span class="sd">        - if you know self is a Mul and want only the head, use self.args[0];</span>
</span><span id="Expr.as_coeff_mul-2011"><a href="#Expr.as_coeff_mul-2011"><span class="linenos">2011</span></a><span class="sd">        - if you do not want to process the arguments of the tail but need the</span>
</span><span id="Expr.as_coeff_mul-2012"><a href="#Expr.as_coeff_mul-2012"><span class="linenos">2012</span></a><span class="sd">          tail then use self.as_two_terms() which gives the head and tail;</span>
</span><span id="Expr.as_coeff_mul-2013"><a href="#Expr.as_coeff_mul-2013"><span class="linenos">2013</span></a><span class="sd">        - if you want to split self into an independent and dependent parts</span>
</span><span id="Expr.as_coeff_mul-2014"><a href="#Expr.as_coeff_mul-2014"><span class="linenos">2014</span></a><span class="sd">          use ``self.as_independent(*deps)``</span>
</span><span id="Expr.as_coeff_mul-2015"><a href="#Expr.as_coeff_mul-2015"><span class="linenos">2015</span></a>
</span><span id="Expr.as_coeff_mul-2016"><a href="#Expr.as_coeff_mul-2016"><span class="linenos">2016</span></a><span class="sd">        &gt;&gt;&gt; from sympy import S</span>
</span><span id="Expr.as_coeff_mul-2017"><a href="#Expr.as_coeff_mul-2017"><span class="linenos">2017</span></a><span class="sd">        &gt;&gt;&gt; from sympy.abc import x, y</span>
</span><span id="Expr.as_coeff_mul-2018"><a href="#Expr.as_coeff_mul-2018"><span class="linenos">2018</span></a><span class="sd">        &gt;&gt;&gt; (S(3)).as_coeff_mul()</span>
</span><span id="Expr.as_coeff_mul-2019"><a href="#Expr.as_coeff_mul-2019"><span class="linenos">2019</span></a><span class="sd">        (3, ())</span>
</span><span id="Expr.as_coeff_mul-2020"><a href="#Expr.as_coeff_mul-2020"><span class="linenos">2020</span></a><span class="sd">        &gt;&gt;&gt; (3*x*y).as_coeff_mul()</span>
</span><span id="Expr.as_coeff_mul-2021"><a href="#Expr.as_coeff_mul-2021"><span class="linenos">2021</span></a><span class="sd">        (3, (x, y))</span>
</span><span id="Expr.as_coeff_mul-2022"><a href="#Expr.as_coeff_mul-2022"><span class="linenos">2022</span></a><span class="sd">        &gt;&gt;&gt; (3*x*y).as_coeff_mul(x)</span>
</span><span id="Expr.as_coeff_mul-2023"><a href="#Expr.as_coeff_mul-2023"><span class="linenos">2023</span></a><span class="sd">        (3*y, (x,))</span>
</span><span id="Expr.as_coeff_mul-2024"><a href="#Expr.as_coeff_mul-2024"><span class="linenos">2024</span></a><span class="sd">        &gt;&gt;&gt; (3*y).as_coeff_mul(x)</span>
</span><span id="Expr.as_coeff_mul-2025"><a href="#Expr.as_coeff_mul-2025"><span class="linenos">2025</span></a><span class="sd">        (3*y, ())</span>
</span><span id="Expr.as_coeff_mul-2026"><a href="#Expr.as_coeff_mul-2026"><span class="linenos">2026</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Expr.as_coeff_mul-2027"><a href="#Expr.as_coeff_mul-2027"><span class="linenos">2027</span></a>        <span class="k">if</span> <span class="n">deps</span><span class="p">:</span>
</span><span id="Expr.as_coeff_mul-2028"><a href="#Expr.as_coeff_mul-2028"><span class="linenos">2028</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">has</span><span class="p">(</span><span class="o">*</span><span class="n">deps</span><span class="p">):</span>
</span><span id="Expr.as_coeff_mul-2029"><a href="#Expr.as_coeff_mul-2029"><span class="linenos">2029</span></a>                <span class="k">return</span> <span class="bp">self</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">()</span>
</span><span id="Expr.as_coeff_mul-2030"><a href="#Expr.as_coeff_mul-2030"><span class="linenos">2030</span></a>        <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">One</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="p">,)</span>
</span></pre></div>


            <div class="docstring"><p>Return the tuple (c, args) where self is written as a Mul, <code>m</code>.</p>

<p>c should be a Rational multiplied by any factors of the Mul that are
independent of deps.</p>

<p>args should be a tuple of all other factors of m; args is empty
if self is a Number or if self is independent of deps (when given).</p>

<p>This should be used when you do not know if self is a Mul or not but
you want to treat self as a Mul or if you want to process the
individual arguments of the tail of self as a Mul.</p>

<ul>
<li>if you know self is a Mul and want only the head, use self.args[0];</li>
<li>if you do not want to process the arguments of the tail but need the
tail then use self.as_two_terms() which gives the head and tail;</li>
<li>if you want to split self into an independent and dependent parts
use <code>self.as_independent(*deps)</code></li>
</ul>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">S</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.abc</span> <span class="kn">import</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">S</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">.</span><span class="n">as_coeff_mul</span><span class="p">()</span>
<span class="go">(3, ())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">as_coeff_mul</span><span class="p">()</span>
<span class="go">(3, (x, y))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">as_coeff_mul</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">(3*y, (x,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">as_coeff_mul</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">(3*y, ())</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="Expr.as_coeff_add" class="classattr">
                                        <input id="Expr.as_coeff_add-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">as_coeff_add</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="o">*</span><span class="n">deps</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Expr.as_coeff_add-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Expr.as_coeff_add"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Expr.as_coeff_add-2032"><a href="#Expr.as_coeff_add-2032"><span class="linenos">2032</span></a>    <span class="k">def</span> <span class="nf">as_coeff_add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">deps</span><span class="p">):</span>
</span><span id="Expr.as_coeff_add-2033"><a href="#Expr.as_coeff_add-2033"><span class="linenos">2033</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the tuple (c, args) where self is written as an Add, ``a``.</span>
</span><span id="Expr.as_coeff_add-2034"><a href="#Expr.as_coeff_add-2034"><span class="linenos">2034</span></a>
</span><span id="Expr.as_coeff_add-2035"><a href="#Expr.as_coeff_add-2035"><span class="linenos">2035</span></a><span class="sd">        c should be a Rational added to any terms of the Add that are</span>
</span><span id="Expr.as_coeff_add-2036"><a href="#Expr.as_coeff_add-2036"><span class="linenos">2036</span></a><span class="sd">        independent of deps.</span>
</span><span id="Expr.as_coeff_add-2037"><a href="#Expr.as_coeff_add-2037"><span class="linenos">2037</span></a>
</span><span id="Expr.as_coeff_add-2038"><a href="#Expr.as_coeff_add-2038"><span class="linenos">2038</span></a><span class="sd">        args should be a tuple of all other terms of ``a``; args is empty</span>
</span><span id="Expr.as_coeff_add-2039"><a href="#Expr.as_coeff_add-2039"><span class="linenos">2039</span></a><span class="sd">        if self is a Number or if self is independent of deps (when given).</span>
</span><span id="Expr.as_coeff_add-2040"><a href="#Expr.as_coeff_add-2040"><span class="linenos">2040</span></a>
</span><span id="Expr.as_coeff_add-2041"><a href="#Expr.as_coeff_add-2041"><span class="linenos">2041</span></a><span class="sd">        This should be used when you do not know if self is an Add or not but</span>
</span><span id="Expr.as_coeff_add-2042"><a href="#Expr.as_coeff_add-2042"><span class="linenos">2042</span></a><span class="sd">        you want to treat self as an Add or if you want to process the</span>
</span><span id="Expr.as_coeff_add-2043"><a href="#Expr.as_coeff_add-2043"><span class="linenos">2043</span></a><span class="sd">        individual arguments of the tail of self as an Add.</span>
</span><span id="Expr.as_coeff_add-2044"><a href="#Expr.as_coeff_add-2044"><span class="linenos">2044</span></a>
</span><span id="Expr.as_coeff_add-2045"><a href="#Expr.as_coeff_add-2045"><span class="linenos">2045</span></a><span class="sd">        - if you know self is an Add and want only the head, use self.args[0];</span>
</span><span id="Expr.as_coeff_add-2046"><a href="#Expr.as_coeff_add-2046"><span class="linenos">2046</span></a><span class="sd">        - if you do not want to process the arguments of the tail but need the</span>
</span><span id="Expr.as_coeff_add-2047"><a href="#Expr.as_coeff_add-2047"><span class="linenos">2047</span></a><span class="sd">          tail then use self.as_two_terms() which gives the head and tail.</span>
</span><span id="Expr.as_coeff_add-2048"><a href="#Expr.as_coeff_add-2048"><span class="linenos">2048</span></a><span class="sd">        - if you want to split self into an independent and dependent parts</span>
</span><span id="Expr.as_coeff_add-2049"><a href="#Expr.as_coeff_add-2049"><span class="linenos">2049</span></a><span class="sd">          use ``self.as_independent(*deps)``</span>
</span><span id="Expr.as_coeff_add-2050"><a href="#Expr.as_coeff_add-2050"><span class="linenos">2050</span></a>
</span><span id="Expr.as_coeff_add-2051"><a href="#Expr.as_coeff_add-2051"><span class="linenos">2051</span></a><span class="sd">        &gt;&gt;&gt; from sympy import S</span>
</span><span id="Expr.as_coeff_add-2052"><a href="#Expr.as_coeff_add-2052"><span class="linenos">2052</span></a><span class="sd">        &gt;&gt;&gt; from sympy.abc import x, y</span>
</span><span id="Expr.as_coeff_add-2053"><a href="#Expr.as_coeff_add-2053"><span class="linenos">2053</span></a><span class="sd">        &gt;&gt;&gt; (S(3)).as_coeff_add()</span>
</span><span id="Expr.as_coeff_add-2054"><a href="#Expr.as_coeff_add-2054"><span class="linenos">2054</span></a><span class="sd">        (3, ())</span>
</span><span id="Expr.as_coeff_add-2055"><a href="#Expr.as_coeff_add-2055"><span class="linenos">2055</span></a><span class="sd">        &gt;&gt;&gt; (3 + x).as_coeff_add()</span>
</span><span id="Expr.as_coeff_add-2056"><a href="#Expr.as_coeff_add-2056"><span class="linenos">2056</span></a><span class="sd">        (3, (x,))</span>
</span><span id="Expr.as_coeff_add-2057"><a href="#Expr.as_coeff_add-2057"><span class="linenos">2057</span></a><span class="sd">        &gt;&gt;&gt; (3 + x + y).as_coeff_add(x)</span>
</span><span id="Expr.as_coeff_add-2058"><a href="#Expr.as_coeff_add-2058"><span class="linenos">2058</span></a><span class="sd">        (y + 3, (x,))</span>
</span><span id="Expr.as_coeff_add-2059"><a href="#Expr.as_coeff_add-2059"><span class="linenos">2059</span></a><span class="sd">        &gt;&gt;&gt; (3 + y).as_coeff_add(x)</span>
</span><span id="Expr.as_coeff_add-2060"><a href="#Expr.as_coeff_add-2060"><span class="linenos">2060</span></a><span class="sd">        (y + 3, ())</span>
</span><span id="Expr.as_coeff_add-2061"><a href="#Expr.as_coeff_add-2061"><span class="linenos">2061</span></a>
</span><span id="Expr.as_coeff_add-2062"><a href="#Expr.as_coeff_add-2062"><span class="linenos">2062</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Expr.as_coeff_add-2063"><a href="#Expr.as_coeff_add-2063"><span class="linenos">2063</span></a>        <span class="k">if</span> <span class="n">deps</span><span class="p">:</span>
</span><span id="Expr.as_coeff_add-2064"><a href="#Expr.as_coeff_add-2064"><span class="linenos">2064</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_free</span><span class="p">(</span><span class="o">*</span><span class="n">deps</span><span class="p">):</span>
</span><span id="Expr.as_coeff_add-2065"><a href="#Expr.as_coeff_add-2065"><span class="linenos">2065</span></a>                <span class="k">return</span> <span class="bp">self</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">()</span>
</span><span id="Expr.as_coeff_add-2066"><a href="#Expr.as_coeff_add-2066"><span class="linenos">2066</span></a>        <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">Zero</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="p">,)</span>
</span></pre></div>


            <div class="docstring"><p>Return the tuple (c, args) where self is written as an Add, <code>a</code>.</p>

<p>c should be a Rational added to any terms of the Add that are
independent of deps.</p>

<p>args should be a tuple of all other terms of <code>a</code>; args is empty
if self is a Number or if self is independent of deps (when given).</p>

<p>This should be used when you do not know if self is an Add or not but
you want to treat self as an Add or if you want to process the
individual arguments of the tail of self as an Add.</p>

<ul>
<li>if you know self is an Add and want only the head, use self.args[0];</li>
<li>if you do not want to process the arguments of the tail but need the
tail then use self.as_two_terms() which gives the head and tail.</li>
<li>if you want to split self into an independent and dependent parts
use <code>self.as_independent(*deps)</code></li>
</ul>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">S</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.abc</span> <span class="kn">import</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">S</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">.</span><span class="n">as_coeff_add</span><span class="p">()</span>
<span class="go">(3, ())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="mi">3</span> <span class="o">+</span> <span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">as_coeff_add</span><span class="p">()</span>
<span class="go">(3, (x,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="mi">3</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">as_coeff_add</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">(y + 3, (x,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="mi">3</span> <span class="o">+</span> <span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">as_coeff_add</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">(y + 3, ())</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="Expr.primitive" class="classattr">
                                        <input id="Expr.primitive-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">primitive</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Expr.primitive-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Expr.primitive"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Expr.primitive-2068"><a href="#Expr.primitive-2068"><span class="linenos">2068</span></a>    <span class="k">def</span> <span class="nf">primitive</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Expr.primitive-2069"><a href="#Expr.primitive-2069"><span class="linenos">2069</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the positive Rational that can be extracted non-recursively</span>
</span><span id="Expr.primitive-2070"><a href="#Expr.primitive-2070"><span class="linenos">2070</span></a><span class="sd">        from every term of self (i.e., self is treated like an Add). This is</span>
</span><span id="Expr.primitive-2071"><a href="#Expr.primitive-2071"><span class="linenos">2071</span></a><span class="sd">        like the as_coeff_Mul() method but primitive always extracts a positive</span>
</span><span id="Expr.primitive-2072"><a href="#Expr.primitive-2072"><span class="linenos">2072</span></a><span class="sd">        Rational (never a negative or a Float).</span>
</span><span id="Expr.primitive-2073"><a href="#Expr.primitive-2073"><span class="linenos">2073</span></a>
</span><span id="Expr.primitive-2074"><a href="#Expr.primitive-2074"><span class="linenos">2074</span></a><span class="sd">        Examples</span>
</span><span id="Expr.primitive-2075"><a href="#Expr.primitive-2075"><span class="linenos">2075</span></a><span class="sd">        ========</span>
</span><span id="Expr.primitive-2076"><a href="#Expr.primitive-2076"><span class="linenos">2076</span></a>
</span><span id="Expr.primitive-2077"><a href="#Expr.primitive-2077"><span class="linenos">2077</span></a><span class="sd">        &gt;&gt;&gt; from sympy.abc import x</span>
</span><span id="Expr.primitive-2078"><a href="#Expr.primitive-2078"><span class="linenos">2078</span></a><span class="sd">        &gt;&gt;&gt; (3*(x + 1)**2).primitive()</span>
</span><span id="Expr.primitive-2079"><a href="#Expr.primitive-2079"><span class="linenos">2079</span></a><span class="sd">        (3, (x + 1)**2)</span>
</span><span id="Expr.primitive-2080"><a href="#Expr.primitive-2080"><span class="linenos">2080</span></a><span class="sd">        &gt;&gt;&gt; a = (6*x + 2); a.primitive()</span>
</span><span id="Expr.primitive-2081"><a href="#Expr.primitive-2081"><span class="linenos">2081</span></a><span class="sd">        (2, 3*x + 1)</span>
</span><span id="Expr.primitive-2082"><a href="#Expr.primitive-2082"><span class="linenos">2082</span></a><span class="sd">        &gt;&gt;&gt; b = (x/2 + 3); b.primitive()</span>
</span><span id="Expr.primitive-2083"><a href="#Expr.primitive-2083"><span class="linenos">2083</span></a><span class="sd">        (1/2, x + 6)</span>
</span><span id="Expr.primitive-2084"><a href="#Expr.primitive-2084"><span class="linenos">2084</span></a><span class="sd">        &gt;&gt;&gt; (a*b).primitive() == (1, a*b)</span>
</span><span id="Expr.primitive-2085"><a href="#Expr.primitive-2085"><span class="linenos">2085</span></a><span class="sd">        True</span>
</span><span id="Expr.primitive-2086"><a href="#Expr.primitive-2086"><span class="linenos">2086</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Expr.primitive-2087"><a href="#Expr.primitive-2087"><span class="linenos">2087</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="p">:</span>
</span><span id="Expr.primitive-2088"><a href="#Expr.primitive-2088"><span class="linenos">2088</span></a>            <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">One</span><span class="p">,</span> <span class="n">S</span><span class="o">.</span><span class="n">Zero</span>
</span><span id="Expr.primitive-2089"><a href="#Expr.primitive-2089"><span class="linenos">2089</span></a>        <span class="n">c</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">as_coeff_Mul</span><span class="p">(</span><span class="n">rational</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="Expr.primitive-2090"><a href="#Expr.primitive-2090"><span class="linenos">2090</span></a>        <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">is_negative</span><span class="p">:</span>
</span><span id="Expr.primitive-2091"><a href="#Expr.primitive-2091"><span class="linenos">2091</span></a>            <span class="n">c</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="o">-</span><span class="n">c</span><span class="p">,</span> <span class="o">-</span><span class="n">r</span>
</span><span id="Expr.primitive-2092"><a href="#Expr.primitive-2092"><span class="linenos">2092</span></a>        <span class="k">return</span> <span class="n">c</span><span class="p">,</span> <span class="n">r</span>
</span></pre></div>


            <div class="docstring"><p>Return the positive Rational that can be extracted non-recursively
from every term of self (i.e., self is treated like an Add). This is
like the as_coeff_Mul() method but primitive always extracts a positive
Rational (never a negative or a Float).</p>

<h1 id="examples">Examples</h1>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.abc</span> <span class="kn">import</span> <span class="n">x</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">primitive</span><span class="p">()</span>
<span class="go">(3, (x + 1)**2)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="p">(</span><span class="mi">6</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">2</span><span class="p">);</span> <span class="n">a</span><span class="o">.</span><span class="n">primitive</span><span class="p">()</span>
<span class="go">(2, 3*x + 1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="p">);</span> <span class="n">b</span><span class="o">.</span><span class="n">primitive</span><span class="p">()</span>
<span class="go">(1/2, x + 6)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">primitive</span><span class="p">()</span> <span class="o">==</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">a</span><span class="o">*</span><span class="n">b</span><span class="p">)</span>
<span class="go">True</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="Expr.as_content_primitive" class="classattr">
                                        <input id="Expr.as_content_primitive-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">as_content_primitive</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">radical</span><span class="o">=</span><span class="kc">False</span>, </span><span class="param"><span class="n">clear</span><span class="o">=</span><span class="kc">True</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Expr.as_content_primitive-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Expr.as_content_primitive"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Expr.as_content_primitive-2094"><a href="#Expr.as_content_primitive-2094"><span class="linenos">2094</span></a>    <span class="k">def</span> <span class="nf">as_content_primitive</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">radical</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">clear</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="Expr.as_content_primitive-2095"><a href="#Expr.as_content_primitive-2095"><span class="linenos">2095</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;This method should recursively remove a Rational from all arguments</span>
</span><span id="Expr.as_content_primitive-2096"><a href="#Expr.as_content_primitive-2096"><span class="linenos">2096</span></a><span class="sd">        and return that (content) and the new self (primitive). The content</span>
</span><span id="Expr.as_content_primitive-2097"><a href="#Expr.as_content_primitive-2097"><span class="linenos">2097</span></a><span class="sd">        should always be positive and ``Mul(*foo.as_content_primitive()) == foo``.</span>
</span><span id="Expr.as_content_primitive-2098"><a href="#Expr.as_content_primitive-2098"><span class="linenos">2098</span></a><span class="sd">        The primitive need not be in canonical form and should try to preserve</span>
</span><span id="Expr.as_content_primitive-2099"><a href="#Expr.as_content_primitive-2099"><span class="linenos">2099</span></a><span class="sd">        the underlying structure if possible (i.e. expand_mul should not be</span>
</span><span id="Expr.as_content_primitive-2100"><a href="#Expr.as_content_primitive-2100"><span class="linenos">2100</span></a><span class="sd">        applied to self).</span>
</span><span id="Expr.as_content_primitive-2101"><a href="#Expr.as_content_primitive-2101"><span class="linenos">2101</span></a>
</span><span id="Expr.as_content_primitive-2102"><a href="#Expr.as_content_primitive-2102"><span class="linenos">2102</span></a><span class="sd">        Examples</span>
</span><span id="Expr.as_content_primitive-2103"><a href="#Expr.as_content_primitive-2103"><span class="linenos">2103</span></a><span class="sd">        ========</span>
</span><span id="Expr.as_content_primitive-2104"><a href="#Expr.as_content_primitive-2104"><span class="linenos">2104</span></a>
</span><span id="Expr.as_content_primitive-2105"><a href="#Expr.as_content_primitive-2105"><span class="linenos">2105</span></a><span class="sd">        &gt;&gt;&gt; from sympy import sqrt</span>
</span><span id="Expr.as_content_primitive-2106"><a href="#Expr.as_content_primitive-2106"><span class="linenos">2106</span></a><span class="sd">        &gt;&gt;&gt; from sympy.abc import x, y, z</span>
</span><span id="Expr.as_content_primitive-2107"><a href="#Expr.as_content_primitive-2107"><span class="linenos">2107</span></a>
</span><span id="Expr.as_content_primitive-2108"><a href="#Expr.as_content_primitive-2108"><span class="linenos">2108</span></a><span class="sd">        &gt;&gt;&gt; eq = 2 + 2*x + 2*y*(3 + 3*y)</span>
</span><span id="Expr.as_content_primitive-2109"><a href="#Expr.as_content_primitive-2109"><span class="linenos">2109</span></a>
</span><span id="Expr.as_content_primitive-2110"><a href="#Expr.as_content_primitive-2110"><span class="linenos">2110</span></a><span class="sd">        The as_content_primitive function is recursive and retains structure:</span>
</span><span id="Expr.as_content_primitive-2111"><a href="#Expr.as_content_primitive-2111"><span class="linenos">2111</span></a>
</span><span id="Expr.as_content_primitive-2112"><a href="#Expr.as_content_primitive-2112"><span class="linenos">2112</span></a><span class="sd">        &gt;&gt;&gt; eq.as_content_primitive()</span>
</span><span id="Expr.as_content_primitive-2113"><a href="#Expr.as_content_primitive-2113"><span class="linenos">2113</span></a><span class="sd">        (2, x + 3*y*(y + 1) + 1)</span>
</span><span id="Expr.as_content_primitive-2114"><a href="#Expr.as_content_primitive-2114"><span class="linenos">2114</span></a>
</span><span id="Expr.as_content_primitive-2115"><a href="#Expr.as_content_primitive-2115"><span class="linenos">2115</span></a><span class="sd">        Integer powers will have Rationals extracted from the base:</span>
</span><span id="Expr.as_content_primitive-2116"><a href="#Expr.as_content_primitive-2116"><span class="linenos">2116</span></a>
</span><span id="Expr.as_content_primitive-2117"><a href="#Expr.as_content_primitive-2117"><span class="linenos">2117</span></a><span class="sd">        &gt;&gt;&gt; ((2 + 6*x)**2).as_content_primitive()</span>
</span><span id="Expr.as_content_primitive-2118"><a href="#Expr.as_content_primitive-2118"><span class="linenos">2118</span></a><span class="sd">        (4, (3*x + 1)**2)</span>
</span><span id="Expr.as_content_primitive-2119"><a href="#Expr.as_content_primitive-2119"><span class="linenos">2119</span></a><span class="sd">        &gt;&gt;&gt; ((2 + 6*x)**(2*y)).as_content_primitive()</span>
</span><span id="Expr.as_content_primitive-2120"><a href="#Expr.as_content_primitive-2120"><span class="linenos">2120</span></a><span class="sd">        (1, (2*(3*x + 1))**(2*y))</span>
</span><span id="Expr.as_content_primitive-2121"><a href="#Expr.as_content_primitive-2121"><span class="linenos">2121</span></a>
</span><span id="Expr.as_content_primitive-2122"><a href="#Expr.as_content_primitive-2122"><span class="linenos">2122</span></a><span class="sd">        Terms may end up joining once their as_content_primitives are added:</span>
</span><span id="Expr.as_content_primitive-2123"><a href="#Expr.as_content_primitive-2123"><span class="linenos">2123</span></a>
</span><span id="Expr.as_content_primitive-2124"><a href="#Expr.as_content_primitive-2124"><span class="linenos">2124</span></a><span class="sd">        &gt;&gt;&gt; ((5*(x*(1 + y)) + 2*x*(3 + 3*y))).as_content_primitive()</span>
</span><span id="Expr.as_content_primitive-2125"><a href="#Expr.as_content_primitive-2125"><span class="linenos">2125</span></a><span class="sd">        (11, x*(y + 1))</span>
</span><span id="Expr.as_content_primitive-2126"><a href="#Expr.as_content_primitive-2126"><span class="linenos">2126</span></a><span class="sd">        &gt;&gt;&gt; ((3*(x*(1 + y)) + 2*x*(3 + 3*y))).as_content_primitive()</span>
</span><span id="Expr.as_content_primitive-2127"><a href="#Expr.as_content_primitive-2127"><span class="linenos">2127</span></a><span class="sd">        (9, x*(y + 1))</span>
</span><span id="Expr.as_content_primitive-2128"><a href="#Expr.as_content_primitive-2128"><span class="linenos">2128</span></a><span class="sd">        &gt;&gt;&gt; ((3*(z*(1 + y)) + 2.0*x*(3 + 3*y))).as_content_primitive()</span>
</span><span id="Expr.as_content_primitive-2129"><a href="#Expr.as_content_primitive-2129"><span class="linenos">2129</span></a><span class="sd">        (1, 6.0*x*(y + 1) + 3*z*(y + 1))</span>
</span><span id="Expr.as_content_primitive-2130"><a href="#Expr.as_content_primitive-2130"><span class="linenos">2130</span></a><span class="sd">        &gt;&gt;&gt; ((5*(x*(1 + y)) + 2*x*(3 + 3*y))**2).as_content_primitive()</span>
</span><span id="Expr.as_content_primitive-2131"><a href="#Expr.as_content_primitive-2131"><span class="linenos">2131</span></a><span class="sd">        (121, x**2*(y + 1)**2)</span>
</span><span id="Expr.as_content_primitive-2132"><a href="#Expr.as_content_primitive-2132"><span class="linenos">2132</span></a><span class="sd">        &gt;&gt;&gt; ((x*(1 + y) + 0.4*x*(3 + 3*y))**2).as_content_primitive()</span>
</span><span id="Expr.as_content_primitive-2133"><a href="#Expr.as_content_primitive-2133"><span class="linenos">2133</span></a><span class="sd">        (1, 4.84*x**2*(y + 1)**2)</span>
</span><span id="Expr.as_content_primitive-2134"><a href="#Expr.as_content_primitive-2134"><span class="linenos">2134</span></a>
</span><span id="Expr.as_content_primitive-2135"><a href="#Expr.as_content_primitive-2135"><span class="linenos">2135</span></a><span class="sd">        Radical content can also be factored out of the primitive:</span>
</span><span id="Expr.as_content_primitive-2136"><a href="#Expr.as_content_primitive-2136"><span class="linenos">2136</span></a>
</span><span id="Expr.as_content_primitive-2137"><a href="#Expr.as_content_primitive-2137"><span class="linenos">2137</span></a><span class="sd">        &gt;&gt;&gt; (2*sqrt(2) + 4*sqrt(10)).as_content_primitive(radical=True)</span>
</span><span id="Expr.as_content_primitive-2138"><a href="#Expr.as_content_primitive-2138"><span class="linenos">2138</span></a><span class="sd">        (2, sqrt(2)*(1 + 2*sqrt(5)))</span>
</span><span id="Expr.as_content_primitive-2139"><a href="#Expr.as_content_primitive-2139"><span class="linenos">2139</span></a>
</span><span id="Expr.as_content_primitive-2140"><a href="#Expr.as_content_primitive-2140"><span class="linenos">2140</span></a><span class="sd">        If clear=False (default is True) then content will not be removed</span>
</span><span id="Expr.as_content_primitive-2141"><a href="#Expr.as_content_primitive-2141"><span class="linenos">2141</span></a><span class="sd">        from an Add if it can be distributed to leave one or more</span>
</span><span id="Expr.as_content_primitive-2142"><a href="#Expr.as_content_primitive-2142"><span class="linenos">2142</span></a><span class="sd">        terms with integer coefficients.</span>
</span><span id="Expr.as_content_primitive-2143"><a href="#Expr.as_content_primitive-2143"><span class="linenos">2143</span></a>
</span><span id="Expr.as_content_primitive-2144"><a href="#Expr.as_content_primitive-2144"><span class="linenos">2144</span></a><span class="sd">        &gt;&gt;&gt; (x/2 + y).as_content_primitive()</span>
</span><span id="Expr.as_content_primitive-2145"><a href="#Expr.as_content_primitive-2145"><span class="linenos">2145</span></a><span class="sd">        (1/2, x + 2*y)</span>
</span><span id="Expr.as_content_primitive-2146"><a href="#Expr.as_content_primitive-2146"><span class="linenos">2146</span></a><span class="sd">        &gt;&gt;&gt; (x/2 + y).as_content_primitive(clear=False)</span>
</span><span id="Expr.as_content_primitive-2147"><a href="#Expr.as_content_primitive-2147"><span class="linenos">2147</span></a><span class="sd">        (1, x/2 + y)</span>
</span><span id="Expr.as_content_primitive-2148"><a href="#Expr.as_content_primitive-2148"><span class="linenos">2148</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Expr.as_content_primitive-2149"><a href="#Expr.as_content_primitive-2149"><span class="linenos">2149</span></a>        <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">One</span><span class="p">,</span> <span class="bp">self</span>
</span></pre></div>


            <div class="docstring"><p>This method should recursively remove a Rational from all arguments
and return that (content) and the new self (primitive). The content
should always be positive and <code>Mul(*foo.as_content_primitive()) == foo</code>.
The primitive need not be in canonical form and should try to preserve
the underlying structure if possible (i.e. expand_mul should not be
applied to self).</p>

<h1 id="examples">Examples</h1>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">sqrt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.abc</span> <span class="kn">import</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span>
</code></pre>
</div>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">eq</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">y</span><span class="o">*</span><span class="p">(</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">y</span><span class="p">)</span>
</code></pre>
</div>

<p>The as_content_primitive function is recursive and retains structure:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">eq</span><span class="o">.</span><span class="n">as_content_primitive</span><span class="p">()</span>
<span class="go">(2, x + 3*y*(y + 1) + 1)</span>
</code></pre>
</div>

<p>Integer powers will have Rationals extracted from the base:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="p">((</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">6</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">as_content_primitive</span><span class="p">()</span>
<span class="go">(4, (3*x + 1)**2)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">((</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">6</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">y</span><span class="p">))</span><span class="o">.</span><span class="n">as_content_primitive</span><span class="p">()</span>
<span class="go">(1, (2*(3*x + 1))**(2*y))</span>
</code></pre>
</div>

<p>Terms may end up joining once their as_content_primitives are added:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="p">((</span><span class="mi">5</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">y</span><span class="p">))</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="p">(</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">y</span><span class="p">)))</span><span class="o">.</span><span class="n">as_content_primitive</span><span class="p">()</span>
<span class="go">(11, x*(y + 1))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">((</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">y</span><span class="p">))</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="p">(</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">y</span><span class="p">)))</span><span class="o">.</span><span class="n">as_content_primitive</span><span class="p">()</span>
<span class="go">(9, x*(y + 1))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">((</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">z</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">y</span><span class="p">))</span> <span class="o">+</span> <span class="mf">2.0</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="p">(</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">y</span><span class="p">)))</span><span class="o">.</span><span class="n">as_content_primitive</span><span class="p">()</span>
<span class="go">(1, 6.0*x*(y + 1) + 3*z*(y + 1))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">((</span><span class="mi">5</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">y</span><span class="p">))</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="p">(</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">y</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">as_content_primitive</span><span class="p">()</span>
<span class="go">(121, x**2*(y + 1)**2)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">((</span><span class="n">x</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">y</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.4</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="p">(</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">y</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">as_content_primitive</span><span class="p">()</span>
<span class="go">(1, 4.84*x**2*(y + 1)**2)</span>
</code></pre>
</div>

<p>Radical content can also be factored out of the primitive:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span><span class="o">.</span><span class="n">as_content_primitive</span><span class="p">(</span><span class="n">radical</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">(2, sqrt(2)*(1 + 2*sqrt(5)))</span>
</code></pre>
</div>

<p>If clear=False (default is True) then content will not be removed
from an Add if it can be distributed to leave one or more
terms with integer coefficients.</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">x</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">as_content_primitive</span><span class="p">()</span>
<span class="go">(1/2, x + 2*y)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">x</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">as_content_primitive</span><span class="p">(</span><span class="n">clear</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">(1, x/2 + y)</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="Expr.as_numer_denom" class="classattr">
                                        <input id="Expr.as_numer_denom-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">as_numer_denom</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Expr.as_numer_denom-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Expr.as_numer_denom"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Expr.as_numer_denom-2151"><a href="#Expr.as_numer_denom-2151"><span class="linenos">2151</span></a>    <span class="k">def</span> <span class="nf">as_numer_denom</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Expr.as_numer_denom-2152"><a href="#Expr.as_numer_denom-2152"><span class="linenos">2152</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; expression -&gt; a/b -&gt; a, b</span>
</span><span id="Expr.as_numer_denom-2153"><a href="#Expr.as_numer_denom-2153"><span class="linenos">2153</span></a>
</span><span id="Expr.as_numer_denom-2154"><a href="#Expr.as_numer_denom-2154"><span class="linenos">2154</span></a><span class="sd">        This is just a stub that should be defined by</span>
</span><span id="Expr.as_numer_denom-2155"><a href="#Expr.as_numer_denom-2155"><span class="linenos">2155</span></a><span class="sd">        an object&#39;s class methods to get anything else.</span>
</span><span id="Expr.as_numer_denom-2156"><a href="#Expr.as_numer_denom-2156"><span class="linenos">2156</span></a>
</span><span id="Expr.as_numer_denom-2157"><a href="#Expr.as_numer_denom-2157"><span class="linenos">2157</span></a><span class="sd">        See Also</span>
</span><span id="Expr.as_numer_denom-2158"><a href="#Expr.as_numer_denom-2158"><span class="linenos">2158</span></a><span class="sd">        ========</span>
</span><span id="Expr.as_numer_denom-2159"><a href="#Expr.as_numer_denom-2159"><span class="linenos">2159</span></a>
</span><span id="Expr.as_numer_denom-2160"><a href="#Expr.as_numer_denom-2160"><span class="linenos">2160</span></a><span class="sd">        normal: return ``a/b`` instead of ``(a, b)``</span>
</span><span id="Expr.as_numer_denom-2161"><a href="#Expr.as_numer_denom-2161"><span class="linenos">2161</span></a>
</span><span id="Expr.as_numer_denom-2162"><a href="#Expr.as_numer_denom-2162"><span class="linenos">2162</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Expr.as_numer_denom-2163"><a href="#Expr.as_numer_denom-2163"><span class="linenos">2163</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="p">,</span> <span class="n">S</span><span class="o">.</span><span class="n">One</span>
</span></pre></div>


            <div class="docstring"><p>expression -> a/b -> a, b</p>

<p>This is just a stub that should be defined by
an object's class methods to get anything else.</p>

<h1 id="see-also">See Also</h1>

<p>normal: return <code>a/b</code> instead of <code>(a, b)</code></p>
</div>


                            </div>
                            <div id="Expr.normal" class="classattr">
                                        <input id="Expr.normal-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">normal</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Expr.normal-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Expr.normal"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Expr.normal-2165"><a href="#Expr.normal-2165"><span class="linenos">2165</span></a>    <span class="k">def</span> <span class="nf">normal</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Expr.normal-2166"><a href="#Expr.normal-2166"><span class="linenos">2166</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; expression -&gt; a/b</span>
</span><span id="Expr.normal-2167"><a href="#Expr.normal-2167"><span class="linenos">2167</span></a>
</span><span id="Expr.normal-2168"><a href="#Expr.normal-2168"><span class="linenos">2168</span></a><span class="sd">        See Also</span>
</span><span id="Expr.normal-2169"><a href="#Expr.normal-2169"><span class="linenos">2169</span></a><span class="sd">        ========</span>
</span><span id="Expr.normal-2170"><a href="#Expr.normal-2170"><span class="linenos">2170</span></a>
</span><span id="Expr.normal-2171"><a href="#Expr.normal-2171"><span class="linenos">2171</span></a><span class="sd">        as_numer_denom: return ``(a, b)`` instead of ``a/b``</span>
</span><span id="Expr.normal-2172"><a href="#Expr.normal-2172"><span class="linenos">2172</span></a>
</span><span id="Expr.normal-2173"><a href="#Expr.normal-2173"><span class="linenos">2173</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Expr.normal-2174"><a href="#Expr.normal-2174"><span class="linenos">2174</span></a>        <span class="kn">from</span> <span class="nn">.mul</span> <span class="kn">import</span> <span class="n">_unevaluated_Mul</span>
</span><span id="Expr.normal-2175"><a href="#Expr.normal-2175"><span class="linenos">2175</span></a>        <span class="n">n</span><span class="p">,</span> <span class="n">d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">as_numer_denom</span><span class="p">()</span>
</span><span id="Expr.normal-2176"><a href="#Expr.normal-2176"><span class="linenos">2176</span></a>        <span class="k">if</span> <span class="n">d</span> <span class="ow">is</span> <span class="n">S</span><span class="o">.</span><span class="n">One</span><span class="p">:</span>
</span><span id="Expr.normal-2177"><a href="#Expr.normal-2177"><span class="linenos">2177</span></a>            <span class="k">return</span> <span class="n">n</span>
</span><span id="Expr.normal-2178"><a href="#Expr.normal-2178"><span class="linenos">2178</span></a>        <span class="k">if</span> <span class="n">d</span><span class="o">.</span><span class="n">is_Number</span><span class="p">:</span>
</span><span id="Expr.normal-2179"><a href="#Expr.normal-2179"><span class="linenos">2179</span></a>            <span class="k">return</span> <span class="n">_unevaluated_Mul</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">d</span><span class="p">)</span>
</span><span id="Expr.normal-2180"><a href="#Expr.normal-2180"><span class="linenos">2180</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Expr.normal-2181"><a href="#Expr.normal-2181"><span class="linenos">2181</span></a>            <span class="k">return</span> <span class="n">n</span><span class="o">/</span><span class="n">d</span>
</span></pre></div>


            <div class="docstring"><p>expression -> a/b</p>

<h1 id="see-also">See Also</h1>

<p>as_numer_denom: return <code>(a, b)</code> instead of <code>a/b</code></p>
</div>


                            </div>
                            <div id="Expr.extract_multiplicatively" class="classattr">
                                        <input id="Expr.extract_multiplicatively-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">extract_multiplicatively</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">c</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Expr.extract_multiplicatively-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Expr.extract_multiplicatively"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Expr.extract_multiplicatively-2183"><a href="#Expr.extract_multiplicatively-2183"><span class="linenos">2183</span></a>    <span class="k">def</span> <span class="nf">extract_multiplicatively</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
</span><span id="Expr.extract_multiplicatively-2184"><a href="#Expr.extract_multiplicatively-2184"><span class="linenos">2184</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return None if it&#39;s not possible to make self in the form</span>
</span><span id="Expr.extract_multiplicatively-2185"><a href="#Expr.extract_multiplicatively-2185"><span class="linenos">2185</span></a><span class="sd">           c * something in a nice way, i.e. preserving the properties</span>
</span><span id="Expr.extract_multiplicatively-2186"><a href="#Expr.extract_multiplicatively-2186"><span class="linenos">2186</span></a><span class="sd">           of arguments of self.</span>
</span><span id="Expr.extract_multiplicatively-2187"><a href="#Expr.extract_multiplicatively-2187"><span class="linenos">2187</span></a>
</span><span id="Expr.extract_multiplicatively-2188"><a href="#Expr.extract_multiplicatively-2188"><span class="linenos">2188</span></a><span class="sd">           Examples</span>
</span><span id="Expr.extract_multiplicatively-2189"><a href="#Expr.extract_multiplicatively-2189"><span class="linenos">2189</span></a><span class="sd">           ========</span>
</span><span id="Expr.extract_multiplicatively-2190"><a href="#Expr.extract_multiplicatively-2190"><span class="linenos">2190</span></a>
</span><span id="Expr.extract_multiplicatively-2191"><a href="#Expr.extract_multiplicatively-2191"><span class="linenos">2191</span></a><span class="sd">           &gt;&gt;&gt; from sympy import symbols, Rational</span>
</span><span id="Expr.extract_multiplicatively-2192"><a href="#Expr.extract_multiplicatively-2192"><span class="linenos">2192</span></a>
</span><span id="Expr.extract_multiplicatively-2193"><a href="#Expr.extract_multiplicatively-2193"><span class="linenos">2193</span></a><span class="sd">           &gt;&gt;&gt; x, y = symbols(&#39;x,y&#39;, real=True)</span>
</span><span id="Expr.extract_multiplicatively-2194"><a href="#Expr.extract_multiplicatively-2194"><span class="linenos">2194</span></a>
</span><span id="Expr.extract_multiplicatively-2195"><a href="#Expr.extract_multiplicatively-2195"><span class="linenos">2195</span></a><span class="sd">           &gt;&gt;&gt; ((x*y)**3).extract_multiplicatively(x**2 * y)</span>
</span><span id="Expr.extract_multiplicatively-2196"><a href="#Expr.extract_multiplicatively-2196"><span class="linenos">2196</span></a><span class="sd">           x*y**2</span>
</span><span id="Expr.extract_multiplicatively-2197"><a href="#Expr.extract_multiplicatively-2197"><span class="linenos">2197</span></a>
</span><span id="Expr.extract_multiplicatively-2198"><a href="#Expr.extract_multiplicatively-2198"><span class="linenos">2198</span></a><span class="sd">           &gt;&gt;&gt; ((x*y)**3).extract_multiplicatively(x**4 * y)</span>
</span><span id="Expr.extract_multiplicatively-2199"><a href="#Expr.extract_multiplicatively-2199"><span class="linenos">2199</span></a>
</span><span id="Expr.extract_multiplicatively-2200"><a href="#Expr.extract_multiplicatively-2200"><span class="linenos">2200</span></a><span class="sd">           &gt;&gt;&gt; (2*x).extract_multiplicatively(2)</span>
</span><span id="Expr.extract_multiplicatively-2201"><a href="#Expr.extract_multiplicatively-2201"><span class="linenos">2201</span></a><span class="sd">           x</span>
</span><span id="Expr.extract_multiplicatively-2202"><a href="#Expr.extract_multiplicatively-2202"><span class="linenos">2202</span></a>
</span><span id="Expr.extract_multiplicatively-2203"><a href="#Expr.extract_multiplicatively-2203"><span class="linenos">2203</span></a><span class="sd">           &gt;&gt;&gt; (2*x).extract_multiplicatively(3)</span>
</span><span id="Expr.extract_multiplicatively-2204"><a href="#Expr.extract_multiplicatively-2204"><span class="linenos">2204</span></a>
</span><span id="Expr.extract_multiplicatively-2205"><a href="#Expr.extract_multiplicatively-2205"><span class="linenos">2205</span></a><span class="sd">           &gt;&gt;&gt; (Rational(1, 2)*x).extract_multiplicatively(3)</span>
</span><span id="Expr.extract_multiplicatively-2206"><a href="#Expr.extract_multiplicatively-2206"><span class="linenos">2206</span></a><span class="sd">           x/6</span>
</span><span id="Expr.extract_multiplicatively-2207"><a href="#Expr.extract_multiplicatively-2207"><span class="linenos">2207</span></a>
</span><span id="Expr.extract_multiplicatively-2208"><a href="#Expr.extract_multiplicatively-2208"><span class="linenos">2208</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Expr.extract_multiplicatively-2209"><a href="#Expr.extract_multiplicatively-2209"><span class="linenos">2209</span></a>        <span class="kn">from</span> <span class="nn">sympy.functions.elementary.exponential</span> <span class="kn">import</span> <span class="n">exp</span>
</span><span id="Expr.extract_multiplicatively-2210"><a href="#Expr.extract_multiplicatively-2210"><span class="linenos">2210</span></a>        <span class="kn">from</span> <span class="nn">.add</span> <span class="kn">import</span> <span class="n">_unevaluated_Add</span>
</span><span id="Expr.extract_multiplicatively-2211"><a href="#Expr.extract_multiplicatively-2211"><span class="linenos">2211</span></a>        <span class="n">c</span> <span class="o">=</span> <span class="n">sympify</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
</span><span id="Expr.extract_multiplicatively-2212"><a href="#Expr.extract_multiplicatively-2212"><span class="linenos">2212</span></a>        <span class="k">if</span> <span class="bp">self</span> <span class="ow">is</span> <span class="n">S</span><span class="o">.</span><span class="n">NaN</span><span class="p">:</span>
</span><span id="Expr.extract_multiplicatively-2213"><a href="#Expr.extract_multiplicatively-2213"><span class="linenos">2213</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="Expr.extract_multiplicatively-2214"><a href="#Expr.extract_multiplicatively-2214"><span class="linenos">2214</span></a>        <span class="k">if</span> <span class="n">c</span> <span class="ow">is</span> <span class="n">S</span><span class="o">.</span><span class="n">One</span><span class="p">:</span>
</span><span id="Expr.extract_multiplicatively-2215"><a href="#Expr.extract_multiplicatively-2215"><span class="linenos">2215</span></a>            <span class="k">return</span> <span class="bp">self</span>
</span><span id="Expr.extract_multiplicatively-2216"><a href="#Expr.extract_multiplicatively-2216"><span class="linenos">2216</span></a>        <span class="k">elif</span> <span class="n">c</span> <span class="o">==</span> <span class="bp">self</span><span class="p">:</span>
</span><span id="Expr.extract_multiplicatively-2217"><a href="#Expr.extract_multiplicatively-2217"><span class="linenos">2217</span></a>            <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">One</span>
</span><span id="Expr.extract_multiplicatively-2218"><a href="#Expr.extract_multiplicatively-2218"><span class="linenos">2218</span></a>
</span><span id="Expr.extract_multiplicatively-2219"><a href="#Expr.extract_multiplicatively-2219"><span class="linenos">2219</span></a>        <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">is_Add</span><span class="p">:</span>
</span><span id="Expr.extract_multiplicatively-2220"><a href="#Expr.extract_multiplicatively-2220"><span class="linenos">2220</span></a>            <span class="n">cc</span><span class="p">,</span> <span class="n">pc</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">primitive</span><span class="p">()</span>
</span><span id="Expr.extract_multiplicatively-2221"><a href="#Expr.extract_multiplicatively-2221"><span class="linenos">2221</span></a>            <span class="k">if</span> <span class="n">cc</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">S</span><span class="o">.</span><span class="n">One</span><span class="p">:</span>
</span><span id="Expr.extract_multiplicatively-2222"><a href="#Expr.extract_multiplicatively-2222"><span class="linenos">2222</span></a>                <span class="n">c</span> <span class="o">=</span> <span class="n">Mul</span><span class="p">(</span><span class="n">cc</span><span class="p">,</span> <span class="n">pc</span><span class="p">,</span> <span class="n">evaluate</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="Expr.extract_multiplicatively-2223"><a href="#Expr.extract_multiplicatively-2223"><span class="linenos">2223</span></a>
</span><span id="Expr.extract_multiplicatively-2224"><a href="#Expr.extract_multiplicatively-2224"><span class="linenos">2224</span></a>        <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">is_Mul</span><span class="p">:</span>
</span><span id="Expr.extract_multiplicatively-2225"><a href="#Expr.extract_multiplicatively-2225"><span class="linenos">2225</span></a>            <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">as_two_terms</span><span class="p">()</span>
</span><span id="Expr.extract_multiplicatively-2226"><a href="#Expr.extract_multiplicatively-2226"><span class="linenos">2226</span></a>            <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">extract_multiplicatively</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</span><span id="Expr.extract_multiplicatively-2227"><a href="#Expr.extract_multiplicatively-2227"><span class="linenos">2227</span></a>            <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Expr.extract_multiplicatively-2228"><a href="#Expr.extract_multiplicatively-2228"><span class="linenos">2228</span></a>                <span class="k">return</span> <span class="n">x</span><span class="o">.</span><span class="n">extract_multiplicatively</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
</span><span id="Expr.extract_multiplicatively-2229"><a href="#Expr.extract_multiplicatively-2229"><span class="linenos">2229</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Expr.extract_multiplicatively-2230"><a href="#Expr.extract_multiplicatively-2230"><span class="linenos">2230</span></a>                <span class="k">return</span> <span class="n">x</span>
</span><span id="Expr.extract_multiplicatively-2231"><a href="#Expr.extract_multiplicatively-2231"><span class="linenos">2231</span></a>
</span><span id="Expr.extract_multiplicatively-2232"><a href="#Expr.extract_multiplicatively-2232"><span class="linenos">2232</span></a>        <span class="n">quotient</span> <span class="o">=</span> <span class="bp">self</span> <span class="o">/</span> <span class="n">c</span>
</span><span id="Expr.extract_multiplicatively-2233"><a href="#Expr.extract_multiplicatively-2233"><span class="linenos">2233</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_Number</span><span class="p">:</span>
</span><span id="Expr.extract_multiplicatively-2234"><a href="#Expr.extract_multiplicatively-2234"><span class="linenos">2234</span></a>            <span class="k">if</span> <span class="bp">self</span> <span class="ow">is</span> <span class="n">S</span><span class="o">.</span><span class="n">Infinity</span><span class="p">:</span>
</span><span id="Expr.extract_multiplicatively-2235"><a href="#Expr.extract_multiplicatively-2235"><span class="linenos">2235</span></a>                <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">is_positive</span><span class="p">:</span>
</span><span id="Expr.extract_multiplicatively-2236"><a href="#Expr.extract_multiplicatively-2236"><span class="linenos">2236</span></a>                    <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">Infinity</span>
</span><span id="Expr.extract_multiplicatively-2237"><a href="#Expr.extract_multiplicatively-2237"><span class="linenos">2237</span></a>            <span class="k">elif</span> <span class="bp">self</span> <span class="ow">is</span> <span class="n">S</span><span class="o">.</span><span class="n">NegativeInfinity</span><span class="p">:</span>
</span><span id="Expr.extract_multiplicatively-2238"><a href="#Expr.extract_multiplicatively-2238"><span class="linenos">2238</span></a>                <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">is_negative</span><span class="p">:</span>
</span><span id="Expr.extract_multiplicatively-2239"><a href="#Expr.extract_multiplicatively-2239"><span class="linenos">2239</span></a>                    <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">Infinity</span>
</span><span id="Expr.extract_multiplicatively-2240"><a href="#Expr.extract_multiplicatively-2240"><span class="linenos">2240</span></a>                <span class="k">elif</span> <span class="n">c</span><span class="o">.</span><span class="n">is_positive</span><span class="p">:</span>
</span><span id="Expr.extract_multiplicatively-2241"><a href="#Expr.extract_multiplicatively-2241"><span class="linenos">2241</span></a>                    <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">NegativeInfinity</span>
</span><span id="Expr.extract_multiplicatively-2242"><a href="#Expr.extract_multiplicatively-2242"><span class="linenos">2242</span></a>            <span class="k">elif</span> <span class="bp">self</span> <span class="ow">is</span> <span class="n">S</span><span class="o">.</span><span class="n">ComplexInfinity</span><span class="p">:</span>
</span><span id="Expr.extract_multiplicatively-2243"><a href="#Expr.extract_multiplicatively-2243"><span class="linenos">2243</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">c</span><span class="o">.</span><span class="n">is_zero</span><span class="p">:</span>
</span><span id="Expr.extract_multiplicatively-2244"><a href="#Expr.extract_multiplicatively-2244"><span class="linenos">2244</span></a>                    <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">ComplexInfinity</span>
</span><span id="Expr.extract_multiplicatively-2245"><a href="#Expr.extract_multiplicatively-2245"><span class="linenos">2245</span></a>            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_Integer</span><span class="p">:</span>
</span><span id="Expr.extract_multiplicatively-2246"><a href="#Expr.extract_multiplicatively-2246"><span class="linenos">2246</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">quotient</span><span class="o">.</span><span class="n">is_Integer</span><span class="p">:</span>
</span><span id="Expr.extract_multiplicatively-2247"><a href="#Expr.extract_multiplicatively-2247"><span class="linenos">2247</span></a>                    <span class="k">return</span> <span class="kc">None</span>
</span><span id="Expr.extract_multiplicatively-2248"><a href="#Expr.extract_multiplicatively-2248"><span class="linenos">2248</span></a>                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_positive</span> <span class="ow">and</span> <span class="n">quotient</span><span class="o">.</span><span class="n">is_negative</span><span class="p">:</span>
</span><span id="Expr.extract_multiplicatively-2249"><a href="#Expr.extract_multiplicatively-2249"><span class="linenos">2249</span></a>                    <span class="k">return</span> <span class="kc">None</span>
</span><span id="Expr.extract_multiplicatively-2250"><a href="#Expr.extract_multiplicatively-2250"><span class="linenos">2250</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="Expr.extract_multiplicatively-2251"><a href="#Expr.extract_multiplicatively-2251"><span class="linenos">2251</span></a>                    <span class="k">return</span> <span class="n">quotient</span>
</span><span id="Expr.extract_multiplicatively-2252"><a href="#Expr.extract_multiplicatively-2252"><span class="linenos">2252</span></a>            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_Rational</span><span class="p">:</span>
</span><span id="Expr.extract_multiplicatively-2253"><a href="#Expr.extract_multiplicatively-2253"><span class="linenos">2253</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">quotient</span><span class="o">.</span><span class="n">is_Rational</span><span class="p">:</span>
</span><span id="Expr.extract_multiplicatively-2254"><a href="#Expr.extract_multiplicatively-2254"><span class="linenos">2254</span></a>                    <span class="k">return</span> <span class="kc">None</span>
</span><span id="Expr.extract_multiplicatively-2255"><a href="#Expr.extract_multiplicatively-2255"><span class="linenos">2255</span></a>                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_positive</span> <span class="ow">and</span> <span class="n">quotient</span><span class="o">.</span><span class="n">is_negative</span><span class="p">:</span>
</span><span id="Expr.extract_multiplicatively-2256"><a href="#Expr.extract_multiplicatively-2256"><span class="linenos">2256</span></a>                    <span class="k">return</span> <span class="kc">None</span>
</span><span id="Expr.extract_multiplicatively-2257"><a href="#Expr.extract_multiplicatively-2257"><span class="linenos">2257</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="Expr.extract_multiplicatively-2258"><a href="#Expr.extract_multiplicatively-2258"><span class="linenos">2258</span></a>                    <span class="k">return</span> <span class="n">quotient</span>
</span><span id="Expr.extract_multiplicatively-2259"><a href="#Expr.extract_multiplicatively-2259"><span class="linenos">2259</span></a>            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_Float</span><span class="p">:</span>
</span><span id="Expr.extract_multiplicatively-2260"><a href="#Expr.extract_multiplicatively-2260"><span class="linenos">2260</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">quotient</span><span class="o">.</span><span class="n">is_Float</span><span class="p">:</span>
</span><span id="Expr.extract_multiplicatively-2261"><a href="#Expr.extract_multiplicatively-2261"><span class="linenos">2261</span></a>                    <span class="k">return</span> <span class="kc">None</span>
</span><span id="Expr.extract_multiplicatively-2262"><a href="#Expr.extract_multiplicatively-2262"><span class="linenos">2262</span></a>                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_positive</span> <span class="ow">and</span> <span class="n">quotient</span><span class="o">.</span><span class="n">is_negative</span><span class="p">:</span>
</span><span id="Expr.extract_multiplicatively-2263"><a href="#Expr.extract_multiplicatively-2263"><span class="linenos">2263</span></a>                    <span class="k">return</span> <span class="kc">None</span>
</span><span id="Expr.extract_multiplicatively-2264"><a href="#Expr.extract_multiplicatively-2264"><span class="linenos">2264</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="Expr.extract_multiplicatively-2265"><a href="#Expr.extract_multiplicatively-2265"><span class="linenos">2265</span></a>                    <span class="k">return</span> <span class="n">quotient</span>
</span><span id="Expr.extract_multiplicatively-2266"><a href="#Expr.extract_multiplicatively-2266"><span class="linenos">2266</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_NumberSymbol</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_Symbol</span> <span class="ow">or</span> <span class="bp">self</span> <span class="ow">is</span> <span class="n">S</span><span class="o">.</span><span class="n">ImaginaryUnit</span><span class="p">:</span>
</span><span id="Expr.extract_multiplicatively-2267"><a href="#Expr.extract_multiplicatively-2267"><span class="linenos">2267</span></a>            <span class="k">if</span> <span class="n">quotient</span><span class="o">.</span><span class="n">is_Mul</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">quotient</span><span class="o">.</span><span class="n">args</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="Expr.extract_multiplicatively-2268"><a href="#Expr.extract_multiplicatively-2268"><span class="linenos">2268</span></a>                <span class="k">if</span> <span class="n">quotient</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">is_Integer</span> <span class="ow">and</span> <span class="n">quotient</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">is_positive</span> <span class="ow">and</span> <span class="n">quotient</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="bp">self</span><span class="p">:</span>
</span><span id="Expr.extract_multiplicatively-2269"><a href="#Expr.extract_multiplicatively-2269"><span class="linenos">2269</span></a>                    <span class="k">return</span> <span class="n">quotient</span>
</span><span id="Expr.extract_multiplicatively-2270"><a href="#Expr.extract_multiplicatively-2270"><span class="linenos">2270</span></a>            <span class="k">elif</span> <span class="n">quotient</span><span class="o">.</span><span class="n">is_Integer</span> <span class="ow">and</span> <span class="n">c</span><span class="o">.</span><span class="n">is_Number</span><span class="p">:</span>
</span><span id="Expr.extract_multiplicatively-2271"><a href="#Expr.extract_multiplicatively-2271"><span class="linenos">2271</span></a>                <span class="k">return</span> <span class="n">quotient</span>
</span><span id="Expr.extract_multiplicatively-2272"><a href="#Expr.extract_multiplicatively-2272"><span class="linenos">2272</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_Add</span><span class="p">:</span>
</span><span id="Expr.extract_multiplicatively-2273"><a href="#Expr.extract_multiplicatively-2273"><span class="linenos">2273</span></a>            <span class="n">cs</span><span class="p">,</span> <span class="n">ps</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">primitive</span><span class="p">()</span>
</span><span id="Expr.extract_multiplicatively-2274"><a href="#Expr.extract_multiplicatively-2274"><span class="linenos">2274</span></a>            <span class="c1"># assert cs &gt;= 1</span>
</span><span id="Expr.extract_multiplicatively-2275"><a href="#Expr.extract_multiplicatively-2275"><span class="linenos">2275</span></a>            <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">is_Number</span> <span class="ow">and</span> <span class="n">c</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">S</span><span class="o">.</span><span class="n">NegativeOne</span><span class="p">:</span>
</span><span id="Expr.extract_multiplicatively-2276"><a href="#Expr.extract_multiplicatively-2276"><span class="linenos">2276</span></a>                <span class="c1"># assert c != 1 (handled at top)</span>
</span><span id="Expr.extract_multiplicatively-2277"><a href="#Expr.extract_multiplicatively-2277"><span class="linenos">2277</span></a>                <span class="k">if</span> <span class="n">cs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">S</span><span class="o">.</span><span class="n">One</span><span class="p">:</span>
</span><span id="Expr.extract_multiplicatively-2278"><a href="#Expr.extract_multiplicatively-2278"><span class="linenos">2278</span></a>                    <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">is_negative</span><span class="p">:</span>
</span><span id="Expr.extract_multiplicatively-2279"><a href="#Expr.extract_multiplicatively-2279"><span class="linenos">2279</span></a>                        <span class="n">xc</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">cs</span><span class="o">.</span><span class="n">extract_multiplicatively</span><span class="p">(</span><span class="o">-</span><span class="n">c</span><span class="p">))</span>
</span><span id="Expr.extract_multiplicatively-2280"><a href="#Expr.extract_multiplicatively-2280"><span class="linenos">2280</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="Expr.extract_multiplicatively-2281"><a href="#Expr.extract_multiplicatively-2281"><span class="linenos">2281</span></a>                        <span class="n">xc</span> <span class="o">=</span> <span class="n">cs</span><span class="o">.</span><span class="n">extract_multiplicatively</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
</span><span id="Expr.extract_multiplicatively-2282"><a href="#Expr.extract_multiplicatively-2282"><span class="linenos">2282</span></a>                    <span class="k">if</span> <span class="n">xc</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Expr.extract_multiplicatively-2283"><a href="#Expr.extract_multiplicatively-2283"><span class="linenos">2283</span></a>                        <span class="k">return</span> <span class="n">xc</span><span class="o">*</span><span class="n">ps</span>  <span class="c1"># rely on 2-arg Mul to restore Add</span>
</span><span id="Expr.extract_multiplicatively-2284"><a href="#Expr.extract_multiplicatively-2284"><span class="linenos">2284</span></a>                <span class="k">return</span>  <span class="c1"># |c| != 1 can only be extracted from cs</span>
</span><span id="Expr.extract_multiplicatively-2285"><a href="#Expr.extract_multiplicatively-2285"><span class="linenos">2285</span></a>            <span class="k">if</span> <span class="n">c</span> <span class="o">==</span> <span class="n">ps</span><span class="p">:</span>
</span><span id="Expr.extract_multiplicatively-2286"><a href="#Expr.extract_multiplicatively-2286"><span class="linenos">2286</span></a>                <span class="k">return</span> <span class="n">cs</span>
</span><span id="Expr.extract_multiplicatively-2287"><a href="#Expr.extract_multiplicatively-2287"><span class="linenos">2287</span></a>            <span class="c1"># check args of ps</span>
</span><span id="Expr.extract_multiplicatively-2288"><a href="#Expr.extract_multiplicatively-2288"><span class="linenos">2288</span></a>            <span class="n">newargs</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Expr.extract_multiplicatively-2289"><a href="#Expr.extract_multiplicatively-2289"><span class="linenos">2289</span></a>            <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">ps</span><span class="o">.</span><span class="n">args</span><span class="p">:</span>
</span><span id="Expr.extract_multiplicatively-2290"><a href="#Expr.extract_multiplicatively-2290"><span class="linenos">2290</span></a>                <span class="n">newarg</span> <span class="o">=</span> <span class="n">arg</span><span class="o">.</span><span class="n">extract_multiplicatively</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
</span><span id="Expr.extract_multiplicatively-2291"><a href="#Expr.extract_multiplicatively-2291"><span class="linenos">2291</span></a>                <span class="k">if</span> <span class="n">newarg</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Expr.extract_multiplicatively-2292"><a href="#Expr.extract_multiplicatively-2292"><span class="linenos">2292</span></a>                    <span class="k">return</span>  <span class="c1"># all or nothing</span>
</span><span id="Expr.extract_multiplicatively-2293"><a href="#Expr.extract_multiplicatively-2293"><span class="linenos">2293</span></a>                <span class="n">newargs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">newarg</span><span class="p">)</span>
</span><span id="Expr.extract_multiplicatively-2294"><a href="#Expr.extract_multiplicatively-2294"><span class="linenos">2294</span></a>            <span class="k">if</span> <span class="n">cs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">S</span><span class="o">.</span><span class="n">One</span><span class="p">:</span>
</span><span id="Expr.extract_multiplicatively-2295"><a href="#Expr.extract_multiplicatively-2295"><span class="linenos">2295</span></a>                <span class="n">args</span> <span class="o">=</span> <span class="p">[</span><span class="n">cs</span><span class="o">*</span><span class="n">t</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">newargs</span><span class="p">]</span>
</span><span id="Expr.extract_multiplicatively-2296"><a href="#Expr.extract_multiplicatively-2296"><span class="linenos">2296</span></a>                <span class="c1"># args may be in different order</span>
</span><span id="Expr.extract_multiplicatively-2297"><a href="#Expr.extract_multiplicatively-2297"><span class="linenos">2297</span></a>                <span class="k">return</span> <span class="n">_unevaluated_Add</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
</span><span id="Expr.extract_multiplicatively-2298"><a href="#Expr.extract_multiplicatively-2298"><span class="linenos">2298</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Expr.extract_multiplicatively-2299"><a href="#Expr.extract_multiplicatively-2299"><span class="linenos">2299</span></a>                <span class="k">return</span> <span class="n">Add</span><span class="o">.</span><span class="n">_from_args</span><span class="p">(</span><span class="n">newargs</span><span class="p">)</span>
</span><span id="Expr.extract_multiplicatively-2300"><a href="#Expr.extract_multiplicatively-2300"><span class="linenos">2300</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_Mul</span><span class="p">:</span>
</span><span id="Expr.extract_multiplicatively-2301"><a href="#Expr.extract_multiplicatively-2301"><span class="linenos">2301</span></a>            <span class="n">args</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">)</span>
</span><span id="Expr.extract_multiplicatively-2302"><a href="#Expr.extract_multiplicatively-2302"><span class="linenos">2302</span></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">arg</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">args</span><span class="p">):</span>
</span><span id="Expr.extract_multiplicatively-2303"><a href="#Expr.extract_multiplicatively-2303"><span class="linenos">2303</span></a>                <span class="n">newarg</span> <span class="o">=</span> <span class="n">arg</span><span class="o">.</span><span class="n">extract_multiplicatively</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
</span><span id="Expr.extract_multiplicatively-2304"><a href="#Expr.extract_multiplicatively-2304"><span class="linenos">2304</span></a>                <span class="k">if</span> <span class="n">newarg</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Expr.extract_multiplicatively-2305"><a href="#Expr.extract_multiplicatively-2305"><span class="linenos">2305</span></a>                    <span class="n">args</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">newarg</span>
</span><span id="Expr.extract_multiplicatively-2306"><a href="#Expr.extract_multiplicatively-2306"><span class="linenos">2306</span></a>                    <span class="k">return</span> <span class="n">Mul</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
</span><span id="Expr.extract_multiplicatively-2307"><a href="#Expr.extract_multiplicatively-2307"><span class="linenos">2307</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_Pow</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exp</span><span class="p">):</span>
</span><span id="Expr.extract_multiplicatively-2308"><a href="#Expr.extract_multiplicatively-2308"><span class="linenos">2308</span></a>            <span class="n">sb</span><span class="p">,</span> <span class="n">se</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">as_base_exp</span><span class="p">()</span>
</span><span id="Expr.extract_multiplicatively-2309"><a href="#Expr.extract_multiplicatively-2309"><span class="linenos">2309</span></a>            <span class="n">cb</span><span class="p">,</span> <span class="n">ce</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">as_base_exp</span><span class="p">()</span>
</span><span id="Expr.extract_multiplicatively-2310"><a href="#Expr.extract_multiplicatively-2310"><span class="linenos">2310</span></a>            <span class="k">if</span> <span class="n">cb</span> <span class="o">==</span> <span class="n">sb</span><span class="p">:</span>
</span><span id="Expr.extract_multiplicatively-2311"><a href="#Expr.extract_multiplicatively-2311"><span class="linenos">2311</span></a>                <span class="n">new_exp</span> <span class="o">=</span> <span class="n">se</span><span class="o">.</span><span class="n">extract_additively</span><span class="p">(</span><span class="n">ce</span><span class="p">)</span>
</span><span id="Expr.extract_multiplicatively-2312"><a href="#Expr.extract_multiplicatively-2312"><span class="linenos">2312</span></a>                <span class="k">if</span> <span class="n">new_exp</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Expr.extract_multiplicatively-2313"><a href="#Expr.extract_multiplicatively-2313"><span class="linenos">2313</span></a>                    <span class="k">return</span> <span class="n">Pow</span><span class="p">(</span><span class="n">sb</span><span class="p">,</span> <span class="n">new_exp</span><span class="p">)</span>
</span><span id="Expr.extract_multiplicatively-2314"><a href="#Expr.extract_multiplicatively-2314"><span class="linenos">2314</span></a>            <span class="k">elif</span> <span class="n">c</span> <span class="o">==</span> <span class="n">sb</span><span class="p">:</span>
</span><span id="Expr.extract_multiplicatively-2315"><a href="#Expr.extract_multiplicatively-2315"><span class="linenos">2315</span></a>                <span class="n">new_exp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">exp</span><span class="o">.</span><span class="n">extract_additively</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span id="Expr.extract_multiplicatively-2316"><a href="#Expr.extract_multiplicatively-2316"><span class="linenos">2316</span></a>                <span class="k">if</span> <span class="n">new_exp</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Expr.extract_multiplicatively-2317"><a href="#Expr.extract_multiplicatively-2317"><span class="linenos">2317</span></a>                    <span class="k">return</span> <span class="n">Pow</span><span class="p">(</span><span class="n">sb</span><span class="p">,</span> <span class="n">new_exp</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Return None if it's not possible to make self in the form
c * something in a nice way, i.e. preserving the properties
of arguments of self.</p>

<h1 id="examples">Examples</h1>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">symbols</span><span class="p">,</span> <span class="n">Rational</span>
</code></pre>
</div>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x,y&#39;</span><span class="p">,</span> <span class="n">real</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre>
</div>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="p">((</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">extract_multiplicatively</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">y</span><span class="p">)</span>
<span class="go">x*y**2</span>
</code></pre>
</div>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="p">((</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">extract_multiplicatively</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">4</span> <span class="o">*</span> <span class="n">y</span><span class="p">)</span>
</code></pre>
</div>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">extract_multiplicatively</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">x</span>
</code></pre>
</div>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">extract_multiplicatively</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</code></pre>
</div>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">Rational</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">extract_multiplicatively</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">x/6</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="Expr.extract_additively" class="classattr">
                                        <input id="Expr.extract_additively-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">extract_additively</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">c</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Expr.extract_additively-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Expr.extract_additively"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Expr.extract_additively-2319"><a href="#Expr.extract_additively-2319"><span class="linenos">2319</span></a>    <span class="k">def</span> <span class="nf">extract_additively</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
</span><span id="Expr.extract_additively-2320"><a href="#Expr.extract_additively-2320"><span class="linenos">2320</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return self - c if it&#39;s possible to subtract c from self and</span>
</span><span id="Expr.extract_additively-2321"><a href="#Expr.extract_additively-2321"><span class="linenos">2321</span></a><span class="sd">        make all matching coefficients move towards zero, else return None.</span>
</span><span id="Expr.extract_additively-2322"><a href="#Expr.extract_additively-2322"><span class="linenos">2322</span></a>
</span><span id="Expr.extract_additively-2323"><a href="#Expr.extract_additively-2323"><span class="linenos">2323</span></a><span class="sd">        Examples</span>
</span><span id="Expr.extract_additively-2324"><a href="#Expr.extract_additively-2324"><span class="linenos">2324</span></a><span class="sd">        ========</span>
</span><span id="Expr.extract_additively-2325"><a href="#Expr.extract_additively-2325"><span class="linenos">2325</span></a>
</span><span id="Expr.extract_additively-2326"><a href="#Expr.extract_additively-2326"><span class="linenos">2326</span></a><span class="sd">        &gt;&gt;&gt; from sympy.abc import x, y</span>
</span><span id="Expr.extract_additively-2327"><a href="#Expr.extract_additively-2327"><span class="linenos">2327</span></a><span class="sd">        &gt;&gt;&gt; e = 2*x + 3</span>
</span><span id="Expr.extract_additively-2328"><a href="#Expr.extract_additively-2328"><span class="linenos">2328</span></a><span class="sd">        &gt;&gt;&gt; e.extract_additively(x + 1)</span>
</span><span id="Expr.extract_additively-2329"><a href="#Expr.extract_additively-2329"><span class="linenos">2329</span></a><span class="sd">        x + 2</span>
</span><span id="Expr.extract_additively-2330"><a href="#Expr.extract_additively-2330"><span class="linenos">2330</span></a><span class="sd">        &gt;&gt;&gt; e.extract_additively(3*x)</span>
</span><span id="Expr.extract_additively-2331"><a href="#Expr.extract_additively-2331"><span class="linenos">2331</span></a><span class="sd">        &gt;&gt;&gt; e.extract_additively(4)</span>
</span><span id="Expr.extract_additively-2332"><a href="#Expr.extract_additively-2332"><span class="linenos">2332</span></a><span class="sd">        &gt;&gt;&gt; (y*(x + 1)).extract_additively(x + 1)</span>
</span><span id="Expr.extract_additively-2333"><a href="#Expr.extract_additively-2333"><span class="linenos">2333</span></a><span class="sd">        &gt;&gt;&gt; ((x + 1)*(x + 2*y + 1) + 3).extract_additively(x + 1)</span>
</span><span id="Expr.extract_additively-2334"><a href="#Expr.extract_additively-2334"><span class="linenos">2334</span></a><span class="sd">        (x + 1)*(x + 2*y) + 3</span>
</span><span id="Expr.extract_additively-2335"><a href="#Expr.extract_additively-2335"><span class="linenos">2335</span></a>
</span><span id="Expr.extract_additively-2336"><a href="#Expr.extract_additively-2336"><span class="linenos">2336</span></a><span class="sd">        See Also</span>
</span><span id="Expr.extract_additively-2337"><a href="#Expr.extract_additively-2337"><span class="linenos">2337</span></a><span class="sd">        ========</span>
</span><span id="Expr.extract_additively-2338"><a href="#Expr.extract_additively-2338"><span class="linenos">2338</span></a><span class="sd">        extract_multiplicatively</span>
</span><span id="Expr.extract_additively-2339"><a href="#Expr.extract_additively-2339"><span class="linenos">2339</span></a><span class="sd">        coeff</span>
</span><span id="Expr.extract_additively-2340"><a href="#Expr.extract_additively-2340"><span class="linenos">2340</span></a><span class="sd">        as_coefficient</span>
</span><span id="Expr.extract_additively-2341"><a href="#Expr.extract_additively-2341"><span class="linenos">2341</span></a>
</span><span id="Expr.extract_additively-2342"><a href="#Expr.extract_additively-2342"><span class="linenos">2342</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Expr.extract_additively-2343"><a href="#Expr.extract_additively-2343"><span class="linenos">2343</span></a>
</span><span id="Expr.extract_additively-2344"><a href="#Expr.extract_additively-2344"><span class="linenos">2344</span></a>        <span class="n">c</span> <span class="o">=</span> <span class="n">sympify</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
</span><span id="Expr.extract_additively-2345"><a href="#Expr.extract_additively-2345"><span class="linenos">2345</span></a>        <span class="k">if</span> <span class="bp">self</span> <span class="ow">is</span> <span class="n">S</span><span class="o">.</span><span class="n">NaN</span><span class="p">:</span>
</span><span id="Expr.extract_additively-2346"><a href="#Expr.extract_additively-2346"><span class="linenos">2346</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="Expr.extract_additively-2347"><a href="#Expr.extract_additively-2347"><span class="linenos">2347</span></a>        <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">is_zero</span><span class="p">:</span>
</span><span id="Expr.extract_additively-2348"><a href="#Expr.extract_additively-2348"><span class="linenos">2348</span></a>            <span class="k">return</span> <span class="bp">self</span>
</span><span id="Expr.extract_additively-2349"><a href="#Expr.extract_additively-2349"><span class="linenos">2349</span></a>        <span class="k">elif</span> <span class="n">c</span> <span class="o">==</span> <span class="bp">self</span><span class="p">:</span>
</span><span id="Expr.extract_additively-2350"><a href="#Expr.extract_additively-2350"><span class="linenos">2350</span></a>            <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">Zero</span>
</span><span id="Expr.extract_additively-2351"><a href="#Expr.extract_additively-2351"><span class="linenos">2351</span></a>        <span class="k">elif</span> <span class="bp">self</span> <span class="o">==</span> <span class="n">S</span><span class="o">.</span><span class="n">Zero</span><span class="p">:</span>
</span><span id="Expr.extract_additively-2352"><a href="#Expr.extract_additively-2352"><span class="linenos">2352</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="Expr.extract_additively-2353"><a href="#Expr.extract_additively-2353"><span class="linenos">2353</span></a>
</span><span id="Expr.extract_additively-2354"><a href="#Expr.extract_additively-2354"><span class="linenos">2354</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_Number</span><span class="p">:</span>
</span><span id="Expr.extract_additively-2355"><a href="#Expr.extract_additively-2355"><span class="linenos">2355</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">c</span><span class="o">.</span><span class="n">is_Number</span><span class="p">:</span>
</span><span id="Expr.extract_additively-2356"><a href="#Expr.extract_additively-2356"><span class="linenos">2356</span></a>                <span class="k">return</span> <span class="kc">None</span>
</span><span id="Expr.extract_additively-2357"><a href="#Expr.extract_additively-2357"><span class="linenos">2357</span></a>            <span class="n">co</span> <span class="o">=</span> <span class="bp">self</span>
</span><span id="Expr.extract_additively-2358"><a href="#Expr.extract_additively-2358"><span class="linenos">2358</span></a>            <span class="n">diff</span> <span class="o">=</span> <span class="n">co</span> <span class="o">-</span> <span class="n">c</span>
</span><span id="Expr.extract_additively-2359"><a href="#Expr.extract_additively-2359"><span class="linenos">2359</span></a>            <span class="c1"># XXX should we match types? i.e should 3 - .1 succeed?</span>
</span><span id="Expr.extract_additively-2360"><a href="#Expr.extract_additively-2360"><span class="linenos">2360</span></a>            <span class="k">if</span> <span class="p">(</span><span class="n">co</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">diff</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">diff</span> <span class="o">&lt;</span> <span class="n">co</span> <span class="ow">or</span>
</span><span id="Expr.extract_additively-2361"><a href="#Expr.extract_additively-2361"><span class="linenos">2361</span></a>                    <span class="n">co</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">diff</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">diff</span> <span class="o">&gt;</span> <span class="n">co</span><span class="p">):</span>
</span><span id="Expr.extract_additively-2362"><a href="#Expr.extract_additively-2362"><span class="linenos">2362</span></a>                <span class="k">return</span> <span class="n">diff</span>
</span><span id="Expr.extract_additively-2363"><a href="#Expr.extract_additively-2363"><span class="linenos">2363</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="Expr.extract_additively-2364"><a href="#Expr.extract_additively-2364"><span class="linenos">2364</span></a>
</span><span id="Expr.extract_additively-2365"><a href="#Expr.extract_additively-2365"><span class="linenos">2365</span></a>        <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">is_Number</span><span class="p">:</span>
</span><span id="Expr.extract_additively-2366"><a href="#Expr.extract_additively-2366"><span class="linenos">2366</span></a>            <span class="n">co</span><span class="p">,</span> <span class="n">t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">as_coeff_Add</span><span class="p">()</span>
</span><span id="Expr.extract_additively-2367"><a href="#Expr.extract_additively-2367"><span class="linenos">2367</span></a>            <span class="n">xa</span> <span class="o">=</span> <span class="n">co</span><span class="o">.</span><span class="n">extract_additively</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
</span><span id="Expr.extract_additively-2368"><a href="#Expr.extract_additively-2368"><span class="linenos">2368</span></a>            <span class="k">if</span> <span class="n">xa</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Expr.extract_additively-2369"><a href="#Expr.extract_additively-2369"><span class="linenos">2369</span></a>                <span class="k">return</span> <span class="kc">None</span>
</span><span id="Expr.extract_additively-2370"><a href="#Expr.extract_additively-2370"><span class="linenos">2370</span></a>            <span class="k">return</span> <span class="n">xa</span> <span class="o">+</span> <span class="n">t</span>
</span><span id="Expr.extract_additively-2371"><a href="#Expr.extract_additively-2371"><span class="linenos">2371</span></a>
</span><span id="Expr.extract_additively-2372"><a href="#Expr.extract_additively-2372"><span class="linenos">2372</span></a>        <span class="c1"># handle the args[0].is_Number case separately</span>
</span><span id="Expr.extract_additively-2373"><a href="#Expr.extract_additively-2373"><span class="linenos">2373</span></a>        <span class="c1"># since we will have trouble looking for the coeff of</span>
</span><span id="Expr.extract_additively-2374"><a href="#Expr.extract_additively-2374"><span class="linenos">2374</span></a>        <span class="c1"># a number.</span>
</span><span id="Expr.extract_additively-2375"><a href="#Expr.extract_additively-2375"><span class="linenos">2375</span></a>        <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">is_Add</span> <span class="ow">and</span> <span class="n">c</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">is_Number</span><span class="p">:</span>
</span><span id="Expr.extract_additively-2376"><a href="#Expr.extract_additively-2376"><span class="linenos">2376</span></a>            <span class="c1"># whole term as a term factor</span>
</span><span id="Expr.extract_additively-2377"><a href="#Expr.extract_additively-2377"><span class="linenos">2377</span></a>            <span class="n">co</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coeff</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
</span><span id="Expr.extract_additively-2378"><a href="#Expr.extract_additively-2378"><span class="linenos">2378</span></a>            <span class="n">xa0</span> <span class="o">=</span> <span class="p">(</span><span class="n">co</span><span class="o">.</span><span class="n">extract_additively</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="ow">or</span> <span class="mi">0</span><span class="p">)</span><span class="o">*</span><span class="n">c</span>
</span><span id="Expr.extract_additively-2379"><a href="#Expr.extract_additively-2379"><span class="linenos">2379</span></a>            <span class="k">if</span> <span class="n">xa0</span><span class="p">:</span>
</span><span id="Expr.extract_additively-2380"><a href="#Expr.extract_additively-2380"><span class="linenos">2380</span></a>                <span class="n">diff</span> <span class="o">=</span> <span class="bp">self</span> <span class="o">-</span> <span class="n">co</span><span class="o">*</span><span class="n">c</span>
</span><span id="Expr.extract_additively-2381"><a href="#Expr.extract_additively-2381"><span class="linenos">2381</span></a>                <span class="k">return</span> <span class="p">(</span><span class="n">xa0</span> <span class="o">+</span> <span class="p">(</span><span class="n">diff</span><span class="o">.</span><span class="n">extract_additively</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="ow">or</span> <span class="n">diff</span><span class="p">))</span> <span class="ow">or</span> <span class="kc">None</span>
</span><span id="Expr.extract_additively-2382"><a href="#Expr.extract_additively-2382"><span class="linenos">2382</span></a>            <span class="c1"># term-wise</span>
</span><span id="Expr.extract_additively-2383"><a href="#Expr.extract_additively-2383"><span class="linenos">2383</span></a>            <span class="n">h</span><span class="p">,</span> <span class="n">t</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">as_coeff_Add</span><span class="p">()</span>
</span><span id="Expr.extract_additively-2384"><a href="#Expr.extract_additively-2384"><span class="linenos">2384</span></a>            <span class="n">sh</span><span class="p">,</span> <span class="n">st</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">as_coeff_Add</span><span class="p">()</span>
</span><span id="Expr.extract_additively-2385"><a href="#Expr.extract_additively-2385"><span class="linenos">2385</span></a>            <span class="n">xa</span> <span class="o">=</span> <span class="n">sh</span><span class="o">.</span><span class="n">extract_additively</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
</span><span id="Expr.extract_additively-2386"><a href="#Expr.extract_additively-2386"><span class="linenos">2386</span></a>            <span class="k">if</span> <span class="n">xa</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Expr.extract_additively-2387"><a href="#Expr.extract_additively-2387"><span class="linenos">2387</span></a>                <span class="k">return</span> <span class="kc">None</span>
</span><span id="Expr.extract_additively-2388"><a href="#Expr.extract_additively-2388"><span class="linenos">2388</span></a>            <span class="n">xa2</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">extract_additively</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
</span><span id="Expr.extract_additively-2389"><a href="#Expr.extract_additively-2389"><span class="linenos">2389</span></a>            <span class="k">if</span> <span class="n">xa2</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Expr.extract_additively-2390"><a href="#Expr.extract_additively-2390"><span class="linenos">2390</span></a>                <span class="k">return</span> <span class="kc">None</span>
</span><span id="Expr.extract_additively-2391"><a href="#Expr.extract_additively-2391"><span class="linenos">2391</span></a>            <span class="k">return</span> <span class="n">xa</span> <span class="o">+</span> <span class="n">xa2</span>
</span><span id="Expr.extract_additively-2392"><a href="#Expr.extract_additively-2392"><span class="linenos">2392</span></a>
</span><span id="Expr.extract_additively-2393"><a href="#Expr.extract_additively-2393"><span class="linenos">2393</span></a>        <span class="c1"># whole term as a term factor</span>
</span><span id="Expr.extract_additively-2394"><a href="#Expr.extract_additively-2394"><span class="linenos">2394</span></a>        <span class="n">co</span><span class="p">,</span> <span class="n">diff</span> <span class="o">=</span> <span class="n">_corem</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
</span><span id="Expr.extract_additively-2395"><a href="#Expr.extract_additively-2395"><span class="linenos">2395</span></a>        <span class="n">xa0</span> <span class="o">=</span> <span class="p">(</span><span class="n">co</span><span class="o">.</span><span class="n">extract_additively</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="ow">or</span> <span class="mi">0</span><span class="p">)</span><span class="o">*</span><span class="n">c</span>
</span><span id="Expr.extract_additively-2396"><a href="#Expr.extract_additively-2396"><span class="linenos">2396</span></a>        <span class="k">if</span> <span class="n">xa0</span><span class="p">:</span>
</span><span id="Expr.extract_additively-2397"><a href="#Expr.extract_additively-2397"><span class="linenos">2397</span></a>            <span class="k">return</span> <span class="p">(</span><span class="n">xa0</span> <span class="o">+</span> <span class="p">(</span><span class="n">diff</span><span class="o">.</span><span class="n">extract_additively</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="ow">or</span> <span class="n">diff</span><span class="p">))</span> <span class="ow">or</span> <span class="kc">None</span>
</span><span id="Expr.extract_additively-2398"><a href="#Expr.extract_additively-2398"><span class="linenos">2398</span></a>        <span class="c1"># term-wise</span>
</span><span id="Expr.extract_additively-2399"><a href="#Expr.extract_additively-2399"><span class="linenos">2399</span></a>        <span class="n">coeffs</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Expr.extract_additively-2400"><a href="#Expr.extract_additively-2400"><span class="linenos">2400</span></a>        <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">Add</span><span class="o">.</span><span class="n">make_args</span><span class="p">(</span><span class="n">c</span><span class="p">):</span>
</span><span id="Expr.extract_additively-2401"><a href="#Expr.extract_additively-2401"><span class="linenos">2401</span></a>            <span class="n">ac</span><span class="p">,</span> <span class="n">at</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">as_coeff_Mul</span><span class="p">()</span>
</span><span id="Expr.extract_additively-2402"><a href="#Expr.extract_additively-2402"><span class="linenos">2402</span></a>            <span class="n">co</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coeff</span><span class="p">(</span><span class="n">at</span><span class="p">)</span>
</span><span id="Expr.extract_additively-2403"><a href="#Expr.extract_additively-2403"><span class="linenos">2403</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">co</span><span class="p">:</span>
</span><span id="Expr.extract_additively-2404"><a href="#Expr.extract_additively-2404"><span class="linenos">2404</span></a>                <span class="k">return</span> <span class="kc">None</span>
</span><span id="Expr.extract_additively-2405"><a href="#Expr.extract_additively-2405"><span class="linenos">2405</span></a>            <span class="n">coc</span><span class="p">,</span> <span class="n">cot</span> <span class="o">=</span> <span class="n">co</span><span class="o">.</span><span class="n">as_coeff_Add</span><span class="p">()</span>
</span><span id="Expr.extract_additively-2406"><a href="#Expr.extract_additively-2406"><span class="linenos">2406</span></a>            <span class="n">xa</span> <span class="o">=</span> <span class="n">coc</span><span class="o">.</span><span class="n">extract_additively</span><span class="p">(</span><span class="n">ac</span><span class="p">)</span>
</span><span id="Expr.extract_additively-2407"><a href="#Expr.extract_additively-2407"><span class="linenos">2407</span></a>            <span class="k">if</span> <span class="n">xa</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Expr.extract_additively-2408"><a href="#Expr.extract_additively-2408"><span class="linenos">2408</span></a>                <span class="k">return</span> <span class="kc">None</span>
</span><span id="Expr.extract_additively-2409"><a href="#Expr.extract_additively-2409"><span class="linenos">2409</span></a>            <span class="bp">self</span> <span class="o">-=</span> <span class="n">co</span><span class="o">*</span><span class="n">at</span>
</span><span id="Expr.extract_additively-2410"><a href="#Expr.extract_additively-2410"><span class="linenos">2410</span></a>            <span class="n">coeffs</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">cot</span> <span class="o">+</span> <span class="n">xa</span><span class="p">)</span><span class="o">*</span><span class="n">at</span><span class="p">)</span>
</span><span id="Expr.extract_additively-2411"><a href="#Expr.extract_additively-2411"><span class="linenos">2411</span></a>        <span class="n">coeffs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="Expr.extract_additively-2412"><a href="#Expr.extract_additively-2412"><span class="linenos">2412</span></a>        <span class="k">return</span> <span class="n">Add</span><span class="p">(</span><span class="o">*</span><span class="n">coeffs</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Return self - c if it's possible to subtract c from self and
make all matching coefficients move towards zero, else return None.</p>

<h1 id="examples">Examples</h1>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.abc</span> <span class="kn">import</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e</span><span class="o">.</span><span class="n">extract_additively</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">x + 2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e</span><span class="o">.</span><span class="n">extract_additively</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e</span><span class="o">.</span><span class="n">extract_additively</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">y</span><span class="o">*</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">extract_additively</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">((</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">y</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">extract_additively</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">(x + 1)*(x + 2*y) + 3</span>
</code></pre>
</div>

<h1 id="see-also">See Also</h1>

<p>extract_multiplicatively
coeff
as_coefficient</p>
</div>


                            </div>
                            <div id="Expr.expr_free_symbols" class="classattr">
                                <div class="attr variable">
            <span class="name">expr_free_symbols</span>

        
    </div>
    <a class="headerlink" href="#Expr.expr_free_symbols"></a>
    
            <div class="docstring"><p>Like <code><a href="#Expr.free_symbols">free_symbols</a></code>, but returns the free symbols only if
they are contained in an expression node.</p>

<h1 id="examples">Examples</h1>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.abc</span> <span class="kn">import</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">expr_free_symbols</span> <span class="c1"># doctest: +SKIP</span>
<span class="go">{x, y}</span>
</code></pre>
</div>

<p>If the expression is contained in a non-expression object, do not return
the free symbols. Compare:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">Tuple</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">Tuple</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">expr_free_symbols</span> <span class="c1"># doctest: +SKIP</span>
<span class="go">set()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">free_symbols</span>
<span class="go">{x, y}</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="Expr.could_extract_minus_sign" class="classattr">
                                        <input id="Expr.could_extract_minus_sign-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">could_extract_minus_sign</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Expr.could_extract_minus_sign-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Expr.could_extract_minus_sign"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Expr.could_extract_minus_sign-2445"><a href="#Expr.could_extract_minus_sign-2445"><span class="linenos">2445</span></a>    <span class="k">def</span> <span class="nf">could_extract_minus_sign</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Expr.could_extract_minus_sign-2446"><a href="#Expr.could_extract_minus_sign-2446"><span class="linenos">2446</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return True if self has -1 as a leading factor or has</span>
</span><span id="Expr.could_extract_minus_sign-2447"><a href="#Expr.could_extract_minus_sign-2447"><span class="linenos">2447</span></a><span class="sd">        more literal negative signs than positive signs in a sum,</span>
</span><span id="Expr.could_extract_minus_sign-2448"><a href="#Expr.could_extract_minus_sign-2448"><span class="linenos">2448</span></a><span class="sd">        otherwise False.</span>
</span><span id="Expr.could_extract_minus_sign-2449"><a href="#Expr.could_extract_minus_sign-2449"><span class="linenos">2449</span></a>
</span><span id="Expr.could_extract_minus_sign-2450"><a href="#Expr.could_extract_minus_sign-2450"><span class="linenos">2450</span></a><span class="sd">        Examples</span>
</span><span id="Expr.could_extract_minus_sign-2451"><a href="#Expr.could_extract_minus_sign-2451"><span class="linenos">2451</span></a><span class="sd">        ========</span>
</span><span id="Expr.could_extract_minus_sign-2452"><a href="#Expr.could_extract_minus_sign-2452"><span class="linenos">2452</span></a>
</span><span id="Expr.could_extract_minus_sign-2453"><a href="#Expr.could_extract_minus_sign-2453"><span class="linenos">2453</span></a><span class="sd">        &gt;&gt;&gt; from sympy.abc import x, y</span>
</span><span id="Expr.could_extract_minus_sign-2454"><a href="#Expr.could_extract_minus_sign-2454"><span class="linenos">2454</span></a><span class="sd">        &gt;&gt;&gt; e = x - y</span>
</span><span id="Expr.could_extract_minus_sign-2455"><a href="#Expr.could_extract_minus_sign-2455"><span class="linenos">2455</span></a><span class="sd">        &gt;&gt;&gt; {i.could_extract_minus_sign() for i in (e, -e)}</span>
</span><span id="Expr.could_extract_minus_sign-2456"><a href="#Expr.could_extract_minus_sign-2456"><span class="linenos">2456</span></a><span class="sd">        {False, True}</span>
</span><span id="Expr.could_extract_minus_sign-2457"><a href="#Expr.could_extract_minus_sign-2457"><span class="linenos">2457</span></a>
</span><span id="Expr.could_extract_minus_sign-2458"><a href="#Expr.could_extract_minus_sign-2458"><span class="linenos">2458</span></a><span class="sd">        Though the ``y - x`` is considered like ``-(x - y)``, since it</span>
</span><span id="Expr.could_extract_minus_sign-2459"><a href="#Expr.could_extract_minus_sign-2459"><span class="linenos">2459</span></a><span class="sd">        is in a product without a leading factor of -1, the result is</span>
</span><span id="Expr.could_extract_minus_sign-2460"><a href="#Expr.could_extract_minus_sign-2460"><span class="linenos">2460</span></a><span class="sd">        false below:</span>
</span><span id="Expr.could_extract_minus_sign-2461"><a href="#Expr.could_extract_minus_sign-2461"><span class="linenos">2461</span></a>
</span><span id="Expr.could_extract_minus_sign-2462"><a href="#Expr.could_extract_minus_sign-2462"><span class="linenos">2462</span></a><span class="sd">        &gt;&gt;&gt; (x*(y - x)).could_extract_minus_sign()</span>
</span><span id="Expr.could_extract_minus_sign-2463"><a href="#Expr.could_extract_minus_sign-2463"><span class="linenos">2463</span></a><span class="sd">        False</span>
</span><span id="Expr.could_extract_minus_sign-2464"><a href="#Expr.could_extract_minus_sign-2464"><span class="linenos">2464</span></a>
</span><span id="Expr.could_extract_minus_sign-2465"><a href="#Expr.could_extract_minus_sign-2465"><span class="linenos">2465</span></a><span class="sd">        To put something in canonical form wrt to sign, use `signsimp`:</span>
</span><span id="Expr.could_extract_minus_sign-2466"><a href="#Expr.could_extract_minus_sign-2466"><span class="linenos">2466</span></a>
</span><span id="Expr.could_extract_minus_sign-2467"><a href="#Expr.could_extract_minus_sign-2467"><span class="linenos">2467</span></a><span class="sd">        &gt;&gt;&gt; from sympy import signsimp</span>
</span><span id="Expr.could_extract_minus_sign-2468"><a href="#Expr.could_extract_minus_sign-2468"><span class="linenos">2468</span></a><span class="sd">        &gt;&gt;&gt; signsimp(x*(y - x))</span>
</span><span id="Expr.could_extract_minus_sign-2469"><a href="#Expr.could_extract_minus_sign-2469"><span class="linenos">2469</span></a><span class="sd">        -x*(x - y)</span>
</span><span id="Expr.could_extract_minus_sign-2470"><a href="#Expr.could_extract_minus_sign-2470"><span class="linenos">2470</span></a><span class="sd">        &gt;&gt;&gt; _.could_extract_minus_sign()</span>
</span><span id="Expr.could_extract_minus_sign-2471"><a href="#Expr.could_extract_minus_sign-2471"><span class="linenos">2471</span></a><span class="sd">        True</span>
</span><span id="Expr.could_extract_minus_sign-2472"><a href="#Expr.could_extract_minus_sign-2472"><span class="linenos">2472</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Expr.could_extract_minus_sign-2473"><a href="#Expr.could_extract_minus_sign-2473"><span class="linenos">2473</span></a>        <span class="k">return</span> <span class="kc">False</span>
</span></pre></div>


            <div class="docstring"><p>Return True if self has -1 as a leading factor or has
more literal negative signs than positive signs in a sum,
otherwise False.</p>

<h1 id="examples">Examples</h1>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.abc</span> <span class="kn">import</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-</span> <span class="n">y</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">{</span><span class="n">i</span><span class="o">.</span><span class="n">could_extract_minus_sign</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="o">-</span><span class="n">e</span><span class="p">)}</span>
<span class="go">{False, True}</span>
</code></pre>
</div>

<p>Though the <code>y - x</code> is considered like <code>-(x - y)</code>, since it
is in a product without a leading factor of -1, the result is
false below:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="p">(</span><span class="n">y</span> <span class="o">-</span> <span class="n">x</span><span class="p">))</span><span class="o">.</span><span class="n">could_extract_minus_sign</span><span class="p">()</span>
<span class="go">False</span>
</code></pre>
</div>

<p>To put something in canonical form wrt to sign, use <code>signsimp</code>:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">signsimp</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">signsimp</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="p">(</span><span class="n">y</span> <span class="o">-</span> <span class="n">x</span><span class="p">))</span>
<span class="go">-x*(x - y)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span><span class="o">.</span><span class="n">could_extract_minus_sign</span><span class="p">()</span>
<span class="go">True</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="Expr.extract_branch_factor" class="classattr">
                                        <input id="Expr.extract_branch_factor-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">extract_branch_factor</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">allow_half</span><span class="o">=</span><span class="kc">False</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Expr.extract_branch_factor-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Expr.extract_branch_factor"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Expr.extract_branch_factor-2475"><a href="#Expr.extract_branch_factor-2475"><span class="linenos">2475</span></a>    <span class="k">def</span> <span class="nf">extract_branch_factor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">allow_half</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="Expr.extract_branch_factor-2476"><a href="#Expr.extract_branch_factor-2476"><span class="linenos">2476</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Expr.extract_branch_factor-2477"><a href="#Expr.extract_branch_factor-2477"><span class="linenos">2477</span></a><span class="sd">        Try to write self as ``exp_polar(2*pi*I*n)*z`` in a nice way.</span>
</span><span id="Expr.extract_branch_factor-2478"><a href="#Expr.extract_branch_factor-2478"><span class="linenos">2478</span></a><span class="sd">        Return (z, n).</span>
</span><span id="Expr.extract_branch_factor-2479"><a href="#Expr.extract_branch_factor-2479"><span class="linenos">2479</span></a>
</span><span id="Expr.extract_branch_factor-2480"><a href="#Expr.extract_branch_factor-2480"><span class="linenos">2480</span></a><span class="sd">        &gt;&gt;&gt; from sympy import exp_polar, I, pi</span>
</span><span id="Expr.extract_branch_factor-2481"><a href="#Expr.extract_branch_factor-2481"><span class="linenos">2481</span></a><span class="sd">        &gt;&gt;&gt; from sympy.abc import x, y</span>
</span><span id="Expr.extract_branch_factor-2482"><a href="#Expr.extract_branch_factor-2482"><span class="linenos">2482</span></a><span class="sd">        &gt;&gt;&gt; exp_polar(I*pi).extract_branch_factor()</span>
</span><span id="Expr.extract_branch_factor-2483"><a href="#Expr.extract_branch_factor-2483"><span class="linenos">2483</span></a><span class="sd">        (exp_polar(I*pi), 0)</span>
</span><span id="Expr.extract_branch_factor-2484"><a href="#Expr.extract_branch_factor-2484"><span class="linenos">2484</span></a><span class="sd">        &gt;&gt;&gt; exp_polar(2*I*pi).extract_branch_factor()</span>
</span><span id="Expr.extract_branch_factor-2485"><a href="#Expr.extract_branch_factor-2485"><span class="linenos">2485</span></a><span class="sd">        (1, 1)</span>
</span><span id="Expr.extract_branch_factor-2486"><a href="#Expr.extract_branch_factor-2486"><span class="linenos">2486</span></a><span class="sd">        &gt;&gt;&gt; exp_polar(-pi*I).extract_branch_factor()</span>
</span><span id="Expr.extract_branch_factor-2487"><a href="#Expr.extract_branch_factor-2487"><span class="linenos">2487</span></a><span class="sd">        (exp_polar(I*pi), -1)</span>
</span><span id="Expr.extract_branch_factor-2488"><a href="#Expr.extract_branch_factor-2488"><span class="linenos">2488</span></a><span class="sd">        &gt;&gt;&gt; exp_polar(3*pi*I + x).extract_branch_factor()</span>
</span><span id="Expr.extract_branch_factor-2489"><a href="#Expr.extract_branch_factor-2489"><span class="linenos">2489</span></a><span class="sd">        (exp_polar(x + I*pi), 1)</span>
</span><span id="Expr.extract_branch_factor-2490"><a href="#Expr.extract_branch_factor-2490"><span class="linenos">2490</span></a><span class="sd">        &gt;&gt;&gt; (y*exp_polar(-5*pi*I)*exp_polar(3*pi*I + 2*pi*x)).extract_branch_factor()</span>
</span><span id="Expr.extract_branch_factor-2491"><a href="#Expr.extract_branch_factor-2491"><span class="linenos">2491</span></a><span class="sd">        (y*exp_polar(2*pi*x), -1)</span>
</span><span id="Expr.extract_branch_factor-2492"><a href="#Expr.extract_branch_factor-2492"><span class="linenos">2492</span></a><span class="sd">        &gt;&gt;&gt; exp_polar(-I*pi/2).extract_branch_factor()</span>
</span><span id="Expr.extract_branch_factor-2493"><a href="#Expr.extract_branch_factor-2493"><span class="linenos">2493</span></a><span class="sd">        (exp_polar(-I*pi/2), 0)</span>
</span><span id="Expr.extract_branch_factor-2494"><a href="#Expr.extract_branch_factor-2494"><span class="linenos">2494</span></a>
</span><span id="Expr.extract_branch_factor-2495"><a href="#Expr.extract_branch_factor-2495"><span class="linenos">2495</span></a><span class="sd">        If allow_half is True, also extract exp_polar(I*pi):</span>
</span><span id="Expr.extract_branch_factor-2496"><a href="#Expr.extract_branch_factor-2496"><span class="linenos">2496</span></a>
</span><span id="Expr.extract_branch_factor-2497"><a href="#Expr.extract_branch_factor-2497"><span class="linenos">2497</span></a><span class="sd">        &gt;&gt;&gt; exp_polar(I*pi).extract_branch_factor(allow_half=True)</span>
</span><span id="Expr.extract_branch_factor-2498"><a href="#Expr.extract_branch_factor-2498"><span class="linenos">2498</span></a><span class="sd">        (1, 1/2)</span>
</span><span id="Expr.extract_branch_factor-2499"><a href="#Expr.extract_branch_factor-2499"><span class="linenos">2499</span></a><span class="sd">        &gt;&gt;&gt; exp_polar(2*I*pi).extract_branch_factor(allow_half=True)</span>
</span><span id="Expr.extract_branch_factor-2500"><a href="#Expr.extract_branch_factor-2500"><span class="linenos">2500</span></a><span class="sd">        (1, 1)</span>
</span><span id="Expr.extract_branch_factor-2501"><a href="#Expr.extract_branch_factor-2501"><span class="linenos">2501</span></a><span class="sd">        &gt;&gt;&gt; exp_polar(3*I*pi).extract_branch_factor(allow_half=True)</span>
</span><span id="Expr.extract_branch_factor-2502"><a href="#Expr.extract_branch_factor-2502"><span class="linenos">2502</span></a><span class="sd">        (1, 3/2)</span>
</span><span id="Expr.extract_branch_factor-2503"><a href="#Expr.extract_branch_factor-2503"><span class="linenos">2503</span></a><span class="sd">        &gt;&gt;&gt; exp_polar(-I*pi).extract_branch_factor(allow_half=True)</span>
</span><span id="Expr.extract_branch_factor-2504"><a href="#Expr.extract_branch_factor-2504"><span class="linenos">2504</span></a><span class="sd">        (1, -1/2)</span>
</span><span id="Expr.extract_branch_factor-2505"><a href="#Expr.extract_branch_factor-2505"><span class="linenos">2505</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Expr.extract_branch_factor-2506"><a href="#Expr.extract_branch_factor-2506"><span class="linenos">2506</span></a>        <span class="kn">from</span> <span class="nn">sympy.functions.elementary.exponential</span> <span class="kn">import</span> <span class="n">exp_polar</span>
</span><span id="Expr.extract_branch_factor-2507"><a href="#Expr.extract_branch_factor-2507"><span class="linenos">2507</span></a>        <span class="kn">from</span> <span class="nn">sympy.functions.elementary.integers</span> <span class="kn">import</span> <span class="n">ceiling</span>
</span><span id="Expr.extract_branch_factor-2508"><a href="#Expr.extract_branch_factor-2508"><span class="linenos">2508</span></a>
</span><span id="Expr.extract_branch_factor-2509"><a href="#Expr.extract_branch_factor-2509"><span class="linenos">2509</span></a>        <span class="n">n</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">Zero</span>
</span><span id="Expr.extract_branch_factor-2510"><a href="#Expr.extract_branch_factor-2510"><span class="linenos">2510</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">One</span>
</span><span id="Expr.extract_branch_factor-2511"><a href="#Expr.extract_branch_factor-2511"><span class="linenos">2511</span></a>        <span class="n">args</span> <span class="o">=</span> <span class="n">Mul</span><span class="o">.</span><span class="n">make_args</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="Expr.extract_branch_factor-2512"><a href="#Expr.extract_branch_factor-2512"><span class="linenos">2512</span></a>        <span class="n">exps</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Expr.extract_branch_factor-2513"><a href="#Expr.extract_branch_factor-2513"><span class="linenos">2513</span></a>        <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">args</span><span class="p">:</span>
</span><span id="Expr.extract_branch_factor-2514"><a href="#Expr.extract_branch_factor-2514"><span class="linenos">2514</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="n">exp_polar</span><span class="p">):</span>
</span><span id="Expr.extract_branch_factor-2515"><a href="#Expr.extract_branch_factor-2515"><span class="linenos">2515</span></a>                <span class="n">exps</span> <span class="o">+=</span> <span class="p">[</span><span class="n">arg</span><span class="o">.</span><span class="n">exp</span><span class="p">]</span>
</span><span id="Expr.extract_branch_factor-2516"><a href="#Expr.extract_branch_factor-2516"><span class="linenos">2516</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Expr.extract_branch_factor-2517"><a href="#Expr.extract_branch_factor-2517"><span class="linenos">2517</span></a>                <span class="n">res</span> <span class="o">*=</span> <span class="n">arg</span>
</span><span id="Expr.extract_branch_factor-2518"><a href="#Expr.extract_branch_factor-2518"><span class="linenos">2518</span></a>        <span class="n">piimult</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">Zero</span>
</span><span id="Expr.extract_branch_factor-2519"><a href="#Expr.extract_branch_factor-2519"><span class="linenos">2519</span></a>        <span class="n">extras</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Expr.extract_branch_factor-2520"><a href="#Expr.extract_branch_factor-2520"><span class="linenos">2520</span></a>
</span><span id="Expr.extract_branch_factor-2521"><a href="#Expr.extract_branch_factor-2521"><span class="linenos">2521</span></a>        <span class="n">ipi</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">Pi</span><span class="o">*</span><span class="n">S</span><span class="o">.</span><span class="n">ImaginaryUnit</span>
</span><span id="Expr.extract_branch_factor-2522"><a href="#Expr.extract_branch_factor-2522"><span class="linenos">2522</span></a>        <span class="k">while</span> <span class="n">exps</span><span class="p">:</span>
</span><span id="Expr.extract_branch_factor-2523"><a href="#Expr.extract_branch_factor-2523"><span class="linenos">2523</span></a>            <span class="n">exp</span> <span class="o">=</span> <span class="n">exps</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
</span><span id="Expr.extract_branch_factor-2524"><a href="#Expr.extract_branch_factor-2524"><span class="linenos">2524</span></a>            <span class="k">if</span> <span class="n">exp</span><span class="o">.</span><span class="n">is_Add</span><span class="p">:</span>
</span><span id="Expr.extract_branch_factor-2525"><a href="#Expr.extract_branch_factor-2525"><span class="linenos">2525</span></a>                <span class="n">exps</span> <span class="o">+=</span> <span class="n">exp</span><span class="o">.</span><span class="n">args</span>
</span><span id="Expr.extract_branch_factor-2526"><a href="#Expr.extract_branch_factor-2526"><span class="linenos">2526</span></a>                <span class="k">continue</span>
</span><span id="Expr.extract_branch_factor-2527"><a href="#Expr.extract_branch_factor-2527"><span class="linenos">2527</span></a>            <span class="k">if</span> <span class="n">exp</span><span class="o">.</span><span class="n">is_Mul</span><span class="p">:</span>
</span><span id="Expr.extract_branch_factor-2528"><a href="#Expr.extract_branch_factor-2528"><span class="linenos">2528</span></a>                <span class="n">coeff</span> <span class="o">=</span> <span class="n">exp</span><span class="o">.</span><span class="n">as_coefficient</span><span class="p">(</span><span class="n">ipi</span><span class="p">)</span>
</span><span id="Expr.extract_branch_factor-2529"><a href="#Expr.extract_branch_factor-2529"><span class="linenos">2529</span></a>                <span class="k">if</span> <span class="n">coeff</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Expr.extract_branch_factor-2530"><a href="#Expr.extract_branch_factor-2530"><span class="linenos">2530</span></a>                    <span class="n">piimult</span> <span class="o">+=</span> <span class="n">coeff</span>
</span><span id="Expr.extract_branch_factor-2531"><a href="#Expr.extract_branch_factor-2531"><span class="linenos">2531</span></a>                    <span class="k">continue</span>
</span><span id="Expr.extract_branch_factor-2532"><a href="#Expr.extract_branch_factor-2532"><span class="linenos">2532</span></a>            <span class="n">extras</span> <span class="o">+=</span> <span class="p">[</span><span class="n">exp</span><span class="p">]</span>
</span><span id="Expr.extract_branch_factor-2533"><a href="#Expr.extract_branch_factor-2533"><span class="linenos">2533</span></a>        <span class="k">if</span> <span class="n">piimult</span><span class="o">.</span><span class="n">is_number</span><span class="p">:</span>
</span><span id="Expr.extract_branch_factor-2534"><a href="#Expr.extract_branch_factor-2534"><span class="linenos">2534</span></a>            <span class="n">coeff</span> <span class="o">=</span> <span class="n">piimult</span>
</span><span id="Expr.extract_branch_factor-2535"><a href="#Expr.extract_branch_factor-2535"><span class="linenos">2535</span></a>            <span class="n">tail</span> <span class="o">=</span> <span class="p">()</span>
</span><span id="Expr.extract_branch_factor-2536"><a href="#Expr.extract_branch_factor-2536"><span class="linenos">2536</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Expr.extract_branch_factor-2537"><a href="#Expr.extract_branch_factor-2537"><span class="linenos">2537</span></a>            <span class="n">coeff</span><span class="p">,</span> <span class="n">tail</span> <span class="o">=</span> <span class="n">piimult</span><span class="o">.</span><span class="n">as_coeff_add</span><span class="p">(</span><span class="o">*</span><span class="n">piimult</span><span class="o">.</span><span class="n">free_symbols</span><span class="p">)</span>
</span><span id="Expr.extract_branch_factor-2538"><a href="#Expr.extract_branch_factor-2538"><span class="linenos">2538</span></a>        <span class="c1"># round down to nearest multiple of 2</span>
</span><span id="Expr.extract_branch_factor-2539"><a href="#Expr.extract_branch_factor-2539"><span class="linenos">2539</span></a>        <span class="n">branchfact</span> <span class="o">=</span> <span class="n">ceiling</span><span class="p">(</span><span class="n">coeff</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span> <span class="n">S</span><span class="o">.</span><span class="n">Half</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span>
</span><span id="Expr.extract_branch_factor-2540"><a href="#Expr.extract_branch_factor-2540"><span class="linenos">2540</span></a>        <span class="n">n</span> <span class="o">+=</span> <span class="n">branchfact</span><span class="o">/</span><span class="mi">2</span>
</span><span id="Expr.extract_branch_factor-2541"><a href="#Expr.extract_branch_factor-2541"><span class="linenos">2541</span></a>        <span class="n">c</span> <span class="o">=</span> <span class="n">coeff</span> <span class="o">-</span> <span class="n">branchfact</span>
</span><span id="Expr.extract_branch_factor-2542"><a href="#Expr.extract_branch_factor-2542"><span class="linenos">2542</span></a>        <span class="k">if</span> <span class="n">allow_half</span><span class="p">:</span>
</span><span id="Expr.extract_branch_factor-2543"><a href="#Expr.extract_branch_factor-2543"><span class="linenos">2543</span></a>            <span class="n">nc</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">extract_additively</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span id="Expr.extract_branch_factor-2544"><a href="#Expr.extract_branch_factor-2544"><span class="linenos">2544</span></a>            <span class="k">if</span> <span class="n">nc</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Expr.extract_branch_factor-2545"><a href="#Expr.extract_branch_factor-2545"><span class="linenos">2545</span></a>                <span class="n">n</span> <span class="o">+=</span> <span class="n">S</span><span class="o">.</span><span class="n">Half</span>
</span><span id="Expr.extract_branch_factor-2546"><a href="#Expr.extract_branch_factor-2546"><span class="linenos">2546</span></a>                <span class="n">c</span> <span class="o">=</span> <span class="n">nc</span>
</span><span id="Expr.extract_branch_factor-2547"><a href="#Expr.extract_branch_factor-2547"><span class="linenos">2547</span></a>        <span class="n">newexp</span> <span class="o">=</span> <span class="n">ipi</span><span class="o">*</span><span class="n">Add</span><span class="p">(</span><span class="o">*</span><span class="p">((</span><span class="n">c</span><span class="p">,</span> <span class="p">)</span> <span class="o">+</span> <span class="n">tail</span><span class="p">))</span> <span class="o">+</span> <span class="n">Add</span><span class="p">(</span><span class="o">*</span><span class="n">extras</span><span class="p">)</span>
</span><span id="Expr.extract_branch_factor-2548"><a href="#Expr.extract_branch_factor-2548"><span class="linenos">2548</span></a>        <span class="k">if</span> <span class="n">newexp</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Expr.extract_branch_factor-2549"><a href="#Expr.extract_branch_factor-2549"><span class="linenos">2549</span></a>            <span class="n">res</span> <span class="o">*=</span> <span class="n">exp_polar</span><span class="p">(</span><span class="n">newexp</span><span class="p">)</span>
</span><span id="Expr.extract_branch_factor-2550"><a href="#Expr.extract_branch_factor-2550"><span class="linenos">2550</span></a>        <span class="k">return</span> <span class="n">res</span><span class="p">,</span> <span class="n">n</span>
</span></pre></div>


            <div class="docstring"><p>Try to write self as <code>exp_polar(2*pi*I*n)*z</code> in a nice way.
Return (z, n).</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">exp_polar</span><span class="p">,</span> <span class="n">I</span><span class="p">,</span> <span class="n">pi</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.abc</span> <span class="kn">import</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">exp_polar</span><span class="p">(</span><span class="n">I</span><span class="o">*</span><span class="n">pi</span><span class="p">)</span><span class="o">.</span><span class="n">extract_branch_factor</span><span class="p">()</span>
<span class="go">(exp_polar(I*pi), 0)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">exp_polar</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">I</span><span class="o">*</span><span class="n">pi</span><span class="p">)</span><span class="o">.</span><span class="n">extract_branch_factor</span><span class="p">()</span>
<span class="go">(1, 1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">exp_polar</span><span class="p">(</span><span class="o">-</span><span class="n">pi</span><span class="o">*</span><span class="n">I</span><span class="p">)</span><span class="o">.</span><span class="n">extract_branch_factor</span><span class="p">()</span>
<span class="go">(exp_polar(I*pi), -1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">exp_polar</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">I</span> <span class="o">+</span> <span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">extract_branch_factor</span><span class="p">()</span>
<span class="go">(exp_polar(x + I*pi), 1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">y</span><span class="o">*</span><span class="n">exp_polar</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">I</span><span class="p">)</span><span class="o">*</span><span class="n">exp_polar</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">I</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span><span class="p">))</span><span class="o">.</span><span class="n">extract_branch_factor</span><span class="p">()</span>
<span class="go">(y*exp_polar(2*pi*x), -1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">exp_polar</span><span class="p">(</span><span class="o">-</span><span class="n">I</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">extract_branch_factor</span><span class="p">()</span>
<span class="go">(exp_polar(-I*pi/2), 0)</span>
</code></pre>
</div>

<p>If allow_half is True, also extract exp_polar(I*pi):</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">exp_polar</span><span class="p">(</span><span class="n">I</span><span class="o">*</span><span class="n">pi</span><span class="p">)</span><span class="o">.</span><span class="n">extract_branch_factor</span><span class="p">(</span><span class="n">allow_half</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">(1, 1/2)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">exp_polar</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">I</span><span class="o">*</span><span class="n">pi</span><span class="p">)</span><span class="o">.</span><span class="n">extract_branch_factor</span><span class="p">(</span><span class="n">allow_half</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">(1, 1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">exp_polar</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">I</span><span class="o">*</span><span class="n">pi</span><span class="p">)</span><span class="o">.</span><span class="n">extract_branch_factor</span><span class="p">(</span><span class="n">allow_half</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">(1, 3/2)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">exp_polar</span><span class="p">(</span><span class="o">-</span><span class="n">I</span><span class="o">*</span><span class="n">pi</span><span class="p">)</span><span class="o">.</span><span class="n">extract_branch_factor</span><span class="p">(</span><span class="n">allow_half</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">(1, -1/2)</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="Expr.is_polynomial" class="classattr">
                                        <input id="Expr.is_polynomial-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">is_polynomial</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="o">*</span><span class="n">syms</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Expr.is_polynomial-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Expr.is_polynomial"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Expr.is_polynomial-2552"><a href="#Expr.is_polynomial-2552"><span class="linenos">2552</span></a>    <span class="k">def</span> <span class="nf">is_polynomial</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">syms</span><span class="p">):</span>
</span><span id="Expr.is_polynomial-2553"><a href="#Expr.is_polynomial-2553"><span class="linenos">2553</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Expr.is_polynomial-2554"><a href="#Expr.is_polynomial-2554"><span class="linenos">2554</span></a><span class="sd">        Return True if self is a polynomial in syms and False otherwise.</span>
</span><span id="Expr.is_polynomial-2555"><a href="#Expr.is_polynomial-2555"><span class="linenos">2555</span></a>
</span><span id="Expr.is_polynomial-2556"><a href="#Expr.is_polynomial-2556"><span class="linenos">2556</span></a><span class="sd">        This checks if self is an exact polynomial in syms.  This function</span>
</span><span id="Expr.is_polynomial-2557"><a href="#Expr.is_polynomial-2557"><span class="linenos">2557</span></a><span class="sd">        returns False for expressions that are &quot;polynomials&quot; with symbolic</span>
</span><span id="Expr.is_polynomial-2558"><a href="#Expr.is_polynomial-2558"><span class="linenos">2558</span></a><span class="sd">        exponents.  Thus, you should be able to apply polynomial algorithms to</span>
</span><span id="Expr.is_polynomial-2559"><a href="#Expr.is_polynomial-2559"><span class="linenos">2559</span></a><span class="sd">        expressions for which this returns True, and Poly(expr, \*syms) should</span>
</span><span id="Expr.is_polynomial-2560"><a href="#Expr.is_polynomial-2560"><span class="linenos">2560</span></a><span class="sd">        work if and only if expr.is_polynomial(\*syms) returns True. The</span>
</span><span id="Expr.is_polynomial-2561"><a href="#Expr.is_polynomial-2561"><span class="linenos">2561</span></a><span class="sd">        polynomial does not have to be in expanded form.  If no symbols are</span>
</span><span id="Expr.is_polynomial-2562"><a href="#Expr.is_polynomial-2562"><span class="linenos">2562</span></a><span class="sd">        given, all free symbols in the expression will be used.</span>
</span><span id="Expr.is_polynomial-2563"><a href="#Expr.is_polynomial-2563"><span class="linenos">2563</span></a>
</span><span id="Expr.is_polynomial-2564"><a href="#Expr.is_polynomial-2564"><span class="linenos">2564</span></a><span class="sd">        This is not part of the assumptions system.  You cannot do</span>
</span><span id="Expr.is_polynomial-2565"><a href="#Expr.is_polynomial-2565"><span class="linenos">2565</span></a><span class="sd">        Symbol(&#39;z&#39;, polynomial=True).</span>
</span><span id="Expr.is_polynomial-2566"><a href="#Expr.is_polynomial-2566"><span class="linenos">2566</span></a>
</span><span id="Expr.is_polynomial-2567"><a href="#Expr.is_polynomial-2567"><span class="linenos">2567</span></a><span class="sd">        Examples</span>
</span><span id="Expr.is_polynomial-2568"><a href="#Expr.is_polynomial-2568"><span class="linenos">2568</span></a><span class="sd">        ========</span>
</span><span id="Expr.is_polynomial-2569"><a href="#Expr.is_polynomial-2569"><span class="linenos">2569</span></a>
</span><span id="Expr.is_polynomial-2570"><a href="#Expr.is_polynomial-2570"><span class="linenos">2570</span></a><span class="sd">        &gt;&gt;&gt; from sympy import Symbol, Function</span>
</span><span id="Expr.is_polynomial-2571"><a href="#Expr.is_polynomial-2571"><span class="linenos">2571</span></a><span class="sd">        &gt;&gt;&gt; x = Symbol(&#39;x&#39;)</span>
</span><span id="Expr.is_polynomial-2572"><a href="#Expr.is_polynomial-2572"><span class="linenos">2572</span></a><span class="sd">        &gt;&gt;&gt; ((x**2 + 1)**4).is_polynomial(x)</span>
</span><span id="Expr.is_polynomial-2573"><a href="#Expr.is_polynomial-2573"><span class="linenos">2573</span></a><span class="sd">        True</span>
</span><span id="Expr.is_polynomial-2574"><a href="#Expr.is_polynomial-2574"><span class="linenos">2574</span></a><span class="sd">        &gt;&gt;&gt; ((x**2 + 1)**4).is_polynomial()</span>
</span><span id="Expr.is_polynomial-2575"><a href="#Expr.is_polynomial-2575"><span class="linenos">2575</span></a><span class="sd">        True</span>
</span><span id="Expr.is_polynomial-2576"><a href="#Expr.is_polynomial-2576"><span class="linenos">2576</span></a><span class="sd">        &gt;&gt;&gt; (2**x + 1).is_polynomial(x)</span>
</span><span id="Expr.is_polynomial-2577"><a href="#Expr.is_polynomial-2577"><span class="linenos">2577</span></a><span class="sd">        False</span>
</span><span id="Expr.is_polynomial-2578"><a href="#Expr.is_polynomial-2578"><span class="linenos">2578</span></a><span class="sd">        &gt;&gt;&gt; (2**x + 1).is_polynomial(2**x)</span>
</span><span id="Expr.is_polynomial-2579"><a href="#Expr.is_polynomial-2579"><span class="linenos">2579</span></a><span class="sd">        True</span>
</span><span id="Expr.is_polynomial-2580"><a href="#Expr.is_polynomial-2580"><span class="linenos">2580</span></a><span class="sd">        &gt;&gt;&gt; f = Function(&#39;f&#39;)</span>
</span><span id="Expr.is_polynomial-2581"><a href="#Expr.is_polynomial-2581"><span class="linenos">2581</span></a><span class="sd">        &gt;&gt;&gt; (f(x) + 1).is_polynomial(x)</span>
</span><span id="Expr.is_polynomial-2582"><a href="#Expr.is_polynomial-2582"><span class="linenos">2582</span></a><span class="sd">        False</span>
</span><span id="Expr.is_polynomial-2583"><a href="#Expr.is_polynomial-2583"><span class="linenos">2583</span></a><span class="sd">        &gt;&gt;&gt; (f(x) + 1).is_polynomial(f(x))</span>
</span><span id="Expr.is_polynomial-2584"><a href="#Expr.is_polynomial-2584"><span class="linenos">2584</span></a><span class="sd">        True</span>
</span><span id="Expr.is_polynomial-2585"><a href="#Expr.is_polynomial-2585"><span class="linenos">2585</span></a><span class="sd">        &gt;&gt;&gt; (1/f(x) + 1).is_polynomial(f(x))</span>
</span><span id="Expr.is_polynomial-2586"><a href="#Expr.is_polynomial-2586"><span class="linenos">2586</span></a><span class="sd">        False</span>
</span><span id="Expr.is_polynomial-2587"><a href="#Expr.is_polynomial-2587"><span class="linenos">2587</span></a>
</span><span id="Expr.is_polynomial-2588"><a href="#Expr.is_polynomial-2588"><span class="linenos">2588</span></a><span class="sd">        &gt;&gt;&gt; n = Symbol(&#39;n&#39;, nonnegative=True, integer=True)</span>
</span><span id="Expr.is_polynomial-2589"><a href="#Expr.is_polynomial-2589"><span class="linenos">2589</span></a><span class="sd">        &gt;&gt;&gt; (x**n + 1).is_polynomial(x)</span>
</span><span id="Expr.is_polynomial-2590"><a href="#Expr.is_polynomial-2590"><span class="linenos">2590</span></a><span class="sd">        False</span>
</span><span id="Expr.is_polynomial-2591"><a href="#Expr.is_polynomial-2591"><span class="linenos">2591</span></a>
</span><span id="Expr.is_polynomial-2592"><a href="#Expr.is_polynomial-2592"><span class="linenos">2592</span></a><span class="sd">        This function does not attempt any nontrivial simplifications that may</span>
</span><span id="Expr.is_polynomial-2593"><a href="#Expr.is_polynomial-2593"><span class="linenos">2593</span></a><span class="sd">        result in an expression that does not appear to be a polynomial to</span>
</span><span id="Expr.is_polynomial-2594"><a href="#Expr.is_polynomial-2594"><span class="linenos">2594</span></a><span class="sd">        become one.</span>
</span><span id="Expr.is_polynomial-2595"><a href="#Expr.is_polynomial-2595"><span class="linenos">2595</span></a>
</span><span id="Expr.is_polynomial-2596"><a href="#Expr.is_polynomial-2596"><span class="linenos">2596</span></a><span class="sd">        &gt;&gt;&gt; from sympy import sqrt, factor, cancel</span>
</span><span id="Expr.is_polynomial-2597"><a href="#Expr.is_polynomial-2597"><span class="linenos">2597</span></a><span class="sd">        &gt;&gt;&gt; y = Symbol(&#39;y&#39;, positive=True)</span>
</span><span id="Expr.is_polynomial-2598"><a href="#Expr.is_polynomial-2598"><span class="linenos">2598</span></a><span class="sd">        &gt;&gt;&gt; a = sqrt(y**2 + 2*y + 1)</span>
</span><span id="Expr.is_polynomial-2599"><a href="#Expr.is_polynomial-2599"><span class="linenos">2599</span></a><span class="sd">        &gt;&gt;&gt; a.is_polynomial(y)</span>
</span><span id="Expr.is_polynomial-2600"><a href="#Expr.is_polynomial-2600"><span class="linenos">2600</span></a><span class="sd">        False</span>
</span><span id="Expr.is_polynomial-2601"><a href="#Expr.is_polynomial-2601"><span class="linenos">2601</span></a><span class="sd">        &gt;&gt;&gt; factor(a)</span>
</span><span id="Expr.is_polynomial-2602"><a href="#Expr.is_polynomial-2602"><span class="linenos">2602</span></a><span class="sd">        y + 1</span>
</span><span id="Expr.is_polynomial-2603"><a href="#Expr.is_polynomial-2603"><span class="linenos">2603</span></a><span class="sd">        &gt;&gt;&gt; factor(a).is_polynomial(y)</span>
</span><span id="Expr.is_polynomial-2604"><a href="#Expr.is_polynomial-2604"><span class="linenos">2604</span></a><span class="sd">        True</span>
</span><span id="Expr.is_polynomial-2605"><a href="#Expr.is_polynomial-2605"><span class="linenos">2605</span></a>
</span><span id="Expr.is_polynomial-2606"><a href="#Expr.is_polynomial-2606"><span class="linenos">2606</span></a><span class="sd">        &gt;&gt;&gt; b = (y**2 + 2*y + 1)/(y + 1)</span>
</span><span id="Expr.is_polynomial-2607"><a href="#Expr.is_polynomial-2607"><span class="linenos">2607</span></a><span class="sd">        &gt;&gt;&gt; b.is_polynomial(y)</span>
</span><span id="Expr.is_polynomial-2608"><a href="#Expr.is_polynomial-2608"><span class="linenos">2608</span></a><span class="sd">        False</span>
</span><span id="Expr.is_polynomial-2609"><a href="#Expr.is_polynomial-2609"><span class="linenos">2609</span></a><span class="sd">        &gt;&gt;&gt; cancel(b)</span>
</span><span id="Expr.is_polynomial-2610"><a href="#Expr.is_polynomial-2610"><span class="linenos">2610</span></a><span class="sd">        y + 1</span>
</span><span id="Expr.is_polynomial-2611"><a href="#Expr.is_polynomial-2611"><span class="linenos">2611</span></a><span class="sd">        &gt;&gt;&gt; cancel(b).is_polynomial(y)</span>
</span><span id="Expr.is_polynomial-2612"><a href="#Expr.is_polynomial-2612"><span class="linenos">2612</span></a><span class="sd">        True</span>
</span><span id="Expr.is_polynomial-2613"><a href="#Expr.is_polynomial-2613"><span class="linenos">2613</span></a>
</span><span id="Expr.is_polynomial-2614"><a href="#Expr.is_polynomial-2614"><span class="linenos">2614</span></a><span class="sd">        See also .is_rational_function()</span>
</span><span id="Expr.is_polynomial-2615"><a href="#Expr.is_polynomial-2615"><span class="linenos">2615</span></a>
</span><span id="Expr.is_polynomial-2616"><a href="#Expr.is_polynomial-2616"><span class="linenos">2616</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Expr.is_polynomial-2617"><a href="#Expr.is_polynomial-2617"><span class="linenos">2617</span></a>        <span class="k">if</span> <span class="n">syms</span><span class="p">:</span>
</span><span id="Expr.is_polynomial-2618"><a href="#Expr.is_polynomial-2618"><span class="linenos">2618</span></a>            <span class="n">syms</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">sympify</span><span class="p">,</span> <span class="n">syms</span><span class="p">))</span>
</span><span id="Expr.is_polynomial-2619"><a href="#Expr.is_polynomial-2619"><span class="linenos">2619</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Expr.is_polynomial-2620"><a href="#Expr.is_polynomial-2620"><span class="linenos">2620</span></a>            <span class="n">syms</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">free_symbols</span>
</span><span id="Expr.is_polynomial-2621"><a href="#Expr.is_polynomial-2621"><span class="linenos">2621</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">syms</span><span class="p">:</span>
</span><span id="Expr.is_polynomial-2622"><a href="#Expr.is_polynomial-2622"><span class="linenos">2622</span></a>                <span class="k">return</span> <span class="kc">True</span>
</span><span id="Expr.is_polynomial-2623"><a href="#Expr.is_polynomial-2623"><span class="linenos">2623</span></a>
</span><span id="Expr.is_polynomial-2624"><a href="#Expr.is_polynomial-2624"><span class="linenos">2624</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_eval_is_polynomial</span><span class="p">(</span><span class="n">syms</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Return True if self is a polynomial in syms and False otherwise.</p>

<p>This checks if self is an exact polynomial in syms.  This function
returns False for expressions that are "polynomials" with symbolic
exponents.  Thus, you should be able to apply polynomial algorithms to
expressions for which this returns True, and Poly(expr, *syms) should
work if and only if expr.is_polynomial(*syms) returns True. The
polynomial does not have to be in expanded form.  If no symbols are
given, all free symbols in the expression will be used.</p>

<p>This is not part of the assumptions system.  You cannot do
Symbol('z', polynomial=True).</p>

<h1 id="examples">Examples</h1>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">Symbol</span><span class="p">,</span> <span class="n">Function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">Symbol</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">((</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">is_polynomial</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">((</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">is_polynomial</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">is_polynomial</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">is_polynomial</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="n">x</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">Function</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">is_polynomial</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">is_polynomial</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">is_polynomial</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="go">False</span>
</code></pre>
</div>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">n</span> <span class="o">=</span> <span class="n">Symbol</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="n">nonnegative</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">integer</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">is_polynomial</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">False</span>
</code></pre>
</div>

<p>This function does not attempt any nontrivial simplifications that may
result in an expression that does not appear to be a polynomial to
become one.</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">sqrt</span><span class="p">,</span> <span class="n">factor</span><span class="p">,</span> <span class="n">cancel</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">Symbol</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">positive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">y</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">y</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">is_polynomial</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">factor</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">y + 1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">factor</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">is_polynomial</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="go">True</span>
</code></pre>
</div>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="p">(</span><span class="n">y</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">y</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">y</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span><span class="o">.</span><span class="n">is_polynomial</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cancel</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="go">y + 1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cancel</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">is_polynomial</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="go">True</span>
</code></pre>
</div>

<p>See also .is_rational_function()</p>
</div>


                            </div>
                            <div id="Expr.is_rational_function" class="classattr">
                                        <input id="Expr.is_rational_function-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">is_rational_function</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="o">*</span><span class="n">syms</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Expr.is_rational_function-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Expr.is_rational_function"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Expr.is_rational_function-2634"><a href="#Expr.is_rational_function-2634"><span class="linenos">2634</span></a>    <span class="k">def</span> <span class="nf">is_rational_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">syms</span><span class="p">):</span>
</span><span id="Expr.is_rational_function-2635"><a href="#Expr.is_rational_function-2635"><span class="linenos">2635</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Expr.is_rational_function-2636"><a href="#Expr.is_rational_function-2636"><span class="linenos">2636</span></a><span class="sd">        Test whether function is a ratio of two polynomials in the given</span>
</span><span id="Expr.is_rational_function-2637"><a href="#Expr.is_rational_function-2637"><span class="linenos">2637</span></a><span class="sd">        symbols, syms. When syms is not given, all free symbols will be used.</span>
</span><span id="Expr.is_rational_function-2638"><a href="#Expr.is_rational_function-2638"><span class="linenos">2638</span></a><span class="sd">        The rational function does not have to be in expanded or in any kind of</span>
</span><span id="Expr.is_rational_function-2639"><a href="#Expr.is_rational_function-2639"><span class="linenos">2639</span></a><span class="sd">        canonical form.</span>
</span><span id="Expr.is_rational_function-2640"><a href="#Expr.is_rational_function-2640"><span class="linenos">2640</span></a>
</span><span id="Expr.is_rational_function-2641"><a href="#Expr.is_rational_function-2641"><span class="linenos">2641</span></a><span class="sd">        This function returns False for expressions that are &quot;rational</span>
</span><span id="Expr.is_rational_function-2642"><a href="#Expr.is_rational_function-2642"><span class="linenos">2642</span></a><span class="sd">        functions&quot; with symbolic exponents.  Thus, you should be able to call</span>
</span><span id="Expr.is_rational_function-2643"><a href="#Expr.is_rational_function-2643"><span class="linenos">2643</span></a><span class="sd">        .as_numer_denom() and apply polynomial algorithms to the result for</span>
</span><span id="Expr.is_rational_function-2644"><a href="#Expr.is_rational_function-2644"><span class="linenos">2644</span></a><span class="sd">        expressions for which this returns True.</span>
</span><span id="Expr.is_rational_function-2645"><a href="#Expr.is_rational_function-2645"><span class="linenos">2645</span></a>
</span><span id="Expr.is_rational_function-2646"><a href="#Expr.is_rational_function-2646"><span class="linenos">2646</span></a><span class="sd">        This is not part of the assumptions system.  You cannot do</span>
</span><span id="Expr.is_rational_function-2647"><a href="#Expr.is_rational_function-2647"><span class="linenos">2647</span></a><span class="sd">        Symbol(&#39;z&#39;, rational_function=True).</span>
</span><span id="Expr.is_rational_function-2648"><a href="#Expr.is_rational_function-2648"><span class="linenos">2648</span></a>
</span><span id="Expr.is_rational_function-2649"><a href="#Expr.is_rational_function-2649"><span class="linenos">2649</span></a><span class="sd">        Examples</span>
</span><span id="Expr.is_rational_function-2650"><a href="#Expr.is_rational_function-2650"><span class="linenos">2650</span></a><span class="sd">        ========</span>
</span><span id="Expr.is_rational_function-2651"><a href="#Expr.is_rational_function-2651"><span class="linenos">2651</span></a>
</span><span id="Expr.is_rational_function-2652"><a href="#Expr.is_rational_function-2652"><span class="linenos">2652</span></a><span class="sd">        &gt;&gt;&gt; from sympy import Symbol, sin</span>
</span><span id="Expr.is_rational_function-2653"><a href="#Expr.is_rational_function-2653"><span class="linenos">2653</span></a><span class="sd">        &gt;&gt;&gt; from sympy.abc import x, y</span>
</span><span id="Expr.is_rational_function-2654"><a href="#Expr.is_rational_function-2654"><span class="linenos">2654</span></a>
</span><span id="Expr.is_rational_function-2655"><a href="#Expr.is_rational_function-2655"><span class="linenos">2655</span></a><span class="sd">        &gt;&gt;&gt; (x/y).is_rational_function()</span>
</span><span id="Expr.is_rational_function-2656"><a href="#Expr.is_rational_function-2656"><span class="linenos">2656</span></a><span class="sd">        True</span>
</span><span id="Expr.is_rational_function-2657"><a href="#Expr.is_rational_function-2657"><span class="linenos">2657</span></a>
</span><span id="Expr.is_rational_function-2658"><a href="#Expr.is_rational_function-2658"><span class="linenos">2658</span></a><span class="sd">        &gt;&gt;&gt; (x**2).is_rational_function()</span>
</span><span id="Expr.is_rational_function-2659"><a href="#Expr.is_rational_function-2659"><span class="linenos">2659</span></a><span class="sd">        True</span>
</span><span id="Expr.is_rational_function-2660"><a href="#Expr.is_rational_function-2660"><span class="linenos">2660</span></a>
</span><span id="Expr.is_rational_function-2661"><a href="#Expr.is_rational_function-2661"><span class="linenos">2661</span></a><span class="sd">        &gt;&gt;&gt; (x/sin(y)).is_rational_function(y)</span>
</span><span id="Expr.is_rational_function-2662"><a href="#Expr.is_rational_function-2662"><span class="linenos">2662</span></a><span class="sd">        False</span>
</span><span id="Expr.is_rational_function-2663"><a href="#Expr.is_rational_function-2663"><span class="linenos">2663</span></a>
</span><span id="Expr.is_rational_function-2664"><a href="#Expr.is_rational_function-2664"><span class="linenos">2664</span></a><span class="sd">        &gt;&gt;&gt; n = Symbol(&#39;n&#39;, integer=True)</span>
</span><span id="Expr.is_rational_function-2665"><a href="#Expr.is_rational_function-2665"><span class="linenos">2665</span></a><span class="sd">        &gt;&gt;&gt; (x**n + 1).is_rational_function(x)</span>
</span><span id="Expr.is_rational_function-2666"><a href="#Expr.is_rational_function-2666"><span class="linenos">2666</span></a><span class="sd">        False</span>
</span><span id="Expr.is_rational_function-2667"><a href="#Expr.is_rational_function-2667"><span class="linenos">2667</span></a>
</span><span id="Expr.is_rational_function-2668"><a href="#Expr.is_rational_function-2668"><span class="linenos">2668</span></a><span class="sd">        This function does not attempt any nontrivial simplifications that may</span>
</span><span id="Expr.is_rational_function-2669"><a href="#Expr.is_rational_function-2669"><span class="linenos">2669</span></a><span class="sd">        result in an expression that does not appear to be a rational function</span>
</span><span id="Expr.is_rational_function-2670"><a href="#Expr.is_rational_function-2670"><span class="linenos">2670</span></a><span class="sd">        to become one.</span>
</span><span id="Expr.is_rational_function-2671"><a href="#Expr.is_rational_function-2671"><span class="linenos">2671</span></a>
</span><span id="Expr.is_rational_function-2672"><a href="#Expr.is_rational_function-2672"><span class="linenos">2672</span></a><span class="sd">        &gt;&gt;&gt; from sympy import sqrt, factor</span>
</span><span id="Expr.is_rational_function-2673"><a href="#Expr.is_rational_function-2673"><span class="linenos">2673</span></a><span class="sd">        &gt;&gt;&gt; y = Symbol(&#39;y&#39;, positive=True)</span>
</span><span id="Expr.is_rational_function-2674"><a href="#Expr.is_rational_function-2674"><span class="linenos">2674</span></a><span class="sd">        &gt;&gt;&gt; a = sqrt(y**2 + 2*y + 1)/y</span>
</span><span id="Expr.is_rational_function-2675"><a href="#Expr.is_rational_function-2675"><span class="linenos">2675</span></a><span class="sd">        &gt;&gt;&gt; a.is_rational_function(y)</span>
</span><span id="Expr.is_rational_function-2676"><a href="#Expr.is_rational_function-2676"><span class="linenos">2676</span></a><span class="sd">        False</span>
</span><span id="Expr.is_rational_function-2677"><a href="#Expr.is_rational_function-2677"><span class="linenos">2677</span></a><span class="sd">        &gt;&gt;&gt; factor(a)</span>
</span><span id="Expr.is_rational_function-2678"><a href="#Expr.is_rational_function-2678"><span class="linenos">2678</span></a><span class="sd">        (y + 1)/y</span>
</span><span id="Expr.is_rational_function-2679"><a href="#Expr.is_rational_function-2679"><span class="linenos">2679</span></a><span class="sd">        &gt;&gt;&gt; factor(a).is_rational_function(y)</span>
</span><span id="Expr.is_rational_function-2680"><a href="#Expr.is_rational_function-2680"><span class="linenos">2680</span></a><span class="sd">        True</span>
</span><span id="Expr.is_rational_function-2681"><a href="#Expr.is_rational_function-2681"><span class="linenos">2681</span></a>
</span><span id="Expr.is_rational_function-2682"><a href="#Expr.is_rational_function-2682"><span class="linenos">2682</span></a><span class="sd">        See also is_algebraic_expr().</span>
</span><span id="Expr.is_rational_function-2683"><a href="#Expr.is_rational_function-2683"><span class="linenos">2683</span></a>
</span><span id="Expr.is_rational_function-2684"><a href="#Expr.is_rational_function-2684"><span class="linenos">2684</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Expr.is_rational_function-2685"><a href="#Expr.is_rational_function-2685"><span class="linenos">2685</span></a>        <span class="k">if</span> <span class="bp">self</span> <span class="ow">in</span> <span class="p">[</span><span class="n">S</span><span class="o">.</span><span class="n">NaN</span><span class="p">,</span> <span class="n">S</span><span class="o">.</span><span class="n">Infinity</span><span class="p">,</span> <span class="n">S</span><span class="o">.</span><span class="n">NegativeInfinity</span><span class="p">,</span> <span class="n">S</span><span class="o">.</span><span class="n">ComplexInfinity</span><span class="p">]:</span>
</span><span id="Expr.is_rational_function-2686"><a href="#Expr.is_rational_function-2686"><span class="linenos">2686</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="Expr.is_rational_function-2687"><a href="#Expr.is_rational_function-2687"><span class="linenos">2687</span></a>
</span><span id="Expr.is_rational_function-2688"><a href="#Expr.is_rational_function-2688"><span class="linenos">2688</span></a>        <span class="k">if</span> <span class="n">syms</span><span class="p">:</span>
</span><span id="Expr.is_rational_function-2689"><a href="#Expr.is_rational_function-2689"><span class="linenos">2689</span></a>            <span class="n">syms</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">sympify</span><span class="p">,</span> <span class="n">syms</span><span class="p">))</span>
</span><span id="Expr.is_rational_function-2690"><a href="#Expr.is_rational_function-2690"><span class="linenos">2690</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Expr.is_rational_function-2691"><a href="#Expr.is_rational_function-2691"><span class="linenos">2691</span></a>            <span class="n">syms</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">free_symbols</span>
</span><span id="Expr.is_rational_function-2692"><a href="#Expr.is_rational_function-2692"><span class="linenos">2692</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">syms</span><span class="p">:</span>
</span><span id="Expr.is_rational_function-2693"><a href="#Expr.is_rational_function-2693"><span class="linenos">2693</span></a>                <span class="k">return</span> <span class="kc">True</span>
</span><span id="Expr.is_rational_function-2694"><a href="#Expr.is_rational_function-2694"><span class="linenos">2694</span></a>
</span><span id="Expr.is_rational_function-2695"><a href="#Expr.is_rational_function-2695"><span class="linenos">2695</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_eval_is_rational_function</span><span class="p">(</span><span class="n">syms</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Test whether function is a ratio of two polynomials in the given
symbols, syms. When syms is not given, all free symbols will be used.
The rational function does not have to be in expanded or in any kind of
canonical form.</p>

<p>This function returns False for expressions that are "rational
functions" with symbolic exponents.  Thus, you should be able to call
.as_numer_denom() and apply polynomial algorithms to the result for
expressions for which this returns True.</p>

<p>This is not part of the assumptions system.  You cannot do
Symbol('z', rational_function=True).</p>

<h1 id="examples">Examples</h1>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">Symbol</span><span class="p">,</span> <span class="n">sin</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.abc</span> <span class="kn">import</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>
</code></pre>
</div>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">x</span><span class="o">/</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">is_rational_function</span><span class="p">()</span>
<span class="go">True</span>
</code></pre>
</div>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">is_rational_function</span><span class="p">()</span>
<span class="go">True</span>
</code></pre>
</div>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">x</span><span class="o">/</span><span class="n">sin</span><span class="p">(</span><span class="n">y</span><span class="p">))</span><span class="o">.</span><span class="n">is_rational_function</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="go">False</span>
</code></pre>
</div>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">n</span> <span class="o">=</span> <span class="n">Symbol</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="n">integer</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">is_rational_function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">False</span>
</code></pre>
</div>

<p>This function does not attempt any nontrivial simplifications that may
result in an expression that does not appear to be a rational function
to become one.</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">sqrt</span><span class="p">,</span> <span class="n">factor</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">Symbol</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">positive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">y</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">y</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">y</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">is_rational_function</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">factor</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">(y + 1)/y</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">factor</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">is_rational_function</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="go">True</span>
</code></pre>
</div>

<p>See also is_algebraic_expr().</p>
</div>


                            </div>
                            <div id="Expr.is_meromorphic" class="classattr">
                                        <input id="Expr.is_meromorphic-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">is_meromorphic</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">x</span>, </span><span class="param"><span class="n">a</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Expr.is_meromorphic-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Expr.is_meromorphic"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Expr.is_meromorphic-2704"><a href="#Expr.is_meromorphic-2704"><span class="linenos">2704</span></a>    <span class="k">def</span> <span class="nf">is_meromorphic</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
</span><span id="Expr.is_meromorphic-2705"><a href="#Expr.is_meromorphic-2705"><span class="linenos">2705</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Expr.is_meromorphic-2706"><a href="#Expr.is_meromorphic-2706"><span class="linenos">2706</span></a><span class="sd">        This tests whether an expression is meromorphic as</span>
</span><span id="Expr.is_meromorphic-2707"><a href="#Expr.is_meromorphic-2707"><span class="linenos">2707</span></a><span class="sd">        a function of the given symbol ``x`` at the point ``a``.</span>
</span><span id="Expr.is_meromorphic-2708"><a href="#Expr.is_meromorphic-2708"><span class="linenos">2708</span></a>
</span><span id="Expr.is_meromorphic-2709"><a href="#Expr.is_meromorphic-2709"><span class="linenos">2709</span></a><span class="sd">        This method is intended as a quick test that will return</span>
</span><span id="Expr.is_meromorphic-2710"><a href="#Expr.is_meromorphic-2710"><span class="linenos">2710</span></a><span class="sd">        None if no decision can be made without simplification or</span>
</span><span id="Expr.is_meromorphic-2711"><a href="#Expr.is_meromorphic-2711"><span class="linenos">2711</span></a><span class="sd">        more detailed analysis.</span>
</span><span id="Expr.is_meromorphic-2712"><a href="#Expr.is_meromorphic-2712"><span class="linenos">2712</span></a>
</span><span id="Expr.is_meromorphic-2713"><a href="#Expr.is_meromorphic-2713"><span class="linenos">2713</span></a><span class="sd">        Examples</span>
</span><span id="Expr.is_meromorphic-2714"><a href="#Expr.is_meromorphic-2714"><span class="linenos">2714</span></a><span class="sd">        ========</span>
</span><span id="Expr.is_meromorphic-2715"><a href="#Expr.is_meromorphic-2715"><span class="linenos">2715</span></a>
</span><span id="Expr.is_meromorphic-2716"><a href="#Expr.is_meromorphic-2716"><span class="linenos">2716</span></a><span class="sd">        &gt;&gt;&gt; from sympy import zoo, log, sin, sqrt</span>
</span><span id="Expr.is_meromorphic-2717"><a href="#Expr.is_meromorphic-2717"><span class="linenos">2717</span></a><span class="sd">        &gt;&gt;&gt; from sympy.abc import x</span>
</span><span id="Expr.is_meromorphic-2718"><a href="#Expr.is_meromorphic-2718"><span class="linenos">2718</span></a>
</span><span id="Expr.is_meromorphic-2719"><a href="#Expr.is_meromorphic-2719"><span class="linenos">2719</span></a><span class="sd">        &gt;&gt;&gt; f = 1/x**2 + 1 - 2*x**3</span>
</span><span id="Expr.is_meromorphic-2720"><a href="#Expr.is_meromorphic-2720"><span class="linenos">2720</span></a><span class="sd">        &gt;&gt;&gt; f.is_meromorphic(x, 0)</span>
</span><span id="Expr.is_meromorphic-2721"><a href="#Expr.is_meromorphic-2721"><span class="linenos">2721</span></a><span class="sd">        True</span>
</span><span id="Expr.is_meromorphic-2722"><a href="#Expr.is_meromorphic-2722"><span class="linenos">2722</span></a><span class="sd">        &gt;&gt;&gt; f.is_meromorphic(x, 1)</span>
</span><span id="Expr.is_meromorphic-2723"><a href="#Expr.is_meromorphic-2723"><span class="linenos">2723</span></a><span class="sd">        True</span>
</span><span id="Expr.is_meromorphic-2724"><a href="#Expr.is_meromorphic-2724"><span class="linenos">2724</span></a><span class="sd">        &gt;&gt;&gt; f.is_meromorphic(x, zoo)</span>
</span><span id="Expr.is_meromorphic-2725"><a href="#Expr.is_meromorphic-2725"><span class="linenos">2725</span></a><span class="sd">        True</span>
</span><span id="Expr.is_meromorphic-2726"><a href="#Expr.is_meromorphic-2726"><span class="linenos">2726</span></a>
</span><span id="Expr.is_meromorphic-2727"><a href="#Expr.is_meromorphic-2727"><span class="linenos">2727</span></a><span class="sd">        &gt;&gt;&gt; g = x**log(3)</span>
</span><span id="Expr.is_meromorphic-2728"><a href="#Expr.is_meromorphic-2728"><span class="linenos">2728</span></a><span class="sd">        &gt;&gt;&gt; g.is_meromorphic(x, 0)</span>
</span><span id="Expr.is_meromorphic-2729"><a href="#Expr.is_meromorphic-2729"><span class="linenos">2729</span></a><span class="sd">        False</span>
</span><span id="Expr.is_meromorphic-2730"><a href="#Expr.is_meromorphic-2730"><span class="linenos">2730</span></a><span class="sd">        &gt;&gt;&gt; g.is_meromorphic(x, 1)</span>
</span><span id="Expr.is_meromorphic-2731"><a href="#Expr.is_meromorphic-2731"><span class="linenos">2731</span></a><span class="sd">        True</span>
</span><span id="Expr.is_meromorphic-2732"><a href="#Expr.is_meromorphic-2732"><span class="linenos">2732</span></a><span class="sd">        &gt;&gt;&gt; g.is_meromorphic(x, zoo)</span>
</span><span id="Expr.is_meromorphic-2733"><a href="#Expr.is_meromorphic-2733"><span class="linenos">2733</span></a><span class="sd">        False</span>
</span><span id="Expr.is_meromorphic-2734"><a href="#Expr.is_meromorphic-2734"><span class="linenos">2734</span></a>
</span><span id="Expr.is_meromorphic-2735"><a href="#Expr.is_meromorphic-2735"><span class="linenos">2735</span></a><span class="sd">        &gt;&gt;&gt; h = sin(1/x)*x**2</span>
</span><span id="Expr.is_meromorphic-2736"><a href="#Expr.is_meromorphic-2736"><span class="linenos">2736</span></a><span class="sd">        &gt;&gt;&gt; h.is_meromorphic(x, 0)</span>
</span><span id="Expr.is_meromorphic-2737"><a href="#Expr.is_meromorphic-2737"><span class="linenos">2737</span></a><span class="sd">        False</span>
</span><span id="Expr.is_meromorphic-2738"><a href="#Expr.is_meromorphic-2738"><span class="linenos">2738</span></a><span class="sd">        &gt;&gt;&gt; h.is_meromorphic(x, 1)</span>
</span><span id="Expr.is_meromorphic-2739"><a href="#Expr.is_meromorphic-2739"><span class="linenos">2739</span></a><span class="sd">        True</span>
</span><span id="Expr.is_meromorphic-2740"><a href="#Expr.is_meromorphic-2740"><span class="linenos">2740</span></a><span class="sd">        &gt;&gt;&gt; h.is_meromorphic(x, zoo)</span>
</span><span id="Expr.is_meromorphic-2741"><a href="#Expr.is_meromorphic-2741"><span class="linenos">2741</span></a><span class="sd">        True</span>
</span><span id="Expr.is_meromorphic-2742"><a href="#Expr.is_meromorphic-2742"><span class="linenos">2742</span></a>
</span><span id="Expr.is_meromorphic-2743"><a href="#Expr.is_meromorphic-2743"><span class="linenos">2743</span></a><span class="sd">        Multivalued functions are considered meromorphic when their</span>
</span><span id="Expr.is_meromorphic-2744"><a href="#Expr.is_meromorphic-2744"><span class="linenos">2744</span></a><span class="sd">        branches are meromorphic. Thus most functions are meromorphic</span>
</span><span id="Expr.is_meromorphic-2745"><a href="#Expr.is_meromorphic-2745"><span class="linenos">2745</span></a><span class="sd">        everywhere except at essential singularities and branch points.</span>
</span><span id="Expr.is_meromorphic-2746"><a href="#Expr.is_meromorphic-2746"><span class="linenos">2746</span></a><span class="sd">        In particular, they will be meromorphic also on branch cuts</span>
</span><span id="Expr.is_meromorphic-2747"><a href="#Expr.is_meromorphic-2747"><span class="linenos">2747</span></a><span class="sd">        except at their endpoints.</span>
</span><span id="Expr.is_meromorphic-2748"><a href="#Expr.is_meromorphic-2748"><span class="linenos">2748</span></a>
</span><span id="Expr.is_meromorphic-2749"><a href="#Expr.is_meromorphic-2749"><span class="linenos">2749</span></a><span class="sd">        &gt;&gt;&gt; log(x).is_meromorphic(x, -1)</span>
</span><span id="Expr.is_meromorphic-2750"><a href="#Expr.is_meromorphic-2750"><span class="linenos">2750</span></a><span class="sd">        True</span>
</span><span id="Expr.is_meromorphic-2751"><a href="#Expr.is_meromorphic-2751"><span class="linenos">2751</span></a><span class="sd">        &gt;&gt;&gt; log(x).is_meromorphic(x, 0)</span>
</span><span id="Expr.is_meromorphic-2752"><a href="#Expr.is_meromorphic-2752"><span class="linenos">2752</span></a><span class="sd">        False</span>
</span><span id="Expr.is_meromorphic-2753"><a href="#Expr.is_meromorphic-2753"><span class="linenos">2753</span></a><span class="sd">        &gt;&gt;&gt; sqrt(x).is_meromorphic(x, -1)</span>
</span><span id="Expr.is_meromorphic-2754"><a href="#Expr.is_meromorphic-2754"><span class="linenos">2754</span></a><span class="sd">        True</span>
</span><span id="Expr.is_meromorphic-2755"><a href="#Expr.is_meromorphic-2755"><span class="linenos">2755</span></a><span class="sd">        &gt;&gt;&gt; sqrt(x).is_meromorphic(x, 0)</span>
</span><span id="Expr.is_meromorphic-2756"><a href="#Expr.is_meromorphic-2756"><span class="linenos">2756</span></a><span class="sd">        False</span>
</span><span id="Expr.is_meromorphic-2757"><a href="#Expr.is_meromorphic-2757"><span class="linenos">2757</span></a>
</span><span id="Expr.is_meromorphic-2758"><a href="#Expr.is_meromorphic-2758"><span class="linenos">2758</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Expr.is_meromorphic-2759"><a href="#Expr.is_meromorphic-2759"><span class="linenos">2759</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">x</span><span class="o">.</span><span class="n">is_symbol</span><span class="p">:</span>
</span><span id="Expr.is_meromorphic-2760"><a href="#Expr.is_meromorphic-2760"><span class="linenos">2760</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> should be of symbol type&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</span><span id="Expr.is_meromorphic-2761"><a href="#Expr.is_meromorphic-2761"><span class="linenos">2761</span></a>        <span class="n">a</span> <span class="o">=</span> <span class="n">sympify</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</span><span id="Expr.is_meromorphic-2762"><a href="#Expr.is_meromorphic-2762"><span class="linenos">2762</span></a>
</span><span id="Expr.is_meromorphic-2763"><a href="#Expr.is_meromorphic-2763"><span class="linenos">2763</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_eval_is_meromorphic</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>This tests whether an expression is meromorphic as
a function of the given symbol <code>x</code> at the point <code>a</code>.</p>

<p>This method is intended as a quick test that will return
None if no decision can be made without simplification or
more detailed analysis.</p>

<h1 id="examples">Examples</h1>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">zoo</span><span class="p">,</span> <span class="n">log</span><span class="p">,</span> <span class="n">sin</span><span class="p">,</span> <span class="n">sqrt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.abc</span> <span class="kn">import</span> <span class="n">x</span>
</code></pre>
</div>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">is_meromorphic</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">is_meromorphic</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">is_meromorphic</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">zoo</span><span class="p">)</span>
<span class="go">True</span>
</code></pre>
</div>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">g</span> <span class="o">=</span> <span class="n">x</span><span class="o">**</span><span class="n">log</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span><span class="o">.</span><span class="n">is_meromorphic</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span><span class="o">.</span><span class="n">is_meromorphic</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span><span class="o">.</span><span class="n">is_meromorphic</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">zoo</span><span class="p">)</span>
<span class="go">False</span>
</code></pre>
</div>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">h</span> <span class="o">=</span> <span class="n">sin</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">h</span><span class="o">.</span><span class="n">is_meromorphic</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">h</span><span class="o">.</span><span class="n">is_meromorphic</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">h</span><span class="o">.</span><span class="n">is_meromorphic</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">zoo</span><span class="p">)</span>
<span class="go">True</span>
</code></pre>
</div>

<p>Multivalued functions are considered meromorphic when their
branches are meromorphic. Thus most functions are meromorphic
everywhere except at essential singularities and branch points.
In particular, they will be meromorphic also on branch cuts
except at their endpoints.</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">is_meromorphic</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">is_meromorphic</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">is_meromorphic</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">is_meromorphic</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="go">False</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="Expr.is_algebraic_expr" class="classattr">
                                        <input id="Expr.is_algebraic_expr-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">is_algebraic_expr</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="o">*</span><span class="n">syms</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Expr.is_algebraic_expr-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Expr.is_algebraic_expr"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Expr.is_algebraic_expr-2772"><a href="#Expr.is_algebraic_expr-2772"><span class="linenos">2772</span></a>    <span class="k">def</span> <span class="nf">is_algebraic_expr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">syms</span><span class="p">):</span>
</span><span id="Expr.is_algebraic_expr-2773"><a href="#Expr.is_algebraic_expr-2773"><span class="linenos">2773</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Expr.is_algebraic_expr-2774"><a href="#Expr.is_algebraic_expr-2774"><span class="linenos">2774</span></a><span class="sd">        This tests whether a given expression is algebraic or not, in the</span>
</span><span id="Expr.is_algebraic_expr-2775"><a href="#Expr.is_algebraic_expr-2775"><span class="linenos">2775</span></a><span class="sd">        given symbols, syms. When syms is not given, all free symbols</span>
</span><span id="Expr.is_algebraic_expr-2776"><a href="#Expr.is_algebraic_expr-2776"><span class="linenos">2776</span></a><span class="sd">        will be used. The rational function does not have to be in expanded</span>
</span><span id="Expr.is_algebraic_expr-2777"><a href="#Expr.is_algebraic_expr-2777"><span class="linenos">2777</span></a><span class="sd">        or in any kind of canonical form.</span>
</span><span id="Expr.is_algebraic_expr-2778"><a href="#Expr.is_algebraic_expr-2778"><span class="linenos">2778</span></a>
</span><span id="Expr.is_algebraic_expr-2779"><a href="#Expr.is_algebraic_expr-2779"><span class="linenos">2779</span></a><span class="sd">        This function returns False for expressions that are &quot;algebraic</span>
</span><span id="Expr.is_algebraic_expr-2780"><a href="#Expr.is_algebraic_expr-2780"><span class="linenos">2780</span></a><span class="sd">        expressions&quot; with symbolic exponents. This is a simple extension to the</span>
</span><span id="Expr.is_algebraic_expr-2781"><a href="#Expr.is_algebraic_expr-2781"><span class="linenos">2781</span></a><span class="sd">        is_rational_function, including rational exponentiation.</span>
</span><span id="Expr.is_algebraic_expr-2782"><a href="#Expr.is_algebraic_expr-2782"><span class="linenos">2782</span></a>
</span><span id="Expr.is_algebraic_expr-2783"><a href="#Expr.is_algebraic_expr-2783"><span class="linenos">2783</span></a><span class="sd">        Examples</span>
</span><span id="Expr.is_algebraic_expr-2784"><a href="#Expr.is_algebraic_expr-2784"><span class="linenos">2784</span></a><span class="sd">        ========</span>
</span><span id="Expr.is_algebraic_expr-2785"><a href="#Expr.is_algebraic_expr-2785"><span class="linenos">2785</span></a>
</span><span id="Expr.is_algebraic_expr-2786"><a href="#Expr.is_algebraic_expr-2786"><span class="linenos">2786</span></a><span class="sd">        &gt;&gt;&gt; from sympy import Symbol, sqrt</span>
</span><span id="Expr.is_algebraic_expr-2787"><a href="#Expr.is_algebraic_expr-2787"><span class="linenos">2787</span></a><span class="sd">        &gt;&gt;&gt; x = Symbol(&#39;x&#39;, real=True)</span>
</span><span id="Expr.is_algebraic_expr-2788"><a href="#Expr.is_algebraic_expr-2788"><span class="linenos">2788</span></a><span class="sd">        &gt;&gt;&gt; sqrt(1 + x).is_rational_function()</span>
</span><span id="Expr.is_algebraic_expr-2789"><a href="#Expr.is_algebraic_expr-2789"><span class="linenos">2789</span></a><span class="sd">        False</span>
</span><span id="Expr.is_algebraic_expr-2790"><a href="#Expr.is_algebraic_expr-2790"><span class="linenos">2790</span></a><span class="sd">        &gt;&gt;&gt; sqrt(1 + x).is_algebraic_expr()</span>
</span><span id="Expr.is_algebraic_expr-2791"><a href="#Expr.is_algebraic_expr-2791"><span class="linenos">2791</span></a><span class="sd">        True</span>
</span><span id="Expr.is_algebraic_expr-2792"><a href="#Expr.is_algebraic_expr-2792"><span class="linenos">2792</span></a>
</span><span id="Expr.is_algebraic_expr-2793"><a href="#Expr.is_algebraic_expr-2793"><span class="linenos">2793</span></a><span class="sd">        This function does not attempt any nontrivial simplifications that may</span>
</span><span id="Expr.is_algebraic_expr-2794"><a href="#Expr.is_algebraic_expr-2794"><span class="linenos">2794</span></a><span class="sd">        result in an expression that does not appear to be an algebraic</span>
</span><span id="Expr.is_algebraic_expr-2795"><a href="#Expr.is_algebraic_expr-2795"><span class="linenos">2795</span></a><span class="sd">        expression to become one.</span>
</span><span id="Expr.is_algebraic_expr-2796"><a href="#Expr.is_algebraic_expr-2796"><span class="linenos">2796</span></a>
</span><span id="Expr.is_algebraic_expr-2797"><a href="#Expr.is_algebraic_expr-2797"><span class="linenos">2797</span></a><span class="sd">        &gt;&gt;&gt; from sympy import exp, factor</span>
</span><span id="Expr.is_algebraic_expr-2798"><a href="#Expr.is_algebraic_expr-2798"><span class="linenos">2798</span></a><span class="sd">        &gt;&gt;&gt; a = sqrt(exp(x)**2 + 2*exp(x) + 1)/(exp(x) + 1)</span>
</span><span id="Expr.is_algebraic_expr-2799"><a href="#Expr.is_algebraic_expr-2799"><span class="linenos">2799</span></a><span class="sd">        &gt;&gt;&gt; a.is_algebraic_expr(x)</span>
</span><span id="Expr.is_algebraic_expr-2800"><a href="#Expr.is_algebraic_expr-2800"><span class="linenos">2800</span></a><span class="sd">        False</span>
</span><span id="Expr.is_algebraic_expr-2801"><a href="#Expr.is_algebraic_expr-2801"><span class="linenos">2801</span></a><span class="sd">        &gt;&gt;&gt; factor(a).is_algebraic_expr()</span>
</span><span id="Expr.is_algebraic_expr-2802"><a href="#Expr.is_algebraic_expr-2802"><span class="linenos">2802</span></a><span class="sd">        True</span>
</span><span id="Expr.is_algebraic_expr-2803"><a href="#Expr.is_algebraic_expr-2803"><span class="linenos">2803</span></a>
</span><span id="Expr.is_algebraic_expr-2804"><a href="#Expr.is_algebraic_expr-2804"><span class="linenos">2804</span></a><span class="sd">        See Also</span>
</span><span id="Expr.is_algebraic_expr-2805"><a href="#Expr.is_algebraic_expr-2805"><span class="linenos">2805</span></a><span class="sd">        ========</span>
</span><span id="Expr.is_algebraic_expr-2806"><a href="#Expr.is_algebraic_expr-2806"><span class="linenos">2806</span></a><span class="sd">        is_rational_function()</span>
</span><span id="Expr.is_algebraic_expr-2807"><a href="#Expr.is_algebraic_expr-2807"><span class="linenos">2807</span></a>
</span><span id="Expr.is_algebraic_expr-2808"><a href="#Expr.is_algebraic_expr-2808"><span class="linenos">2808</span></a><span class="sd">        References</span>
</span><span id="Expr.is_algebraic_expr-2809"><a href="#Expr.is_algebraic_expr-2809"><span class="linenos">2809</span></a><span class="sd">        ==========</span>
</span><span id="Expr.is_algebraic_expr-2810"><a href="#Expr.is_algebraic_expr-2810"><span class="linenos">2810</span></a>
</span><span id="Expr.is_algebraic_expr-2811"><a href="#Expr.is_algebraic_expr-2811"><span class="linenos">2811</span></a><span class="sd">        .. [1] https://en.wikipedia.org/wiki/Algebraic_expression</span>
</span><span id="Expr.is_algebraic_expr-2812"><a href="#Expr.is_algebraic_expr-2812"><span class="linenos">2812</span></a>
</span><span id="Expr.is_algebraic_expr-2813"><a href="#Expr.is_algebraic_expr-2813"><span class="linenos">2813</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Expr.is_algebraic_expr-2814"><a href="#Expr.is_algebraic_expr-2814"><span class="linenos">2814</span></a>        <span class="k">if</span> <span class="n">syms</span><span class="p">:</span>
</span><span id="Expr.is_algebraic_expr-2815"><a href="#Expr.is_algebraic_expr-2815"><span class="linenos">2815</span></a>            <span class="n">syms</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">sympify</span><span class="p">,</span> <span class="n">syms</span><span class="p">))</span>
</span><span id="Expr.is_algebraic_expr-2816"><a href="#Expr.is_algebraic_expr-2816"><span class="linenos">2816</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Expr.is_algebraic_expr-2817"><a href="#Expr.is_algebraic_expr-2817"><span class="linenos">2817</span></a>            <span class="n">syms</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">free_symbols</span>
</span><span id="Expr.is_algebraic_expr-2818"><a href="#Expr.is_algebraic_expr-2818"><span class="linenos">2818</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">syms</span><span class="p">:</span>
</span><span id="Expr.is_algebraic_expr-2819"><a href="#Expr.is_algebraic_expr-2819"><span class="linenos">2819</span></a>                <span class="k">return</span> <span class="kc">True</span>
</span><span id="Expr.is_algebraic_expr-2820"><a href="#Expr.is_algebraic_expr-2820"><span class="linenos">2820</span></a>
</span><span id="Expr.is_algebraic_expr-2821"><a href="#Expr.is_algebraic_expr-2821"><span class="linenos">2821</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_eval_is_algebraic_expr</span><span class="p">(</span><span class="n">syms</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>This tests whether a given expression is algebraic or not, in the
given symbols, syms. When syms is not given, all free symbols
will be used. The rational function does not have to be in expanded
or in any kind of canonical form.</p>

<p>This function returns False for expressions that are "algebraic
expressions" with symbolic exponents. This is a simple extension to the
is_rational_function, including rational exponentiation.</p>

<h1 id="examples">Examples</h1>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">Symbol</span><span class="p">,</span> <span class="n">sqrt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">Symbol</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">real</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">is_rational_function</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">is_algebraic_expr</span><span class="p">()</span>
<span class="go">True</span>
</code></pre>
</div>

<p>This function does not attempt any nontrivial simplifications that may
result in an expression that does not appear to be an algebraic
expression to become one.</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">exp</span><span class="p">,</span> <span class="n">factor</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">is_algebraic_expr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">factor</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">is_algebraic_expr</span><span class="p">()</span>
<span class="go">True</span>
</code></pre>
</div>

<h1 id="see-also">See Also</h1>

<p>is_rational_function()</p>

<h1 id="references">References</h1>

<div class="footnotes">
<hr />
<ol>
</ol>
</div>
</div>


                            </div>
                            <div id="Expr.series" class="classattr">
                                        <input id="Expr.series-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">series</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">x</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="n">x0</span><span class="o">=</span><span class="mi">0</span>, </span><span class="param"><span class="n">n</span><span class="o">=</span><span class="mi">6</span>, </span><span class="param"><span class="nb">dir</span><span class="o">=</span><span class="s1">&#39;+&#39;</span>, </span><span class="param"><span class="n">logx</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="n">cdir</span><span class="o">=</span><span class="mi">0</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Expr.series-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Expr.series"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Expr.series-2834"><a href="#Expr.series-2834"><span class="linenos">2834</span></a>    <span class="k">def</span> <span class="nf">series</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="nb">dir</span><span class="o">=</span><span class="s2">&quot;+&quot;</span><span class="p">,</span> <span class="n">logx</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cdir</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
</span><span id="Expr.series-2835"><a href="#Expr.series-2835"><span class="linenos">2835</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Expr.series-2836"><a href="#Expr.series-2836"><span class="linenos">2836</span></a><span class="sd">        Series expansion of &quot;self&quot; around ``x = x0`` yielding either terms of</span>
</span><span id="Expr.series-2837"><a href="#Expr.series-2837"><span class="linenos">2837</span></a><span class="sd">        the series one by one (the lazy series given when n=None), else</span>
</span><span id="Expr.series-2838"><a href="#Expr.series-2838"><span class="linenos">2838</span></a><span class="sd">        all the terms at once when n != None.</span>
</span><span id="Expr.series-2839"><a href="#Expr.series-2839"><span class="linenos">2839</span></a>
</span><span id="Expr.series-2840"><a href="#Expr.series-2840"><span class="linenos">2840</span></a><span class="sd">        Returns the series expansion of &quot;self&quot; around the point ``x = x0``</span>
</span><span id="Expr.series-2841"><a href="#Expr.series-2841"><span class="linenos">2841</span></a><span class="sd">        with respect to ``x`` up to ``O((x - x0)**n, x, x0)`` (default n is 6).</span>
</span><span id="Expr.series-2842"><a href="#Expr.series-2842"><span class="linenos">2842</span></a>
</span><span id="Expr.series-2843"><a href="#Expr.series-2843"><span class="linenos">2843</span></a><span class="sd">        If ``x=None`` and ``self`` is univariate, the univariate symbol will</span>
</span><span id="Expr.series-2844"><a href="#Expr.series-2844"><span class="linenos">2844</span></a><span class="sd">        be supplied, otherwise an error will be raised.</span>
</span><span id="Expr.series-2845"><a href="#Expr.series-2845"><span class="linenos">2845</span></a>
</span><span id="Expr.series-2846"><a href="#Expr.series-2846"><span class="linenos">2846</span></a><span class="sd">        Parameters</span>
</span><span id="Expr.series-2847"><a href="#Expr.series-2847"><span class="linenos">2847</span></a><span class="sd">        ==========</span>
</span><span id="Expr.series-2848"><a href="#Expr.series-2848"><span class="linenos">2848</span></a>
</span><span id="Expr.series-2849"><a href="#Expr.series-2849"><span class="linenos">2849</span></a><span class="sd">        expr : Expression</span>
</span><span id="Expr.series-2850"><a href="#Expr.series-2850"><span class="linenos">2850</span></a><span class="sd">               The expression whose series is to be expanded.</span>
</span><span id="Expr.series-2851"><a href="#Expr.series-2851"><span class="linenos">2851</span></a>
</span><span id="Expr.series-2852"><a href="#Expr.series-2852"><span class="linenos">2852</span></a><span class="sd">        x : Symbol</span>
</span><span id="Expr.series-2853"><a href="#Expr.series-2853"><span class="linenos">2853</span></a><span class="sd">            It is the variable of the expression to be calculated.</span>
</span><span id="Expr.series-2854"><a href="#Expr.series-2854"><span class="linenos">2854</span></a>
</span><span id="Expr.series-2855"><a href="#Expr.series-2855"><span class="linenos">2855</span></a><span class="sd">        x0 : Value</span>
</span><span id="Expr.series-2856"><a href="#Expr.series-2856"><span class="linenos">2856</span></a><span class="sd">             The value around which ``x`` is calculated. Can be any value</span>
</span><span id="Expr.series-2857"><a href="#Expr.series-2857"><span class="linenos">2857</span></a><span class="sd">             from ``-oo`` to ``oo``.</span>
</span><span id="Expr.series-2858"><a href="#Expr.series-2858"><span class="linenos">2858</span></a>
</span><span id="Expr.series-2859"><a href="#Expr.series-2859"><span class="linenos">2859</span></a><span class="sd">        n : Value</span>
</span><span id="Expr.series-2860"><a href="#Expr.series-2860"><span class="linenos">2860</span></a><span class="sd">            The number of terms upto which the series is to be expanded.</span>
</span><span id="Expr.series-2861"><a href="#Expr.series-2861"><span class="linenos">2861</span></a>
</span><span id="Expr.series-2862"><a href="#Expr.series-2862"><span class="linenos">2862</span></a><span class="sd">        dir : String, optional</span>
</span><span id="Expr.series-2863"><a href="#Expr.series-2863"><span class="linenos">2863</span></a><span class="sd">              The series-expansion can be bi-directional. If ``dir=&quot;+&quot;``,</span>
</span><span id="Expr.series-2864"><a href="#Expr.series-2864"><span class="linenos">2864</span></a><span class="sd">              then (x-&gt;x0+). If ``dir=&quot;-&quot;, then (x-&gt;x0-). For infinite</span>
</span><span id="Expr.series-2865"><a href="#Expr.series-2865"><span class="linenos">2865</span></a><span class="sd">              ``x0`` (``oo`` or ``-oo``), the ``dir`` argument is determined</span>
</span><span id="Expr.series-2866"><a href="#Expr.series-2866"><span class="linenos">2866</span></a><span class="sd">              from the direction of the infinity (i.e., ``dir=&quot;-&quot;`` for</span>
</span><span id="Expr.series-2867"><a href="#Expr.series-2867"><span class="linenos">2867</span></a><span class="sd">              ``oo``).</span>
</span><span id="Expr.series-2868"><a href="#Expr.series-2868"><span class="linenos">2868</span></a>
</span><span id="Expr.series-2869"><a href="#Expr.series-2869"><span class="linenos">2869</span></a><span class="sd">        logx : optional</span>
</span><span id="Expr.series-2870"><a href="#Expr.series-2870"><span class="linenos">2870</span></a><span class="sd">               It is used to replace any log(x) in the returned series with a</span>
</span><span id="Expr.series-2871"><a href="#Expr.series-2871"><span class="linenos">2871</span></a><span class="sd">               symbolic value rather than evaluating the actual value.</span>
</span><span id="Expr.series-2872"><a href="#Expr.series-2872"><span class="linenos">2872</span></a>
</span><span id="Expr.series-2873"><a href="#Expr.series-2873"><span class="linenos">2873</span></a><span class="sd">        cdir : optional</span>
</span><span id="Expr.series-2874"><a href="#Expr.series-2874"><span class="linenos">2874</span></a><span class="sd">               It stands for complex direction, and indicates the direction</span>
</span><span id="Expr.series-2875"><a href="#Expr.series-2875"><span class="linenos">2875</span></a><span class="sd">               from which the expansion needs to be evaluated.</span>
</span><span id="Expr.series-2876"><a href="#Expr.series-2876"><span class="linenos">2876</span></a>
</span><span id="Expr.series-2877"><a href="#Expr.series-2877"><span class="linenos">2877</span></a><span class="sd">        Examples</span>
</span><span id="Expr.series-2878"><a href="#Expr.series-2878"><span class="linenos">2878</span></a><span class="sd">        ========</span>
</span><span id="Expr.series-2879"><a href="#Expr.series-2879"><span class="linenos">2879</span></a>
</span><span id="Expr.series-2880"><a href="#Expr.series-2880"><span class="linenos">2880</span></a><span class="sd">        &gt;&gt;&gt; from sympy import cos, exp, tan</span>
</span><span id="Expr.series-2881"><a href="#Expr.series-2881"><span class="linenos">2881</span></a><span class="sd">        &gt;&gt;&gt; from sympy.abc import x, y</span>
</span><span id="Expr.series-2882"><a href="#Expr.series-2882"><span class="linenos">2882</span></a><span class="sd">        &gt;&gt;&gt; cos(x).series()</span>
</span><span id="Expr.series-2883"><a href="#Expr.series-2883"><span class="linenos">2883</span></a><span class="sd">        1 - x**2/2 + x**4/24 + O(x**6)</span>
</span><span id="Expr.series-2884"><a href="#Expr.series-2884"><span class="linenos">2884</span></a><span class="sd">        &gt;&gt;&gt; cos(x).series(n=4)</span>
</span><span id="Expr.series-2885"><a href="#Expr.series-2885"><span class="linenos">2885</span></a><span class="sd">        1 - x**2/2 + O(x**4)</span>
</span><span id="Expr.series-2886"><a href="#Expr.series-2886"><span class="linenos">2886</span></a><span class="sd">        &gt;&gt;&gt; cos(x).series(x, x0=1, n=2)</span>
</span><span id="Expr.series-2887"><a href="#Expr.series-2887"><span class="linenos">2887</span></a><span class="sd">        cos(1) - (x - 1)*sin(1) + O((x - 1)**2, (x, 1))</span>
</span><span id="Expr.series-2888"><a href="#Expr.series-2888"><span class="linenos">2888</span></a><span class="sd">        &gt;&gt;&gt; e = cos(x + exp(y))</span>
</span><span id="Expr.series-2889"><a href="#Expr.series-2889"><span class="linenos">2889</span></a><span class="sd">        &gt;&gt;&gt; e.series(y, n=2)</span>
</span><span id="Expr.series-2890"><a href="#Expr.series-2890"><span class="linenos">2890</span></a><span class="sd">        cos(x + 1) - y*sin(x + 1) + O(y**2)</span>
</span><span id="Expr.series-2891"><a href="#Expr.series-2891"><span class="linenos">2891</span></a><span class="sd">        &gt;&gt;&gt; e.series(x, n=2)</span>
</span><span id="Expr.series-2892"><a href="#Expr.series-2892"><span class="linenos">2892</span></a><span class="sd">        cos(exp(y)) - x*sin(exp(y)) + O(x**2)</span>
</span><span id="Expr.series-2893"><a href="#Expr.series-2893"><span class="linenos">2893</span></a>
</span><span id="Expr.series-2894"><a href="#Expr.series-2894"><span class="linenos">2894</span></a><span class="sd">        If ``n=None`` then a generator of the series terms will be returned.</span>
</span><span id="Expr.series-2895"><a href="#Expr.series-2895"><span class="linenos">2895</span></a>
</span><span id="Expr.series-2896"><a href="#Expr.series-2896"><span class="linenos">2896</span></a><span class="sd">        &gt;&gt;&gt; term=cos(x).series(n=None)</span>
</span><span id="Expr.series-2897"><a href="#Expr.series-2897"><span class="linenos">2897</span></a><span class="sd">        &gt;&gt;&gt; [next(term) for i in range(2)]</span>
</span><span id="Expr.series-2898"><a href="#Expr.series-2898"><span class="linenos">2898</span></a><span class="sd">        [1, -x**2/2]</span>
</span><span id="Expr.series-2899"><a href="#Expr.series-2899"><span class="linenos">2899</span></a>
</span><span id="Expr.series-2900"><a href="#Expr.series-2900"><span class="linenos">2900</span></a><span class="sd">        For ``dir=+`` (default) the series is calculated from the right and</span>
</span><span id="Expr.series-2901"><a href="#Expr.series-2901"><span class="linenos">2901</span></a><span class="sd">        for ``dir=-`` the series from the left. For smooth functions this</span>
</span><span id="Expr.series-2902"><a href="#Expr.series-2902"><span class="linenos">2902</span></a><span class="sd">        flag will not alter the results.</span>
</span><span id="Expr.series-2903"><a href="#Expr.series-2903"><span class="linenos">2903</span></a>
</span><span id="Expr.series-2904"><a href="#Expr.series-2904"><span class="linenos">2904</span></a><span class="sd">        &gt;&gt;&gt; abs(x).series(dir=&quot;+&quot;)</span>
</span><span id="Expr.series-2905"><a href="#Expr.series-2905"><span class="linenos">2905</span></a><span class="sd">        x</span>
</span><span id="Expr.series-2906"><a href="#Expr.series-2906"><span class="linenos">2906</span></a><span class="sd">        &gt;&gt;&gt; abs(x).series(dir=&quot;-&quot;)</span>
</span><span id="Expr.series-2907"><a href="#Expr.series-2907"><span class="linenos">2907</span></a><span class="sd">        -x</span>
</span><span id="Expr.series-2908"><a href="#Expr.series-2908"><span class="linenos">2908</span></a><span class="sd">        &gt;&gt;&gt; f = tan(x)</span>
</span><span id="Expr.series-2909"><a href="#Expr.series-2909"><span class="linenos">2909</span></a><span class="sd">        &gt;&gt;&gt; f.series(x, 2, 6, &quot;+&quot;)</span>
</span><span id="Expr.series-2910"><a href="#Expr.series-2910"><span class="linenos">2910</span></a><span class="sd">        tan(2) + (1 + tan(2)**2)*(x - 2) + (x - 2)**2*(tan(2)**3 + tan(2)) +</span>
</span><span id="Expr.series-2911"><a href="#Expr.series-2911"><span class="linenos">2911</span></a><span class="sd">        (x - 2)**3*(1/3 + 4*tan(2)**2/3 + tan(2)**4) + (x - 2)**4*(tan(2)**5 +</span>
</span><span id="Expr.series-2912"><a href="#Expr.series-2912"><span class="linenos">2912</span></a><span class="sd">        5*tan(2)**3/3 + 2*tan(2)/3) + (x - 2)**5*(2/15 + 17*tan(2)**2/15 +</span>
</span><span id="Expr.series-2913"><a href="#Expr.series-2913"><span class="linenos">2913</span></a><span class="sd">        2*tan(2)**4 + tan(2)**6) + O((x - 2)**6, (x, 2))</span>
</span><span id="Expr.series-2914"><a href="#Expr.series-2914"><span class="linenos">2914</span></a>
</span><span id="Expr.series-2915"><a href="#Expr.series-2915"><span class="linenos">2915</span></a><span class="sd">        &gt;&gt;&gt; f.series(x, 2, 3, &quot;-&quot;)</span>
</span><span id="Expr.series-2916"><a href="#Expr.series-2916"><span class="linenos">2916</span></a><span class="sd">        tan(2) + (2 - x)*(-tan(2)**2 - 1) + (2 - x)**2*(tan(2)**3 + tan(2))</span>
</span><span id="Expr.series-2917"><a href="#Expr.series-2917"><span class="linenos">2917</span></a><span class="sd">        + O((x - 2)**3, (x, 2))</span>
</span><span id="Expr.series-2918"><a href="#Expr.series-2918"><span class="linenos">2918</span></a>
</span><span id="Expr.series-2919"><a href="#Expr.series-2919"><span class="linenos">2919</span></a><span class="sd">        Returns</span>
</span><span id="Expr.series-2920"><a href="#Expr.series-2920"><span class="linenos">2920</span></a><span class="sd">        =======</span>
</span><span id="Expr.series-2921"><a href="#Expr.series-2921"><span class="linenos">2921</span></a>
</span><span id="Expr.series-2922"><a href="#Expr.series-2922"><span class="linenos">2922</span></a><span class="sd">        Expr : Expression</span>
</span><span id="Expr.series-2923"><a href="#Expr.series-2923"><span class="linenos">2923</span></a><span class="sd">            Series expansion of the expression about x0</span>
</span><span id="Expr.series-2924"><a href="#Expr.series-2924"><span class="linenos">2924</span></a>
</span><span id="Expr.series-2925"><a href="#Expr.series-2925"><span class="linenos">2925</span></a><span class="sd">        Raises</span>
</span><span id="Expr.series-2926"><a href="#Expr.series-2926"><span class="linenos">2926</span></a><span class="sd">        ======</span>
</span><span id="Expr.series-2927"><a href="#Expr.series-2927"><span class="linenos">2927</span></a>
</span><span id="Expr.series-2928"><a href="#Expr.series-2928"><span class="linenos">2928</span></a><span class="sd">        TypeError</span>
</span><span id="Expr.series-2929"><a href="#Expr.series-2929"><span class="linenos">2929</span></a><span class="sd">            If &quot;n&quot; and &quot;x0&quot; are infinity objects</span>
</span><span id="Expr.series-2930"><a href="#Expr.series-2930"><span class="linenos">2930</span></a>
</span><span id="Expr.series-2931"><a href="#Expr.series-2931"><span class="linenos">2931</span></a><span class="sd">        PoleError</span>
</span><span id="Expr.series-2932"><a href="#Expr.series-2932"><span class="linenos">2932</span></a><span class="sd">            If &quot;x0&quot; is an infinity object</span>
</span><span id="Expr.series-2933"><a href="#Expr.series-2933"><span class="linenos">2933</span></a>
</span><span id="Expr.series-2934"><a href="#Expr.series-2934"><span class="linenos">2934</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Expr.series-2935"><a href="#Expr.series-2935"><span class="linenos">2935</span></a>        <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Expr.series-2936"><a href="#Expr.series-2936"><span class="linenos">2936</span></a>            <span class="n">syms</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">free_symbols</span>
</span><span id="Expr.series-2937"><a href="#Expr.series-2937"><span class="linenos">2937</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">syms</span><span class="p">:</span>
</span><span id="Expr.series-2938"><a href="#Expr.series-2938"><span class="linenos">2938</span></a>                <span class="k">return</span> <span class="bp">self</span>
</span><span id="Expr.series-2939"><a href="#Expr.series-2939"><span class="linenos">2939</span></a>            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">syms</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Expr.series-2940"><a href="#Expr.series-2940"><span class="linenos">2940</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;x must be given for multivariate functions.&#39;</span><span class="p">)</span>
</span><span id="Expr.series-2941"><a href="#Expr.series-2941"><span class="linenos">2941</span></a>            <span class="n">x</span> <span class="o">=</span> <span class="n">syms</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
</span><span id="Expr.series-2942"><a href="#Expr.series-2942"><span class="linenos">2942</span></a>
</span><span id="Expr.series-2943"><a href="#Expr.series-2943"><span class="linenos">2943</span></a>        <span class="kn">from</span> <span class="nn">.symbol</span> <span class="kn">import</span> <span class="n">Dummy</span><span class="p">,</span> <span class="n">Symbol</span>
</span><span id="Expr.series-2944"><a href="#Expr.series-2944"><span class="linenos">2944</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Symbol</span><span class="p">):</span>
</span><span id="Expr.series-2945"><a href="#Expr.series-2945"><span class="linenos">2945</span></a>            <span class="n">dep</span> <span class="o">=</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">free_symbols</span>
</span><span id="Expr.series-2946"><a href="#Expr.series-2946"><span class="linenos">2946</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Expr.series-2947"><a href="#Expr.series-2947"><span class="linenos">2947</span></a>            <span class="n">d</span> <span class="o">=</span> <span class="n">Dummy</span><span class="p">()</span>
</span><span id="Expr.series-2948"><a href="#Expr.series-2948"><span class="linenos">2948</span></a>            <span class="n">dep</span> <span class="o">=</span> <span class="n">d</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">xreplace</span><span class="p">({</span><span class="n">x</span><span class="p">:</span> <span class="n">d</span><span class="p">})</span><span class="o">.</span><span class="n">free_symbols</span>
</span><span id="Expr.series-2949"><a href="#Expr.series-2949"><span class="linenos">2949</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">dep</span><span class="p">:</span>
</span><span id="Expr.series-2950"><a href="#Expr.series-2950"><span class="linenos">2950</span></a>            <span class="k">if</span> <span class="n">n</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Expr.series-2951"><a href="#Expr.series-2951"><span class="linenos">2951</span></a>                <span class="k">return</span> <span class="p">(</span><span class="n">s</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="p">[</span><span class="bp">self</span><span class="p">])</span>
</span><span id="Expr.series-2952"><a href="#Expr.series-2952"><span class="linenos">2952</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Expr.series-2953"><a href="#Expr.series-2953"><span class="linenos">2953</span></a>                <span class="k">return</span> <span class="bp">self</span>
</span><span id="Expr.series-2954"><a href="#Expr.series-2954"><span class="linenos">2954</span></a>
</span><span id="Expr.series-2955"><a href="#Expr.series-2955"><span class="linenos">2955</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">dir</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span> <span class="ow">or</span> <span class="nb">dir</span> <span class="ow">not</span> <span class="ow">in</span> <span class="s1">&#39;+-&#39;</span><span class="p">:</span>
</span><span id="Expr.series-2956"><a href="#Expr.series-2956"><span class="linenos">2956</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Dir must be &#39;+&#39; or &#39;-&#39;&quot;</span><span class="p">)</span>
</span><span id="Expr.series-2957"><a href="#Expr.series-2957"><span class="linenos">2957</span></a>
</span><span id="Expr.series-2958"><a href="#Expr.series-2958"><span class="linenos">2958</span></a>        <span class="k">if</span> <span class="n">x0</span> <span class="ow">in</span> <span class="p">[</span><span class="n">S</span><span class="o">.</span><span class="n">Infinity</span><span class="p">,</span> <span class="n">S</span><span class="o">.</span><span class="n">NegativeInfinity</span><span class="p">]:</span>
</span><span id="Expr.series-2959"><a href="#Expr.series-2959"><span class="linenos">2959</span></a>            <span class="kn">from</span> <span class="nn">.function</span> <span class="kn">import</span> <span class="n">PoleError</span>
</span><span id="Expr.series-2960"><a href="#Expr.series-2960"><span class="linenos">2960</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="Expr.series-2961"><a href="#Expr.series-2961"><span class="linenos">2961</span></a>                <span class="n">sgn</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">x0</span> <span class="ow">is</span> <span class="n">S</span><span class="o">.</span><span class="n">Infinity</span> <span class="k">else</span> <span class="o">-</span><span class="mi">1</span>
</span><span id="Expr.series-2962"><a href="#Expr.series-2962"><span class="linenos">2962</span></a>                <span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">sgn</span><span class="o">/</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">series</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="nb">dir</span><span class="o">=</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="n">cdir</span><span class="o">=</span><span class="n">cdir</span><span class="p">)</span>
</span><span id="Expr.series-2963"><a href="#Expr.series-2963"><span class="linenos">2963</span></a>                <span class="k">if</span> <span class="n">n</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Expr.series-2964"><a href="#Expr.series-2964"><span class="linenos">2964</span></a>                    <span class="k">return</span> <span class="p">(</span><span class="n">si</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">sgn</span><span class="o">/</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">si</span> <span class="ow">in</span> <span class="n">s</span><span class="p">)</span>
</span><span id="Expr.series-2965"><a href="#Expr.series-2965"><span class="linenos">2965</span></a>                <span class="k">return</span> <span class="n">s</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">sgn</span><span class="o">/</span><span class="n">x</span><span class="p">)</span>
</span><span id="Expr.series-2966"><a href="#Expr.series-2966"><span class="linenos">2966</span></a>            <span class="k">except</span> <span class="n">PoleError</span><span class="p">:</span>
</span><span id="Expr.series-2967"><a href="#Expr.series-2967"><span class="linenos">2967</span></a>                <span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">sgn</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">aseries</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
</span><span id="Expr.series-2968"><a href="#Expr.series-2968"><span class="linenos">2968</span></a>                <span class="k">return</span> <span class="n">s</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">sgn</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
</span><span id="Expr.series-2969"><a href="#Expr.series-2969"><span class="linenos">2969</span></a>
</span><span id="Expr.series-2970"><a href="#Expr.series-2970"><span class="linenos">2970</span></a>        <span class="c1"># use rep to shift origin to x0 and change sign (if dir is negative)</span>
</span><span id="Expr.series-2971"><a href="#Expr.series-2971"><span class="linenos">2971</span></a>        <span class="c1"># and undo the process with rep2</span>
</span><span id="Expr.series-2972"><a href="#Expr.series-2972"><span class="linenos">2972</span></a>        <span class="k">if</span> <span class="n">x0</span> <span class="ow">or</span> <span class="nb">dir</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span><span class="p">:</span>
</span><span id="Expr.series-2973"><a href="#Expr.series-2973"><span class="linenos">2973</span></a>            <span class="k">if</span> <span class="nb">dir</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span><span class="p">:</span>
</span><span id="Expr.series-2974"><a href="#Expr.series-2974"><span class="linenos">2974</span></a>                <span class="n">rep</span> <span class="o">=</span> <span class="o">-</span><span class="n">x</span> <span class="o">+</span> <span class="n">x0</span>
</span><span id="Expr.series-2975"><a href="#Expr.series-2975"><span class="linenos">2975</span></a>                <span class="n">rep2</span> <span class="o">=</span> <span class="o">-</span><span class="n">x</span>
</span><span id="Expr.series-2976"><a href="#Expr.series-2976"><span class="linenos">2976</span></a>                <span class="n">rep2b</span> <span class="o">=</span> <span class="n">x0</span>
</span><span id="Expr.series-2977"><a href="#Expr.series-2977"><span class="linenos">2977</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Expr.series-2978"><a href="#Expr.series-2978"><span class="linenos">2978</span></a>                <span class="n">rep</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">x0</span>
</span><span id="Expr.series-2979"><a href="#Expr.series-2979"><span class="linenos">2979</span></a>                <span class="n">rep2</span> <span class="o">=</span> <span class="n">x</span>
</span><span id="Expr.series-2980"><a href="#Expr.series-2980"><span class="linenos">2980</span></a>                <span class="n">rep2b</span> <span class="o">=</span> <span class="o">-</span><span class="n">x0</span>
</span><span id="Expr.series-2981"><a href="#Expr.series-2981"><span class="linenos">2981</span></a>            <span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">rep</span><span class="p">)</span><span class="o">.</span><span class="n">series</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="nb">dir</span><span class="o">=</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="n">logx</span><span class="o">=</span><span class="n">logx</span><span class="p">,</span> <span class="n">cdir</span><span class="o">=</span><span class="n">cdir</span><span class="p">)</span>
</span><span id="Expr.series-2982"><a href="#Expr.series-2982"><span class="linenos">2982</span></a>            <span class="k">if</span> <span class="n">n</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># lseries...</span>
</span><span id="Expr.series-2983"><a href="#Expr.series-2983"><span class="linenos">2983</span></a>                <span class="k">return</span> <span class="p">(</span><span class="n">si</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">rep2</span> <span class="o">+</span> <span class="n">rep2b</span><span class="p">)</span> <span class="k">for</span> <span class="n">si</span> <span class="ow">in</span> <span class="n">s</span><span class="p">)</span>
</span><span id="Expr.series-2984"><a href="#Expr.series-2984"><span class="linenos">2984</span></a>            <span class="k">return</span> <span class="n">s</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">rep2</span> <span class="o">+</span> <span class="n">rep2b</span><span class="p">)</span>
</span><span id="Expr.series-2985"><a href="#Expr.series-2985"><span class="linenos">2985</span></a>
</span><span id="Expr.series-2986"><a href="#Expr.series-2986"><span class="linenos">2986</span></a>        <span class="c1"># from here on it&#39;s x0=0 and dir=&#39;+&#39; handling</span>
</span><span id="Expr.series-2987"><a href="#Expr.series-2987"><span class="linenos">2987</span></a>
</span><span id="Expr.series-2988"><a href="#Expr.series-2988"><span class="linenos">2988</span></a>        <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">is_positive</span> <span class="ow">is</span> <span class="n">x</span><span class="o">.</span><span class="n">is_negative</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">x</span><span class="o">.</span><span class="n">is_Symbol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="Expr.series-2989"><a href="#Expr.series-2989"><span class="linenos">2989</span></a>            <span class="c1"># replace x with an x that has a positive assumption</span>
</span><span id="Expr.series-2990"><a href="#Expr.series-2990"><span class="linenos">2990</span></a>            <span class="n">xpos</span> <span class="o">=</span> <span class="n">Dummy</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">positive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="Expr.series-2991"><a href="#Expr.series-2991"><span class="linenos">2991</span></a>            <span class="n">rv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">xpos</span><span class="p">)</span><span class="o">.</span><span class="n">series</span><span class="p">(</span><span class="n">xpos</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="nb">dir</span><span class="p">,</span> <span class="n">logx</span><span class="o">=</span><span class="n">logx</span><span class="p">,</span> <span class="n">cdir</span><span class="o">=</span><span class="n">cdir</span><span class="p">)</span>
</span><span id="Expr.series-2992"><a href="#Expr.series-2992"><span class="linenos">2992</span></a>            <span class="k">if</span> <span class="n">n</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Expr.series-2993"><a href="#Expr.series-2993"><span class="linenos">2993</span></a>                <span class="k">return</span> <span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">xpos</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">rv</span><span class="p">)</span>
</span><span id="Expr.series-2994"><a href="#Expr.series-2994"><span class="linenos">2994</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Expr.series-2995"><a href="#Expr.series-2995"><span class="linenos">2995</span></a>                <span class="k">return</span> <span class="n">rv</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">xpos</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</span><span id="Expr.series-2996"><a href="#Expr.series-2996"><span class="linenos">2996</span></a>
</span><span id="Expr.series-2997"><a href="#Expr.series-2997"><span class="linenos">2997</span></a>        <span class="kn">from</span> <span class="nn">sympy.series.order</span> <span class="kn">import</span> <span class="n">Order</span>
</span><span id="Expr.series-2998"><a href="#Expr.series-2998"><span class="linenos">2998</span></a>        <span class="k">if</span> <span class="n">n</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># nseries handling</span>
</span><span id="Expr.series-2999"><a href="#Expr.series-2999"><span class="linenos">2999</span></a>            <span class="n">s1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_eval_nseries</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">logx</span><span class="o">=</span><span class="n">logx</span><span class="p">,</span> <span class="n">cdir</span><span class="o">=</span><span class="n">cdir</span><span class="p">)</span>
</span><span id="Expr.series-3000"><a href="#Expr.series-3000"><span class="linenos">3000</span></a>            <span class="n">o</span> <span class="o">=</span> <span class="n">s1</span><span class="o">.</span><span class="n">getO</span><span class="p">()</span> <span class="ow">or</span> <span class="n">S</span><span class="o">.</span><span class="n">Zero</span>
</span><span id="Expr.series-3001"><a href="#Expr.series-3001"><span class="linenos">3001</span></a>            <span class="k">if</span> <span class="n">o</span><span class="p">:</span>
</span><span id="Expr.series-3002"><a href="#Expr.series-3002"><span class="linenos">3002</span></a>                <span class="c1"># make sure the requested order is returned</span>
</span><span id="Expr.series-3003"><a href="#Expr.series-3003"><span class="linenos">3003</span></a>                <span class="n">ngot</span> <span class="o">=</span> <span class="n">o</span><span class="o">.</span><span class="n">getn</span><span class="p">()</span>
</span><span id="Expr.series-3004"><a href="#Expr.series-3004"><span class="linenos">3004</span></a>                <span class="k">if</span> <span class="n">ngot</span> <span class="o">&gt;</span> <span class="n">n</span><span class="p">:</span>
</span><span id="Expr.series-3005"><a href="#Expr.series-3005"><span class="linenos">3005</span></a>                    <span class="c1"># leave o in its current form (e.g. with x*log(x)) so</span>
</span><span id="Expr.series-3006"><a href="#Expr.series-3006"><span class="linenos">3006</span></a>                    <span class="c1"># it eats terms properly, then replace it below</span>
</span><span id="Expr.series-3007"><a href="#Expr.series-3007"><span class="linenos">3007</span></a>                    <span class="k">if</span> <span class="n">n</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Expr.series-3008"><a href="#Expr.series-3008"><span class="linenos">3008</span></a>                        <span class="n">s1</span> <span class="o">+=</span> <span class="n">o</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">**</span><span class="n">Rational</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">ngot</span><span class="p">))</span>
</span><span id="Expr.series-3009"><a href="#Expr.series-3009"><span class="linenos">3009</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="Expr.series-3010"><a href="#Expr.series-3010"><span class="linenos">3010</span></a>                        <span class="n">s1</span> <span class="o">+=</span> <span class="n">Order</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</span><span id="Expr.series-3011"><a href="#Expr.series-3011"><span class="linenos">3011</span></a>                <span class="k">elif</span> <span class="n">ngot</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">:</span>
</span><span id="Expr.series-3012"><a href="#Expr.series-3012"><span class="linenos">3012</span></a>                    <span class="c1"># increase the requested number of terms to get the desired</span>
</span><span id="Expr.series-3013"><a href="#Expr.series-3013"><span class="linenos">3013</span></a>                    <span class="c1"># number keep increasing (up to 9) until the received order</span>
</span><span id="Expr.series-3014"><a href="#Expr.series-3014"><span class="linenos">3014</span></a>                    <span class="c1"># is different than the original order and then predict how</span>
</span><span id="Expr.series-3015"><a href="#Expr.series-3015"><span class="linenos">3015</span></a>                    <span class="c1"># many additional terms are needed</span>
</span><span id="Expr.series-3016"><a href="#Expr.series-3016"><span class="linenos">3016</span></a>                    <span class="kn">from</span> <span class="nn">sympy.functions.elementary.integers</span> <span class="kn">import</span> <span class="n">ceiling</span>
</span><span id="Expr.series-3017"><a href="#Expr.series-3017"><span class="linenos">3017</span></a>                    <span class="k">for</span> <span class="n">more</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">9</span><span class="p">):</span>
</span><span id="Expr.series-3018"><a href="#Expr.series-3018"><span class="linenos">3018</span></a>                        <span class="n">s1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_eval_nseries</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">n</span> <span class="o">+</span> <span class="n">more</span><span class="p">,</span> <span class="n">logx</span><span class="o">=</span><span class="n">logx</span><span class="p">,</span> <span class="n">cdir</span><span class="o">=</span><span class="n">cdir</span><span class="p">)</span>
</span><span id="Expr.series-3019"><a href="#Expr.series-3019"><span class="linenos">3019</span></a>                        <span class="n">newn</span> <span class="o">=</span> <span class="n">s1</span><span class="o">.</span><span class="n">getn</span><span class="p">()</span>
</span><span id="Expr.series-3020"><a href="#Expr.series-3020"><span class="linenos">3020</span></a>                        <span class="k">if</span> <span class="n">newn</span> <span class="o">!=</span> <span class="n">ngot</span><span class="p">:</span>
</span><span id="Expr.series-3021"><a href="#Expr.series-3021"><span class="linenos">3021</span></a>                            <span class="n">ndo</span> <span class="o">=</span> <span class="n">n</span> <span class="o">+</span> <span class="n">ceiling</span><span class="p">((</span><span class="n">n</span> <span class="o">-</span> <span class="n">ngot</span><span class="p">)</span><span class="o">*</span><span class="n">more</span><span class="o">/</span><span class="p">(</span><span class="n">newn</span> <span class="o">-</span> <span class="n">ngot</span><span class="p">))</span>
</span><span id="Expr.series-3022"><a href="#Expr.series-3022"><span class="linenos">3022</span></a>                            <span class="n">s1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_eval_nseries</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">ndo</span><span class="p">,</span> <span class="n">logx</span><span class="o">=</span><span class="n">logx</span><span class="p">,</span> <span class="n">cdir</span><span class="o">=</span><span class="n">cdir</span><span class="p">)</span>
</span><span id="Expr.series-3023"><a href="#Expr.series-3023"><span class="linenos">3023</span></a>                            <span class="k">while</span> <span class="n">s1</span><span class="o">.</span><span class="n">getn</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">:</span>
</span><span id="Expr.series-3024"><a href="#Expr.series-3024"><span class="linenos">3024</span></a>                                <span class="n">s1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_eval_nseries</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">ndo</span><span class="p">,</span> <span class="n">logx</span><span class="o">=</span><span class="n">logx</span><span class="p">,</span> <span class="n">cdir</span><span class="o">=</span><span class="n">cdir</span><span class="p">)</span>
</span><span id="Expr.series-3025"><a href="#Expr.series-3025"><span class="linenos">3025</span></a>                                <span class="n">ndo</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="Expr.series-3026"><a href="#Expr.series-3026"><span class="linenos">3026</span></a>                            <span class="k">break</span>
</span><span id="Expr.series-3027"><a href="#Expr.series-3027"><span class="linenos">3027</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="Expr.series-3028"><a href="#Expr.series-3028"><span class="linenos">3028</span></a>                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Could not calculate </span><span class="si">%s</span><span class="s1"> terms for </span><span class="si">%s</span><span class="s1">&#39;</span>
</span><span id="Expr.series-3029"><a href="#Expr.series-3029"><span class="linenos">3029</span></a>                                         <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">),</span> <span class="bp">self</span><span class="p">))</span>
</span><span id="Expr.series-3030"><a href="#Expr.series-3030"><span class="linenos">3030</span></a>                    <span class="n">s1</span> <span class="o">+=</span> <span class="n">Order</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="n">n</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</span><span id="Expr.series-3031"><a href="#Expr.series-3031"><span class="linenos">3031</span></a>                <span class="n">o</span> <span class="o">=</span> <span class="n">s1</span><span class="o">.</span><span class="n">getO</span><span class="p">()</span>
</span><span id="Expr.series-3032"><a href="#Expr.series-3032"><span class="linenos">3032</span></a>                <span class="n">s1</span> <span class="o">=</span> <span class="n">s1</span><span class="o">.</span><span class="n">removeO</span><span class="p">()</span>
</span><span id="Expr.series-3033"><a href="#Expr.series-3033"><span class="linenos">3033</span></a>            <span class="k">elif</span> <span class="n">s1</span><span class="o">.</span><span class="n">has</span><span class="p">(</span><span class="n">Order</span><span class="p">):</span>
</span><span id="Expr.series-3034"><a href="#Expr.series-3034"><span class="linenos">3034</span></a>                <span class="c1"># asymptotic expansion</span>
</span><span id="Expr.series-3035"><a href="#Expr.series-3035"><span class="linenos">3035</span></a>                <span class="k">return</span> <span class="n">s1</span>
</span><span id="Expr.series-3036"><a href="#Expr.series-3036"><span class="linenos">3036</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Expr.series-3037"><a href="#Expr.series-3037"><span class="linenos">3037</span></a>                <span class="n">o</span> <span class="o">=</span> <span class="n">Order</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="n">n</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</span><span id="Expr.series-3038"><a href="#Expr.series-3038"><span class="linenos">3038</span></a>                <span class="n">s1done</span> <span class="o">=</span> <span class="n">s1</span><span class="o">.</span><span class="n">doit</span><span class="p">()</span>
</span><span id="Expr.series-3039"><a href="#Expr.series-3039"><span class="linenos">3039</span></a>                <span class="k">if</span> <span class="p">(</span><span class="n">s1done</span> <span class="o">+</span> <span class="n">o</span><span class="p">)</span><span class="o">.</span><span class="n">removeO</span><span class="p">()</span> <span class="o">==</span> <span class="n">s1done</span><span class="p">:</span>
</span><span id="Expr.series-3040"><a href="#Expr.series-3040"><span class="linenos">3040</span></a>                    <span class="n">o</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">Zero</span>
</span><span id="Expr.series-3041"><a href="#Expr.series-3041"><span class="linenos">3041</span></a>
</span><span id="Expr.series-3042"><a href="#Expr.series-3042"><span class="linenos">3042</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="Expr.series-3043"><a href="#Expr.series-3043"><span class="linenos">3043</span></a>                <span class="kn">from</span> <span class="nn">sympy.simplify.radsimp</span> <span class="kn">import</span> <span class="n">collect</span>
</span><span id="Expr.series-3044"><a href="#Expr.series-3044"><span class="linenos">3044</span></a>                <span class="k">return</span> <span class="n">collect</span><span class="p">(</span><span class="n">s1</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">o</span>
</span><span id="Expr.series-3045"><a href="#Expr.series-3045"><span class="linenos">3045</span></a>            <span class="k">except</span> <span class="ne">NotImplementedError</span><span class="p">:</span>
</span><span id="Expr.series-3046"><a href="#Expr.series-3046"><span class="linenos">3046</span></a>                <span class="k">return</span> <span class="n">s1</span> <span class="o">+</span> <span class="n">o</span>
</span><span id="Expr.series-3047"><a href="#Expr.series-3047"><span class="linenos">3047</span></a>
</span><span id="Expr.series-3048"><a href="#Expr.series-3048"><span class="linenos">3048</span></a>        <span class="k">else</span><span class="p">:</span>  <span class="c1"># lseries handling</span>
</span><span id="Expr.series-3049"><a href="#Expr.series-3049"><span class="linenos">3049</span></a>            <span class="k">def</span> <span class="nf">yield_lseries</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
</span><span id="Expr.series-3050"><a href="#Expr.series-3050"><span class="linenos">3050</span></a><span class="w">                </span><span class="sd">&quot;&quot;&quot;Return terms of lseries one at a time.&quot;&quot;&quot;</span>
</span><span id="Expr.series-3051"><a href="#Expr.series-3051"><span class="linenos">3051</span></a>                <span class="k">for</span> <span class="n">si</span> <span class="ow">in</span> <span class="n">s</span><span class="p">:</span>
</span><span id="Expr.series-3052"><a href="#Expr.series-3052"><span class="linenos">3052</span></a>                    <span class="k">if</span> <span class="ow">not</span> <span class="n">si</span><span class="o">.</span><span class="n">is_Add</span><span class="p">:</span>
</span><span id="Expr.series-3053"><a href="#Expr.series-3053"><span class="linenos">3053</span></a>                        <span class="k">yield</span> <span class="n">si</span>
</span><span id="Expr.series-3054"><a href="#Expr.series-3054"><span class="linenos">3054</span></a>                        <span class="k">continue</span>
</span><span id="Expr.series-3055"><a href="#Expr.series-3055"><span class="linenos">3055</span></a>                    <span class="c1"># yield terms 1 at a time if possible</span>
</span><span id="Expr.series-3056"><a href="#Expr.series-3056"><span class="linenos">3056</span></a>                    <span class="c1"># by increasing order until all the</span>
</span><span id="Expr.series-3057"><a href="#Expr.series-3057"><span class="linenos">3057</span></a>                    <span class="c1"># terms have been returned</span>
</span><span id="Expr.series-3058"><a href="#Expr.series-3058"><span class="linenos">3058</span></a>                    <span class="n">yielded</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Expr.series-3059"><a href="#Expr.series-3059"><span class="linenos">3059</span></a>                    <span class="n">o</span> <span class="o">=</span> <span class="n">Order</span><span class="p">(</span><span class="n">si</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">x</span>
</span><span id="Expr.series-3060"><a href="#Expr.series-3060"><span class="linenos">3060</span></a>                    <span class="n">ndid</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Expr.series-3061"><a href="#Expr.series-3061"><span class="linenos">3061</span></a>                    <span class="n">ndo</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">si</span><span class="o">.</span><span class="n">args</span><span class="p">)</span>
</span><span id="Expr.series-3062"><a href="#Expr.series-3062"><span class="linenos">3062</span></a>                    <span class="k">while</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Expr.series-3063"><a href="#Expr.series-3063"><span class="linenos">3063</span></a>                        <span class="n">do</span> <span class="o">=</span> <span class="p">(</span><span class="n">si</span> <span class="o">-</span> <span class="n">yielded</span> <span class="o">+</span> <span class="n">o</span><span class="p">)</span><span class="o">.</span><span class="n">removeO</span><span class="p">()</span>
</span><span id="Expr.series-3064"><a href="#Expr.series-3064"><span class="linenos">3064</span></a>                        <span class="n">o</span> <span class="o">*=</span> <span class="n">x</span>
</span><span id="Expr.series-3065"><a href="#Expr.series-3065"><span class="linenos">3065</span></a>                        <span class="k">if</span> <span class="ow">not</span> <span class="n">do</span> <span class="ow">or</span> <span class="n">do</span><span class="o">.</span><span class="n">is_Order</span><span class="p">:</span>
</span><span id="Expr.series-3066"><a href="#Expr.series-3066"><span class="linenos">3066</span></a>                            <span class="k">continue</span>
</span><span id="Expr.series-3067"><a href="#Expr.series-3067"><span class="linenos">3067</span></a>                        <span class="k">if</span> <span class="n">do</span><span class="o">.</span><span class="n">is_Add</span><span class="p">:</span>
</span><span id="Expr.series-3068"><a href="#Expr.series-3068"><span class="linenos">3068</span></a>                            <span class="n">ndid</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">do</span><span class="o">.</span><span class="n">args</span><span class="p">)</span>
</span><span id="Expr.series-3069"><a href="#Expr.series-3069"><span class="linenos">3069</span></a>                        <span class="k">else</span><span class="p">:</span>
</span><span id="Expr.series-3070"><a href="#Expr.series-3070"><span class="linenos">3070</span></a>                            <span class="n">ndid</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="Expr.series-3071"><a href="#Expr.series-3071"><span class="linenos">3071</span></a>                        <span class="k">yield</span> <span class="n">do</span>
</span><span id="Expr.series-3072"><a href="#Expr.series-3072"><span class="linenos">3072</span></a>                        <span class="k">if</span> <span class="n">ndid</span> <span class="o">==</span> <span class="n">ndo</span><span class="p">:</span>
</span><span id="Expr.series-3073"><a href="#Expr.series-3073"><span class="linenos">3073</span></a>                            <span class="k">break</span>
</span><span id="Expr.series-3074"><a href="#Expr.series-3074"><span class="linenos">3074</span></a>                        <span class="n">yielded</span> <span class="o">+=</span> <span class="n">do</span>
</span><span id="Expr.series-3075"><a href="#Expr.series-3075"><span class="linenos">3075</span></a>
</span><span id="Expr.series-3076"><a href="#Expr.series-3076"><span class="linenos">3076</span></a>            <span class="k">return</span> <span class="n">yield_lseries</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">removeO</span><span class="p">()</span><span class="o">.</span><span class="n">_eval_lseries</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">logx</span><span class="o">=</span><span class="n">logx</span><span class="p">,</span> <span class="n">cdir</span><span class="o">=</span><span class="n">cdir</span><span class="p">))</span>
</span></pre></div>


            <div class="docstring"><p>Series expansion of "self" around <code>x = x0</code> yielding either terms of
the series one by one (the lazy series given when n=None), else
all the terms at once when n != None.</p>

<p>Returns the series expansion of "self" around the point <code>x = x0</code>
with respect to <code>x</code> up to <code>O((x - x0)**n, x, x0)</code> (default n is 6).</p>

<p>If <code>x=None</code> and <code>self</code> is univariate, the univariate symbol will
be supplied, otherwise an error will be raised.</p>

<h1 id="parameters">Parameters</h1>

<p>expr : Expression
       The expression whose series is to be expanded.</p>

<p>x : Symbol
    It is the variable of the expression to be calculated.</p>

<p>x0 : Value
     The value around which <code>x</code> is calculated. Can be any value
     from <code>-oo</code> to <code>oo</code>.</p>

<p>n : Value
    The number of terms upto which the series is to be expanded.</p>

<p>dir : String, optional
      The series-expansion can be bi-directional. If <code>dir="+"</code>,
      then (x->x0+). If <code>dir="-", then (x-&gt;x0-). For infinite
</code>x0<code>(</code>oo<code>or</code>-oo<code>), the</code>dir<code>argument is determined
      from the direction of the infinity (i.e.,</code>dir="-"<code>for
</code>oo``).</p>

<p>logx : optional
       It is used to replace any log(x) in the returned series with a
       symbolic value rather than evaluating the actual value.</p>

<p>cdir : optional
       It stands for complex direction, and indicates the direction
       from which the expansion needs to be evaluated.</p>

<h1 id="examples">Examples</h1>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">cos</span><span class="p">,</span> <span class="n">exp</span><span class="p">,</span> <span class="n">tan</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.abc</span> <span class="kn">import</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">series</span><span class="p">()</span>
<span class="go">1 - x**2/2 + x**4/24 + O(x**6)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">series</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="go">1 - x**2/2 + O(x**4)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">series</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="go">cos(1) - (x - 1)*sin(1) + O((x - 1)**2, (x, 1))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e</span> <span class="o">=</span> <span class="n">cos</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">exp</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e</span><span class="o">.</span><span class="n">series</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="go">cos(x + 1) - y*sin(x + 1) + O(y**2)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e</span><span class="o">.</span><span class="n">series</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="go">cos(exp(y)) - x*sin(exp(y)) + O(x**2)</span>
</code></pre>
</div>

<p>If <code>n=None</code> then a generator of the series terms will be returned.</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">term</span><span class="o">=</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">series</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="nb">next</span><span class="p">(</span><span class="n">term</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">)]</span>
<span class="go">[1, -x**2/2]</span>
</code></pre>
</div>

<p>For <code>dir=+</code> (default) the series is calculated from the right and
for <code>dir=-</code> the series from the left. For smooth functions this
flag will not alter the results.</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">series</span><span class="p">(</span><span class="nb">dir</span><span class="o">=</span><span class="s2">&quot;+&quot;</span><span class="p">)</span>
<span class="go">x</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">series</span><span class="p">(</span><span class="nb">dir</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">)</span>
<span class="go">-x</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">tan</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">series</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="s2">&quot;+&quot;</span><span class="p">)</span>
<span class="go">tan(2) + (1 + tan(2)**2)*(x - 2) + (x - 2)**2*(tan(2)**3 + tan(2)) +</span>
<span class="go">(x - 2)**3*(1/3 + 4*tan(2)**2/3 + tan(2)**4) + (x - 2)**4*(tan(2)**5 +</span>
<span class="go">5*tan(2)**3/3 + 2*tan(2)/3) + (x - 2)**5*(2/15 + 17*tan(2)**2/15 +</span>
<span class="go">2*tan(2)**4 + tan(2)**6) + O((x - 2)**6, (x, 2))</span>
</code></pre>
</div>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">series</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">)</span>
<span class="go">tan(2) + (2 - x)*(-tan(2)**2 - 1) + (2 - x)**2*(tan(2)**3 + tan(2))</span>
<span class="go">+ O((x - 2)**3, (x, 2))</span>
</code></pre>
</div>

<h1 id="returns">Returns</h1>

<p>Expr : Expression
    Series expansion of the expression about x0</p>

<h1 id="raises">Raises</h1>

<p>TypeError
    If "n" and "x0" are infinity objects</p>

<p>PoleError
    If "x0" is an infinity object</p>
</div>


                            </div>
                            <div id="Expr.aseries" class="classattr">
                                        <input id="Expr.aseries-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">aseries</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">x</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="n">n</span><span class="o">=</span><span class="mi">6</span>, </span><span class="param"><span class="n">bound</span><span class="o">=</span><span class="mi">0</span>, </span><span class="param"><span class="n">hir</span><span class="o">=</span><span class="kc">False</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Expr.aseries-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Expr.aseries"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Expr.aseries-3078"><a href="#Expr.aseries-3078"><span class="linenos">3078</span></a>    <span class="k">def</span> <span class="nf">aseries</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">bound</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">hir</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="Expr.aseries-3079"><a href="#Expr.aseries-3079"><span class="linenos">3079</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Asymptotic Series expansion of self.</span>
</span><span id="Expr.aseries-3080"><a href="#Expr.aseries-3080"><span class="linenos">3080</span></a><span class="sd">        This is equivalent to ``self.series(x, oo, n)``.</span>
</span><span id="Expr.aseries-3081"><a href="#Expr.aseries-3081"><span class="linenos">3081</span></a>
</span><span id="Expr.aseries-3082"><a href="#Expr.aseries-3082"><span class="linenos">3082</span></a><span class="sd">        Parameters</span>
</span><span id="Expr.aseries-3083"><a href="#Expr.aseries-3083"><span class="linenos">3083</span></a><span class="sd">        ==========</span>
</span><span id="Expr.aseries-3084"><a href="#Expr.aseries-3084"><span class="linenos">3084</span></a>
</span><span id="Expr.aseries-3085"><a href="#Expr.aseries-3085"><span class="linenos">3085</span></a><span class="sd">        self : Expression</span>
</span><span id="Expr.aseries-3086"><a href="#Expr.aseries-3086"><span class="linenos">3086</span></a><span class="sd">               The expression whose series is to be expanded.</span>
</span><span id="Expr.aseries-3087"><a href="#Expr.aseries-3087"><span class="linenos">3087</span></a>
</span><span id="Expr.aseries-3088"><a href="#Expr.aseries-3088"><span class="linenos">3088</span></a><span class="sd">        x : Symbol</span>
</span><span id="Expr.aseries-3089"><a href="#Expr.aseries-3089"><span class="linenos">3089</span></a><span class="sd">            It is the variable of the expression to be calculated.</span>
</span><span id="Expr.aseries-3090"><a href="#Expr.aseries-3090"><span class="linenos">3090</span></a>
</span><span id="Expr.aseries-3091"><a href="#Expr.aseries-3091"><span class="linenos">3091</span></a><span class="sd">        n : Value</span>
</span><span id="Expr.aseries-3092"><a href="#Expr.aseries-3092"><span class="linenos">3092</span></a><span class="sd">            The number of terms upto which the series is to be expanded.</span>
</span><span id="Expr.aseries-3093"><a href="#Expr.aseries-3093"><span class="linenos">3093</span></a>
</span><span id="Expr.aseries-3094"><a href="#Expr.aseries-3094"><span class="linenos">3094</span></a><span class="sd">        hir : Boolean</span>
</span><span id="Expr.aseries-3095"><a href="#Expr.aseries-3095"><span class="linenos">3095</span></a><span class="sd">              Set this parameter to be True to produce hierarchical series.</span>
</span><span id="Expr.aseries-3096"><a href="#Expr.aseries-3096"><span class="linenos">3096</span></a><span class="sd">              It stops the recursion at an early level and may provide nicer</span>
</span><span id="Expr.aseries-3097"><a href="#Expr.aseries-3097"><span class="linenos">3097</span></a><span class="sd">              and more useful results.</span>
</span><span id="Expr.aseries-3098"><a href="#Expr.aseries-3098"><span class="linenos">3098</span></a>
</span><span id="Expr.aseries-3099"><a href="#Expr.aseries-3099"><span class="linenos">3099</span></a><span class="sd">        bound : Value, Integer</span>
</span><span id="Expr.aseries-3100"><a href="#Expr.aseries-3100"><span class="linenos">3100</span></a><span class="sd">                Use the ``bound`` parameter to give limit on rewriting</span>
</span><span id="Expr.aseries-3101"><a href="#Expr.aseries-3101"><span class="linenos">3101</span></a><span class="sd">                coefficients in its normalised form.</span>
</span><span id="Expr.aseries-3102"><a href="#Expr.aseries-3102"><span class="linenos">3102</span></a>
</span><span id="Expr.aseries-3103"><a href="#Expr.aseries-3103"><span class="linenos">3103</span></a><span class="sd">        Examples</span>
</span><span id="Expr.aseries-3104"><a href="#Expr.aseries-3104"><span class="linenos">3104</span></a><span class="sd">        ========</span>
</span><span id="Expr.aseries-3105"><a href="#Expr.aseries-3105"><span class="linenos">3105</span></a>
</span><span id="Expr.aseries-3106"><a href="#Expr.aseries-3106"><span class="linenos">3106</span></a><span class="sd">        &gt;&gt;&gt; from sympy import sin, exp</span>
</span><span id="Expr.aseries-3107"><a href="#Expr.aseries-3107"><span class="linenos">3107</span></a><span class="sd">        &gt;&gt;&gt; from sympy.abc import x</span>
</span><span id="Expr.aseries-3108"><a href="#Expr.aseries-3108"><span class="linenos">3108</span></a>
</span><span id="Expr.aseries-3109"><a href="#Expr.aseries-3109"><span class="linenos">3109</span></a><span class="sd">        &gt;&gt;&gt; e = sin(1/x + exp(-x)) - sin(1/x)</span>
</span><span id="Expr.aseries-3110"><a href="#Expr.aseries-3110"><span class="linenos">3110</span></a>
</span><span id="Expr.aseries-3111"><a href="#Expr.aseries-3111"><span class="linenos">3111</span></a><span class="sd">        &gt;&gt;&gt; e.aseries(x)</span>
</span><span id="Expr.aseries-3112"><a href="#Expr.aseries-3112"><span class="linenos">3112</span></a><span class="sd">        (1/(24*x**4) - 1/(2*x**2) + 1 + O(x**(-6), (x, oo)))*exp(-x)</span>
</span><span id="Expr.aseries-3113"><a href="#Expr.aseries-3113"><span class="linenos">3113</span></a>
</span><span id="Expr.aseries-3114"><a href="#Expr.aseries-3114"><span class="linenos">3114</span></a><span class="sd">        &gt;&gt;&gt; e.aseries(x, n=3, hir=True)</span>
</span><span id="Expr.aseries-3115"><a href="#Expr.aseries-3115"><span class="linenos">3115</span></a><span class="sd">        -exp(-2*x)*sin(1/x)/2 + exp(-x)*cos(1/x) + O(exp(-3*x), (x, oo))</span>
</span><span id="Expr.aseries-3116"><a href="#Expr.aseries-3116"><span class="linenos">3116</span></a>
</span><span id="Expr.aseries-3117"><a href="#Expr.aseries-3117"><span class="linenos">3117</span></a><span class="sd">        &gt;&gt;&gt; e = exp(exp(x)/(1 - 1/x))</span>
</span><span id="Expr.aseries-3118"><a href="#Expr.aseries-3118"><span class="linenos">3118</span></a>
</span><span id="Expr.aseries-3119"><a href="#Expr.aseries-3119"><span class="linenos">3119</span></a><span class="sd">        &gt;&gt;&gt; e.aseries(x)</span>
</span><span id="Expr.aseries-3120"><a href="#Expr.aseries-3120"><span class="linenos">3120</span></a><span class="sd">        exp(exp(x)/(1 - 1/x))</span>
</span><span id="Expr.aseries-3121"><a href="#Expr.aseries-3121"><span class="linenos">3121</span></a>
</span><span id="Expr.aseries-3122"><a href="#Expr.aseries-3122"><span class="linenos">3122</span></a><span class="sd">        &gt;&gt;&gt; e.aseries(x, bound=3) # doctest: +SKIP</span>
</span><span id="Expr.aseries-3123"><a href="#Expr.aseries-3123"><span class="linenos">3123</span></a><span class="sd">        exp(exp(x)/x**2)*exp(exp(x)/x)*exp(-exp(x) + exp(x)/(1 - 1/x) - exp(x)/x - exp(x)/x**2)*exp(exp(x))</span>
</span><span id="Expr.aseries-3124"><a href="#Expr.aseries-3124"><span class="linenos">3124</span></a>
</span><span id="Expr.aseries-3125"><a href="#Expr.aseries-3125"><span class="linenos">3125</span></a><span class="sd">        Returns</span>
</span><span id="Expr.aseries-3126"><a href="#Expr.aseries-3126"><span class="linenos">3126</span></a><span class="sd">        =======</span>
</span><span id="Expr.aseries-3127"><a href="#Expr.aseries-3127"><span class="linenos">3127</span></a>
</span><span id="Expr.aseries-3128"><a href="#Expr.aseries-3128"><span class="linenos">3128</span></a><span class="sd">        Expr</span>
</span><span id="Expr.aseries-3129"><a href="#Expr.aseries-3129"><span class="linenos">3129</span></a><span class="sd">            Asymptotic series expansion of the expression.</span>
</span><span id="Expr.aseries-3130"><a href="#Expr.aseries-3130"><span class="linenos">3130</span></a>
</span><span id="Expr.aseries-3131"><a href="#Expr.aseries-3131"><span class="linenos">3131</span></a><span class="sd">        Notes</span>
</span><span id="Expr.aseries-3132"><a href="#Expr.aseries-3132"><span class="linenos">3132</span></a><span class="sd">        =====</span>
</span><span id="Expr.aseries-3133"><a href="#Expr.aseries-3133"><span class="linenos">3133</span></a>
</span><span id="Expr.aseries-3134"><a href="#Expr.aseries-3134"><span class="linenos">3134</span></a><span class="sd">        This algorithm is directly induced from the limit computational algorithm provided by Gruntz.</span>
</span><span id="Expr.aseries-3135"><a href="#Expr.aseries-3135"><span class="linenos">3135</span></a><span class="sd">        It majorly uses the mrv and rewrite sub-routines. The overall idea of this algorithm is first</span>
</span><span id="Expr.aseries-3136"><a href="#Expr.aseries-3136"><span class="linenos">3136</span></a><span class="sd">        to look for the most rapidly varying subexpression w of a given expression f and then expands f</span>
</span><span id="Expr.aseries-3137"><a href="#Expr.aseries-3137"><span class="linenos">3137</span></a><span class="sd">        in a series in w. Then same thing is recursively done on the leading coefficient</span>
</span><span id="Expr.aseries-3138"><a href="#Expr.aseries-3138"><span class="linenos">3138</span></a><span class="sd">        till we get constant coefficients.</span>
</span><span id="Expr.aseries-3139"><a href="#Expr.aseries-3139"><span class="linenos">3139</span></a>
</span><span id="Expr.aseries-3140"><a href="#Expr.aseries-3140"><span class="linenos">3140</span></a><span class="sd">        If the most rapidly varying subexpression of a given expression f is f itself,</span>
</span><span id="Expr.aseries-3141"><a href="#Expr.aseries-3141"><span class="linenos">3141</span></a><span class="sd">        the algorithm tries to find a normalised representation of the mrv set and rewrites f</span>
</span><span id="Expr.aseries-3142"><a href="#Expr.aseries-3142"><span class="linenos">3142</span></a><span class="sd">        using this normalised representation.</span>
</span><span id="Expr.aseries-3143"><a href="#Expr.aseries-3143"><span class="linenos">3143</span></a>
</span><span id="Expr.aseries-3144"><a href="#Expr.aseries-3144"><span class="linenos">3144</span></a><span class="sd">        If the expansion contains an order term, it will be either ``O(x ** (-n))`` or ``O(w ** (-n))``</span>
</span><span id="Expr.aseries-3145"><a href="#Expr.aseries-3145"><span class="linenos">3145</span></a><span class="sd">        where ``w`` belongs to the most rapidly varying expression of ``self``.</span>
</span><span id="Expr.aseries-3146"><a href="#Expr.aseries-3146"><span class="linenos">3146</span></a>
</span><span id="Expr.aseries-3147"><a href="#Expr.aseries-3147"><span class="linenos">3147</span></a><span class="sd">        References</span>
</span><span id="Expr.aseries-3148"><a href="#Expr.aseries-3148"><span class="linenos">3148</span></a><span class="sd">        ==========</span>
</span><span id="Expr.aseries-3149"><a href="#Expr.aseries-3149"><span class="linenos">3149</span></a>
</span><span id="Expr.aseries-3150"><a href="#Expr.aseries-3150"><span class="linenos">3150</span></a><span class="sd">        .. [1] Gruntz, Dominik. A new algorithm for computing asymptotic series.</span>
</span><span id="Expr.aseries-3151"><a href="#Expr.aseries-3151"><span class="linenos">3151</span></a><span class="sd">               In: Proc. 1993 Int. Symp. Symbolic and Algebraic Computation. 1993.</span>
</span><span id="Expr.aseries-3152"><a href="#Expr.aseries-3152"><span class="linenos">3152</span></a><span class="sd">               pp. 239-244.</span>
</span><span id="Expr.aseries-3153"><a href="#Expr.aseries-3153"><span class="linenos">3153</span></a><span class="sd">        .. [2] Gruntz thesis - p90</span>
</span><span id="Expr.aseries-3154"><a href="#Expr.aseries-3154"><span class="linenos">3154</span></a><span class="sd">        .. [3] http://en.wikipedia.org/wiki/Asymptotic_expansion</span>
</span><span id="Expr.aseries-3155"><a href="#Expr.aseries-3155"><span class="linenos">3155</span></a>
</span><span id="Expr.aseries-3156"><a href="#Expr.aseries-3156"><span class="linenos">3156</span></a><span class="sd">        See Also</span>
</span><span id="Expr.aseries-3157"><a href="#Expr.aseries-3157"><span class="linenos">3157</span></a><span class="sd">        ========</span>
</span><span id="Expr.aseries-3158"><a href="#Expr.aseries-3158"><span class="linenos">3158</span></a>
</span><span id="Expr.aseries-3159"><a href="#Expr.aseries-3159"><span class="linenos">3159</span></a><span class="sd">        Expr.aseries: See the docstring of this function for complete details of this wrapper.</span>
</span><span id="Expr.aseries-3160"><a href="#Expr.aseries-3160"><span class="linenos">3160</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Expr.aseries-3161"><a href="#Expr.aseries-3161"><span class="linenos">3161</span></a>
</span><span id="Expr.aseries-3162"><a href="#Expr.aseries-3162"><span class="linenos">3162</span></a>        <span class="kn">from</span> <span class="nn">.symbol</span> <span class="kn">import</span> <span class="n">Dummy</span>
</span><span id="Expr.aseries-3163"><a href="#Expr.aseries-3163"><span class="linenos">3163</span></a>
</span><span id="Expr.aseries-3164"><a href="#Expr.aseries-3164"><span class="linenos">3164</span></a>        <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">is_positive</span> <span class="ow">is</span> <span class="n">x</span><span class="o">.</span><span class="n">is_negative</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Expr.aseries-3165"><a href="#Expr.aseries-3165"><span class="linenos">3165</span></a>            <span class="n">xpos</span> <span class="o">=</span> <span class="n">Dummy</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">positive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="Expr.aseries-3166"><a href="#Expr.aseries-3166"><span class="linenos">3166</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">xpos</span><span class="p">)</span><span class="o">.</span><span class="n">aseries</span><span class="p">(</span><span class="n">xpos</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">bound</span><span class="p">,</span> <span class="n">hir</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">xpos</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</span><span id="Expr.aseries-3167"><a href="#Expr.aseries-3167"><span class="linenos">3167</span></a>
</span><span id="Expr.aseries-3168"><a href="#Expr.aseries-3168"><span class="linenos">3168</span></a>        <span class="kn">from</span> <span class="nn">.function</span> <span class="kn">import</span> <span class="n">PoleError</span>
</span><span id="Expr.aseries-3169"><a href="#Expr.aseries-3169"><span class="linenos">3169</span></a>        <span class="kn">from</span> <span class="nn">sympy.series.gruntz</span> <span class="kn">import</span> <span class="n">mrv</span><span class="p">,</span> <span class="n">rewrite</span>
</span><span id="Expr.aseries-3170"><a href="#Expr.aseries-3170"><span class="linenos">3170</span></a>
</span><span id="Expr.aseries-3171"><a href="#Expr.aseries-3171"><span class="linenos">3171</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="Expr.aseries-3172"><a href="#Expr.aseries-3172"><span class="linenos">3172</span></a>            <span class="n">om</span><span class="p">,</span> <span class="n">exps</span> <span class="o">=</span> <span class="n">mrv</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</span><span id="Expr.aseries-3173"><a href="#Expr.aseries-3173"><span class="linenos">3173</span></a>        <span class="k">except</span> <span class="n">PoleError</span><span class="p">:</span>
</span><span id="Expr.aseries-3174"><a href="#Expr.aseries-3174"><span class="linenos">3174</span></a>            <span class="k">return</span> <span class="bp">self</span>
</span><span id="Expr.aseries-3175"><a href="#Expr.aseries-3175"><span class="linenos">3175</span></a>
</span><span id="Expr.aseries-3176"><a href="#Expr.aseries-3176"><span class="linenos">3176</span></a>        <span class="c1"># We move one level up by replacing `x` by `exp(x)`, and then</span>
</span><span id="Expr.aseries-3177"><a href="#Expr.aseries-3177"><span class="linenos">3177</span></a>        <span class="c1"># computing the asymptotic series for f(exp(x)). Then asymptotic series</span>
</span><span id="Expr.aseries-3178"><a href="#Expr.aseries-3178"><span class="linenos">3178</span></a>        <span class="c1"># can be obtained by moving one-step back, by replacing x by ln(x).</span>
</span><span id="Expr.aseries-3179"><a href="#Expr.aseries-3179"><span class="linenos">3179</span></a>
</span><span id="Expr.aseries-3180"><a href="#Expr.aseries-3180"><span class="linenos">3180</span></a>        <span class="kn">from</span> <span class="nn">sympy.functions.elementary.exponential</span> <span class="kn">import</span> <span class="n">exp</span><span class="p">,</span> <span class="n">log</span>
</span><span id="Expr.aseries-3181"><a href="#Expr.aseries-3181"><span class="linenos">3181</span></a>        <span class="kn">from</span> <span class="nn">sympy.series.order</span> <span class="kn">import</span> <span class="n">Order</span>
</span><span id="Expr.aseries-3182"><a href="#Expr.aseries-3182"><span class="linenos">3182</span></a>
</span><span id="Expr.aseries-3183"><a href="#Expr.aseries-3183"><span class="linenos">3183</span></a>        <span class="k">if</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">om</span><span class="p">:</span>
</span><span id="Expr.aseries-3184"><a href="#Expr.aseries-3184"><span class="linenos">3184</span></a>            <span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">.</span><span class="n">aseries</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">bound</span><span class="p">,</span> <span class="n">hir</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</span><span id="Expr.aseries-3185"><a href="#Expr.aseries-3185"><span class="linenos">3185</span></a>            <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">getO</span><span class="p">():</span>
</span><span id="Expr.aseries-3186"><a href="#Expr.aseries-3186"><span class="linenos">3186</span></a>                <span class="k">return</span> <span class="n">s</span> <span class="o">+</span> <span class="n">Order</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">x</span><span class="o">**</span><span class="n">n</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">S</span><span class="o">.</span><span class="n">Infinity</span><span class="p">))</span>
</span><span id="Expr.aseries-3187"><a href="#Expr.aseries-3187"><span class="linenos">3187</span></a>            <span class="k">return</span> <span class="n">s</span>
</span><span id="Expr.aseries-3188"><a href="#Expr.aseries-3188"><span class="linenos">3188</span></a>
</span><span id="Expr.aseries-3189"><a href="#Expr.aseries-3189"><span class="linenos">3189</span></a>        <span class="n">k</span> <span class="o">=</span> <span class="n">Dummy</span><span class="p">(</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">positive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="Expr.aseries-3190"><a href="#Expr.aseries-3190"><span class="linenos">3190</span></a>        <span class="c1"># f is rewritten in terms of omega</span>
</span><span id="Expr.aseries-3191"><a href="#Expr.aseries-3191"><span class="linenos">3191</span></a>        <span class="n">func</span><span class="p">,</span> <span class="n">logw</span> <span class="o">=</span> <span class="n">rewrite</span><span class="p">(</span><span class="n">exps</span><span class="p">,</span> <span class="n">om</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
</span><span id="Expr.aseries-3192"><a href="#Expr.aseries-3192"><span class="linenos">3192</span></a>
</span><span id="Expr.aseries-3193"><a href="#Expr.aseries-3193"><span class="linenos">3193</span></a>        <span class="k">if</span> <span class="bp">self</span> <span class="ow">in</span> <span class="n">om</span><span class="p">:</span>
</span><span id="Expr.aseries-3194"><a href="#Expr.aseries-3194"><span class="linenos">3194</span></a>            <span class="k">if</span> <span class="n">bound</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Expr.aseries-3195"><a href="#Expr.aseries-3195"><span class="linenos">3195</span></a>                <span class="k">return</span> <span class="bp">self</span>
</span><span id="Expr.aseries-3196"><a href="#Expr.aseries-3196"><span class="linenos">3196</span></a>            <span class="n">s</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">exp</span><span class="p">)</span><span class="o">.</span><span class="n">aseries</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">bound</span><span class="o">=</span><span class="n">bound</span><span class="p">)</span>
</span><span id="Expr.aseries-3197"><a href="#Expr.aseries-3197"><span class="linenos">3197</span></a>            <span class="n">s</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">removeO</span><span class="p">()</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">s</span><span class="o">.</span><span class="n">args</span><span class="p">])</span>
</span><span id="Expr.aseries-3198"><a href="#Expr.aseries-3198"><span class="linenos">3198</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="Expr.aseries-3199"><a href="#Expr.aseries-3199"><span class="linenos">3199</span></a>                <span class="n">res</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">as_leading_term</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">x</span><span class="p">))</span>
</span><span id="Expr.aseries-3200"><a href="#Expr.aseries-3200"><span class="linenos">3200</span></a>            <span class="k">except</span> <span class="n">PoleError</span><span class="p">:</span>
</span><span id="Expr.aseries-3201"><a href="#Expr.aseries-3201"><span class="linenos">3201</span></a>                <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span>
</span><span id="Expr.aseries-3202"><a href="#Expr.aseries-3202"><span class="linenos">3202</span></a>
</span><span id="Expr.aseries-3203"><a href="#Expr.aseries-3203"><span class="linenos">3203</span></a>            <span class="n">func</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">res</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="n">k</span>
</span><span id="Expr.aseries-3204"><a href="#Expr.aseries-3204"><span class="linenos">3204</span></a>            <span class="n">logw</span> <span class="o">=</span> <span class="n">log</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">res</span><span class="p">)</span>
</span><span id="Expr.aseries-3205"><a href="#Expr.aseries-3205"><span class="linenos">3205</span></a>
</span><span id="Expr.aseries-3206"><a href="#Expr.aseries-3206"><span class="linenos">3206</span></a>        <span class="n">s</span> <span class="o">=</span> <span class="n">func</span><span class="o">.</span><span class="n">series</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
</span><span id="Expr.aseries-3207"><a href="#Expr.aseries-3207"><span class="linenos">3207</span></a>
</span><span id="Expr.aseries-3208"><a href="#Expr.aseries-3208"><span class="linenos">3208</span></a>        <span class="c1"># Hierarchical series</span>
</span><span id="Expr.aseries-3209"><a href="#Expr.aseries-3209"><span class="linenos">3209</span></a>        <span class="k">if</span> <span class="n">hir</span><span class="p">:</span>
</span><span id="Expr.aseries-3210"><a href="#Expr.aseries-3210"><span class="linenos">3210</span></a>            <span class="k">return</span> <span class="n">s</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">exp</span><span class="p">(</span><span class="n">logw</span><span class="p">))</span>
</span><span id="Expr.aseries-3211"><a href="#Expr.aseries-3211"><span class="linenos">3211</span></a>
</span><span id="Expr.aseries-3212"><a href="#Expr.aseries-3212"><span class="linenos">3212</span></a>        <span class="n">o</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">getO</span><span class="p">()</span>
</span><span id="Expr.aseries-3213"><a href="#Expr.aseries-3213"><span class="linenos">3213</span></a>        <span class="n">terms</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">Add</span><span class="o">.</span><span class="n">make_args</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">removeO</span><span class="p">()),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">as_coeff_exponent</span><span class="p">(</span><span class="n">k</span><span class="p">)[</span><span class="mi">1</span><span class="p">]))</span>
</span><span id="Expr.aseries-3214"><a href="#Expr.aseries-3214"><span class="linenos">3214</span></a>        <span class="n">s</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">Zero</span>
</span><span id="Expr.aseries-3215"><a href="#Expr.aseries-3215"><span class="linenos">3215</span></a>        <span class="n">has_ord</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="Expr.aseries-3216"><a href="#Expr.aseries-3216"><span class="linenos">3216</span></a>
</span><span id="Expr.aseries-3217"><a href="#Expr.aseries-3217"><span class="linenos">3217</span></a>        <span class="c1"># Then we recursively expand these coefficients one by one into</span>
</span><span id="Expr.aseries-3218"><a href="#Expr.aseries-3218"><span class="linenos">3218</span></a>        <span class="c1"># their asymptotic series in terms of their most rapidly varying subexpressions.</span>
</span><span id="Expr.aseries-3219"><a href="#Expr.aseries-3219"><span class="linenos">3219</span></a>        <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">terms</span><span class="p">:</span>
</span><span id="Expr.aseries-3220"><a href="#Expr.aseries-3220"><span class="linenos">3220</span></a>            <span class="n">coeff</span><span class="p">,</span> <span class="n">expo</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">as_coeff_exponent</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
</span><span id="Expr.aseries-3221"><a href="#Expr.aseries-3221"><span class="linenos">3221</span></a>            <span class="k">if</span> <span class="n">coeff</span><span class="o">.</span><span class="n">has</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
</span><span id="Expr.aseries-3222"><a href="#Expr.aseries-3222"><span class="linenos">3222</span></a>                <span class="c1"># Recursive step</span>
</span><span id="Expr.aseries-3223"><a href="#Expr.aseries-3223"><span class="linenos">3223</span></a>                <span class="n">snew</span> <span class="o">=</span> <span class="n">coeff</span><span class="o">.</span><span class="n">aseries</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">bound</span><span class="o">=</span><span class="n">bound</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span><span id="Expr.aseries-3224"><a href="#Expr.aseries-3224"><span class="linenos">3224</span></a>                <span class="k">if</span> <span class="n">has_ord</span> <span class="ow">and</span> <span class="n">snew</span><span class="o">.</span><span class="n">getO</span><span class="p">():</span>
</span><span id="Expr.aseries-3225"><a href="#Expr.aseries-3225"><span class="linenos">3225</span></a>                    <span class="k">break</span>
</span><span id="Expr.aseries-3226"><a href="#Expr.aseries-3226"><span class="linenos">3226</span></a>                <span class="k">elif</span> <span class="n">snew</span><span class="o">.</span><span class="n">getO</span><span class="p">():</span>
</span><span id="Expr.aseries-3227"><a href="#Expr.aseries-3227"><span class="linenos">3227</span></a>                    <span class="n">has_ord</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="Expr.aseries-3228"><a href="#Expr.aseries-3228"><span class="linenos">3228</span></a>                <span class="n">s</span> <span class="o">+=</span> <span class="p">(</span><span class="n">snew</span> <span class="o">*</span> <span class="n">k</span><span class="o">**</span><span class="n">expo</span><span class="p">)</span>
</span><span id="Expr.aseries-3229"><a href="#Expr.aseries-3229"><span class="linenos">3229</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Expr.aseries-3230"><a href="#Expr.aseries-3230"><span class="linenos">3230</span></a>                <span class="n">s</span> <span class="o">+=</span> <span class="n">t</span>
</span><span id="Expr.aseries-3231"><a href="#Expr.aseries-3231"><span class="linenos">3231</span></a>
</span><span id="Expr.aseries-3232"><a href="#Expr.aseries-3232"><span class="linenos">3232</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">o</span> <span class="ow">or</span> <span class="n">has_ord</span><span class="p">:</span>
</span><span id="Expr.aseries-3233"><a href="#Expr.aseries-3233"><span class="linenos">3233</span></a>            <span class="k">return</span> <span class="n">s</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">exp</span><span class="p">(</span><span class="n">logw</span><span class="p">))</span>
</span><span id="Expr.aseries-3234"><a href="#Expr.aseries-3234"><span class="linenos">3234</span></a>        <span class="k">return</span> <span class="p">(</span><span class="n">s</span> <span class="o">+</span> <span class="n">o</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">exp</span><span class="p">(</span><span class="n">logw</span><span class="p">))</span>
</span></pre></div>


            <div class="docstring"><p>Asymptotic Series expansion of self.
This is equivalent to <code>self.series(x, oo, n)</code>.</p>

<h1 id="parameters">Parameters</h1>

<p>self : Expression
       The expression whose series is to be expanded.</p>

<p>x : Symbol
    It is the variable of the expression to be calculated.</p>

<p>n : Value
    The number of terms upto which the series is to be expanded.</p>

<p>hir : Boolean
      Set this parameter to be True to produce hierarchical series.
      It stops the recursion at an early level and may provide nicer
      and more useful results.</p>

<p>bound : Value, Integer
        Use the <code>bound</code> parameter to give limit on rewriting
        coefficients in its normalised form.</p>

<h1 id="examples">Examples</h1>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">sin</span><span class="p">,</span> <span class="n">exp</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.abc</span> <span class="kn">import</span> <span class="n">x</span>
</code></pre>
</div>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">e</span> <span class="o">=</span> <span class="n">sin</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">x</span> <span class="o">+</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">))</span> <span class="o">-</span> <span class="n">sin</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">x</span><span class="p">)</span>
</code></pre>
</div>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">e</span><span class="o">.</span><span class="n">aseries</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">(1/(24*x**4) - 1/(2*x**2) + 1 + O(x**(-6), (x, oo)))*exp(-x)</span>
</code></pre>
</div>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">e</span><span class="o">.</span><span class="n">aseries</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">hir</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">-exp(-2*x)*sin(1/x)/2 + exp(-x)*cos(1/x) + O(exp(-3*x), (x, oo))</span>
</code></pre>
</div>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">e</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="n">x</span><span class="p">))</span>
</code></pre>
</div>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">e</span><span class="o">.</span><span class="n">aseries</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">exp(exp(x)/(1 - 1/x))</span>
</code></pre>
</div>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">e</span><span class="o">.</span><span class="n">aseries</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">bound</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span> <span class="c1"># doctest: +SKIP</span>
<span class="go">exp(exp(x)/x**2)*exp(exp(x)/x)*exp(-exp(x) + exp(x)/(1 - 1/x) - exp(x)/x - exp(x)/x**2)*exp(exp(x))</span>
</code></pre>
</div>

<h1 id="returns">Returns</h1>

<p>Expr
    Asymptotic series expansion of the expression.</p>

<h1 id="notes">Notes</h1>

<p>This algorithm is directly induced from the limit computational algorithm provided by Gruntz.
It majorly uses the mrv and rewrite sub-routines. The overall idea of this algorithm is first
to look for the most rapidly varying subexpression w of a given expression f and then expands f
in a series in w. Then same thing is recursively done on the leading coefficient
till we get constant coefficients.</p>

<p>If the most rapidly varying subexpression of a given expression f is f itself,
the algorithm tries to find a normalised representation of the mrv set and rewrites f
using this normalised representation.</p>

<p>If the expansion contains an order term, it will be either <code>O(x ** (-n))</code> or <code>O(w ** (-n))</code>
where <code>w</code> belongs to the most rapidly varying expression of <code>self</code>.</p>

<h1 id="references">References</h1>

<h1 id="see-also">See Also</h1>

<p><a href="#Expr.aseries">Expr.aseries</a>: See the docstring of this function for complete details of this wrapper.</p>

<div class="footnotes">
<hr />
<ol>
</ol>
</div>
</div>


                            </div>
                            <div id="Expr.taylor_term" class="classattr">
                                        <input id="Expr.taylor_term-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">taylor_term</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">n</span>, </span><span class="param"><span class="n">x</span>, </span><span class="param"><span class="o">*</span><span class="n">previous_terms</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Expr.taylor_term-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Expr.taylor_term"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Expr.taylor_term-3237"><a href="#Expr.taylor_term-3237"><span class="linenos">3237</span></a>    <span class="k">def</span> <span class="nf">taylor_term</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">previous_terms</span><span class="p">):</span>
</span><span id="Expr.taylor_term-3238"><a href="#Expr.taylor_term-3238"><span class="linenos">3238</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;General method for the taylor term.</span>
</span><span id="Expr.taylor_term-3239"><a href="#Expr.taylor_term-3239"><span class="linenos">3239</span></a>
</span><span id="Expr.taylor_term-3240"><a href="#Expr.taylor_term-3240"><span class="linenos">3240</span></a><span class="sd">        This method is slow, because it differentiates n-times. Subclasses can</span>
</span><span id="Expr.taylor_term-3241"><a href="#Expr.taylor_term-3241"><span class="linenos">3241</span></a><span class="sd">        redefine it to make it faster by using the &quot;previous_terms&quot;.</span>
</span><span id="Expr.taylor_term-3242"><a href="#Expr.taylor_term-3242"><span class="linenos">3242</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Expr.taylor_term-3243"><a href="#Expr.taylor_term-3243"><span class="linenos">3243</span></a>        <span class="kn">from</span> <span class="nn">.symbol</span> <span class="kn">import</span> <span class="n">Dummy</span>
</span><span id="Expr.taylor_term-3244"><a href="#Expr.taylor_term-3244"><span class="linenos">3244</span></a>        <span class="kn">from</span> <span class="nn">sympy.functions.combinatorial.factorials</span> <span class="kn">import</span> <span class="n">factorial</span>
</span><span id="Expr.taylor_term-3245"><a href="#Expr.taylor_term-3245"><span class="linenos">3245</span></a>
</span><span id="Expr.taylor_term-3246"><a href="#Expr.taylor_term-3246"><span class="linenos">3246</span></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">sympify</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span><span id="Expr.taylor_term-3247"><a href="#Expr.taylor_term-3247"><span class="linenos">3247</span></a>        <span class="n">_x</span> <span class="o">=</span> <span class="n">Dummy</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
</span><span id="Expr.taylor_term-3248"><a href="#Expr.taylor_term-3248"><span class="linenos">3248</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">_x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">_x</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">_x</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="n">n</span> <span class="o">/</span> <span class="n">factorial</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>General method for the taylor term.</p>

<p>This method is slow, because it differentiates n-times. Subclasses can
redefine it to make it faster by using the "previous_terms".</p>
</div>


                            </div>
                            <div id="Expr.lseries" class="classattr">
                                        <input id="Expr.lseries-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">lseries</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">x</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="n">x0</span><span class="o">=</span><span class="mi">0</span>, </span><span class="param"><span class="nb">dir</span><span class="o">=</span><span class="s1">&#39;+&#39;</span>, </span><span class="param"><span class="n">logx</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="n">cdir</span><span class="o">=</span><span class="mi">0</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Expr.lseries-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Expr.lseries"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Expr.lseries-3250"><a href="#Expr.lseries-3250"><span class="linenos">3250</span></a>    <span class="k">def</span> <span class="nf">lseries</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">dir</span><span class="o">=</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="n">logx</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cdir</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
</span><span id="Expr.lseries-3251"><a href="#Expr.lseries-3251"><span class="linenos">3251</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Expr.lseries-3252"><a href="#Expr.lseries-3252"><span class="linenos">3252</span></a><span class="sd">        Wrapper for series yielding an iterator of the terms of the series.</span>
</span><span id="Expr.lseries-3253"><a href="#Expr.lseries-3253"><span class="linenos">3253</span></a>
</span><span id="Expr.lseries-3254"><a href="#Expr.lseries-3254"><span class="linenos">3254</span></a><span class="sd">        Note: an infinite series will yield an infinite iterator. The following,</span>
</span><span id="Expr.lseries-3255"><a href="#Expr.lseries-3255"><span class="linenos">3255</span></a><span class="sd">        for exaxmple, will never terminate. It will just keep printing terms</span>
</span><span id="Expr.lseries-3256"><a href="#Expr.lseries-3256"><span class="linenos">3256</span></a><span class="sd">        of the sin(x) series::</span>
</span><span id="Expr.lseries-3257"><a href="#Expr.lseries-3257"><span class="linenos">3257</span></a>
</span><span id="Expr.lseries-3258"><a href="#Expr.lseries-3258"><span class="linenos">3258</span></a><span class="sd">          for term in sin(x).lseries(x):</span>
</span><span id="Expr.lseries-3259"><a href="#Expr.lseries-3259"><span class="linenos">3259</span></a><span class="sd">              print term</span>
</span><span id="Expr.lseries-3260"><a href="#Expr.lseries-3260"><span class="linenos">3260</span></a>
</span><span id="Expr.lseries-3261"><a href="#Expr.lseries-3261"><span class="linenos">3261</span></a><span class="sd">        The advantage of lseries() over nseries() is that many times you are</span>
</span><span id="Expr.lseries-3262"><a href="#Expr.lseries-3262"><span class="linenos">3262</span></a><span class="sd">        just interested in the next term in the series (i.e. the first term for</span>
</span><span id="Expr.lseries-3263"><a href="#Expr.lseries-3263"><span class="linenos">3263</span></a><span class="sd">        example), but you do not know how many you should ask for in nseries()</span>
</span><span id="Expr.lseries-3264"><a href="#Expr.lseries-3264"><span class="linenos">3264</span></a><span class="sd">        using the &quot;n&quot; parameter.</span>
</span><span id="Expr.lseries-3265"><a href="#Expr.lseries-3265"><span class="linenos">3265</span></a>
</span><span id="Expr.lseries-3266"><a href="#Expr.lseries-3266"><span class="linenos">3266</span></a><span class="sd">        See also nseries().</span>
</span><span id="Expr.lseries-3267"><a href="#Expr.lseries-3267"><span class="linenos">3267</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Expr.lseries-3268"><a href="#Expr.lseries-3268"><span class="linenos">3268</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">series</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">dir</span><span class="o">=</span><span class="nb">dir</span><span class="p">,</span> <span class="n">logx</span><span class="o">=</span><span class="n">logx</span><span class="p">,</span> <span class="n">cdir</span><span class="o">=</span><span class="n">cdir</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Wrapper for series yielding an iterator of the terms of the series.</p>

<p>Note: an infinite series will yield an infinite iterator. The following,
for exaxmple, will never terminate. It will just keep printing terms
of the sin(x) series::</p>

<p>for term in sin(x).lseries(x):
      print term</p>

<p>The advantage of lseries() over nseries() is that many times you are
just interested in the next term in the series (i.e. the first term for
example), but you do not know how many you should ask for in nseries()
using the "n" parameter.</p>

<p>See also nseries().</p>
</div>


                            </div>
                            <div id="Expr.nseries" class="classattr">
                                        <input id="Expr.nseries-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">nseries</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">x</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="n">x0</span><span class="o">=</span><span class="mi">0</span>, </span><span class="param"><span class="n">n</span><span class="o">=</span><span class="mi">6</span>, </span><span class="param"><span class="nb">dir</span><span class="o">=</span><span class="s1">&#39;+&#39;</span>, </span><span class="param"><span class="n">logx</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="n">cdir</span><span class="o">=</span><span class="mi">0</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Expr.nseries-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Expr.nseries"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Expr.nseries-3299"><a href="#Expr.nseries-3299"><span class="linenos">3299</span></a>    <span class="k">def</span> <span class="nf">nseries</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="nb">dir</span><span class="o">=</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="n">logx</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cdir</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
</span><span id="Expr.nseries-3300"><a href="#Expr.nseries-3300"><span class="linenos">3300</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Expr.nseries-3301"><a href="#Expr.nseries-3301"><span class="linenos">3301</span></a><span class="sd">        Wrapper to _eval_nseries if assumptions allow, else to series.</span>
</span><span id="Expr.nseries-3302"><a href="#Expr.nseries-3302"><span class="linenos">3302</span></a>
</span><span id="Expr.nseries-3303"><a href="#Expr.nseries-3303"><span class="linenos">3303</span></a><span class="sd">        If x is given, x0 is 0, dir=&#39;+&#39;, and self has x, then _eval_nseries is</span>
</span><span id="Expr.nseries-3304"><a href="#Expr.nseries-3304"><span class="linenos">3304</span></a><span class="sd">        called. This calculates &quot;n&quot; terms in the innermost expressions and</span>
</span><span id="Expr.nseries-3305"><a href="#Expr.nseries-3305"><span class="linenos">3305</span></a><span class="sd">        then builds up the final series just by &quot;cross-multiplying&quot; everything</span>
</span><span id="Expr.nseries-3306"><a href="#Expr.nseries-3306"><span class="linenos">3306</span></a><span class="sd">        out.</span>
</span><span id="Expr.nseries-3307"><a href="#Expr.nseries-3307"><span class="linenos">3307</span></a>
</span><span id="Expr.nseries-3308"><a href="#Expr.nseries-3308"><span class="linenos">3308</span></a><span class="sd">        The optional ``logx`` parameter can be used to replace any log(x) in the</span>
</span><span id="Expr.nseries-3309"><a href="#Expr.nseries-3309"><span class="linenos">3309</span></a><span class="sd">        returned series with a symbolic value to avoid evaluating log(x) at 0. A</span>
</span><span id="Expr.nseries-3310"><a href="#Expr.nseries-3310"><span class="linenos">3310</span></a><span class="sd">        symbol to use in place of log(x) should be provided.</span>
</span><span id="Expr.nseries-3311"><a href="#Expr.nseries-3311"><span class="linenos">3311</span></a>
</span><span id="Expr.nseries-3312"><a href="#Expr.nseries-3312"><span class="linenos">3312</span></a><span class="sd">        Advantage -- it&#39;s fast, because we do not have to determine how many</span>
</span><span id="Expr.nseries-3313"><a href="#Expr.nseries-3313"><span class="linenos">3313</span></a><span class="sd">        terms we need to calculate in advance.</span>
</span><span id="Expr.nseries-3314"><a href="#Expr.nseries-3314"><span class="linenos">3314</span></a>
</span><span id="Expr.nseries-3315"><a href="#Expr.nseries-3315"><span class="linenos">3315</span></a><span class="sd">        Disadvantage -- you may end up with less terms than you may have</span>
</span><span id="Expr.nseries-3316"><a href="#Expr.nseries-3316"><span class="linenos">3316</span></a><span class="sd">        expected, but the O(x**n) term appended will always be correct and</span>
</span><span id="Expr.nseries-3317"><a href="#Expr.nseries-3317"><span class="linenos">3317</span></a><span class="sd">        so the result, though perhaps shorter, will also be correct.</span>
</span><span id="Expr.nseries-3318"><a href="#Expr.nseries-3318"><span class="linenos">3318</span></a>
</span><span id="Expr.nseries-3319"><a href="#Expr.nseries-3319"><span class="linenos">3319</span></a><span class="sd">        If any of those assumptions is not met, this is treated like a</span>
</span><span id="Expr.nseries-3320"><a href="#Expr.nseries-3320"><span class="linenos">3320</span></a><span class="sd">        wrapper to series which will try harder to return the correct</span>
</span><span id="Expr.nseries-3321"><a href="#Expr.nseries-3321"><span class="linenos">3321</span></a><span class="sd">        number of terms.</span>
</span><span id="Expr.nseries-3322"><a href="#Expr.nseries-3322"><span class="linenos">3322</span></a>
</span><span id="Expr.nseries-3323"><a href="#Expr.nseries-3323"><span class="linenos">3323</span></a><span class="sd">        See also lseries().</span>
</span><span id="Expr.nseries-3324"><a href="#Expr.nseries-3324"><span class="linenos">3324</span></a>
</span><span id="Expr.nseries-3325"><a href="#Expr.nseries-3325"><span class="linenos">3325</span></a><span class="sd">        Examples</span>
</span><span id="Expr.nseries-3326"><a href="#Expr.nseries-3326"><span class="linenos">3326</span></a><span class="sd">        ========</span>
</span><span id="Expr.nseries-3327"><a href="#Expr.nseries-3327"><span class="linenos">3327</span></a>
</span><span id="Expr.nseries-3328"><a href="#Expr.nseries-3328"><span class="linenos">3328</span></a><span class="sd">        &gt;&gt;&gt; from sympy import sin, log, Symbol</span>
</span><span id="Expr.nseries-3329"><a href="#Expr.nseries-3329"><span class="linenos">3329</span></a><span class="sd">        &gt;&gt;&gt; from sympy.abc import x, y</span>
</span><span id="Expr.nseries-3330"><a href="#Expr.nseries-3330"><span class="linenos">3330</span></a><span class="sd">        &gt;&gt;&gt; sin(x).nseries(x, 0, 6)</span>
</span><span id="Expr.nseries-3331"><a href="#Expr.nseries-3331"><span class="linenos">3331</span></a><span class="sd">        x - x**3/6 + x**5/120 + O(x**6)</span>
</span><span id="Expr.nseries-3332"><a href="#Expr.nseries-3332"><span class="linenos">3332</span></a><span class="sd">        &gt;&gt;&gt; log(x+1).nseries(x, 0, 5)</span>
</span><span id="Expr.nseries-3333"><a href="#Expr.nseries-3333"><span class="linenos">3333</span></a><span class="sd">        x - x**2/2 + x**3/3 - x**4/4 + O(x**5)</span>
</span><span id="Expr.nseries-3334"><a href="#Expr.nseries-3334"><span class="linenos">3334</span></a>
</span><span id="Expr.nseries-3335"><a href="#Expr.nseries-3335"><span class="linenos">3335</span></a><span class="sd">        Handling of the ``logx`` parameter --- in the following example the</span>
</span><span id="Expr.nseries-3336"><a href="#Expr.nseries-3336"><span class="linenos">3336</span></a><span class="sd">        expansion fails since ``sin`` does not have an asymptotic expansion</span>
</span><span id="Expr.nseries-3337"><a href="#Expr.nseries-3337"><span class="linenos">3337</span></a><span class="sd">        at -oo (the limit of log(x) as x approaches 0):</span>
</span><span id="Expr.nseries-3338"><a href="#Expr.nseries-3338"><span class="linenos">3338</span></a>
</span><span id="Expr.nseries-3339"><a href="#Expr.nseries-3339"><span class="linenos">3339</span></a><span class="sd">        &gt;&gt;&gt; e = sin(log(x))</span>
</span><span id="Expr.nseries-3340"><a href="#Expr.nseries-3340"><span class="linenos">3340</span></a><span class="sd">        &gt;&gt;&gt; e.nseries(x, 0, 6)</span>
</span><span id="Expr.nseries-3341"><a href="#Expr.nseries-3341"><span class="linenos">3341</span></a><span class="sd">        Traceback (most recent call last):</span>
</span><span id="Expr.nseries-3342"><a href="#Expr.nseries-3342"><span class="linenos">3342</span></a><span class="sd">        ...</span>
</span><span id="Expr.nseries-3343"><a href="#Expr.nseries-3343"><span class="linenos">3343</span></a><span class="sd">        PoleError: ...</span>
</span><span id="Expr.nseries-3344"><a href="#Expr.nseries-3344"><span class="linenos">3344</span></a><span class="sd">        ...</span>
</span><span id="Expr.nseries-3345"><a href="#Expr.nseries-3345"><span class="linenos">3345</span></a><span class="sd">        &gt;&gt;&gt; logx = Symbol(&#39;logx&#39;)</span>
</span><span id="Expr.nseries-3346"><a href="#Expr.nseries-3346"><span class="linenos">3346</span></a><span class="sd">        &gt;&gt;&gt; e.nseries(x, 0, 6, logx=logx)</span>
</span><span id="Expr.nseries-3347"><a href="#Expr.nseries-3347"><span class="linenos">3347</span></a><span class="sd">        sin(logx)</span>
</span><span id="Expr.nseries-3348"><a href="#Expr.nseries-3348"><span class="linenos">3348</span></a>
</span><span id="Expr.nseries-3349"><a href="#Expr.nseries-3349"><span class="linenos">3349</span></a><span class="sd">        In the following example, the expansion works but gives only an Order term</span>
</span><span id="Expr.nseries-3350"><a href="#Expr.nseries-3350"><span class="linenos">3350</span></a><span class="sd">        unless the ``logx`` parameter is used:</span>
</span><span id="Expr.nseries-3351"><a href="#Expr.nseries-3351"><span class="linenos">3351</span></a>
</span><span id="Expr.nseries-3352"><a href="#Expr.nseries-3352"><span class="linenos">3352</span></a><span class="sd">        &gt;&gt;&gt; e = x**y</span>
</span><span id="Expr.nseries-3353"><a href="#Expr.nseries-3353"><span class="linenos">3353</span></a><span class="sd">        &gt;&gt;&gt; e.nseries(x, 0, 2)</span>
</span><span id="Expr.nseries-3354"><a href="#Expr.nseries-3354"><span class="linenos">3354</span></a><span class="sd">        O(log(x)**2)</span>
</span><span id="Expr.nseries-3355"><a href="#Expr.nseries-3355"><span class="linenos">3355</span></a><span class="sd">        &gt;&gt;&gt; e.nseries(x, 0, 2, logx=logx)</span>
</span><span id="Expr.nseries-3356"><a href="#Expr.nseries-3356"><span class="linenos">3356</span></a><span class="sd">        exp(logx*y)</span>
</span><span id="Expr.nseries-3357"><a href="#Expr.nseries-3357"><span class="linenos">3357</span></a>
</span><span id="Expr.nseries-3358"><a href="#Expr.nseries-3358"><span class="linenos">3358</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Expr.nseries-3359"><a href="#Expr.nseries-3359"><span class="linenos">3359</span></a>        <span class="k">if</span> <span class="n">x</span> <span class="ow">and</span> <span class="n">x</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">free_symbols</span><span class="p">:</span>
</span><span id="Expr.nseries-3360"><a href="#Expr.nseries-3360"><span class="linenos">3360</span></a>            <span class="k">return</span> <span class="bp">self</span>
</span><span id="Expr.nseries-3361"><a href="#Expr.nseries-3361"><span class="linenos">3361</span></a>        <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">x0</span> <span class="ow">or</span> <span class="nb">dir</span> <span class="o">!=</span> <span class="s1">&#39;+&#39;</span><span class="p">:</span>  <span class="c1"># {see XPOS above} or (x.is_positive == x.is_negative == None):</span>
</span><span id="Expr.nseries-3362"><a href="#Expr.nseries-3362"><span class="linenos">3362</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">series</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="nb">dir</span><span class="p">,</span> <span class="n">cdir</span><span class="o">=</span><span class="n">cdir</span><span class="p">)</span>
</span><span id="Expr.nseries-3363"><a href="#Expr.nseries-3363"><span class="linenos">3363</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Expr.nseries-3364"><a href="#Expr.nseries-3364"><span class="linenos">3364</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_eval_nseries</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">logx</span><span class="o">=</span><span class="n">logx</span><span class="p">,</span> <span class="n">cdir</span><span class="o">=</span><span class="n">cdir</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Wrapper to _eval_nseries if assumptions allow, else to series.</p>

<p>If x is given, x0 is 0, dir='+', and self has x, then _eval_nseries is
called. This calculates "n" terms in the innermost expressions and
then builds up the final series just by "cross-multiplying" everything
out.</p>

<p>The optional <code>logx</code> parameter can be used to replace any log(x) in the
returned series with a symbolic value to avoid evaluating log(x) at 0. A
symbol to use in place of log(x) should be provided.</p>

<p>Advantage -- it's fast, because we do not have to determine how many
terms we need to calculate in advance.</p>

<p>Disadvantage -- you may end up with less terms than you may have
expected, but the O(x**n) term appended will always be correct and
so the result, though perhaps shorter, will also be correct.</p>

<p>If any of those assumptions is not met, this is treated like a
wrapper to series which will try harder to return the correct
number of terms.</p>

<p>See also lseries().</p>

<h1 id="examples">Examples</h1>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">sin</span><span class="p">,</span> <span class="n">log</span><span class="p">,</span> <span class="n">Symbol</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.abc</span> <span class="kn">import</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">nseries</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="go">x - x**3/6 + x**5/120 + O(x**6)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">nseries</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="go">x - x**2/2 + x**3/3 - x**4/4 + O(x**5)</span>
</code></pre>
</div>

<p>Handling of the <code>logx</code> parameter --- in the following example the
expansion fails since <code>sin</code> does not have an asymptotic expansion
at -oo (the limit of log(x) as x approaches 0):</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">e</span> <span class="o">=</span> <span class="n">sin</span><span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e</span><span class="o">.</span><span class="n">nseries</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">PoleError</span>: <span class="n">...</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">logx</span> <span class="o">=</span> <span class="n">Symbol</span><span class="p">(</span><span class="s1">&#39;logx&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e</span><span class="o">.</span><span class="n">nseries</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">logx</span><span class="o">=</span><span class="n">logx</span><span class="p">)</span>
<span class="go">sin(logx)</span>
</code></pre>
</div>

<p>In the following example, the expansion works but gives only an Order term
unless the <code>logx</code> parameter is used:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">e</span> <span class="o">=</span> <span class="n">x</span><span class="o">**</span><span class="n">y</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e</span><span class="o">.</span><span class="n">nseries</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">O(log(x)**2)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e</span><span class="o">.</span><span class="n">nseries</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">logx</span><span class="o">=</span><span class="n">logx</span><span class="p">)</span>
<span class="go">exp(logx*y)</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="Expr.limit" class="classattr">
                                        <input id="Expr.limit-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">limit</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">x</span>, </span><span class="param"><span class="n">xlim</span>, </span><span class="param"><span class="nb">dir</span><span class="o">=</span><span class="s1">&#39;+&#39;</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Expr.limit-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Expr.limit"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Expr.limit-3382"><a href="#Expr.limit-3382"><span class="linenos">3382</span></a>    <span class="k">def</span> <span class="nf">limit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">xlim</span><span class="p">,</span> <span class="nb">dir</span><span class="o">=</span><span class="s1">&#39;+&#39;</span><span class="p">):</span>
</span><span id="Expr.limit-3383"><a href="#Expr.limit-3383"><span class="linenos">3383</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; Compute limit x-&gt;xlim.</span>
</span><span id="Expr.limit-3384"><a href="#Expr.limit-3384"><span class="linenos">3384</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Expr.limit-3385"><a href="#Expr.limit-3385"><span class="linenos">3385</span></a>        <span class="kn">from</span> <span class="nn">sympy.series.limits</span> <span class="kn">import</span> <span class="n">limit</span>
</span><span id="Expr.limit-3386"><a href="#Expr.limit-3386"><span class="linenos">3386</span></a>        <span class="k">return</span> <span class="n">limit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">xlim</span><span class="p">,</span> <span class="nb">dir</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Compute limit x->xlim.</p>
</div>


                            </div>
                            <div id="Expr.compute_leading_term" class="classattr">
                                        <input id="Expr.compute_leading_term-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">compute_leading_term</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">x</span>, </span><span class="param"><span class="n">logx</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Expr.compute_leading_term-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Expr.compute_leading_term"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Expr.compute_leading_term-3388"><a href="#Expr.compute_leading_term-3388"><span class="linenos">3388</span></a>    <span class="k">def</span> <span class="nf">compute_leading_term</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">logx</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="Expr.compute_leading_term-3389"><a href="#Expr.compute_leading_term-3389"><span class="linenos">3389</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Expr.compute_leading_term-3390"><a href="#Expr.compute_leading_term-3390"><span class="linenos">3390</span></a><span class="sd">        as_leading_term is only allowed for results of .series()</span>
</span><span id="Expr.compute_leading_term-3391"><a href="#Expr.compute_leading_term-3391"><span class="linenos">3391</span></a><span class="sd">        This is a wrapper to compute a series first.</span>
</span><span id="Expr.compute_leading_term-3392"><a href="#Expr.compute_leading_term-3392"><span class="linenos">3392</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Expr.compute_leading_term-3393"><a href="#Expr.compute_leading_term-3393"><span class="linenos">3393</span></a>
</span><span id="Expr.compute_leading_term-3394"><a href="#Expr.compute_leading_term-3394"><span class="linenos">3394</span></a>        <span class="kn">from</span> <span class="nn">sympy.functions.elementary.piecewise</span> <span class="kn">import</span> <span class="n">Piecewise</span><span class="p">,</span> <span class="n">piecewise_fold</span>
</span><span id="Expr.compute_leading_term-3395"><a href="#Expr.compute_leading_term-3395"><span class="linenos">3395</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">has</span><span class="p">(</span><span class="n">Piecewise</span><span class="p">):</span>
</span><span id="Expr.compute_leading_term-3396"><a href="#Expr.compute_leading_term-3396"><span class="linenos">3396</span></a>            <span class="n">expr</span> <span class="o">=</span> <span class="n">piecewise_fold</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="Expr.compute_leading_term-3397"><a href="#Expr.compute_leading_term-3397"><span class="linenos">3397</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Expr.compute_leading_term-3398"><a href="#Expr.compute_leading_term-3398"><span class="linenos">3398</span></a>            <span class="n">expr</span> <span class="o">=</span> <span class="bp">self</span>
</span><span id="Expr.compute_leading_term-3399"><a href="#Expr.compute_leading_term-3399"><span class="linenos">3399</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">removeO</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Expr.compute_leading_term-3400"><a href="#Expr.compute_leading_term-3400"><span class="linenos">3400</span></a>            <span class="k">return</span> <span class="bp">self</span>
</span><span id="Expr.compute_leading_term-3401"><a href="#Expr.compute_leading_term-3401"><span class="linenos">3401</span></a>
</span><span id="Expr.compute_leading_term-3402"><a href="#Expr.compute_leading_term-3402"><span class="linenos">3402</span></a>        <span class="kn">from</span> <span class="nn">sympy.series.gruntz</span> <span class="kn">import</span> <span class="n">calculate_series</span>
</span><span id="Expr.compute_leading_term-3403"><a href="#Expr.compute_leading_term-3403"><span class="linenos">3403</span></a>
</span><span id="Expr.compute_leading_term-3404"><a href="#Expr.compute_leading_term-3404"><span class="linenos">3404</span></a>        <span class="k">if</span> <span class="n">logx</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Expr.compute_leading_term-3405"><a href="#Expr.compute_leading_term-3405"><span class="linenos">3405</span></a>            <span class="kn">from</span> <span class="nn">.symbol</span> <span class="kn">import</span> <span class="n">Dummy</span>
</span><span id="Expr.compute_leading_term-3406"><a href="#Expr.compute_leading_term-3406"><span class="linenos">3406</span></a>            <span class="kn">from</span> <span class="nn">sympy.functions.elementary.exponential</span> <span class="kn">import</span> <span class="n">log</span>
</span><span id="Expr.compute_leading_term-3407"><a href="#Expr.compute_leading_term-3407"><span class="linenos">3407</span></a>            <span class="n">d</span> <span class="o">=</span> <span class="n">Dummy</span><span class="p">(</span><span class="s1">&#39;logx&#39;</span><span class="p">)</span>
</span><span id="Expr.compute_leading_term-3408"><a href="#Expr.compute_leading_term-3408"><span class="linenos">3408</span></a>            <span class="n">s</span> <span class="o">=</span> <span class="n">calculate_series</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</span><span id="Expr.compute_leading_term-3409"><a href="#Expr.compute_leading_term-3409"><span class="linenos">3409</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Expr.compute_leading_term-3410"><a href="#Expr.compute_leading_term-3410"><span class="linenos">3410</span></a>            <span class="n">s</span> <span class="o">=</span> <span class="n">calculate_series</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">logx</span><span class="p">)</span>
</span><span id="Expr.compute_leading_term-3411"><a href="#Expr.compute_leading_term-3411"><span class="linenos">3411</span></a>
</span><span id="Expr.compute_leading_term-3412"><a href="#Expr.compute_leading_term-3412"><span class="linenos">3412</span></a>        <span class="k">return</span> <span class="n">s</span><span class="o">.</span><span class="n">as_leading_term</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>as_leading_term is only allowed for results of .series()
This is a wrapper to compute a series first.</p>
</div>


                            </div>
                            <div id="Expr.as_leading_term" class="classattr">
                                        <input id="Expr.as_leading_term-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@cacheit</div>

        <span class="def">def</span>
        <span class="name">as_leading_term</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="o">*</span><span class="n">symbols</span>, </span><span class="param"><span class="n">logx</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="n">cdir</span><span class="o">=</span><span class="mi">0</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Expr.as_leading_term-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Expr.as_leading_term"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Expr.as_leading_term-3414"><a href="#Expr.as_leading_term-3414"><span class="linenos">3414</span></a>    <span class="nd">@cacheit</span>
</span><span id="Expr.as_leading_term-3415"><a href="#Expr.as_leading_term-3415"><span class="linenos">3415</span></a>    <span class="k">def</span> <span class="nf">as_leading_term</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">symbols</span><span class="p">,</span> <span class="n">logx</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cdir</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
</span><span id="Expr.as_leading_term-3416"><a href="#Expr.as_leading_term-3416"><span class="linenos">3416</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Expr.as_leading_term-3417"><a href="#Expr.as_leading_term-3417"><span class="linenos">3417</span></a><span class="sd">        Returns the leading (nonzero) term of the series expansion of self.</span>
</span><span id="Expr.as_leading_term-3418"><a href="#Expr.as_leading_term-3418"><span class="linenos">3418</span></a>
</span><span id="Expr.as_leading_term-3419"><a href="#Expr.as_leading_term-3419"><span class="linenos">3419</span></a><span class="sd">        The _eval_as_leading_term routines are used to do this, and they must</span>
</span><span id="Expr.as_leading_term-3420"><a href="#Expr.as_leading_term-3420"><span class="linenos">3420</span></a><span class="sd">        always return a non-zero value.</span>
</span><span id="Expr.as_leading_term-3421"><a href="#Expr.as_leading_term-3421"><span class="linenos">3421</span></a>
</span><span id="Expr.as_leading_term-3422"><a href="#Expr.as_leading_term-3422"><span class="linenos">3422</span></a><span class="sd">        Examples</span>
</span><span id="Expr.as_leading_term-3423"><a href="#Expr.as_leading_term-3423"><span class="linenos">3423</span></a><span class="sd">        ========</span>
</span><span id="Expr.as_leading_term-3424"><a href="#Expr.as_leading_term-3424"><span class="linenos">3424</span></a>
</span><span id="Expr.as_leading_term-3425"><a href="#Expr.as_leading_term-3425"><span class="linenos">3425</span></a><span class="sd">        &gt;&gt;&gt; from sympy.abc import x</span>
</span><span id="Expr.as_leading_term-3426"><a href="#Expr.as_leading_term-3426"><span class="linenos">3426</span></a><span class="sd">        &gt;&gt;&gt; (1 + x + x**2).as_leading_term(x)</span>
</span><span id="Expr.as_leading_term-3427"><a href="#Expr.as_leading_term-3427"><span class="linenos">3427</span></a><span class="sd">        1</span>
</span><span id="Expr.as_leading_term-3428"><a href="#Expr.as_leading_term-3428"><span class="linenos">3428</span></a><span class="sd">        &gt;&gt;&gt; (1/x**2 + x + x**2).as_leading_term(x)</span>
</span><span id="Expr.as_leading_term-3429"><a href="#Expr.as_leading_term-3429"><span class="linenos">3429</span></a><span class="sd">        x**(-2)</span>
</span><span id="Expr.as_leading_term-3430"><a href="#Expr.as_leading_term-3430"><span class="linenos">3430</span></a>
</span><span id="Expr.as_leading_term-3431"><a href="#Expr.as_leading_term-3431"><span class="linenos">3431</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Expr.as_leading_term-3432"><a href="#Expr.as_leading_term-3432"><span class="linenos">3432</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">symbols</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Expr.as_leading_term-3433"><a href="#Expr.as_leading_term-3433"><span class="linenos">3433</span></a>            <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span>
</span><span id="Expr.as_leading_term-3434"><a href="#Expr.as_leading_term-3434"><span class="linenos">3434</span></a>            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">symbols</span><span class="p">:</span>
</span><span id="Expr.as_leading_term-3435"><a href="#Expr.as_leading_term-3435"><span class="linenos">3435</span></a>                <span class="n">c</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">as_leading_term</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">logx</span><span class="o">=</span><span class="n">logx</span><span class="p">,</span> <span class="n">cdir</span><span class="o">=</span><span class="n">cdir</span><span class="p">)</span>
</span><span id="Expr.as_leading_term-3436"><a href="#Expr.as_leading_term-3436"><span class="linenos">3436</span></a>            <span class="k">return</span> <span class="n">c</span>
</span><span id="Expr.as_leading_term-3437"><a href="#Expr.as_leading_term-3437"><span class="linenos">3437</span></a>        <span class="k">elif</span> <span class="ow">not</span> <span class="n">symbols</span><span class="p">:</span>
</span><span id="Expr.as_leading_term-3438"><a href="#Expr.as_leading_term-3438"><span class="linenos">3438</span></a>            <span class="k">return</span> <span class="bp">self</span>
</span><span id="Expr.as_leading_term-3439"><a href="#Expr.as_leading_term-3439"><span class="linenos">3439</span></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">sympify</span><span class="p">(</span><span class="n">symbols</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="Expr.as_leading_term-3440"><a href="#Expr.as_leading_term-3440"><span class="linenos">3440</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">x</span><span class="o">.</span><span class="n">is_symbol</span><span class="p">:</span>
</span><span id="Expr.as_leading_term-3441"><a href="#Expr.as_leading_term-3441"><span class="linenos">3441</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;expecting a Symbol but got </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">x</span><span class="p">)</span>
</span><span id="Expr.as_leading_term-3442"><a href="#Expr.as_leading_term-3442"><span class="linenos">3442</span></a>        <span class="k">if</span> <span class="n">x</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">free_symbols</span><span class="p">:</span>
</span><span id="Expr.as_leading_term-3443"><a href="#Expr.as_leading_term-3443"><span class="linenos">3443</span></a>            <span class="k">return</span> <span class="bp">self</span>
</span><span id="Expr.as_leading_term-3444"><a href="#Expr.as_leading_term-3444"><span class="linenos">3444</span></a>        <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_eval_as_leading_term</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">logx</span><span class="o">=</span><span class="n">logx</span><span class="p">,</span> <span class="n">cdir</span><span class="o">=</span><span class="n">cdir</span><span class="p">)</span>
</span><span id="Expr.as_leading_term-3445"><a href="#Expr.as_leading_term-3445"><span class="linenos">3445</span></a>        <span class="k">if</span> <span class="n">obj</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Expr.as_leading_term-3446"><a href="#Expr.as_leading_term-3446"><span class="linenos">3446</span></a>            <span class="kn">from</span> <span class="nn">sympy.simplify.powsimp</span> <span class="kn">import</span> <span class="n">powsimp</span>
</span><span id="Expr.as_leading_term-3447"><a href="#Expr.as_leading_term-3447"><span class="linenos">3447</span></a>            <span class="k">return</span> <span class="n">powsimp</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">combine</span><span class="o">=</span><span class="s1">&#39;exp&#39;</span><span class="p">)</span>
</span><span id="Expr.as_leading_term-3448"><a href="#Expr.as_leading_term-3448"><span class="linenos">3448</span></a>        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;as_leading_term(</span><span class="si">%s</span><span class="s1">, </span><span class="si">%s</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">))</span>
</span></pre></div>


            <div class="docstring"><p>Returns the leading (nonzero) term of the series expansion of self.</p>

<p>The _eval_as_leading_term routines are used to do this, and they must
always return a non-zero value.</p>

<h1 id="examples">Examples</h1>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.abc</span> <span class="kn">import</span> <span class="n">x</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">as_leading_term</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">as_leading_term</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">x**(-2)</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="Expr.as_coeff_exponent" class="classattr">
                                        <input id="Expr.as_coeff_exponent-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">as_coeff_exponent</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">x</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Expr.as_coeff_exponent-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Expr.as_coeff_exponent"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Expr.as_coeff_exponent-3453"><a href="#Expr.as_coeff_exponent-3453"><span class="linenos">3453</span></a>    <span class="k">def</span> <span class="nf">as_coeff_exponent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
</span><span id="Expr.as_coeff_exponent-3454"><a href="#Expr.as_coeff_exponent-3454"><span class="linenos">3454</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; ``c*x**e -&gt; c,e`` where x can be any symbolic expression.</span>
</span><span id="Expr.as_coeff_exponent-3455"><a href="#Expr.as_coeff_exponent-3455"><span class="linenos">3455</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Expr.as_coeff_exponent-3456"><a href="#Expr.as_coeff_exponent-3456"><span class="linenos">3456</span></a>        <span class="kn">from</span> <span class="nn">sympy.simplify.radsimp</span> <span class="kn">import</span> <span class="n">collect</span>
</span><span id="Expr.as_coeff_exponent-3457"><a href="#Expr.as_coeff_exponent-3457"><span class="linenos">3457</span></a>        <span class="n">s</span> <span class="o">=</span> <span class="n">collect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</span><span id="Expr.as_coeff_exponent-3458"><a href="#Expr.as_coeff_exponent-3458"><span class="linenos">3458</span></a>        <span class="n">c</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">as_coeff_mul</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span><span id="Expr.as_coeff_exponent-3459"><a href="#Expr.as_coeff_exponent-3459"><span class="linenos">3459</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Expr.as_coeff_exponent-3460"><a href="#Expr.as_coeff_exponent-3460"><span class="linenos">3460</span></a>            <span class="n">b</span><span class="p">,</span> <span class="n">e</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">as_base_exp</span><span class="p">()</span>
</span><span id="Expr.as_coeff_exponent-3461"><a href="#Expr.as_coeff_exponent-3461"><span class="linenos">3461</span></a>            <span class="k">if</span> <span class="n">b</span> <span class="o">==</span> <span class="n">x</span><span class="p">:</span>
</span><span id="Expr.as_coeff_exponent-3462"><a href="#Expr.as_coeff_exponent-3462"><span class="linenos">3462</span></a>                <span class="k">return</span> <span class="n">c</span><span class="p">,</span> <span class="n">e</span>
</span><span id="Expr.as_coeff_exponent-3463"><a href="#Expr.as_coeff_exponent-3463"><span class="linenos">3463</span></a>        <span class="k">return</span> <span class="n">s</span><span class="p">,</span> <span class="n">S</span><span class="o">.</span><span class="n">Zero</span>
</span></pre></div>


            <div class="docstring"><p><code>c*x**e -&gt; c,e</code> where x can be any symbolic expression.</p>
</div>


                            </div>
                            <div id="Expr.leadterm" class="classattr">
                                        <input id="Expr.leadterm-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">leadterm</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">x</span>, </span><span class="param"><span class="n">logx</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="n">cdir</span><span class="o">=</span><span class="mi">0</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Expr.leadterm-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Expr.leadterm"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Expr.leadterm-3465"><a href="#Expr.leadterm-3465"><span class="linenos">3465</span></a>    <span class="k">def</span> <span class="nf">leadterm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">logx</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cdir</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
</span><span id="Expr.leadterm-3466"><a href="#Expr.leadterm-3466"><span class="linenos">3466</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Expr.leadterm-3467"><a href="#Expr.leadterm-3467"><span class="linenos">3467</span></a><span class="sd">        Returns the leading term a*x**b as a tuple (a, b).</span>
</span><span id="Expr.leadterm-3468"><a href="#Expr.leadterm-3468"><span class="linenos">3468</span></a>
</span><span id="Expr.leadterm-3469"><a href="#Expr.leadterm-3469"><span class="linenos">3469</span></a><span class="sd">        Examples</span>
</span><span id="Expr.leadterm-3470"><a href="#Expr.leadterm-3470"><span class="linenos">3470</span></a><span class="sd">        ========</span>
</span><span id="Expr.leadterm-3471"><a href="#Expr.leadterm-3471"><span class="linenos">3471</span></a>
</span><span id="Expr.leadterm-3472"><a href="#Expr.leadterm-3472"><span class="linenos">3472</span></a><span class="sd">        &gt;&gt;&gt; from sympy.abc import x</span>
</span><span id="Expr.leadterm-3473"><a href="#Expr.leadterm-3473"><span class="linenos">3473</span></a><span class="sd">        &gt;&gt;&gt; (1+x+x**2).leadterm(x)</span>
</span><span id="Expr.leadterm-3474"><a href="#Expr.leadterm-3474"><span class="linenos">3474</span></a><span class="sd">        (1, 0)</span>
</span><span id="Expr.leadterm-3475"><a href="#Expr.leadterm-3475"><span class="linenos">3475</span></a><span class="sd">        &gt;&gt;&gt; (1/x**2+x+x**2).leadterm(x)</span>
</span><span id="Expr.leadterm-3476"><a href="#Expr.leadterm-3476"><span class="linenos">3476</span></a><span class="sd">        (1, -2)</span>
</span><span id="Expr.leadterm-3477"><a href="#Expr.leadterm-3477"><span class="linenos">3477</span></a>
</span><span id="Expr.leadterm-3478"><a href="#Expr.leadterm-3478"><span class="linenos">3478</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Expr.leadterm-3479"><a href="#Expr.leadterm-3479"><span class="linenos">3479</span></a>        <span class="kn">from</span> <span class="nn">.symbol</span> <span class="kn">import</span> <span class="n">Dummy</span>
</span><span id="Expr.leadterm-3480"><a href="#Expr.leadterm-3480"><span class="linenos">3480</span></a>        <span class="kn">from</span> <span class="nn">sympy.functions.elementary.exponential</span> <span class="kn">import</span> <span class="n">log</span>
</span><span id="Expr.leadterm-3481"><a href="#Expr.leadterm-3481"><span class="linenos">3481</span></a>        <span class="n">l</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">as_leading_term</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">logx</span><span class="o">=</span><span class="n">logx</span><span class="p">,</span> <span class="n">cdir</span><span class="o">=</span><span class="n">cdir</span><span class="p">)</span>
</span><span id="Expr.leadterm-3482"><a href="#Expr.leadterm-3482"><span class="linenos">3482</span></a>        <span class="n">d</span> <span class="o">=</span> <span class="n">Dummy</span><span class="p">(</span><span class="s1">&#39;logx&#39;</span><span class="p">)</span>
</span><span id="Expr.leadterm-3483"><a href="#Expr.leadterm-3483"><span class="linenos">3483</span></a>        <span class="k">if</span> <span class="n">l</span><span class="o">.</span><span class="n">has</span><span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)):</span>
</span><span id="Expr.leadterm-3484"><a href="#Expr.leadterm-3484"><span class="linenos">3484</span></a>            <span class="n">l</span> <span class="o">=</span> <span class="n">l</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">d</span><span class="p">)</span>
</span><span id="Expr.leadterm-3485"><a href="#Expr.leadterm-3485"><span class="linenos">3485</span></a>        <span class="n">c</span><span class="p">,</span> <span class="n">e</span> <span class="o">=</span> <span class="n">l</span><span class="o">.</span><span class="n">as_coeff_exponent</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span><span id="Expr.leadterm-3486"><a href="#Expr.leadterm-3486"><span class="linenos">3486</span></a>        <span class="k">if</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">c</span><span class="o">.</span><span class="n">free_symbols</span><span class="p">:</span>
</span><span id="Expr.leadterm-3487"><a href="#Expr.leadterm-3487"><span class="linenos">3487</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">filldedent</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
</span><span id="Expr.leadterm-3488"><a href="#Expr.leadterm-3488"><span class="linenos">3488</span></a><span class="s2">                cannot compute leadterm(</span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">). The coefficient</span>
</span><span id="Expr.leadterm-3489"><a href="#Expr.leadterm-3489"><span class="linenos">3489</span></a><span class="s2">                should have been free of </span><span class="si">%s</span><span class="s2"> but got </span><span class="si">%s</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="p">)))</span>
</span><span id="Expr.leadterm-3490"><a href="#Expr.leadterm-3490"><span class="linenos">3490</span></a>        <span class="n">c</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</span><span id="Expr.leadterm-3491"><a href="#Expr.leadterm-3491"><span class="linenos">3491</span></a>        <span class="k">return</span> <span class="n">c</span><span class="p">,</span> <span class="n">e</span>
</span></pre></div>


            <div class="docstring"><p>Returns the leading term a<em>x</em>*b as a tuple (a, b).</p>

<h1 id="examples">Examples</h1>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.abc</span> <span class="kn">import</span> <span class="n">x</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">x</span><span class="o">+</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">leadterm</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">(1, 0)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">x</span><span class="o">+</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">leadterm</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">(1, -2)</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="Expr.as_coeff_Mul" class="classattr">
                                        <input id="Expr.as_coeff_Mul-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">as_coeff_Mul</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">rational</span><span class="o">=</span><span class="kc">False</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Expr.as_coeff_Mul-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Expr.as_coeff_Mul"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Expr.as_coeff_Mul-3493"><a href="#Expr.as_coeff_Mul-3493"><span class="linenos">3493</span></a>    <span class="k">def</span> <span class="nf">as_coeff_Mul</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rational</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="Expr.as_coeff_Mul-3494"><a href="#Expr.as_coeff_Mul-3494"><span class="linenos">3494</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Efficiently extract the coefficient of a product. &quot;&quot;&quot;</span>
</span><span id="Expr.as_coeff_Mul-3495"><a href="#Expr.as_coeff_Mul-3495"><span class="linenos">3495</span></a>        <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">One</span><span class="p">,</span> <span class="bp">self</span>
</span></pre></div>


            <div class="docstring"><p>Efficiently extract the coefficient of a product.</p>
</div>


                            </div>
                            <div id="Expr.as_coeff_Add" class="classattr">
                                        <input id="Expr.as_coeff_Add-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">as_coeff_Add</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">rational</span><span class="o">=</span><span class="kc">False</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Expr.as_coeff_Add-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Expr.as_coeff_Add"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Expr.as_coeff_Add-3497"><a href="#Expr.as_coeff_Add-3497"><span class="linenos">3497</span></a>    <span class="k">def</span> <span class="nf">as_coeff_Add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rational</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="Expr.as_coeff_Add-3498"><a href="#Expr.as_coeff_Add-3498"><span class="linenos">3498</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Efficiently extract the coefficient of a summation. &quot;&quot;&quot;</span>
</span><span id="Expr.as_coeff_Add-3499"><a href="#Expr.as_coeff_Add-3499"><span class="linenos">3499</span></a>        <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">Zero</span><span class="p">,</span> <span class="bp">self</span>
</span></pre></div>


            <div class="docstring"><p>Efficiently extract the coefficient of a summation.</p>
</div>


                            </div>
                            <div id="Expr.fps" class="classattr">
                                        <input id="Expr.fps-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">fps</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">x</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">x0</span><span class="o">=</span><span class="mi">0</span>,</span><span class="param">	<span class="nb">dir</span><span class="o">=</span><span class="mi">1</span>,</span><span class="param">	<span class="n">hyper</span><span class="o">=</span><span class="kc">True</span>,</span><span class="param">	<span class="n">order</span><span class="o">=</span><span class="mi">4</span>,</span><span class="param">	<span class="n">rational</span><span class="o">=</span><span class="kc">True</span>,</span><span class="param">	<span class="n">full</span><span class="o">=</span><span class="kc">False</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Expr.fps-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Expr.fps"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Expr.fps-3501"><a href="#Expr.fps-3501"><span class="linenos">3501</span></a>    <span class="k">def</span> <span class="nf">fps</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">dir</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">hyper</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">rational</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="Expr.fps-3502"><a href="#Expr.fps-3502"><span class="linenos">3502</span></a>            <span class="n">full</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="Expr.fps-3503"><a href="#Expr.fps-3503"><span class="linenos">3503</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Expr.fps-3504"><a href="#Expr.fps-3504"><span class="linenos">3504</span></a><span class="sd">        Compute formal power power series of self.</span>
</span><span id="Expr.fps-3505"><a href="#Expr.fps-3505"><span class="linenos">3505</span></a>
</span><span id="Expr.fps-3506"><a href="#Expr.fps-3506"><span class="linenos">3506</span></a><span class="sd">        See the docstring of the :func:`fps` function in sympy.series.formal for</span>
</span><span id="Expr.fps-3507"><a href="#Expr.fps-3507"><span class="linenos">3507</span></a><span class="sd">        more information.</span>
</span><span id="Expr.fps-3508"><a href="#Expr.fps-3508"><span class="linenos">3508</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Expr.fps-3509"><a href="#Expr.fps-3509"><span class="linenos">3509</span></a>        <span class="kn">from</span> <span class="nn">sympy.series.formal</span> <span class="kn">import</span> <span class="n">fps</span>
</span><span id="Expr.fps-3510"><a href="#Expr.fps-3510"><span class="linenos">3510</span></a>
</span><span id="Expr.fps-3511"><a href="#Expr.fps-3511"><span class="linenos">3511</span></a>        <span class="k">return</span> <span class="n">fps</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="nb">dir</span><span class="p">,</span> <span class="n">hyper</span><span class="p">,</span> <span class="n">order</span><span class="p">,</span> <span class="n">rational</span><span class="p">,</span> <span class="n">full</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Compute formal power power series of self.</p>

<p>See the docstring of the <code><a href="#Expr.fps">fps()</a></code> function in sympy.series.formal for
more information.</p>
</div>


                            </div>
                            <div id="Expr.fourier_series" class="classattr">
                                        <input id="Expr.fourier_series-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">fourier_series</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">limits</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Expr.fourier_series-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Expr.fourier_series"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Expr.fourier_series-3513"><a href="#Expr.fourier_series-3513"><span class="linenos">3513</span></a>    <span class="k">def</span> <span class="nf">fourier_series</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">limits</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="Expr.fourier_series-3514"><a href="#Expr.fourier_series-3514"><span class="linenos">3514</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute fourier sine/cosine series of self.</span>
</span><span id="Expr.fourier_series-3515"><a href="#Expr.fourier_series-3515"><span class="linenos">3515</span></a>
</span><span id="Expr.fourier_series-3516"><a href="#Expr.fourier_series-3516"><span class="linenos">3516</span></a><span class="sd">        See the docstring of the :func:`fourier_series` in sympy.series.fourier</span>
</span><span id="Expr.fourier_series-3517"><a href="#Expr.fourier_series-3517"><span class="linenos">3517</span></a><span class="sd">        for more information.</span>
</span><span id="Expr.fourier_series-3518"><a href="#Expr.fourier_series-3518"><span class="linenos">3518</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Expr.fourier_series-3519"><a href="#Expr.fourier_series-3519"><span class="linenos">3519</span></a>        <span class="kn">from</span> <span class="nn">sympy.series.fourier</span> <span class="kn">import</span> <span class="n">fourier_series</span>
</span><span id="Expr.fourier_series-3520"><a href="#Expr.fourier_series-3520"><span class="linenos">3520</span></a>
</span><span id="Expr.fourier_series-3521"><a href="#Expr.fourier_series-3521"><span class="linenos">3521</span></a>        <span class="k">return</span> <span class="n">fourier_series</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">limits</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Compute fourier sine/cosine series of self.</p>

<p>See the docstring of the <code><a href="#Expr.fourier_series">fourier_series()</a></code> in sympy.series.fourier
for more information.</p>
</div>


                            </div>
                            <div id="Expr.diff" class="classattr">
                                        <input id="Expr.diff-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">diff</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="o">*</span><span class="n">symbols</span>, </span><span class="param"><span class="o">**</span><span class="n">assumptions</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Expr.diff-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Expr.diff"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Expr.diff-3527"><a href="#Expr.diff-3527"><span class="linenos">3527</span></a>    <span class="k">def</span> <span class="nf">diff</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">symbols</span><span class="p">,</span> <span class="o">**</span><span class="n">assumptions</span><span class="p">):</span>
</span><span id="Expr.diff-3528"><a href="#Expr.diff-3528"><span class="linenos">3528</span></a>        <span class="n">assumptions</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s2">&quot;evaluate&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
</span><span id="Expr.diff-3529"><a href="#Expr.diff-3529"><span class="linenos">3529</span></a>        <span class="k">return</span> <span class="n">_derivative_dispatch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">symbols</span><span class="p">,</span> <span class="o">**</span><span class="n">assumptions</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="Expr.expand" class="classattr">
                                        <input id="Expr.expand-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@cacheit</div>

        <span class="def">def</span>
        <span class="name">expand</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">deep</span><span class="o">=</span><span class="kc">True</span>,</span><span class="param">	<span class="n">modulus</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">power_base</span><span class="o">=</span><span class="kc">True</span>,</span><span class="param">	<span class="n">power_exp</span><span class="o">=</span><span class="kc">True</span>,</span><span class="param">	<span class="n">mul</span><span class="o">=</span><span class="kc">True</span>,</span><span class="param">	<span class="n">log</span><span class="o">=</span><span class="kc">True</span>,</span><span class="param">	<span class="n">multinomial</span><span class="o">=</span><span class="kc">True</span>,</span><span class="param">	<span class="n">basic</span><span class="o">=</span><span class="kc">True</span>,</span><span class="param">	<span class="o">**</span><span class="n">hints</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Expr.expand-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Expr.expand"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Expr.expand-3572"><a href="#Expr.expand-3572"><span class="linenos">3572</span></a>    <span class="nd">@cacheit</span>
</span><span id="Expr.expand-3573"><a href="#Expr.expand-3573"><span class="linenos">3573</span></a>    <span class="k">def</span> <span class="nf">expand</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">modulus</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">power_base</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">power_exp</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="Expr.expand-3574"><a href="#Expr.expand-3574"><span class="linenos">3574</span></a>            <span class="n">mul</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">multinomial</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">basic</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">hints</span><span class="p">):</span>
</span><span id="Expr.expand-3575"><a href="#Expr.expand-3575"><span class="linenos">3575</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Expr.expand-3576"><a href="#Expr.expand-3576"><span class="linenos">3576</span></a><span class="sd">        Expand an expression using hints.</span>
</span><span id="Expr.expand-3577"><a href="#Expr.expand-3577"><span class="linenos">3577</span></a>
</span><span id="Expr.expand-3578"><a href="#Expr.expand-3578"><span class="linenos">3578</span></a><span class="sd">        See the docstring of the expand() function in sympy.core.function for</span>
</span><span id="Expr.expand-3579"><a href="#Expr.expand-3579"><span class="linenos">3579</span></a><span class="sd">        more information.</span>
</span><span id="Expr.expand-3580"><a href="#Expr.expand-3580"><span class="linenos">3580</span></a>
</span><span id="Expr.expand-3581"><a href="#Expr.expand-3581"><span class="linenos">3581</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Expr.expand-3582"><a href="#Expr.expand-3582"><span class="linenos">3582</span></a>        <span class="kn">from</span> <span class="nn">sympy.simplify.radsimp</span> <span class="kn">import</span> <span class="n">fraction</span>
</span><span id="Expr.expand-3583"><a href="#Expr.expand-3583"><span class="linenos">3583</span></a>
</span><span id="Expr.expand-3584"><a href="#Expr.expand-3584"><span class="linenos">3584</span></a>        <span class="n">hints</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">power_base</span><span class="o">=</span><span class="n">power_base</span><span class="p">,</span> <span class="n">power_exp</span><span class="o">=</span><span class="n">power_exp</span><span class="p">,</span> <span class="n">mul</span><span class="o">=</span><span class="n">mul</span><span class="p">,</span>
</span><span id="Expr.expand-3585"><a href="#Expr.expand-3585"><span class="linenos">3585</span></a>           <span class="n">log</span><span class="o">=</span><span class="n">log</span><span class="p">,</span> <span class="n">multinomial</span><span class="o">=</span><span class="n">multinomial</span><span class="p">,</span> <span class="n">basic</span><span class="o">=</span><span class="n">basic</span><span class="p">)</span>
</span><span id="Expr.expand-3586"><a href="#Expr.expand-3586"><span class="linenos">3586</span></a>
</span><span id="Expr.expand-3587"><a href="#Expr.expand-3587"><span class="linenos">3587</span></a>        <span class="n">expr</span> <span class="o">=</span> <span class="bp">self</span>
</span><span id="Expr.expand-3588"><a href="#Expr.expand-3588"><span class="linenos">3588</span></a>        <span class="k">if</span> <span class="n">hints</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;frac&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
</span><span id="Expr.expand-3589"><a href="#Expr.expand-3589"><span class="linenos">3589</span></a>            <span class="n">n</span><span class="p">,</span> <span class="n">d</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="n">deep</span><span class="p">,</span> <span class="n">modulus</span><span class="o">=</span><span class="n">modulus</span><span class="p">,</span> <span class="o">**</span><span class="n">hints</span><span class="p">)</span>
</span><span id="Expr.expand-3590"><a href="#Expr.expand-3590"><span class="linenos">3590</span></a>                    <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">fraction</span><span class="p">(</span><span class="bp">self</span><span class="p">)]</span>
</span><span id="Expr.expand-3591"><a href="#Expr.expand-3591"><span class="linenos">3591</span></a>            <span class="k">return</span> <span class="n">n</span><span class="o">/</span><span class="n">d</span>
</span><span id="Expr.expand-3592"><a href="#Expr.expand-3592"><span class="linenos">3592</span></a>        <span class="k">elif</span> <span class="n">hints</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;denom&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
</span><span id="Expr.expand-3593"><a href="#Expr.expand-3593"><span class="linenos">3593</span></a>            <span class="n">n</span><span class="p">,</span> <span class="n">d</span> <span class="o">=</span> <span class="n">fraction</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="Expr.expand-3594"><a href="#Expr.expand-3594"><span class="linenos">3594</span></a>            <span class="k">return</span> <span class="n">n</span><span class="o">/</span><span class="n">d</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="n">deep</span><span class="p">,</span> <span class="n">modulus</span><span class="o">=</span><span class="n">modulus</span><span class="p">,</span> <span class="o">**</span><span class="n">hints</span><span class="p">)</span>
</span><span id="Expr.expand-3595"><a href="#Expr.expand-3595"><span class="linenos">3595</span></a>        <span class="k">elif</span> <span class="n">hints</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;numer&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
</span><span id="Expr.expand-3596"><a href="#Expr.expand-3596"><span class="linenos">3596</span></a>            <span class="n">n</span><span class="p">,</span> <span class="n">d</span> <span class="o">=</span> <span class="n">fraction</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="Expr.expand-3597"><a href="#Expr.expand-3597"><span class="linenos">3597</span></a>            <span class="k">return</span> <span class="n">n</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="n">deep</span><span class="p">,</span> <span class="n">modulus</span><span class="o">=</span><span class="n">modulus</span><span class="p">,</span> <span class="o">**</span><span class="n">hints</span><span class="p">)</span><span class="o">/</span><span class="n">d</span>
</span><span id="Expr.expand-3598"><a href="#Expr.expand-3598"><span class="linenos">3598</span></a>
</span><span id="Expr.expand-3599"><a href="#Expr.expand-3599"><span class="linenos">3599</span></a>        <span class="c1"># Although the hints are sorted here, an earlier hint may get applied</span>
</span><span id="Expr.expand-3600"><a href="#Expr.expand-3600"><span class="linenos">3600</span></a>        <span class="c1"># at a given node in the expression tree before another because of how</span>
</span><span id="Expr.expand-3601"><a href="#Expr.expand-3601"><span class="linenos">3601</span></a>        <span class="c1"># the hints are applied.  e.g. expand(log(x*(y + z))) -&gt; log(x*y +</span>
</span><span id="Expr.expand-3602"><a href="#Expr.expand-3602"><span class="linenos">3602</span></a>        <span class="c1"># x*z) because while applying log at the top level, log and mul are</span>
</span><span id="Expr.expand-3603"><a href="#Expr.expand-3603"><span class="linenos">3603</span></a>        <span class="c1"># applied at the deeper level in the tree so that when the log at the</span>
</span><span id="Expr.expand-3604"><a href="#Expr.expand-3604"><span class="linenos">3604</span></a>        <span class="c1"># upper level gets applied, the mul has already been applied at the</span>
</span><span id="Expr.expand-3605"><a href="#Expr.expand-3605"><span class="linenos">3605</span></a>        <span class="c1"># lower level.</span>
</span><span id="Expr.expand-3606"><a href="#Expr.expand-3606"><span class="linenos">3606</span></a>
</span><span id="Expr.expand-3607"><a href="#Expr.expand-3607"><span class="linenos">3607</span></a>        <span class="c1"># Additionally, because hints are only applied once, the expression</span>
</span><span id="Expr.expand-3608"><a href="#Expr.expand-3608"><span class="linenos">3608</span></a>        <span class="c1"># may not be expanded all the way.   For example, if mul is applied</span>
</span><span id="Expr.expand-3609"><a href="#Expr.expand-3609"><span class="linenos">3609</span></a>        <span class="c1"># before multinomial, x*(x + 1)**2 won&#39;t be expanded all the way.  For</span>
</span><span id="Expr.expand-3610"><a href="#Expr.expand-3610"><span class="linenos">3610</span></a>        <span class="c1"># now, we just use a special case to make multinomial run before mul,</span>
</span><span id="Expr.expand-3611"><a href="#Expr.expand-3611"><span class="linenos">3611</span></a>        <span class="c1"># so that at least polynomials will be expanded all the way.  In the</span>
</span><span id="Expr.expand-3612"><a href="#Expr.expand-3612"><span class="linenos">3612</span></a>        <span class="c1"># future, smarter heuristics should be applied.</span>
</span><span id="Expr.expand-3613"><a href="#Expr.expand-3613"><span class="linenos">3613</span></a>        <span class="c1"># TODO: Smarter heuristics</span>
</span><span id="Expr.expand-3614"><a href="#Expr.expand-3614"><span class="linenos">3614</span></a>
</span><span id="Expr.expand-3615"><a href="#Expr.expand-3615"><span class="linenos">3615</span></a>        <span class="k">def</span> <span class="nf">_expand_hint_key</span><span class="p">(</span><span class="n">hint</span><span class="p">):</span>
</span><span id="Expr.expand-3616"><a href="#Expr.expand-3616"><span class="linenos">3616</span></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;Make multinomial come before mul&quot;&quot;&quot;</span>
</span><span id="Expr.expand-3617"><a href="#Expr.expand-3617"><span class="linenos">3617</span></a>            <span class="k">if</span> <span class="n">hint</span> <span class="o">==</span> <span class="s1">&#39;mul&#39;</span><span class="p">:</span>
</span><span id="Expr.expand-3618"><a href="#Expr.expand-3618"><span class="linenos">3618</span></a>                <span class="k">return</span> <span class="s1">&#39;mulz&#39;</span>
</span><span id="Expr.expand-3619"><a href="#Expr.expand-3619"><span class="linenos">3619</span></a>            <span class="k">return</span> <span class="n">hint</span>
</span><span id="Expr.expand-3620"><a href="#Expr.expand-3620"><span class="linenos">3620</span></a>
</span><span id="Expr.expand-3621"><a href="#Expr.expand-3621"><span class="linenos">3621</span></a>        <span class="k">for</span> <span class="n">hint</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">hints</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="n">key</span><span class="o">=</span><span class="n">_expand_hint_key</span><span class="p">):</span>
</span><span id="Expr.expand-3622"><a href="#Expr.expand-3622"><span class="linenos">3622</span></a>            <span class="n">use_hint</span> <span class="o">=</span> <span class="n">hints</span><span class="p">[</span><span class="n">hint</span><span class="p">]</span>
</span><span id="Expr.expand-3623"><a href="#Expr.expand-3623"><span class="linenos">3623</span></a>            <span class="k">if</span> <span class="n">use_hint</span><span class="p">:</span>
</span><span id="Expr.expand-3624"><a href="#Expr.expand-3624"><span class="linenos">3624</span></a>                <span class="n">hint</span> <span class="o">=</span> <span class="s1">&#39;_eval_expand_&#39;</span> <span class="o">+</span> <span class="n">hint</span>
</span><span id="Expr.expand-3625"><a href="#Expr.expand-3625"><span class="linenos">3625</span></a>                <span class="n">expr</span><span class="p">,</span> <span class="n">hit</span> <span class="o">=</span> <span class="n">Expr</span><span class="o">.</span><span class="n">_expand_hint</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">hint</span><span class="p">,</span> <span class="n">deep</span><span class="o">=</span><span class="n">deep</span><span class="p">,</span> <span class="o">**</span><span class="n">hints</span><span class="p">)</span>
</span><span id="Expr.expand-3626"><a href="#Expr.expand-3626"><span class="linenos">3626</span></a>
</span><span id="Expr.expand-3627"><a href="#Expr.expand-3627"><span class="linenos">3627</span></a>        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="Expr.expand-3628"><a href="#Expr.expand-3628"><span class="linenos">3628</span></a>            <span class="n">was</span> <span class="o">=</span> <span class="n">expr</span>
</span><span id="Expr.expand-3629"><a href="#Expr.expand-3629"><span class="linenos">3629</span></a>            <span class="k">if</span> <span class="n">hints</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;multinomial&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
</span><span id="Expr.expand-3630"><a href="#Expr.expand-3630"><span class="linenos">3630</span></a>                <span class="n">expr</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">Expr</span><span class="o">.</span><span class="n">_expand_hint</span><span class="p">(</span>
</span><span id="Expr.expand-3631"><a href="#Expr.expand-3631"><span class="linenos">3631</span></a>                    <span class="n">expr</span><span class="p">,</span> <span class="s1">&#39;_eval_expand_multinomial&#39;</span><span class="p">,</span> <span class="n">deep</span><span class="o">=</span><span class="n">deep</span><span class="p">,</span> <span class="o">**</span><span class="n">hints</span><span class="p">)</span>
</span><span id="Expr.expand-3632"><a href="#Expr.expand-3632"><span class="linenos">3632</span></a>            <span class="k">if</span> <span class="n">hints</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;mul&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
</span><span id="Expr.expand-3633"><a href="#Expr.expand-3633"><span class="linenos">3633</span></a>                <span class="n">expr</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">Expr</span><span class="o">.</span><span class="n">_expand_hint</span><span class="p">(</span>
</span><span id="Expr.expand-3634"><a href="#Expr.expand-3634"><span class="linenos">3634</span></a>                    <span class="n">expr</span><span class="p">,</span> <span class="s1">&#39;_eval_expand_mul&#39;</span><span class="p">,</span> <span class="n">deep</span><span class="o">=</span><span class="n">deep</span><span class="p">,</span> <span class="o">**</span><span class="n">hints</span><span class="p">)</span>
</span><span id="Expr.expand-3635"><a href="#Expr.expand-3635"><span class="linenos">3635</span></a>            <span class="k">if</span> <span class="n">hints</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
</span><span id="Expr.expand-3636"><a href="#Expr.expand-3636"><span class="linenos">3636</span></a>                <span class="n">expr</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">Expr</span><span class="o">.</span><span class="n">_expand_hint</span><span class="p">(</span>
</span><span id="Expr.expand-3637"><a href="#Expr.expand-3637"><span class="linenos">3637</span></a>                    <span class="n">expr</span><span class="p">,</span> <span class="s1">&#39;_eval_expand_log&#39;</span><span class="p">,</span> <span class="n">deep</span><span class="o">=</span><span class="n">deep</span><span class="p">,</span> <span class="o">**</span><span class="n">hints</span><span class="p">)</span>
</span><span id="Expr.expand-3638"><a href="#Expr.expand-3638"><span class="linenos">3638</span></a>            <span class="k">if</span> <span class="n">expr</span> <span class="o">==</span> <span class="n">was</span><span class="p">:</span>
</span><span id="Expr.expand-3639"><a href="#Expr.expand-3639"><span class="linenos">3639</span></a>                <span class="k">break</span>
</span><span id="Expr.expand-3640"><a href="#Expr.expand-3640"><span class="linenos">3640</span></a>
</span><span id="Expr.expand-3641"><a href="#Expr.expand-3641"><span class="linenos">3641</span></a>        <span class="k">if</span> <span class="n">modulus</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Expr.expand-3642"><a href="#Expr.expand-3642"><span class="linenos">3642</span></a>            <span class="n">modulus</span> <span class="o">=</span> <span class="n">sympify</span><span class="p">(</span><span class="n">modulus</span><span class="p">)</span>
</span><span id="Expr.expand-3643"><a href="#Expr.expand-3643"><span class="linenos">3643</span></a>
</span><span id="Expr.expand-3644"><a href="#Expr.expand-3644"><span class="linenos">3644</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">modulus</span><span class="o">.</span><span class="n">is_Integer</span> <span class="ow">or</span> <span class="n">modulus</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Expr.expand-3645"><a href="#Expr.expand-3645"><span class="linenos">3645</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="Expr.expand-3646"><a href="#Expr.expand-3646"><span class="linenos">3646</span></a>                    <span class="s2">&quot;modulus must be a positive integer, got </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">modulus</span><span class="p">)</span>
</span><span id="Expr.expand-3647"><a href="#Expr.expand-3647"><span class="linenos">3647</span></a>
</span><span id="Expr.expand-3648"><a href="#Expr.expand-3648"><span class="linenos">3648</span></a>            <span class="n">terms</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Expr.expand-3649"><a href="#Expr.expand-3649"><span class="linenos">3649</span></a>
</span><span id="Expr.expand-3650"><a href="#Expr.expand-3650"><span class="linenos">3650</span></a>            <span class="k">for</span> <span class="n">term</span> <span class="ow">in</span> <span class="n">Add</span><span class="o">.</span><span class="n">make_args</span><span class="p">(</span><span class="n">expr</span><span class="p">):</span>
</span><span id="Expr.expand-3651"><a href="#Expr.expand-3651"><span class="linenos">3651</span></a>                <span class="n">coeff</span><span class="p">,</span> <span class="n">tail</span> <span class="o">=</span> <span class="n">term</span><span class="o">.</span><span class="n">as_coeff_Mul</span><span class="p">(</span><span class="n">rational</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="Expr.expand-3652"><a href="#Expr.expand-3652"><span class="linenos">3652</span></a>
</span><span id="Expr.expand-3653"><a href="#Expr.expand-3653"><span class="linenos">3653</span></a>                <span class="n">coeff</span> <span class="o">%=</span> <span class="n">modulus</span>
</span><span id="Expr.expand-3654"><a href="#Expr.expand-3654"><span class="linenos">3654</span></a>
</span><span id="Expr.expand-3655"><a href="#Expr.expand-3655"><span class="linenos">3655</span></a>                <span class="k">if</span> <span class="n">coeff</span><span class="p">:</span>
</span><span id="Expr.expand-3656"><a href="#Expr.expand-3656"><span class="linenos">3656</span></a>                    <span class="n">terms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">coeff</span><span class="o">*</span><span class="n">tail</span><span class="p">)</span>
</span><span id="Expr.expand-3657"><a href="#Expr.expand-3657"><span class="linenos">3657</span></a>
</span><span id="Expr.expand-3658"><a href="#Expr.expand-3658"><span class="linenos">3658</span></a>            <span class="n">expr</span> <span class="o">=</span> <span class="n">Add</span><span class="p">(</span><span class="o">*</span><span class="n">terms</span><span class="p">)</span>
</span><span id="Expr.expand-3659"><a href="#Expr.expand-3659"><span class="linenos">3659</span></a>
</span><span id="Expr.expand-3660"><a href="#Expr.expand-3660"><span class="linenos">3660</span></a>        <span class="k">return</span> <span class="n">expr</span>
</span></pre></div>


            <div class="docstring"><p>Expand an expression using hints.</p>

<p>See the docstring of the expand() function in sympy.core.function for
more information.</p>
</div>


                            </div>
                            <div id="Expr.integrate" class="classattr">
                                        <input id="Expr.integrate-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">integrate</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="o">*</span><span class="n">args</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Expr.integrate-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Expr.integrate"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Expr.integrate-3666"><a href="#Expr.integrate-3666"><span class="linenos">3666</span></a>    <span class="k">def</span> <span class="nf">integrate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Expr.integrate-3667"><a href="#Expr.integrate-3667"><span class="linenos">3667</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;See the integrate function in sympy.integrals&quot;&quot;&quot;</span>
</span><span id="Expr.integrate-3668"><a href="#Expr.integrate-3668"><span class="linenos">3668</span></a>        <span class="kn">from</span> <span class="nn">sympy.integrals.integrals</span> <span class="kn">import</span> <span class="n">integrate</span>
</span><span id="Expr.integrate-3669"><a href="#Expr.integrate-3669"><span class="linenos">3669</span></a>        <span class="k">return</span> <span class="n">integrate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>See the integrate function in sympy.integrals</p>
</div>


                            </div>
                            <div id="Expr.nsimplify" class="classattr">
                                        <input id="Expr.nsimplify-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">nsimplify</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">constants</span><span class="o">=</span><span class="p">()</span>, </span><span class="param"><span class="n">tolerance</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="n">full</span><span class="o">=</span><span class="kc">False</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Expr.nsimplify-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Expr.nsimplify"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Expr.nsimplify-3671"><a href="#Expr.nsimplify-3671"><span class="linenos">3671</span></a>    <span class="k">def</span> <span class="nf">nsimplify</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">constants</span><span class="o">=</span><span class="p">(),</span> <span class="n">tolerance</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">full</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="Expr.nsimplify-3672"><a href="#Expr.nsimplify-3672"><span class="linenos">3672</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;See the nsimplify function in sympy.simplify&quot;&quot;&quot;</span>
</span><span id="Expr.nsimplify-3673"><a href="#Expr.nsimplify-3673"><span class="linenos">3673</span></a>        <span class="kn">from</span> <span class="nn">sympy.simplify.simplify</span> <span class="kn">import</span> <span class="n">nsimplify</span>
</span><span id="Expr.nsimplify-3674"><a href="#Expr.nsimplify-3674"><span class="linenos">3674</span></a>        <span class="k">return</span> <span class="n">nsimplify</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">constants</span><span class="p">,</span> <span class="n">tolerance</span><span class="p">,</span> <span class="n">full</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>See the nsimplify function in sympy.simplify</p>
</div>


                            </div>
                            <div id="Expr.separate" class="classattr">
                                        <input id="Expr.separate-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">separate</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">deep</span><span class="o">=</span><span class="kc">False</span>, </span><span class="param"><span class="n">force</span><span class="o">=</span><span class="kc">False</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Expr.separate-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Expr.separate"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Expr.separate-3676"><a href="#Expr.separate-3676"><span class="linenos">3676</span></a>    <span class="k">def</span> <span class="nf">separate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">deep</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="Expr.separate-3677"><a href="#Expr.separate-3677"><span class="linenos">3677</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;See the separate function in sympy.simplify&quot;&quot;&quot;</span>
</span><span id="Expr.separate-3678"><a href="#Expr.separate-3678"><span class="linenos">3678</span></a>        <span class="kn">from</span> <span class="nn">.function</span> <span class="kn">import</span> <span class="n">expand_power_base</span>
</span><span id="Expr.separate-3679"><a href="#Expr.separate-3679"><span class="linenos">3679</span></a>        <span class="k">return</span> <span class="n">expand_power_base</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">deep</span><span class="o">=</span><span class="n">deep</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="n">force</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>See the separate function in sympy.simplify</p>
</div>


                            </div>
                            <div id="Expr.collect" class="classattr">
                                        <input id="Expr.collect-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">collect</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">syms</span>,</span><span class="param">	<span class="n">func</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">evaluate</span><span class="o">=</span><span class="kc">True</span>,</span><span class="param">	<span class="n">exact</span><span class="o">=</span><span class="kc">False</span>,</span><span class="param">	<span class="n">distribute_order_term</span><span class="o">=</span><span class="kc">True</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Expr.collect-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Expr.collect"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Expr.collect-3681"><a href="#Expr.collect-3681"><span class="linenos">3681</span></a>    <span class="k">def</span> <span class="nf">collect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">syms</span><span class="p">,</span> <span class="n">func</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">evaluate</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exact</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">distribute_order_term</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="Expr.collect-3682"><a href="#Expr.collect-3682"><span class="linenos">3682</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;See the collect function in sympy.simplify&quot;&quot;&quot;</span>
</span><span id="Expr.collect-3683"><a href="#Expr.collect-3683"><span class="linenos">3683</span></a>        <span class="kn">from</span> <span class="nn">sympy.simplify.radsimp</span> <span class="kn">import</span> <span class="n">collect</span>
</span><span id="Expr.collect-3684"><a href="#Expr.collect-3684"><span class="linenos">3684</span></a>        <span class="k">return</span> <span class="n">collect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">syms</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="n">evaluate</span><span class="p">,</span> <span class="n">exact</span><span class="p">,</span> <span class="n">distribute_order_term</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>See the collect function in sympy.simplify</p>
</div>


                            </div>
                            <div id="Expr.together" class="classattr">
                                        <input id="Expr.together-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">together</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="o">*</span><span class="n">args</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Expr.together-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Expr.together"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Expr.together-3686"><a href="#Expr.together-3686"><span class="linenos">3686</span></a>    <span class="k">def</span> <span class="nf">together</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Expr.together-3687"><a href="#Expr.together-3687"><span class="linenos">3687</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;See the together function in sympy.polys&quot;&quot;&quot;</span>
</span><span id="Expr.together-3688"><a href="#Expr.together-3688"><span class="linenos">3688</span></a>        <span class="kn">from</span> <span class="nn">sympy.polys.rationaltools</span> <span class="kn">import</span> <span class="n">together</span>
</span><span id="Expr.together-3689"><a href="#Expr.together-3689"><span class="linenos">3689</span></a>        <span class="k">return</span> <span class="n">together</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>See the together function in sympy.polys</p>
</div>


                            </div>
                            <div id="Expr.apart" class="classattr">
                                        <input id="Expr.apart-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">apart</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">x</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="o">**</span><span class="n">args</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Expr.apart-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Expr.apart"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Expr.apart-3691"><a href="#Expr.apart-3691"><span class="linenos">3691</span></a>    <span class="k">def</span> <span class="nf">apart</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">):</span>
</span><span id="Expr.apart-3692"><a href="#Expr.apart-3692"><span class="linenos">3692</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;See the apart function in sympy.polys&quot;&quot;&quot;</span>
</span><span id="Expr.apart-3693"><a href="#Expr.apart-3693"><span class="linenos">3693</span></a>        <span class="kn">from</span> <span class="nn">sympy.polys.partfrac</span> <span class="kn">import</span> <span class="n">apart</span>
</span><span id="Expr.apart-3694"><a href="#Expr.apart-3694"><span class="linenos">3694</span></a>        <span class="k">return</span> <span class="n">apart</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>See the apart function in sympy.polys</p>
</div>


                            </div>
                            <div id="Expr.ratsimp" class="classattr">
                                        <input id="Expr.ratsimp-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">ratsimp</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Expr.ratsimp-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Expr.ratsimp"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Expr.ratsimp-3696"><a href="#Expr.ratsimp-3696"><span class="linenos">3696</span></a>    <span class="k">def</span> <span class="nf">ratsimp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Expr.ratsimp-3697"><a href="#Expr.ratsimp-3697"><span class="linenos">3697</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;See the ratsimp function in sympy.simplify&quot;&quot;&quot;</span>
</span><span id="Expr.ratsimp-3698"><a href="#Expr.ratsimp-3698"><span class="linenos">3698</span></a>        <span class="kn">from</span> <span class="nn">sympy.simplify.ratsimp</span> <span class="kn">import</span> <span class="n">ratsimp</span>
</span><span id="Expr.ratsimp-3699"><a href="#Expr.ratsimp-3699"><span class="linenos">3699</span></a>        <span class="k">return</span> <span class="n">ratsimp</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>See the ratsimp function in sympy.simplify</p>
</div>


                            </div>
                            <div id="Expr.trigsimp" class="classattr">
                                        <input id="Expr.trigsimp-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">trigsimp</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="o">**</span><span class="n">args</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Expr.trigsimp-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Expr.trigsimp"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Expr.trigsimp-3701"><a href="#Expr.trigsimp-3701"><span class="linenos">3701</span></a>    <span class="k">def</span> <span class="nf">trigsimp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">):</span>
</span><span id="Expr.trigsimp-3702"><a href="#Expr.trigsimp-3702"><span class="linenos">3702</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;See the trigsimp function in sympy.simplify&quot;&quot;&quot;</span>
</span><span id="Expr.trigsimp-3703"><a href="#Expr.trigsimp-3703"><span class="linenos">3703</span></a>        <span class="kn">from</span> <span class="nn">sympy.simplify.trigsimp</span> <span class="kn">import</span> <span class="n">trigsimp</span>
</span><span id="Expr.trigsimp-3704"><a href="#Expr.trigsimp-3704"><span class="linenos">3704</span></a>        <span class="k">return</span> <span class="n">trigsimp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>See the trigsimp function in sympy.simplify</p>
</div>


                            </div>
                            <div id="Expr.radsimp" class="classattr">
                                        <input id="Expr.radsimp-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">radsimp</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Expr.radsimp-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Expr.radsimp"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Expr.radsimp-3706"><a href="#Expr.radsimp-3706"><span class="linenos">3706</span></a>    <span class="k">def</span> <span class="nf">radsimp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Expr.radsimp-3707"><a href="#Expr.radsimp-3707"><span class="linenos">3707</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;See the radsimp function in sympy.simplify&quot;&quot;&quot;</span>
</span><span id="Expr.radsimp-3708"><a href="#Expr.radsimp-3708"><span class="linenos">3708</span></a>        <span class="kn">from</span> <span class="nn">sympy.simplify.radsimp</span> <span class="kn">import</span> <span class="n">radsimp</span>
</span><span id="Expr.radsimp-3709"><a href="#Expr.radsimp-3709"><span class="linenos">3709</span></a>        <span class="k">return</span> <span class="n">radsimp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>See the radsimp function in sympy.simplify</p>
</div>


                            </div>
                            <div id="Expr.powsimp" class="classattr">
                                        <input id="Expr.powsimp-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">powsimp</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="o">*</span><span class="n">args</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Expr.powsimp-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Expr.powsimp"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Expr.powsimp-3711"><a href="#Expr.powsimp-3711"><span class="linenos">3711</span></a>    <span class="k">def</span> <span class="nf">powsimp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Expr.powsimp-3712"><a href="#Expr.powsimp-3712"><span class="linenos">3712</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;See the powsimp function in sympy.simplify&quot;&quot;&quot;</span>
</span><span id="Expr.powsimp-3713"><a href="#Expr.powsimp-3713"><span class="linenos">3713</span></a>        <span class="kn">from</span> <span class="nn">sympy.simplify.powsimp</span> <span class="kn">import</span> <span class="n">powsimp</span>
</span><span id="Expr.powsimp-3714"><a href="#Expr.powsimp-3714"><span class="linenos">3714</span></a>        <span class="k">return</span> <span class="n">powsimp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>See the powsimp function in sympy.simplify</p>
</div>


                            </div>
                            <div id="Expr.combsimp" class="classattr">
                                        <input id="Expr.combsimp-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">combsimp</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Expr.combsimp-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Expr.combsimp"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Expr.combsimp-3716"><a href="#Expr.combsimp-3716"><span class="linenos">3716</span></a>    <span class="k">def</span> <span class="nf">combsimp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Expr.combsimp-3717"><a href="#Expr.combsimp-3717"><span class="linenos">3717</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;See the combsimp function in sympy.simplify&quot;&quot;&quot;</span>
</span><span id="Expr.combsimp-3718"><a href="#Expr.combsimp-3718"><span class="linenos">3718</span></a>        <span class="kn">from</span> <span class="nn">sympy.simplify.combsimp</span> <span class="kn">import</span> <span class="n">combsimp</span>
</span><span id="Expr.combsimp-3719"><a href="#Expr.combsimp-3719"><span class="linenos">3719</span></a>        <span class="k">return</span> <span class="n">combsimp</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>See the combsimp function in sympy.simplify</p>
</div>


                            </div>
                            <div id="Expr.gammasimp" class="classattr">
                                        <input id="Expr.gammasimp-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">gammasimp</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Expr.gammasimp-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Expr.gammasimp"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Expr.gammasimp-3721"><a href="#Expr.gammasimp-3721"><span class="linenos">3721</span></a>    <span class="k">def</span> <span class="nf">gammasimp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Expr.gammasimp-3722"><a href="#Expr.gammasimp-3722"><span class="linenos">3722</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;See the gammasimp function in sympy.simplify&quot;&quot;&quot;</span>
</span><span id="Expr.gammasimp-3723"><a href="#Expr.gammasimp-3723"><span class="linenos">3723</span></a>        <span class="kn">from</span> <span class="nn">sympy.simplify.gammasimp</span> <span class="kn">import</span> <span class="n">gammasimp</span>
</span><span id="Expr.gammasimp-3724"><a href="#Expr.gammasimp-3724"><span class="linenos">3724</span></a>        <span class="k">return</span> <span class="n">gammasimp</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>See the gammasimp function in sympy.simplify</p>
</div>


                            </div>
                            <div id="Expr.factor" class="classattr">
                                        <input id="Expr.factor-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">factor</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="o">*</span><span class="n">gens</span>, </span><span class="param"><span class="o">**</span><span class="n">args</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Expr.factor-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Expr.factor"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Expr.factor-3726"><a href="#Expr.factor-3726"><span class="linenos">3726</span></a>    <span class="k">def</span> <span class="nf">factor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">):</span>
</span><span id="Expr.factor-3727"><a href="#Expr.factor-3727"><span class="linenos">3727</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;See the factor() function in sympy.polys.polytools&quot;&quot;&quot;</span>
</span><span id="Expr.factor-3728"><a href="#Expr.factor-3728"><span class="linenos">3728</span></a>        <span class="kn">from</span> <span class="nn">sympy.polys.polytools</span> <span class="kn">import</span> <span class="n">factor</span>
</span><span id="Expr.factor-3729"><a href="#Expr.factor-3729"><span class="linenos">3729</span></a>        <span class="k">return</span> <span class="n">factor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>See the factor() function in sympy.polys.polytools</p>
</div>


                            </div>
                            <div id="Expr.cancel" class="classattr">
                                        <input id="Expr.cancel-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">cancel</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="o">*</span><span class="n">gens</span>, </span><span class="param"><span class="o">**</span><span class="n">args</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Expr.cancel-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Expr.cancel"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Expr.cancel-3731"><a href="#Expr.cancel-3731"><span class="linenos">3731</span></a>    <span class="k">def</span> <span class="nf">cancel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">):</span>
</span><span id="Expr.cancel-3732"><a href="#Expr.cancel-3732"><span class="linenos">3732</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;See the cancel function in sympy.polys&quot;&quot;&quot;</span>
</span><span id="Expr.cancel-3733"><a href="#Expr.cancel-3733"><span class="linenos">3733</span></a>        <span class="kn">from</span> <span class="nn">sympy.polys.polytools</span> <span class="kn">import</span> <span class="n">cancel</span>
</span><span id="Expr.cancel-3734"><a href="#Expr.cancel-3734"><span class="linenos">3734</span></a>        <span class="k">return</span> <span class="n">cancel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>See the cancel function in sympy.polys</p>
</div>


                            </div>
                            <div id="Expr.invert" class="classattr">
                                        <input id="Expr.invert-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">invert</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">g</span>, </span><span class="param"><span class="o">*</span><span class="n">gens</span>, </span><span class="param"><span class="o">**</span><span class="n">args</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Expr.invert-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Expr.invert"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Expr.invert-3736"><a href="#Expr.invert-3736"><span class="linenos">3736</span></a>    <span class="k">def</span> <span class="nf">invert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">):</span>
</span><span id="Expr.invert-3737"><a href="#Expr.invert-3737"><span class="linenos">3737</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the multiplicative inverse of ``self`` mod ``g``</span>
</span><span id="Expr.invert-3738"><a href="#Expr.invert-3738"><span class="linenos">3738</span></a><span class="sd">        where ``self`` (and ``g``) may be symbolic expressions).</span>
</span><span id="Expr.invert-3739"><a href="#Expr.invert-3739"><span class="linenos">3739</span></a>
</span><span id="Expr.invert-3740"><a href="#Expr.invert-3740"><span class="linenos">3740</span></a><span class="sd">        See Also</span>
</span><span id="Expr.invert-3741"><a href="#Expr.invert-3741"><span class="linenos">3741</span></a><span class="sd">        ========</span>
</span><span id="Expr.invert-3742"><a href="#Expr.invert-3742"><span class="linenos">3742</span></a><span class="sd">        sympy.core.numbers.mod_inverse, sympy.polys.polytools.invert</span>
</span><span id="Expr.invert-3743"><a href="#Expr.invert-3743"><span class="linenos">3743</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Expr.invert-3744"><a href="#Expr.invert-3744"><span class="linenos">3744</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_number</span> <span class="ow">and</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="s1">&#39;is_number&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">):</span>
</span><span id="Expr.invert-3745"><a href="#Expr.invert-3745"><span class="linenos">3745</span></a>            <span class="kn">from</span> <span class="nn">.numbers</span> <span class="kn">import</span> <span class="n">mod_inverse</span>
</span><span id="Expr.invert-3746"><a href="#Expr.invert-3746"><span class="linenos">3746</span></a>            <span class="k">return</span> <span class="n">mod_inverse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">g</span><span class="p">)</span>
</span><span id="Expr.invert-3747"><a href="#Expr.invert-3747"><span class="linenos">3747</span></a>        <span class="kn">from</span> <span class="nn">sympy.polys.polytools</span> <span class="kn">import</span> <span class="n">invert</span>
</span><span id="Expr.invert-3748"><a href="#Expr.invert-3748"><span class="linenos">3748</span></a>        <span class="k">return</span> <span class="n">invert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="o">*</span><span class="n">gens</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Return the multiplicative inverse of <code>self</code> mod <code>g</code>
where <code>self</code> (and <code>g</code>) may be symbolic expressions).</p>

<h1 id="see-also">See Also</h1>

<p>sympy.core.numbers.mod_inverse, sympy.polys.polytools.invert</p>
</div>


                            </div>
                            <div id="Expr.round" class="classattr">
                                        <input id="Expr.round-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">round</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">n</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Expr.round-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Expr.round"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Expr.round-3750"><a href="#Expr.round-3750"><span class="linenos">3750</span></a>    <span class="k">def</span> <span class="nf">round</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="Expr.round-3751"><a href="#Expr.round-3751"><span class="linenos">3751</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return x rounded to the given decimal place.</span>
</span><span id="Expr.round-3752"><a href="#Expr.round-3752"><span class="linenos">3752</span></a>
</span><span id="Expr.round-3753"><a href="#Expr.round-3753"><span class="linenos">3753</span></a><span class="sd">        If a complex number would results, apply round to the real</span>
</span><span id="Expr.round-3754"><a href="#Expr.round-3754"><span class="linenos">3754</span></a><span class="sd">        and imaginary components of the number.</span>
</span><span id="Expr.round-3755"><a href="#Expr.round-3755"><span class="linenos">3755</span></a>
</span><span id="Expr.round-3756"><a href="#Expr.round-3756"><span class="linenos">3756</span></a><span class="sd">        Examples</span>
</span><span id="Expr.round-3757"><a href="#Expr.round-3757"><span class="linenos">3757</span></a><span class="sd">        ========</span>
</span><span id="Expr.round-3758"><a href="#Expr.round-3758"><span class="linenos">3758</span></a>
</span><span id="Expr.round-3759"><a href="#Expr.round-3759"><span class="linenos">3759</span></a><span class="sd">        &gt;&gt;&gt; from sympy import pi, E, I, S, Number</span>
</span><span id="Expr.round-3760"><a href="#Expr.round-3760"><span class="linenos">3760</span></a><span class="sd">        &gt;&gt;&gt; pi.round()</span>
</span><span id="Expr.round-3761"><a href="#Expr.round-3761"><span class="linenos">3761</span></a><span class="sd">        3</span>
</span><span id="Expr.round-3762"><a href="#Expr.round-3762"><span class="linenos">3762</span></a><span class="sd">        &gt;&gt;&gt; pi.round(2)</span>
</span><span id="Expr.round-3763"><a href="#Expr.round-3763"><span class="linenos">3763</span></a><span class="sd">        3.14</span>
</span><span id="Expr.round-3764"><a href="#Expr.round-3764"><span class="linenos">3764</span></a><span class="sd">        &gt;&gt;&gt; (2*pi + E*I).round()</span>
</span><span id="Expr.round-3765"><a href="#Expr.round-3765"><span class="linenos">3765</span></a><span class="sd">        6 + 3*I</span>
</span><span id="Expr.round-3766"><a href="#Expr.round-3766"><span class="linenos">3766</span></a>
</span><span id="Expr.round-3767"><a href="#Expr.round-3767"><span class="linenos">3767</span></a><span class="sd">        The round method has a chopping effect:</span>
</span><span id="Expr.round-3768"><a href="#Expr.round-3768"><span class="linenos">3768</span></a>
</span><span id="Expr.round-3769"><a href="#Expr.round-3769"><span class="linenos">3769</span></a><span class="sd">        &gt;&gt;&gt; (2*pi + I/10).round()</span>
</span><span id="Expr.round-3770"><a href="#Expr.round-3770"><span class="linenos">3770</span></a><span class="sd">        6</span>
</span><span id="Expr.round-3771"><a href="#Expr.round-3771"><span class="linenos">3771</span></a><span class="sd">        &gt;&gt;&gt; (pi/10 + 2*I).round()</span>
</span><span id="Expr.round-3772"><a href="#Expr.round-3772"><span class="linenos">3772</span></a><span class="sd">        2*I</span>
</span><span id="Expr.round-3773"><a href="#Expr.round-3773"><span class="linenos">3773</span></a><span class="sd">        &gt;&gt;&gt; (pi/10 + E*I).round(2)</span>
</span><span id="Expr.round-3774"><a href="#Expr.round-3774"><span class="linenos">3774</span></a><span class="sd">        0.31 + 2.72*I</span>
</span><span id="Expr.round-3775"><a href="#Expr.round-3775"><span class="linenos">3775</span></a>
</span><span id="Expr.round-3776"><a href="#Expr.round-3776"><span class="linenos">3776</span></a><span class="sd">        Notes</span>
</span><span id="Expr.round-3777"><a href="#Expr.round-3777"><span class="linenos">3777</span></a><span class="sd">        =====</span>
</span><span id="Expr.round-3778"><a href="#Expr.round-3778"><span class="linenos">3778</span></a>
</span><span id="Expr.round-3779"><a href="#Expr.round-3779"><span class="linenos">3779</span></a><span class="sd">        The Python ``round`` function uses the SymPy ``round`` method so it</span>
</span><span id="Expr.round-3780"><a href="#Expr.round-3780"><span class="linenos">3780</span></a><span class="sd">        will always return a SymPy number (not a Python float or int):</span>
</span><span id="Expr.round-3781"><a href="#Expr.round-3781"><span class="linenos">3781</span></a>
</span><span id="Expr.round-3782"><a href="#Expr.round-3782"><span class="linenos">3782</span></a><span class="sd">        &gt;&gt;&gt; isinstance(round(S(123), -2), Number)</span>
</span><span id="Expr.round-3783"><a href="#Expr.round-3783"><span class="linenos">3783</span></a><span class="sd">        True</span>
</span><span id="Expr.round-3784"><a href="#Expr.round-3784"><span class="linenos">3784</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Expr.round-3785"><a href="#Expr.round-3785"><span class="linenos">3785</span></a>        <span class="kn">from</span> <span class="nn">sympy.core.numbers</span> <span class="kn">import</span> <span class="n">Float</span>
</span><span id="Expr.round-3786"><a href="#Expr.round-3786"><span class="linenos">3786</span></a>
</span><span id="Expr.round-3787"><a href="#Expr.round-3787"><span class="linenos">3787</span></a>        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span>
</span><span id="Expr.round-3788"><a href="#Expr.round-3788"><span class="linenos">3788</span></a>
</span><span id="Expr.round-3789"><a href="#Expr.round-3789"><span class="linenos">3789</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">x</span><span class="o">.</span><span class="n">is_number</span><span class="p">:</span>
</span><span id="Expr.round-3790"><a href="#Expr.round-3790"><span class="linenos">3790</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Cannot round symbolic expression&quot;</span><span class="p">)</span>
</span><span id="Expr.round-3791"><a href="#Expr.round-3791"><span class="linenos">3791</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">x</span><span class="o">.</span><span class="n">is_Atom</span><span class="p">:</span>
</span><span id="Expr.round-3792"><a href="#Expr.round-3792"><span class="linenos">3792</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">pure_complex</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">n</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">or_real</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="Expr.round-3793"><a href="#Expr.round-3793"><span class="linenos">3793</span></a>                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
</span><span id="Expr.round-3794"><a href="#Expr.round-3794"><span class="linenos">3794</span></a>                    <span class="s1">&#39;Expected a number but got </span><span class="si">%s</span><span class="s1">:&#39;</span> <span class="o">%</span> <span class="n">func_name</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</span><span id="Expr.round-3795"><a href="#Expr.round-3795"><span class="linenos">3795</span></a>        <span class="k">elif</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">NaN</span><span class="p">,</span> <span class="n">S</span><span class="o">.</span><span class="n">Infinity</span><span class="p">,</span> <span class="n">S</span><span class="o">.</span><span class="n">NegativeInfinity</span><span class="p">,</span> <span class="n">S</span><span class="o">.</span><span class="n">ComplexInfinity</span><span class="p">):</span>
</span><span id="Expr.round-3796"><a href="#Expr.round-3796"><span class="linenos">3796</span></a>            <span class="k">return</span> <span class="n">x</span>
</span><span id="Expr.round-3797"><a href="#Expr.round-3797"><span class="linenos">3797</span></a>        <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">is_extended_real</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
</span><span id="Expr.round-3798"><a href="#Expr.round-3798"><span class="linenos">3798</span></a>            <span class="n">r</span><span class="p">,</span> <span class="n">i</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">as_real_imag</span><span class="p">()</span>
</span><span id="Expr.round-3799"><a href="#Expr.round-3799"><span class="linenos">3799</span></a>            <span class="k">return</span> <span class="n">r</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">+</span> <span class="n">S</span><span class="o">.</span><span class="n">ImaginaryUnit</span><span class="o">*</span><span class="n">i</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
</span><span id="Expr.round-3800"><a href="#Expr.round-3800"><span class="linenos">3800</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">x</span><span class="p">:</span>
</span><span id="Expr.round-3801"><a href="#Expr.round-3801"><span class="linenos">3801</span></a>            <span class="k">return</span> <span class="n">S</span><span class="o">.</span><span class="n">Zero</span> <span class="k">if</span> <span class="n">n</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">x</span>
</span><span id="Expr.round-3802"><a href="#Expr.round-3802"><span class="linenos">3802</span></a>
</span><span id="Expr.round-3803"><a href="#Expr.round-3803"><span class="linenos">3803</span></a>        <span class="n">p</span> <span class="o">=</span> <span class="n">as_int</span><span class="p">(</span><span class="n">n</span> <span class="ow">or</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="Expr.round-3804"><a href="#Expr.round-3804"><span class="linenos">3804</span></a>
</span><span id="Expr.round-3805"><a href="#Expr.round-3805"><span class="linenos">3805</span></a>        <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">is_Integer</span><span class="p">:</span>
</span><span id="Expr.round-3806"><a href="#Expr.round-3806"><span class="linenos">3806</span></a>            <span class="k">return</span> <span class="n">Integer</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">p</span><span class="p">))</span>
</span><span id="Expr.round-3807"><a href="#Expr.round-3807"><span class="linenos">3807</span></a>
</span><span id="Expr.round-3808"><a href="#Expr.round-3808"><span class="linenos">3808</span></a>        <span class="n">digits_to_decimal</span> <span class="o">=</span> <span class="n">_mag</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>  <span class="c1"># _mag(12) = 2, _mag(.012) = -1</span>
</span><span id="Expr.round-3809"><a href="#Expr.round-3809"><span class="linenos">3809</span></a>        <span class="n">allow</span> <span class="o">=</span> <span class="n">digits_to_decimal</span> <span class="o">+</span> <span class="n">p</span>
</span><span id="Expr.round-3810"><a href="#Expr.round-3810"><span class="linenos">3810</span></a>        <span class="n">precs</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span><span class="o">.</span><span class="n">_prec</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">x</span><span class="o">.</span><span class="n">atoms</span><span class="p">(</span><span class="n">Float</span><span class="p">)]</span>
</span><span id="Expr.round-3811"><a href="#Expr.round-3811"><span class="linenos">3811</span></a>        <span class="n">dps</span> <span class="o">=</span> <span class="n">prec_to_dps</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">precs</span><span class="p">))</span> <span class="k">if</span> <span class="n">precs</span> <span class="k">else</span> <span class="kc">None</span>
</span><span id="Expr.round-3812"><a href="#Expr.round-3812"><span class="linenos">3812</span></a>        <span class="k">if</span> <span class="n">dps</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Expr.round-3813"><a href="#Expr.round-3813"><span class="linenos">3813</span></a>            <span class="c1"># assume everything is exact so use the Python</span>
</span><span id="Expr.round-3814"><a href="#Expr.round-3814"><span class="linenos">3814</span></a>            <span class="c1"># float default or whatever was requested</span>
</span><span id="Expr.round-3815"><a href="#Expr.round-3815"><span class="linenos">3815</span></a>            <span class="n">dps</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="n">allow</span><span class="p">)</span>
</span><span id="Expr.round-3816"><a href="#Expr.round-3816"><span class="linenos">3816</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Expr.round-3817"><a href="#Expr.round-3817"><span class="linenos">3817</span></a>            <span class="n">allow</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">allow</span><span class="p">,</span> <span class="n">dps</span><span class="p">)</span>
</span><span id="Expr.round-3818"><a href="#Expr.round-3818"><span class="linenos">3818</span></a>        <span class="c1"># this will shift all digits to right of decimal</span>
</span><span id="Expr.round-3819"><a href="#Expr.round-3819"><span class="linenos">3819</span></a>        <span class="c1"># and give us dps to work with as an int</span>
</span><span id="Expr.round-3820"><a href="#Expr.round-3820"><span class="linenos">3820</span></a>        <span class="n">shift</span> <span class="o">=</span> <span class="o">-</span><span class="n">digits_to_decimal</span> <span class="o">+</span> <span class="n">dps</span>
</span><span id="Expr.round-3821"><a href="#Expr.round-3821"><span class="linenos">3821</span></a>        <span class="n">extra</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># how far we look past known digits</span>
</span><span id="Expr.round-3822"><a href="#Expr.round-3822"><span class="linenos">3822</span></a>        <span class="c1"># NOTE</span>
</span><span id="Expr.round-3823"><a href="#Expr.round-3823"><span class="linenos">3823</span></a>        <span class="c1"># mpmath will calculate the binary representation to</span>
</span><span id="Expr.round-3824"><a href="#Expr.round-3824"><span class="linenos">3824</span></a>        <span class="c1"># an arbitrary number of digits but we must base our</span>
</span><span id="Expr.round-3825"><a href="#Expr.round-3825"><span class="linenos">3825</span></a>        <span class="c1"># answer on a finite number of those digits, e.g.</span>
</span><span id="Expr.round-3826"><a href="#Expr.round-3826"><span class="linenos">3826</span></a>        <span class="c1"># .575 2589569785738035/2**52 in binary.</span>
</span><span id="Expr.round-3827"><a href="#Expr.round-3827"><span class="linenos">3827</span></a>        <span class="c1"># mpmath shows us that the first 18 digits are</span>
</span><span id="Expr.round-3828"><a href="#Expr.round-3828"><span class="linenos">3828</span></a>        <span class="c1">#     &gt;&gt;&gt; Float(.575).n(18)</span>
</span><span id="Expr.round-3829"><a href="#Expr.round-3829"><span class="linenos">3829</span></a>        <span class="c1">#     0.574999999999999956</span>
</span><span id="Expr.round-3830"><a href="#Expr.round-3830"><span class="linenos">3830</span></a>        <span class="c1"># The default precision is 15 digits and if we ask</span>
</span><span id="Expr.round-3831"><a href="#Expr.round-3831"><span class="linenos">3831</span></a>        <span class="c1"># for 15 we get</span>
</span><span id="Expr.round-3832"><a href="#Expr.round-3832"><span class="linenos">3832</span></a>        <span class="c1">#     &gt;&gt;&gt; Float(.575).n(15)</span>
</span><span id="Expr.round-3833"><a href="#Expr.round-3833"><span class="linenos">3833</span></a>        <span class="c1">#     0.575000000000000</span>
</span><span id="Expr.round-3834"><a href="#Expr.round-3834"><span class="linenos">3834</span></a>        <span class="c1"># mpmath handles rounding at the 15th digit. But we</span>
</span><span id="Expr.round-3835"><a href="#Expr.round-3835"><span class="linenos">3835</span></a>        <span class="c1"># need to be careful since the user might be asking</span>
</span><span id="Expr.round-3836"><a href="#Expr.round-3836"><span class="linenos">3836</span></a>        <span class="c1"># for rounding at the last digit and our semantics</span>
</span><span id="Expr.round-3837"><a href="#Expr.round-3837"><span class="linenos">3837</span></a>        <span class="c1"># are to round toward the even final digit when there</span>
</span><span id="Expr.round-3838"><a href="#Expr.round-3838"><span class="linenos">3838</span></a>        <span class="c1"># is a tie. So the extra digit will be used to make</span>
</span><span id="Expr.round-3839"><a href="#Expr.round-3839"><span class="linenos">3839</span></a>        <span class="c1"># that decision. In this case, the value is the same</span>
</span><span id="Expr.round-3840"><a href="#Expr.round-3840"><span class="linenos">3840</span></a>        <span class="c1"># to 15 digits:</span>
</span><span id="Expr.round-3841"><a href="#Expr.round-3841"><span class="linenos">3841</span></a>        <span class="c1">#     &gt;&gt;&gt; Float(.575).n(16)</span>
</span><span id="Expr.round-3842"><a href="#Expr.round-3842"><span class="linenos">3842</span></a>        <span class="c1">#     0.5750000000000000</span>
</span><span id="Expr.round-3843"><a href="#Expr.round-3843"><span class="linenos">3843</span></a>        <span class="c1"># Now converting this to the 15 known digits gives</span>
</span><span id="Expr.round-3844"><a href="#Expr.round-3844"><span class="linenos">3844</span></a>        <span class="c1">#     575000000000000.0</span>
</span><span id="Expr.round-3845"><a href="#Expr.round-3845"><span class="linenos">3845</span></a>        <span class="c1"># which rounds to integer</span>
</span><span id="Expr.round-3846"><a href="#Expr.round-3846"><span class="linenos">3846</span></a>        <span class="c1">#    5750000000000000</span>
</span><span id="Expr.round-3847"><a href="#Expr.round-3847"><span class="linenos">3847</span></a>        <span class="c1"># And now we can round to the desired digt, e.g. at</span>
</span><span id="Expr.round-3848"><a href="#Expr.round-3848"><span class="linenos">3848</span></a>        <span class="c1"># the second from the left and we get</span>
</span><span id="Expr.round-3849"><a href="#Expr.round-3849"><span class="linenos">3849</span></a>        <span class="c1">#    5800000000000000</span>
</span><span id="Expr.round-3850"><a href="#Expr.round-3850"><span class="linenos">3850</span></a>        <span class="c1"># and rescaling that gives</span>
</span><span id="Expr.round-3851"><a href="#Expr.round-3851"><span class="linenos">3851</span></a>        <span class="c1">#    0.58</span>
</span><span id="Expr.round-3852"><a href="#Expr.round-3852"><span class="linenos">3852</span></a>        <span class="c1"># as the final result.</span>
</span><span id="Expr.round-3853"><a href="#Expr.round-3853"><span class="linenos">3853</span></a>        <span class="c1"># If the value is made slightly less than 0.575 we might</span>
</span><span id="Expr.round-3854"><a href="#Expr.round-3854"><span class="linenos">3854</span></a>        <span class="c1"># still obtain the same value:</span>
</span><span id="Expr.round-3855"><a href="#Expr.round-3855"><span class="linenos">3855</span></a>        <span class="c1">#    &gt;&gt;&gt; Float(.575-1e-16).n(16)*10**15</span>
</span><span id="Expr.round-3856"><a href="#Expr.round-3856"><span class="linenos">3856</span></a>        <span class="c1">#    574999999999999.8</span>
</span><span id="Expr.round-3857"><a href="#Expr.round-3857"><span class="linenos">3857</span></a>        <span class="c1"># What 15 digits best represents the known digits (which are</span>
</span><span id="Expr.round-3858"><a href="#Expr.round-3858"><span class="linenos">3858</span></a>        <span class="c1"># to the left of the decimal? 5750000000000000, the same as</span>
</span><span id="Expr.round-3859"><a href="#Expr.round-3859"><span class="linenos">3859</span></a>        <span class="c1"># before. The only way we will round down (in this case) is</span>
</span><span id="Expr.round-3860"><a href="#Expr.round-3860"><span class="linenos">3860</span></a>        <span class="c1"># if we declared that we had more than 15 digits of precision.</span>
</span><span id="Expr.round-3861"><a href="#Expr.round-3861"><span class="linenos">3861</span></a>        <span class="c1"># For example, if we use 16 digits of precision, the integer</span>
</span><span id="Expr.round-3862"><a href="#Expr.round-3862"><span class="linenos">3862</span></a>        <span class="c1"># we deal with is</span>
</span><span id="Expr.round-3863"><a href="#Expr.round-3863"><span class="linenos">3863</span></a>        <span class="c1">#    &gt;&gt;&gt; Float(.575-1e-16).n(17)*10**16</span>
</span><span id="Expr.round-3864"><a href="#Expr.round-3864"><span class="linenos">3864</span></a>        <span class="c1">#    5749999999999998.4</span>
</span><span id="Expr.round-3865"><a href="#Expr.round-3865"><span class="linenos">3865</span></a>        <span class="c1"># and this now rounds to 5749999999999998 and (if we round to</span>
</span><span id="Expr.round-3866"><a href="#Expr.round-3866"><span class="linenos">3866</span></a>        <span class="c1"># the 2nd digit from the left) we get 5700000000000000.</span>
</span><span id="Expr.round-3867"><a href="#Expr.round-3867"><span class="linenos">3867</span></a>        <span class="c1">#</span>
</span><span id="Expr.round-3868"><a href="#Expr.round-3868"><span class="linenos">3868</span></a>        <span class="n">xf</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">n</span><span class="p">(</span><span class="n">dps</span> <span class="o">+</span> <span class="n">extra</span><span class="p">)</span><span class="o">*</span><span class="n">Pow</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">shift</span><span class="p">)</span>
</span><span id="Expr.round-3869"><a href="#Expr.round-3869"><span class="linenos">3869</span></a>        <span class="n">xi</span> <span class="o">=</span> <span class="n">Integer</span><span class="p">(</span><span class="n">xf</span><span class="p">)</span>
</span><span id="Expr.round-3870"><a href="#Expr.round-3870"><span class="linenos">3870</span></a>        <span class="c1"># use the last digit to select the value of xi</span>
</span><span id="Expr.round-3871"><a href="#Expr.round-3871"><span class="linenos">3871</span></a>        <span class="c1"># nearest to x before rounding at the desired digit</span>
</span><span id="Expr.round-3872"><a href="#Expr.round-3872"><span class="linenos">3872</span></a>        <span class="n">sign</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="o">-</span><span class="mi">1</span>
</span><span id="Expr.round-3873"><a href="#Expr.round-3873"><span class="linenos">3873</span></a>        <span class="n">dif2</span> <span class="o">=</span> <span class="n">sign</span><span class="o">*</span><span class="p">(</span><span class="n">xf</span> <span class="o">-</span> <span class="n">xi</span><span class="p">)</span><span class="o">.</span><span class="n">n</span><span class="p">(</span><span class="n">extra</span><span class="p">)</span>
</span><span id="Expr.round-3874"><a href="#Expr.round-3874"><span class="linenos">3874</span></a>        <span class="k">if</span> <span class="n">dif2</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Expr.round-3875"><a href="#Expr.round-3875"><span class="linenos">3875</span></a>            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
</span><span id="Expr.round-3876"><a href="#Expr.round-3876"><span class="linenos">3876</span></a>                <span class="s1">&#39;not expecting int(x) to round away from 0&#39;</span><span class="p">)</span>
</span><span id="Expr.round-3877"><a href="#Expr.round-3877"><span class="linenos">3877</span></a>        <span class="k">if</span> <span class="n">dif2</span> <span class="o">&gt;</span> <span class="mf">.5</span><span class="p">:</span>
</span><span id="Expr.round-3878"><a href="#Expr.round-3878"><span class="linenos">3878</span></a>            <span class="n">xi</span> <span class="o">+=</span> <span class="n">sign</span>  <span class="c1"># round away from 0</span>
</span><span id="Expr.round-3879"><a href="#Expr.round-3879"><span class="linenos">3879</span></a>        <span class="k">elif</span> <span class="n">dif2</span> <span class="o">==</span> <span class="mf">.5</span><span class="p">:</span>
</span><span id="Expr.round-3880"><a href="#Expr.round-3880"><span class="linenos">3880</span></a>            <span class="n">xi</span> <span class="o">+=</span> <span class="n">sign</span> <span class="k">if</span> <span class="n">xi</span><span class="o">%</span><span class="mi">2</span> <span class="k">else</span> <span class="o">-</span><span class="n">sign</span>  <span class="c1"># round toward even</span>
</span><span id="Expr.round-3881"><a href="#Expr.round-3881"><span class="linenos">3881</span></a>        <span class="c1"># shift p to the new position</span>
</span><span id="Expr.round-3882"><a href="#Expr.round-3882"><span class="linenos">3882</span></a>        <span class="n">ip</span> <span class="o">=</span> <span class="n">p</span> <span class="o">-</span> <span class="n">shift</span>
</span><span id="Expr.round-3883"><a href="#Expr.round-3883"><span class="linenos">3883</span></a>        <span class="c1"># let Python handle the int rounding then rescale</span>
</span><span id="Expr.round-3884"><a href="#Expr.round-3884"><span class="linenos">3884</span></a>        <span class="n">xr</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">xi</span><span class="o">.</span><span class="n">p</span><span class="p">,</span> <span class="n">ip</span><span class="p">)</span>
</span><span id="Expr.round-3885"><a href="#Expr.round-3885"><span class="linenos">3885</span></a>        <span class="c1"># restore scale</span>
</span><span id="Expr.round-3886"><a href="#Expr.round-3886"><span class="linenos">3886</span></a>        <span class="n">rv</span> <span class="o">=</span> <span class="n">Rational</span><span class="p">(</span><span class="n">xr</span><span class="p">,</span> <span class="n">Pow</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">shift</span><span class="p">))</span>
</span><span id="Expr.round-3887"><a href="#Expr.round-3887"><span class="linenos">3887</span></a>        <span class="c1"># return Float or Integer</span>
</span><span id="Expr.round-3888"><a href="#Expr.round-3888"><span class="linenos">3888</span></a>        <span class="k">if</span> <span class="n">rv</span><span class="o">.</span><span class="n">is_Integer</span><span class="p">:</span>
</span><span id="Expr.round-3889"><a href="#Expr.round-3889"><span class="linenos">3889</span></a>            <span class="k">if</span> <span class="n">n</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># the single-arg case</span>
</span><span id="Expr.round-3890"><a href="#Expr.round-3890"><span class="linenos">3890</span></a>                <span class="k">return</span> <span class="n">rv</span>
</span><span id="Expr.round-3891"><a href="#Expr.round-3891"><span class="linenos">3891</span></a>            <span class="c1"># use str or else it won&#39;t be a float</span>
</span><span id="Expr.round-3892"><a href="#Expr.round-3892"><span class="linenos">3892</span></a>            <span class="k">return</span> <span class="n">Float</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">rv</span><span class="p">),</span> <span class="n">dps</span><span class="p">)</span>  <span class="c1"># keep same precision</span>
</span><span id="Expr.round-3893"><a href="#Expr.round-3893"><span class="linenos">3893</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Expr.round-3894"><a href="#Expr.round-3894"><span class="linenos">3894</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">allow</span> <span class="ow">and</span> <span class="n">rv</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="p">:</span>
</span><span id="Expr.round-3895"><a href="#Expr.round-3895"><span class="linenos">3895</span></a>                <span class="n">allow</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="Expr.round-3896"><a href="#Expr.round-3896"><span class="linenos">3896</span></a>            <span class="k">return</span> <span class="n">Float</span><span class="p">(</span><span class="n">rv</span><span class="p">,</span> <span class="n">allow</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Return x rounded to the given decimal place.</p>

<p>If a complex number would results, apply round to the real
and imaginary components of the number.</p>

<h1 id="examples">Examples</h1>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">pi</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">I</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">Number</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pi</span><span class="o">.</span><span class="n">round</span><span class="p">()</span>
<span class="go">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pi</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">3.14</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span> <span class="o">+</span> <span class="n">E</span><span class="o">*</span><span class="n">I</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">()</span>
<span class="go">6 + 3*I</span>
</code></pre>
</div>

<p>The round method has a chopping effect:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span> <span class="o">+</span> <span class="n">I</span><span class="o">/</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">()</span>
<span class="go">6</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">pi</span><span class="o">/</span><span class="mi">10</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">I</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">()</span>
<span class="go">2*I</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">pi</span><span class="o">/</span><span class="mi">10</span> <span class="o">+</span> <span class="n">E</span><span class="o">*</span><span class="n">I</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">0.31 + 2.72*I</span>
</code></pre>
</div>

<h1 id="notes">Notes</h1>

<p>The Python <code><a href="#Expr.round">round</a></code> function uses the SymPy <code><a href="#Expr.round">round</a></code> method so it
will always return a SymPy number (not a Python float or int):</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="nb">isinstance</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">S</span><span class="p">(</span><span class="mi">123</span><span class="p">),</span> <span class="o">-</span><span class="mi">2</span><span class="p">),</span> <span class="n">Number</span><span class="p">)</span>
<span class="go">True</span>
</code></pre>
</div>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt>sympy.core.basic.Basic</dt>
                                <dd id="Expr.copy" class="function">copy</dd>
                <dd id="Expr.assumptions0" class="variable">assumptions0</dd>
                <dd id="Expr.compare" class="function">compare</dd>
                <dd id="Expr.fromiter" class="function">fromiter</dd>
                <dd id="Expr.class_key" class="function">class_key</dd>
                <dd id="Expr.dummy_eq" class="function">dummy_eq</dd>
                <dd id="Expr.atoms" class="function">atoms</dd>
                <dd id="Expr.free_symbols" class="variable">free_symbols</dd>
                <dd id="Expr.as_dummy" class="function">as_dummy</dd>
                <dd id="Expr.canonical_variables" class="variable">canonical_variables</dd>
                <dd id="Expr.rcall" class="function">rcall</dd>
                <dd id="Expr.is_hypergeometric" class="function">is_hypergeometric</dd>
                <dd id="Expr.is_comparable" class="variable">is_comparable</dd>
                <dd id="Expr.func" class="variable">func</dd>
                <dd id="Expr.args" class="variable">args</dd>
                <dd id="Expr.subs" class="function">subs</dd>
                <dd id="Expr.xreplace" class="function">xreplace</dd>
                <dd id="Expr.has" class="function">has</dd>
                <dd id="Expr.has_free" class="function">has_free</dd>
                <dd id="Expr.replace" class="function">replace</dd>
                <dd id="Expr.find" class="function">find</dd>
                <dd id="Expr.count" class="function">count</dd>
                <dd id="Expr.matches" class="function">matches</dd>
                <dd id="Expr.match" class="function">match</dd>
                <dd id="Expr.doit" class="function">doit</dd>
                <dd id="Expr.simplify" class="function">simplify</dd>
                <dd id="Expr.refine" class="function">refine</dd>
                <dd id="Expr.rewrite" class="function">rewrite</dd>

            </div>
            <div><dt>sympy.core.evalf.EvalfMixin</dt>
                                <dd id="Expr.evalf" class="function">evalf</dd>
                <dd id="Expr.n" class="function">n</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="energy">
                            <input id="energy-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">energy</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">indices</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="o">~</span><span class="n">E</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span> <span class="o">...</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="o">~</span><span class="n">E</span>:</span></span>

                <label class="view-source-button" for="energy-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#energy"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="energy-25"><a href="#energy-25"><span class="linenos">25</span></a><span class="k">def</span> <span class="nf">energy</span><span class="p">(</span><span class="n">indices</span><span class="p">:</span> <span class="n">Indices</span><span class="p">[</span><span class="n">E</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">E</span><span class="p">:</span>
</span><span id="energy-26"><a href="#energy-26"><span class="linenos">26</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="energy-27"><a href="#energy-27"><span class="linenos">27</span></a><span class="sd">    energy(indices)</span>
</span><span id="energy-28"><a href="#energy-28"><span class="linenos">28</span></a>
</span><span id="energy-29"><a href="#energy-29"><span class="linenos">29</span></a><span class="sd">    Returns the sum M(m) of operator sequence indices.</span>
</span><span id="energy-30"><a href="#energy-30"><span class="linenos">30</span></a>
</span><span id="energy-31"><a href="#energy-31"><span class="linenos">31</span></a><span class="sd">    Parameters</span>
</span><span id="energy-32"><a href="#energy-32"><span class="linenos">32</span></a><span class="sd">    ----------</span>
</span><span id="energy-33"><a href="#energy-33"><span class="linenos">33</span></a><span class="sd">    indices</span>
</span><span id="energy-34"><a href="#energy-34"><span class="linenos">34</span></a><span class="sd">        Operator sequence indices.</span>
</span><span id="energy-35"><a href="#energy-35"><span class="linenos">35</span></a>
</span><span id="energy-36"><a href="#energy-36"><span class="linenos">36</span></a><span class="sd">    Returns</span>
</span><span id="energy-37"><a href="#energy-37"><span class="linenos">37</span></a><span class="sd">    -------</span>
</span><span id="energy-38"><a href="#energy-38"><span class="linenos">38</span></a><span class="sd">    Union[int, float, Fraction, complex, Expr]</span>
</span><span id="energy-39"><a href="#energy-39"><span class="linenos">39</span></a><span class="sd">        Sum M(m).</span>
</span><span id="energy-40"><a href="#energy-40"><span class="linenos">40</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="energy-41"><a href="#energy-41"><span class="linenos">41</span></a>
</span><span id="energy-42"><a href="#energy-42"><span class="linenos">42</span></a>    <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="n">reduce</span><span class="p">(</span><span class="n">operator</span><span class="o">.</span><span class="n">add</span><span class="p">,</span> <span class="n">indices</span><span class="p">),</span> <span class="n">cast</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
</span></pre></div>


            <div class="docstring"><p>energy(indices)</p>

<p>Returns the sum M(m) of operator sequence indices.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>indices</strong>: Operator sequence indices.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>Union[int, float, Fraction, complex, Expr]</strong>: Sum M(m).</li>
</ul>
</div>


                </section>
                <section id="energy_broad">
                            <input id="energy_broad-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">energy_broad</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">indices</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="n">fractions</span><span class="o">.</span><span class="n">Fraction</span><span class="p">],</span> <span class="o">...</span><span class="p">],</span> <span class="o">...</span><span class="p">]</span>,</span><span class="param">	<span class="n">delta</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="n">fractions</span><span class="o">.</span><span class="n">Fraction</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="n">fractions</span><span class="o">.</span><span class="n">Fraction</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="energy_broad-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#energy_broad"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="energy_broad-45"><a href="#energy_broad-45"><span class="linenos">45</span></a><span class="k">def</span> <span class="nf">energy_broad</span><span class="p">(</span><span class="n">indices</span><span class="p">:</span> <span class="n">Indices</span><span class="p">[</span><span class="n">Energy_real</span><span class="p">],</span> <span class="n">delta</span><span class="p">:</span> <span class="n">Energy_real</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Energy_real</span><span class="p">:</span>
</span><span id="energy_broad-46"><a href="#energy_broad-46"><span class="linenos">46</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="energy_broad-47"><a href="#energy_broad-47"><span class="linenos">47</span></a><span class="sd">    energy_broad(indices)</span>
</span><span id="energy_broad-48"><a href="#energy_broad-48"><span class="linenos">48</span></a>
</span><span id="energy_broad-49"><a href="#energy_broad-49"><span class="linenos">49</span></a><span class="sd">    Returns the *broadened* sum M(m)*theta(|M(m)|-delta) of operator sequence indices, where theta is the Heaviside</span>
</span><span id="energy_broad-50"><a href="#energy_broad-50"><span class="linenos">50</span></a><span class="sd">    step function.</span>
</span><span id="energy_broad-51"><a href="#energy_broad-51"><span class="linenos">51</span></a>
</span><span id="energy_broad-52"><a href="#energy_broad-52"><span class="linenos">52</span></a><span class="sd">    Parameters</span>
</span><span id="energy_broad-53"><a href="#energy_broad-53"><span class="linenos">53</span></a><span class="sd">    ----------</span>
</span><span id="energy_broad-54"><a href="#energy_broad-54"><span class="linenos">54</span></a><span class="sd">    indices</span>
</span><span id="energy_broad-55"><a href="#energy_broad-55"><span class="linenos">55</span></a><span class="sd">        Operator sequence indices.</span>
</span><span id="energy_broad-56"><a href="#energy_broad-56"><span class="linenos">56</span></a>
</span><span id="energy_broad-57"><a href="#energy_broad-57"><span class="linenos">57</span></a><span class="sd">    Returns</span>
</span><span id="energy_broad-58"><a href="#energy_broad-58"><span class="linenos">58</span></a><span class="sd">    -------</span>
</span><span id="energy_broad-59"><a href="#energy_broad-59"><span class="linenos">59</span></a><span class="sd">    Union[int, float, Fraction]</span>
</span><span id="energy_broad-60"><a href="#energy_broad-60"><span class="linenos">60</span></a><span class="sd">        Sum M(m)*theta(|M(m)|-delta).</span>
</span><span id="energy_broad-61"><a href="#energy_broad-61"><span class="linenos">61</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="energy_broad-62"><a href="#energy_broad-62"><span class="linenos">62</span></a>
</span><span id="energy_broad-63"><a href="#energy_broad-63"><span class="linenos">63</span></a>    <span class="n">e</span> <span class="o">=</span> <span class="n">energy</span><span class="p">(</span><span class="n">indices</span><span class="p">)</span>
</span><span id="energy_broad-64"><a href="#energy_broad-64"><span class="linenos">64</span></a>    <span class="c1"># also return 0 if `abs(e)` is very close to `delta` to deal with</span>
</span><span id="energy_broad-65"><a href="#energy_broad-65"><span class="linenos">65</span></a>    <span class="c1"># floating errors</span>
</span><span id="energy_broad-66"><a href="#energy_broad-66"><span class="linenos">66</span></a>    <span class="k">return</span> <span class="n">e</span> <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">e</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">delta</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">are_close</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">e</span><span class="p">),</span> <span class="n">delta</span><span class="p">)</span> <span class="k">else</span> <span class="mi">0</span>
</span></pre></div>


            <div class="docstring"><p>energy_broad(indices)</p>

<p>Returns the <em>broadened</em> sum M(m)*theta(|M(m)|-delta) of operator sequence indices, where theta is the Heaviside
step function.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>indices</strong>: Operator sequence indices.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>Union[int, float, Fraction]</strong>: Sum M(m)*theta(|M(m)|-delta).</li>
</ul>
</div>


                </section>
                <section id="signum">
                            <input id="signum-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">signum</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">indices1</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="n">fractions</span><span class="o">.</span><span class="n">Fraction</span><span class="p">],</span> <span class="o">...</span><span class="p">],</span> <span class="o">...</span><span class="p">]</span>,</span><span class="param">	<span class="n">indices2</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="n">fractions</span><span class="o">.</span><span class="n">Fraction</span><span class="p">],</span> <span class="o">...</span><span class="p">],</span> <span class="o">...</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="nb">int</span>:</span></span>

                <label class="view-source-button" for="signum-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#signum"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="signum-69"><a href="#signum-69"><span class="linenos">69</span></a><span class="k">def</span> <span class="nf">signum</span><span class="p">(</span><span class="n">indices1</span><span class="p">:</span> <span class="n">Indices</span><span class="p">[</span><span class="n">Energy_real</span><span class="p">],</span> <span class="n">indices2</span><span class="p">:</span> <span class="n">Indices</span><span class="p">[</span><span class="n">Energy_real</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="signum-70"><a href="#signum-70"><span class="linenos">70</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="signum-71"><a href="#signum-71"><span class="linenos">71</span></a><span class="sd">    signum(indices1, indices2)</span>
</span><span id="signum-72"><a href="#signum-72"><span class="linenos">72</span></a>
</span><span id="signum-73"><a href="#signum-73"><span class="linenos">73</span></a><span class="sd">    Returns the prefactor sgn(M(m1)) - sgn(M(m2)).</span>
</span><span id="signum-74"><a href="#signum-74"><span class="linenos">74</span></a>
</span><span id="signum-75"><a href="#signum-75"><span class="linenos">75</span></a><span class="sd">    Parameters</span>
</span><span id="signum-76"><a href="#signum-76"><span class="linenos">76</span></a><span class="sd">    ----------</span>
</span><span id="signum-77"><a href="#signum-77"><span class="linenos">77</span></a><span class="sd">    indices1</span>
</span><span id="signum-78"><a href="#signum-78"><span class="linenos">78</span></a><span class="sd">        Operator sequence indices whose sgn(M(m1)) is to be added.</span>
</span><span id="signum-79"><a href="#signum-79"><span class="linenos">79</span></a><span class="sd">    indices2</span>
</span><span id="signum-80"><a href="#signum-80"><span class="linenos">80</span></a><span class="sd">        Operator sequence indices whose sgn(M(m2)) is to be substracted.</span>
</span><span id="signum-81"><a href="#signum-81"><span class="linenos">81</span></a>
</span><span id="signum-82"><a href="#signum-82"><span class="linenos">82</span></a><span class="sd">    Returns</span>
</span><span id="signum-83"><a href="#signum-83"><span class="linenos">83</span></a><span class="sd">    -------</span>
</span><span id="signum-84"><a href="#signum-84"><span class="linenos">84</span></a><span class="sd">    int</span>
</span><span id="signum-85"><a href="#signum-85"><span class="linenos">85</span></a><span class="sd">        Difference of signum functions.</span>
</span><span id="signum-86"><a href="#signum-86"><span class="linenos">86</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="signum-87"><a href="#signum-87"><span class="linenos">87</span></a>
</span><span id="signum-88"><a href="#signum-88"><span class="linenos">88</span></a>    <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">energy</span><span class="p">(</span><span class="n">indices1</span><span class="p">)))</span> <span class="o">-</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">energy</span><span class="p">(</span><span class="n">indices2</span><span class="p">)))</span>
</span></pre></div>


            <div class="docstring"><p>signum(indices1, indices2)</p>

<p>Returns the prefactor sgn(M(m1)) - sgn(M(m2)).</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>indices1</strong>: Operator sequence indices whose sgn(M(m1)) is to be added.</li>
<li><strong>indices2</strong>: Operator sequence indices whose sgn(M(m2)) is to be substracted.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>int</strong>: Difference of signum functions.</li>
</ul>
</div>


                </section>
                <section id="signum_broad">
                            <input id="signum_broad-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">signum_broad</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">indices1</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="n">fractions</span><span class="o">.</span><span class="n">Fraction</span><span class="p">],</span> <span class="o">...</span><span class="p">],</span> <span class="o">...</span><span class="p">]</span>,</span><span class="param">	<span class="n">indices2</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="n">fractions</span><span class="o">.</span><span class="n">Fraction</span><span class="p">],</span> <span class="o">...</span><span class="p">],</span> <span class="o">...</span><span class="p">]</span>,</span><span class="param">	<span class="n">delta</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="n">fractions</span><span class="o">.</span><span class="n">Fraction</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="nb">int</span>:</span></span>

                <label class="view-source-button" for="signum_broad-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#signum_broad"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="signum_broad-91"><a href="#signum_broad-91"><span class="linenos"> 91</span></a><span class="k">def</span> <span class="nf">signum_broad</span><span class="p">(</span><span class="n">indices1</span><span class="p">:</span> <span class="n">Indices</span><span class="p">[</span><span class="n">Energy_real</span><span class="p">],</span> <span class="n">indices2</span><span class="p">:</span> <span class="n">Indices</span><span class="p">[</span><span class="n">Energy_real</span><span class="p">],</span> <span class="n">delta</span><span class="p">:</span> <span class="n">Energy_real</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="signum_broad-92"><a href="#signum_broad-92"><span class="linenos"> 92</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="signum_broad-93"><a href="#signum_broad-93"><span class="linenos"> 93</span></a><span class="sd">    signum_broad(indices1, indices2, delta)</span>
</span><span id="signum_broad-94"><a href="#signum_broad-94"><span class="linenos"> 94</span></a>
</span><span id="signum_broad-95"><a href="#signum_broad-95"><span class="linenos"> 95</span></a><span class="sd">    Returns the prefactor sgn_`delta`(M(m1)) - sgn_delta(M(m2)), where sgn_d is the broadened signum function with</span>
</span><span id="signum_broad-96"><a href="#signum_broad-96"><span class="linenos"> 96</span></a><span class="sd">    sgn_d(x) = 0 for |x| &lt;= d and sgn_d(x) = sgn(x), otherwise.</span>
</span><span id="signum_broad-97"><a href="#signum_broad-97"><span class="linenos"> 97</span></a>
</span><span id="signum_broad-98"><a href="#signum_broad-98"><span class="linenos"> 98</span></a><span class="sd">    Parameters</span>
</span><span id="signum_broad-99"><a href="#signum_broad-99"><span class="linenos"> 99</span></a><span class="sd">    ----------</span>
</span><span id="signum_broad-100"><a href="#signum_broad-100"><span class="linenos">100</span></a><span class="sd">    indices1</span>
</span><span id="signum_broad-101"><a href="#signum_broad-101"><span class="linenos">101</span></a><span class="sd">        Operator sequence indices whose sgn_d(M(m1)) is to be added.</span>
</span><span id="signum_broad-102"><a href="#signum_broad-102"><span class="linenos">102</span></a><span class="sd">    indices2</span>
</span><span id="signum_broad-103"><a href="#signum_broad-103"><span class="linenos">103</span></a><span class="sd">        Operator sequence indices whose sgn_d(M(m2)) is to be substracted.</span>
</span><span id="signum_broad-104"><a href="#signum_broad-104"><span class="linenos">104</span></a>
</span><span id="signum_broad-105"><a href="#signum_broad-105"><span class="linenos">105</span></a><span class="sd">    Returns</span>
</span><span id="signum_broad-106"><a href="#signum_broad-106"><span class="linenos">106</span></a><span class="sd">    -------</span>
</span><span id="signum_broad-107"><a href="#signum_broad-107"><span class="linenos">107</span></a><span class="sd">    int</span>
</span><span id="signum_broad-108"><a href="#signum_broad-108"><span class="linenos">108</span></a><span class="sd">        Difference of broad signum functions.</span>
</span><span id="signum_broad-109"><a href="#signum_broad-109"><span class="linenos">109</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="signum_broad-110"><a href="#signum_broad-110"><span class="linenos">110</span></a>
</span><span id="signum_broad-111"><a href="#signum_broad-111"><span class="linenos">111</span></a>    <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">energy_broad</span><span class="p">(</span><span class="n">indices1</span><span class="p">,</span> <span class="n">delta</span><span class="p">)))</span> <span class="o">-</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">energy_broad</span><span class="p">(</span><span class="n">indices2</span><span class="p">,</span> <span class="n">delta</span><span class="p">)))</span>
</span></pre></div>


            <div class="docstring"><p>signum_broad(indices1, indices2, delta)</p>

<p>Returns the prefactor sgn_<code>delta</code>(M(m1)) - sgn_delta(M(m2)), where sgn_d is the broadened signum function with
sgn_d(x) = 0 for |x| &lt;= d and sgn_d(x) = sgn(x), otherwise.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>indices1</strong>: Operator sequence indices whose sgn_d(M(m1)) is to be added.</li>
<li><strong>indices2</strong>: Operator sequence indices whose sgn_d(M(m2)) is to be substracted.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>int</strong>: Difference of broad signum functions.</li>
</ul>
</div>


                </section>
                <section id="signum_complex">
                            <input id="signum_complex-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">signum_complex</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">indices1</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">complex</span><span class="p">,</span> <span class="n"><a href="#Expr">mathematics.Expr</a></span><span class="p">],</span> <span class="o">...</span><span class="p">],</span> <span class="o">...</span><span class="p">]</span>,</span><span class="param">	<span class="n">indices2</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">complex</span><span class="p">,</span> <span class="n"><a href="#Expr">mathematics.Expr</a></span><span class="p">],</span> <span class="o">...</span><span class="p">],</span> <span class="o">...</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="n">Union</span><span class="p">[</span><span class="nb">complex</span><span class="p">,</span> <span class="n"><a href="#Expr">mathematics.Expr</a></span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="signum_complex-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#signum_complex"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="signum_complex-114"><a href="#signum_complex-114"><span class="linenos">114</span></a><span class="k">def</span> <span class="nf">signum_complex</span><span class="p">(</span><span class="n">indices1</span><span class="p">:</span> <span class="n">Indices</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">complex</span><span class="p">,</span> <span class="n">Expr</span><span class="p">]],</span> <span class="n">indices2</span><span class="p">:</span> <span class="n">Indices</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">complex</span><span class="p">,</span> <span class="n">Expr</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="nb">complex</span><span class="p">,</span>
</span><span id="signum_complex-115"><a href="#signum_complex-115"><span class="linenos">115</span></a>                                                                                                              <span class="n">Expr</span><span class="p">]:</span>
</span><span id="signum_complex-116"><a href="#signum_complex-116"><span class="linenos">116</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="signum_complex-117"><a href="#signum_complex-117"><span class="linenos">117</span></a><span class="sd">    signum_complex(indices1, indices2)</span>
</span><span id="signum_complex-118"><a href="#signum_complex-118"><span class="linenos">118</span></a>
</span><span id="signum_complex-119"><a href="#signum_complex-119"><span class="linenos">119</span></a><span class="sd">    Returns the prefactor sgn(M(m1)) - sgn(M(m2)) with the definition sgn(z) = z / |z| as used in the Schmiedinghoff,</span>
</span><span id="signum_complex-120"><a href="#signum_complex-120"><span class="linenos">120</span></a><span class="sd">    Uhrig paper.</span>
</span><span id="signum_complex-121"><a href="#signum_complex-121"><span class="linenos">121</span></a>
</span><span id="signum_complex-122"><a href="#signum_complex-122"><span class="linenos">122</span></a><span class="sd">    Parameters</span>
</span><span id="signum_complex-123"><a href="#signum_complex-123"><span class="linenos">123</span></a><span class="sd">    ----------</span>
</span><span id="signum_complex-124"><a href="#signum_complex-124"><span class="linenos">124</span></a><span class="sd">    indices1</span>
</span><span id="signum_complex-125"><a href="#signum_complex-125"><span class="linenos">125</span></a><span class="sd">        Operator sequence indices whose complex sgn(M(m1)) is to be added.</span>
</span><span id="signum_complex-126"><a href="#signum_complex-126"><span class="linenos">126</span></a><span class="sd">    indices2</span>
</span><span id="signum_complex-127"><a href="#signum_complex-127"><span class="linenos">127</span></a><span class="sd">        Operator sequence indices whose complex sgn(M(m2)) is to be subtracted.</span>
</span><span id="signum_complex-128"><a href="#signum_complex-128"><span class="linenos">128</span></a>
</span><span id="signum_complex-129"><a href="#signum_complex-129"><span class="linenos">129</span></a><span class="sd">    Returns</span>
</span><span id="signum_complex-130"><a href="#signum_complex-130"><span class="linenos">130</span></a><span class="sd">    -------</span>
</span><span id="signum_complex-131"><a href="#signum_complex-131"><span class="linenos">131</span></a><span class="sd">    Union[complex, Expr]</span>
</span><span id="signum_complex-132"><a href="#signum_complex-132"><span class="linenos">132</span></a><span class="sd">        Difference of complex signum functions.</span>
</span><span id="signum_complex-133"><a href="#signum_complex-133"><span class="linenos">133</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="signum_complex-134"><a href="#signum_complex-134"><span class="linenos">134</span></a>
</span><span id="signum_complex-135"><a href="#signum_complex-135"><span class="linenos">135</span></a>    <span class="n">complex_sgn</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">z</span><span class="p">:</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">is_zero</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="k">else</span> <span class="n">z</span><span class="o">.</span><span class="n">conjugate</span><span class="p">()</span> <span class="o">/</span> <span class="nb">abs</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
</span><span id="signum_complex-136"><a href="#signum_complex-136"><span class="linenos">136</span></a>    <span class="k">return</span> <span class="n">complex_sgn</span><span class="p">(</span><span class="n">energy</span><span class="p">(</span><span class="n">indices1</span><span class="p">))</span> <span class="o">-</span> <span class="n">complex_sgn</span><span class="p">(</span><span class="n">energy</span><span class="p">(</span><span class="n">indices2</span><span class="p">))</span>
</span></pre></div>


            <div class="docstring"><p>signum_complex(indices1, indices2)</p>

<p>Returns the prefactor sgn(M(m1)) - sgn(M(m2)) with the definition sgn(z) = z / |z| as used in the Schmiedinghoff,
Uhrig paper.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>indices1</strong>: Operator sequence indices whose complex sgn(M(m1)) is to be added.</li>
<li><strong>indices2</strong>: Operator sequence indices whose complex sgn(M(m2)) is to be subtracted.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>Union[complex, Expr]</strong>: Difference of complex signum functions.</li>
</ul>
</div>


                </section>
                <section id="exponential">
                            <input id="exponential-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">exponential</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">indices</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="n">fractions</span><span class="o">.</span><span class="n">Fraction</span><span class="p">,</span> <span class="nb">complex</span><span class="p">,</span> <span class="n"><a href="#Expr">mathematics.Expr</a></span><span class="p">],</span> <span class="o">...</span><span class="p">],</span> <span class="o">...</span><span class="p">]</span>,</span><span class="param">	<span class="n">indices1</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="n">fractions</span><span class="o">.</span><span class="n">Fraction</span><span class="p">,</span> <span class="nb">complex</span><span class="p">,</span> <span class="n"><a href="#Expr">mathematics.Expr</a></span><span class="p">],</span> <span class="o">...</span><span class="p">],</span> <span class="o">...</span><span class="p">]</span>,</span><span class="param">	<span class="n">indices2</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="n">fractions</span><span class="o">.</span><span class="n">Fraction</span><span class="p">,</span> <span class="nb">complex</span><span class="p">,</span> <span class="n"><a href="#Expr">mathematics.Expr</a></span><span class="p">],</span> <span class="o">...</span><span class="p">],</span> <span class="o">...</span><span class="p">]</span>,</span><span class="param">	<span class="n">energy_func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="n">fractions</span><span class="o">.</span><span class="n">Fraction</span><span class="p">,</span> <span class="nb">complex</span><span class="p">,</span> <span class="n"><a href="#Expr">mathematics.Expr</a></span><span class="p">],</span> <span class="o">...</span><span class="p">],</span> <span class="o">...</span><span class="p">]],</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="n">fractions</span><span class="o">.</span><span class="n">Fraction</span><span class="p">,</span> <span class="nb">complex</span><span class="p">,</span> <span class="n"><a href="#Expr">mathematics.Expr</a></span><span class="p">]]</span></span><span class="return-annotation">) -> <span class="n"><a href="quasiPolynomial.html#QuasiPolynomial">quasiPolynomial.QuasiPolynomial</a></span>:</span></span>

                <label class="view-source-button" for="exponential-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#exponential"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="exponential-139"><a href="#exponential-139"><span class="linenos">139</span></a><span class="k">def</span> <span class="nf">exponential</span><span class="p">(</span><span class="n">indices</span><span class="p">:</span> <span class="n">Indices</span><span class="p">[</span><span class="n">Energy</span><span class="p">],</span>
</span><span id="exponential-140"><a href="#exponential-140"><span class="linenos">140</span></a>                <span class="n">indices1</span><span class="p">:</span> <span class="n">Indices</span><span class="p">[</span><span class="n">Energy</span><span class="p">],</span>
</span><span id="exponential-141"><a href="#exponential-141"><span class="linenos">141</span></a>                <span class="n">indices2</span><span class="p">:</span> <span class="n">Indices</span><span class="p">[</span><span class="n">Energy</span><span class="p">],</span>
</span><span id="exponential-142"><a href="#exponential-142"><span class="linenos">142</span></a>                <span class="n">energy_func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Indices</span><span class="p">[</span><span class="n">Energy</span><span class="p">]],</span> <span class="n">Energy</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">QuasiPolynomial</span><span class="p">:</span>
</span><span id="exponential-143"><a href="#exponential-143"><span class="linenos">143</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="exponential-144"><a href="#exponential-144"><span class="linenos">144</span></a><span class="sd">    exponential(indices, indices1, indices2)</span>
</span><span id="exponential-145"><a href="#exponential-145"><span class="linenos">145</span></a>
</span><span id="exponential-146"><a href="#exponential-146"><span class="linenos">146</span></a><span class="sd">    Returns the exponential exp(- alpha x) with alpha = - (|M(m)| - |M(m1)| - |M(m2)|).</span>
</span><span id="exponential-147"><a href="#exponential-147"><span class="linenos">147</span></a>
</span><span id="exponential-148"><a href="#exponential-148"><span class="linenos">148</span></a><span class="sd">    Parameters</span>
</span><span id="exponential-149"><a href="#exponential-149"><span class="linenos">149</span></a><span class="sd">    ----------</span>
</span><span id="exponential-150"><a href="#exponential-150"><span class="linenos">150</span></a><span class="sd">    indices</span>
</span><span id="exponential-151"><a href="#exponential-151"><span class="linenos">151</span></a><span class="sd">        Operator sequence indices whose |M(m)| is to be added in the exponential.</span>
</span><span id="exponential-152"><a href="#exponential-152"><span class="linenos">152</span></a><span class="sd">    indices1</span>
</span><span id="exponential-153"><a href="#exponential-153"><span class="linenos">153</span></a><span class="sd">        First operator sequence indices whose |M(m1)| is to be subtracted in the exponential.</span>
</span><span id="exponential-154"><a href="#exponential-154"><span class="linenos">154</span></a><span class="sd">    indices2</span>
</span><span id="exponential-155"><a href="#exponential-155"><span class="linenos">155</span></a><span class="sd">        Second operator sequence indices whose |M(m2)| is to be subtracted in the exponential.</span>
</span><span id="exponential-156"><a href="#exponential-156"><span class="linenos">156</span></a><span class="sd">    energy_func</span>
</span><span id="exponential-157"><a href="#exponential-157"><span class="linenos">157</span></a><span class="sd">        Energy function to be used (normal or broad).</span>
</span><span id="exponential-158"><a href="#exponential-158"><span class="linenos">158</span></a>
</span><span id="exponential-159"><a href="#exponential-159"><span class="linenos">159</span></a><span class="sd">    Returns</span>
</span><span id="exponential-160"><a href="#exponential-160"><span class="linenos">160</span></a><span class="sd">    -------</span>
</span><span id="exponential-161"><a href="#exponential-161"><span class="linenos">161</span></a><span class="sd">    QuasiPolynomial</span>
</span><span id="exponential-162"><a href="#exponential-162"><span class="linenos">162</span></a><span class="sd">        Resulting quasi-polynomial.</span>
</span><span id="exponential-163"><a href="#exponential-163"><span class="linenos">163</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="exponential-164"><a href="#exponential-164"><span class="linenos">164</span></a>
</span><span id="exponential-165"><a href="#exponential-165"><span class="linenos">165</span></a>    <span class="n">alpha</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">energy_func</span><span class="p">(</span><span class="n">indices</span><span class="p">))</span> <span class="o">-</span> <span class="nb">abs</span><span class="p">(</span><span class="n">energy_func</span><span class="p">(</span><span class="n">indices1</span><span class="p">))</span> <span class="o">-</span> <span class="nb">abs</span><span class="p">(</span><span class="n">energy_func</span><span class="p">(</span><span class="n">indices2</span><span class="p">))</span>
</span><span id="exponential-166"><a href="#exponential-166"><span class="linenos">166</span></a>    <span class="k">return</span> <span class="n">QuasiPolynomial</span><span class="o">.</span><span class="n">new</span><span class="p">({</span><span class="o">-</span><span class="n">alpha</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">]})</span>
</span></pre></div>


            <div class="docstring"><p>exponential(indices, indices1, indices2)</p>

<p>Returns the exponential exp(- alpha x) with alpha = - (|M(m)| - |M(m1)| - |M(m2)|).</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>indices</strong>: Operator sequence indices whose |M(m)| is to be added in the exponential.</li>
<li><strong>indices1</strong>: First operator sequence indices whose |M(m1)| is to be subtracted in the exponential.</li>
<li><strong>indices2</strong>: Second operator sequence indices whose |M(m2)| is to be subtracted in the exponential.</li>
<li><strong>energy_func</strong>: Energy function to be used (normal or broad).</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>QuasiPolynomial</strong>: Resulting quasi-polynomial.</li>
</ul>
</div>


                </section>
                <section id="partitions">
                            <input id="partitions-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">partitions</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">sequence</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span> <span class="o">...</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span> <span class="o">...</span><span class="p">],</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span> <span class="o">...</span><span class="p">]]]</span>:</span></span>

                <label class="view-source-button" for="partitions-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#partitions"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="partitions-169"><a href="#partitions-169"><span class="linenos">169</span></a><span class="k">def</span> <span class="nf">partitions</span><span class="p">(</span><span class="n">sequence</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">Sequence</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">]]:</span>
</span><span id="partitions-170"><a href="#partitions-170"><span class="linenos">170</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="partitions-171"><a href="#partitions-171"><span class="linenos">171</span></a><span class="sd">    partitions(sequence)</span>
</span><span id="partitions-172"><a href="#partitions-172"><span class="linenos">172</span></a>
</span><span id="partitions-173"><a href="#partitions-173"><span class="linenos">173</span></a><span class="sd">    Returns all partitions of the operator sequence (m, n, o, ...) into ((m1, n1, o1, ...), (m2, n2, o2, ...)).</span>
</span><span id="partitions-174"><a href="#partitions-174"><span class="linenos">174</span></a>
</span><span id="partitions-175"><a href="#partitions-175"><span class="linenos">175</span></a><span class="sd">    Parameters</span>
</span><span id="partitions-176"><a href="#partitions-176"><span class="linenos">176</span></a><span class="sd">    ----------</span>
</span><span id="partitions-177"><a href="#partitions-177"><span class="linenos">177</span></a><span class="sd">    sequence</span>
</span><span id="partitions-178"><a href="#partitions-178"><span class="linenos">178</span></a><span class="sd">        Operator sequence to be partitioned.</span>
</span><span id="partitions-179"><a href="#partitions-179"><span class="linenos">179</span></a>
</span><span id="partitions-180"><a href="#partitions-180"><span class="linenos">180</span></a><span class="sd">    Returns</span>
</span><span id="partitions-181"><a href="#partitions-181"><span class="linenos">181</span></a><span class="sd">    -------</span>
</span><span id="partitions-182"><a href="#partitions-182"><span class="linenos">182</span></a><span class="sd">    List[Tuple[Tuple[Tuple[int,...],...],Tuple[Tuple[int,...],...]]]</span>
</span><span id="partitions-183"><a href="#partitions-183"><span class="linenos">183</span></a><span class="sd">        List of partitions.</span>
</span><span id="partitions-184"><a href="#partitions-184"><span class="linenos">184</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="partitions-185"><a href="#partitions-185"><span class="linenos">185</span></a>
</span><span id="partitions-186"><a href="#partitions-186"><span class="linenos">186</span></a>    <span class="c1"># TODO: Why we have to look at all possible partitions, especially those where we have different amount of terms on</span>
</span><span id="partitions-187"><a href="#partitions-187"><span class="linenos">187</span></a>    <span class="c1">#  the left side for commuting Hilbert spaces? Should this depend on the starting conditions e.g. is this needed for</span>
</span><span id="partitions-188"><a href="#partitions-188"><span class="linenos">188</span></a>    <span class="c1">#  the Dicke model?</span>
</span><span id="partitions-189"><a href="#partitions-189"><span class="linenos">189</span></a>    <span class="c1">#  -&gt; Maybe add an option to restrict partitions depending on the model</span>
</span><span id="partitions-190"><a href="#partitions-190"><span class="linenos">190</span></a>    <span class="n">partitions</span> <span class="o">=</span> <span class="p">[[(</span><span class="n">s</span><span class="p">[:</span><span class="n">i</span><span class="p">],</span> <span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">:])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">sequence</span><span class="p">]</span>
</span><span id="partitions-191"><a href="#partitions-191"><span class="linenos">191</span></a>    <span class="c1"># skip edge cases of completely empty left or right side</span>
</span><span id="partitions-192"><a href="#partitions-192"><span class="linenos">192</span></a>    <span class="n">valid_partitions</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">product</span><span class="p">(</span><span class="o">*</span><span class="n">partitions</span><span class="p">))[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="partitions-193"><a href="#partitions-193"><span class="linenos">193</span></a>    <span class="k">return</span> <span class="p">[(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">pr</span><span class="p">),</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">pr</span><span class="p">))</span> <span class="k">for</span> <span class="n">pr</span> <span class="ow">in</span> <span class="n">valid_partitions</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>partitions(sequence)</p>

<p>Returns all partitions of the operator sequence (m, n, o, ...) into ((m1, n1, o1, ...), (m2, n2, o2, ...)).</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>sequence</strong>: Operator sequence to be partitioned.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>List[Tuple[Tuple[Tuple[int,...],...],Tuple[Tuple[int,...],...]]]</strong>: List of partitions.</li>
</ul>
</div>


                </section>
    </main>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let search, searchErr;

    async function initialize() {
        try {
            search = await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.type = "text/javascript";
                script.async = true;
                script.onload = () => resolve(window.pdocSearch);
                script.onerror = (e) => reject(e);
                script.src = "search.js";
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        } catch (e) {
            console.error("Cannot fetch pdoc search index");
            searchErr = "Cannot fetch search index.";
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const term = getSearchTerm();
            if (!term) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!search) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = search(term);

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(term)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.kind) {
                    case "function":
                        if (doc.fullname.endsWith(".__init__")) {
                            heading = `<span class="name">${doc.fullname.replace(/\.__init__$/, "")}</span>${doc.signature}`;
                        } else {
                            heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span>${doc.signature}`;
                        }
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        if (doc.bases)
                            heading += `<wbr>(<span class="base">${doc.bases}</span>)`;
                        heading += `:`;
                        break;
                    case "variable":
                        heading = `<span class="name">${doc.fullname}</span>`;
                        if (doc.annotation)
                            heading += `<span class="annotation">${doc.annotation}</span>`;
                        if (doc.default_value)
                            heading += `<span class="default_value"> = ${doc.default_value}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.kind}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script></body>
</html>